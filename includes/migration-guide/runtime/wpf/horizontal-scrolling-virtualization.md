---
ms.openlocfilehash: ac7a56dc654ef4fd966077dd25012f0c50b0fc8d
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/15/2020
ms.locfileid: "67857525"
---
### <a name="horizontal-scrolling-and-virtualization"></a>Горизонтальная прокрутка и виртуализация

|   |   |
|---|---|
|Подробнее|Это изменение относится к элементу управления <xref:System.Windows.Controls.ItemsControl?displayProperty=name>, который выполняет собственную виртуализацию в направлении, перпендикулярном основному направлению прокрутки (главным примером является элемент <xref:System.Windows.Controls.DataGrid?displayProperty=name>, для которого EnableColumnVirtualization=&quot;True&quot;).  Результат некоторых операций горизонтальной прокрутки был изменен для получения результатов, которые являются более интуитивно понятными и более подобными результатам сопоставимых вертикальных операций.<p/>К таким операциям относятся &quot;Прокрутка на месте&quot; и &quot;К правому краю&quot;, с использованием имен из меню, открываемого щелчком правой кнопкой мыши по горизонтальной полосе прокрутки.  Обе они вычисляют предполагаемое смещение и вызывают <xref:System.Windows.Controls.Primitives.IScrollInfo.SetHorizontalOffset(System.Double)>.<p/>После прокрутки к новой позиции может измениться значение &quot;на месте&quot; или &quot;правый край&quot; может измениться, поскольку новое девиртуализированное содержимое изменяет значение свойства <xref:System.Windows.Controls.Primitives.IScrollInfo.ExtentWidth?displayProperty=name>.<p/>В версиях до .NET Framework 4.6.2 операция прокрутки просто использует предполагаемое смещение, несмотря на то, что оно может оказаться больше не &quot;на месте&quot; или на &quot;правом краю&quot;.  Его результаты проявляются в виде &quot;подпрыгивания&quot; бегунка прокрутки. Лучше всего это проиллюстрировать на примере. Допустим, для <xref:System.Windows.Controls.DataGrid?displayProperty=name> заданы значения ExtentWidth=1000 и Width=200.  При прокрутке &quot;к правому краю&quot; используется вариант смещения 1000 – 200 = 800.  В процессе прокрутки к этому смещению девиртуализируются новые столбцы. Предположим, что они очень широкие, и теперь свойство <xref:System.Windows.Controls.Primitives.IScrollInfo.ExtentWidth?displayProperty=name> получает значение 2000.  Прокрутка заканчивается при HorizontalOffset=800, и бегунок &quot;отпрыгивает&quot; обратно почти в середину полосы прокрутки, а точнее, на позицию 40 % (800/2000).<p/>Это изменение позволяет повторно вычислить новое предполагаемое смещение в такой ситуации и повторить попытку. (Так уже работает вертикальная прокрутка.) <p/>Это поведение стало более прогнозируемым и интуитивно понятным для конечного пользователя, но изменение может повлиять на те приложения, которые ожидают конкретных значений свойства <xref:System.Windows.Controls.Primitives.IScrollInfo.HorizontalOffset?displayProperty=name> после горизонтальной прокрутки, вызванной действиями пользователя или прямым вызовом <xref:System.Windows.Controls.Primitives.IScrollInfo.SetHorizontalOffset(System.Double)>.|
|Предложение|Нужно изменить приложения, использующие прогнозируемое значение для <xref:System.Windows.Controls.Primitives.IScrollInfo.HorizontalOffset?displayProperty=name>, чтобы они извлекали фактическое значение (а также значение <xref:System.Windows.Controls.Primitives.IScrollInfo.ExtentWidth?displayProperty=name>) после любой горизонтальной прокрутки, при которой <xref:System.Windows.Controls.Primitives.IScrollInfo.ExtentWidth?displayProperty=name> может измениться из-за девиртуализации.|
|Область|Дополнительный номер|
|Version|4.6.2|
|Type|Параметры выполнения|
|Затронутые API|<ul><li><xref:System.Windows.Controls.Primitives.IScrollInfo?displayProperty=nameWithType></li></ul>|
