---
title: 'Подходы к развертыванию архитектуры: бессерверные приложения'
description: Руководство по различным способам развертывания корпоративных архитектур в облако со сравнением между IaaS, PaaS, контейнерами и бессерверными приложениями.
author: JEREMYLIKNESS
ms.author: jeliknes
ms.date: 06/26/2018
ms.openlocfilehash: c745a4eb1c6f4a00bf139100b02f31cf3327d01e
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/14/2020
ms.locfileid: "72522726"
---
# <a name="architecture-deployment-approaches"></a>Подходы к развертыванию архитектуры

Независимо от архитектурного подхода, используемого для разработки бизнес-приложений, реализация или развертывание этих приложений могут различаться. Предприятия размещают приложения в различных расположениях: от физического оборудования до бессерверных устройств.

## <a name="n-tier-applications"></a>N-уровневые приложения

[Шаблон n-уровневой архитектуры](https://docs.microsoft.com/azure/architecture/guide/architecture-styles/n-tier) является полнофункциональной архитектурой и предназначен для приложений, в которых различные логические слои разделены на отдельные физические уровни. N-уровневая архитектура — это физическая реализация n-слойной архитектуры. Наиболее распространенная реализация этой архитектуры включает в себя:

- уровень представления, например веб-приложение;
- уровень API или доступа к данным, такой как REST API;
- уровень данных, такой как база данных SQL.

![N-уровневая архитектура](./media/n-tier-architecture.png)

N-уровневые решения имеют следующие характеристики:

- Проекты обычно выровнены по уровням.
- Тестирование может проходить по-разному, в зависимости от уровня.
- Уровни предоставляют слои абстракции, например, уровень представления обычно не содержит сведений о реализации уровня данных.
- Как правило, слои взаимодействуют только со смежными слоями.
- Управление выпусками часто выполняется на уровне проекта и, следовательно, на всем уровне. Изменение простого API может потребовать нового выпуска всего среднего уровня.

Такой подход обеспечивает несколько преимуществ, включая следующие:

- изоляция базы данных (часто внешний интерфейс не имеет прямого доступа к серверной части базы данных);
- повторное использование API (например, клиенты мобильных устройств, настольных компьютеров и веб-приложений могут использовать одни и те же API);
- возможность масштабировать уровни независимо друг от друга;
- изоляция рефакторинга: один уровень может быть подвергнут рефакторингу без влияния на другие уровни.

## <a name="on-premises-and-infrastructure-as-a-service-iaas"></a>Локальная инфраструктура и инфраструктура как услуга (IaaS)

Традиционный подход к размещению приложений требует приобретения оборудования и управления всеми установками программного обеспечения, включая операционную систему. Первоначально для него требовались дорогостоящие центры обработки данных и физическое оборудование. С эксплуатацией физического оборудования связано множество проблем, в том числе:

- необходимость приобретать излишки "на всякий случай" или для сценариев пиковой нагрузки;
- обеспечение безопасного физического доступа к оборудованию;
- ответственность за сбой оборудования (например, сбой диска);
- охлаждение;
- настройка маршрутизаторов и подсистем балансировки нагрузки;
- избыточность мощности;
- защита доступа к программному обеспечению.

![Подход IaaS](./media/iaas-approach.png)

Виртуализация оборудования с помощью виртуальных машин позволяет использовать инфраструктуру как услугу (IaaS). Хост-компьютеры эффективно разделены для предоставления экземплярам ресурсов для их собственной памяти, ЦП и хранилища. Команда обеспечивает необходимые виртуальные машины и настраивает связанные сети и доступ к хранилищу.

Дополнительные сведения см. в статье [Windows N-tier application on Azure with SQL Server](https://docs.microsoft.com/azure/architecture/reference-architectures/virtual-machines-windows/n-tier) (Использование n-уровневого приложения с SQL Server в Azure).

Хотя с помощью виртуализации и инфраструктуры как услуга (IaaS) можно решить многие проблемы, большая часть ответственности за преодоление трудностей остается в руках команды, занимающейся настройкой инфраструктуры. Команда управляет версиями операционной системы, применяет исправления безопасности и устанавливает сторонние зависимости на целевых компьютерах. Поведение приложений в рабочей и тестовой средах часто отличается. Проблемы возникают по причине использования разных версий зависимостей и/или уровней SKU ОС. Хотя многие организации развертывают n-уровневые приложения в этих целевых средах, ряд компаний пользуется преимуществами развертывания в собственной облачной модели, такой как [платформа как услуга](#platform-as-a-service-paas). Архитектуры с микрослужбами являются более сложными из-за требований к масштабированию для обеспечения эластичности и устойчивости.

Дополнительные сведения о виртуальных машинах см. на [этой странице](https://docs.microsoft.com/azure/virtual-machines/).

## <a name="platform-as-a-service-paas"></a>Платформа как услуга (PaaS)

Платформа как услуга (PaaS) предлагает настроенные решения, к которым разработчики могут подключиться напрямую. PaaS — это еще один термин для управляемой среды размещения. Эта модель устраняет необходимость управления базовой операционной системой, исправлениями безопасности и во многих случаях любыми сторонними зависимостями. Примерами платформ являются веб-приложения, базы данных и серверные части для мобильных приложений.

С помощью PaaS можно решить проблемы, характерные для IaaS. PaaS позволяет разработчику сосредоточиться на коде или схеме базы данных, а не на развертывании инфраструктуры. PaaS обладает такими преимуществами:

- Плата за использование моделей, устраняющая накладные расходы на инвестиции в бездействующие компьютеры.
- Прямое развертывание и улучшенная методика DevOps, конвейеры непрерывной интеграции (CI) и непрерывной поставки (CD).
- Автоматический переход к новой версии, обновления и обновления для системы безопасности.
- Быстрое горизонтальное и вертикальное масштабирование (эластичное масштабирование).

Традиционно основным недостатком PaaS была привязка к поставщику. Например, некоторые поставщики PaaS поддерживают только ASP.NET, Node.js или другие конкретные языки и платформы. Для работы с несколькими платформами и поддержки различных языков и сред для размещения веб-приложений были разработаны такие продукты, как Служба приложений Azure.

![Архитектура платформы как услуги](./media/paas-architecture.png)

## <a name="software-as-a-service-saas"></a>Программное обеспечение как услуга (SaaS)

Программное обеспечение как услуга (SaaS) размещено централизовано и доступно без локальной установки или подготовки. SaaS часто размещают поверх PaaS в качестве платформы для развертывания программного обеспечения. SaaS предоставляет службы для запуска имеющегося программного обеспечения и подключения к нему. SaaS часто используется в конкретных отраслях и отраслевых вертикалях. SaaS часто имеет лицензию и обычно предоставляет модель "клиент — сервер". Большинство современных предложений SaaS используют веб-приложения для клиента. Компании обычно рассматривают модель SaaS как бизнес-решение для предложений лицензий. Ее редко реализуют как архитектуру для обеспечения масштабируемости и удобства поддержки приложений. Действительно, в основе большинства решений SaaS лежит IaaS, PaaS и/или бессерверное решение.

Дополнительные сведения о SaaS см. в статье [The Wingtip Tickets SaaS application](https://docs.microsoft.com/azure/sql-database/saas-tenancy-welcome-wingtip-tickets-app) (Приложение SaaS Wingtip Tickets).

## <a name="containers-and-functions-as-a-service-faas"></a>Контейнеры и функции как услуга (FaaS)

Контейнеры представляют собой интересное решение, которое обеспечивает преимущества, подобные PaaS, без дополнительных затрат, как в случае с IaaS. Контейнер — это, по сути, среда выполнения, которая содержит базовые элементы, необходимые для запуска уникального приложения. Ядро или основная часть операционной системы сервера виртуальных машин и службы, такие как хранилище, общие для всех узлов. Благодаря использованию общего ядра контейнеры более компактны (некоторые из них имеют размеры, измеряемые мегабайтами, в то время как размер типичной виртуальной машины измеряется в гигабайтах). Работающие узлы позволяют быстро запускать контейнеры, обеспечивая высокий уровень доступности. Возможность быстрого развертывания контейнеров также гарантирует дополнительные уровни устойчивости. Docker — это одна из самых популярных реализаций контейнеров.

Контейнеры обладают такими преимуществами:

- упрощенность и портативность;
- автономность, устраняющая необходимость установки зависимостей;
- обеспечение согласованной среды независимо от узла (работает на ноутбуке точно так же, как на облачном сервере);
- поддержка быстрой подготовки для масштабирования;
- поддержка быстрого перезапуска для восстановления после сбоя.

Контейнер запускается на узле контейнера (который, в свою очередь, может работать на компьютере без операционной системы или на виртуальной машине). Несколько контейнеров или экземпляров одних и тех же контейнеров могут работать на одном узле. Для обеспечения отработки отказа и устойчивости контейнеры необходимо масштабировать во всех узлах.

Дополнительные сведения о контейнерах Docker см. в статье [Что такое Docker?](../microservices/container-docker-introduction/docker-defined.md).

Для управления контейнерами во всех узлах обычно требуется инструмент оркестрации, такой как Kubernetes. Настройка решений оркестрации и управление ими может привести к дополнительным затратам и сложностям в работе с проектами. К счастью, многие поставщики облачных служб предоставляют службы оркестрации через решения PaaS, что упрощает управление контейнерами.

На следующем рисунке показан пример установки Kubernetes. Узлы в установке устраняют проблемы с масштабированием и отработкой отказа. Они запускают экземпляры контейнеров Docker, которыми управляет главный сервер. *Kubelet* — это клиент, который передает команды из Kubernetes в Docker.

![Kubernetes](./media/kubernetes-example.png)

Дополнительные сведения об оркестрации см. в статье [Служба Azure Kubernetes (AKS)](https://docs.microsoft.com/azure/aks/intro-kubernetes).

Функции как услуга (FaaS) — это специализированная служба контейнеров, похожая на бессерверную архитектуру. Специальная реализация FaaS, называемая [OpenFaaS](https://github.com/openfaas/faas), располагается поверх контейнеров, обеспечивая таким образом бессерверные возможности. OpenFaaS предоставляет шаблоны, которые упаковывают все зависимости контейнера, необходимые для выполнения фрагмента кода. Использование шаблонов упрощает процесс развертывания кода как функционального блока. OpenFaaS предназначена для архитектур, которые уже содержат контейнеры и оркестраторы, потому что она может использовать имеющуюся инфраструктуру. Хотя эта реализация обеспечивает бессерверную функциональность, она требует использования Docker и оркестратора.

## <a name="serverless"></a>Бессерверные приложения

Беcсерверная архитектура обеспечивает четкое разделение кода и среды его размещения. Вы реализуете код в *функции*, которая вызывается *триггером*. После выхода из этой функции все необходимые ресурсы можно освободить. Триггером может быть выполняемая вручную операция, процесс с заданным временем выполнения, HTTP-запрос или передача файла. Результатом триггера является выполнение кода. Несмотря на то что бессерверные платформы различаются, большинство из них предоставляют доступ к предварительно определенным API и привязкам, упрощая такие задачи, как запись в базу данных или постановка в очередь результатов.

Бессерверная архитектура в значительной степени зависит от абстрагирования среды узла, сосредоточивая все внимание на коде. Ее можно считать архитектурой с *ограниченным использованием сервера*.

Решения для работы с контейнерами предоставляют разработчикам имеющиеся скрипты сборки для публикации кода в готовых к использованию бессерверных образах. Другие реализации используют имеющиеся решения PaaS для обеспечения масштабируемой архитектуры.

Абстракция устраняет для команды DevOps необходимость предоставлять серверы или определенные контейнеры и управлять ими. На бессерверной платформе размещается код в виде скрипта или упакованных исполняемых файлов, созданных с помощью соответствующего SDK, а также выделяются необходимые ресурсы для масштабирования кода.

На следующем рисунке показаны четыре бессерверных компонента. HTTP-запрос активирует выполнение кода API Checkout. API Checkout вставляет код в базу данных, запуская таким образом несколько других функций для выполнения таких задач, как вычисление и выполнение заказа.

![Реализация бессерверной архитектуры](./media/serverless-implementation.png)

Бессерверная архитектура обладает следующими преимуществами:

- **Высокая плотность.** Многие экземпляры одной и той же бессерверной архитектуры кода могут выполняться на одном узле в отличие от контейнеров или виртуальных машин. Экземпляры масштабируются в нескольких узлах и обладают устойчивостью.
- **Оптимальное выставление счетов.** Большинство поставщиков бессерверных архитектур выставляют счета на основе выполнений бессерверных архитектур, что обеспечивает значительную экономию затрат в определенных сценариях.
- **Мгновенное масштабирование.** Бессерверную архитектуру можно автоматически быстро масштабировать с учетом рабочих нагрузок.
- **Ускоренный вывод на рынок.** Разработчики сосредотачиваются на написании кода и выполняют развертывание непосредственно на бессерверную платформу. Компоненты можно освобождать независимо друг от друга.

Бессерверная архитектура чаще всего обсуждается в контексте вычислений, но ее также можно применять к данным. Например, [SQL Azure](https://docs.microsoft.com/azure/sql-database) и [Cosmos DB](https://docs.microsoft.com/azure/cosmos-db) предоставляют облачные базы данных, которые не требуют настройки хост-компьютеров или кластеров. Эта статья посвящена вычислениям с помощью бессерверной архитектуры.

## <a name="summary"></a>Сводка

Существует широкий ряд доступных вариантов для архитектуры, включая гибридный подход. Использование бессерверной архитектуры упрощает подход, управление и снижает стоимость функций приложения за счет возможностей контроля и переноса. Тем не менее многие бессерверные платформы предоставляют конфигурацию, помогающую настроить решение. С помощью хороших методик программирования можно написать более переносимый код и ослабить привязку к бессерверной платформе. В приведенной ниже таблице представлены подходы к развертыванию архитектуры. Выберите бессерверную архитектуру, учитывая свои потребности в масштабировании, необходимость управления средой выполнения и способность разбивать рабочие нагрузки на небольшие компоненты надлежащим образом. В следующей статье вы ознакомитесь со сведениями о возможных проблемах, возникающих при использовании бессерверных архитектур, и другими примечаниями о решениях.

|         |IaaS     |PaaS     |Контейнер|Бессерверные приложения|
|---------|---------|---------|---------|----------|
|**Масштаб**|ВМ       |Экземпляр |Приложение      |Компонент  |
|**Абстрагирование**|Оборудование|Платформа|Узел ОС|Параметры выполнения   |
|**Единица измерения** |ВМ       |Проект  |Образ —    |Код      |
|**Время существования**|Months|От нескольких дней до нескольких месяцев|От нескольких минут до нескольких дней|От нескольких миллисекунд до нескольких минут|
|**Обязательство**|Приложения, зависимости, среда выполнения и операционная система|Приложения и зависимости|Приложения, зависимости и среда выполнения|Компонент

- **Масштабирование** относится к единице, которая используется для масштабирования приложения.
- **Абстрагирование** относится к слою, который абстрагируется реализацией.
- **Единица измерения** относится к области развертывания.
- **Время существования** относится к обычной среде выполнения конкретного экземпляра.
- **Обязательство** относится к накладным расходам на создание, развертывание и обслуживание приложения.

Следующее руководство посвящено описанию бессерверной архитектуры, вариантов использования и конструктивных шаблонов.

## <a name="recommended-resources"></a>Рекомендуемые ресурсы

- [Руководство по архитектуре приложений Azure](https://docs.microsoft.com/azure/architecture/guide/)
- [Azure Cosmos DB](https://docs.microsoft.com/azure/cosmos-db)
- [Azure SQL;](https://docs.microsoft.com/azure/sql-database)
- [N-tier architecture style](https://docs.microsoft.com/azure/architecture/guide/architecture-styles/n-tier) (N-уровневый стиль архитектуры)
- [Kubernetes в Azure](https://docs.microsoft.com/azure/aks/intro-kubernetes)
- [Микрослужбы](https://docs.microsoft.com/azure/architecture/guide/architecture-styles/microservices)
- [Windows N-tier application on Azure with SQL Server](https://docs.microsoft.com/azure/architecture/reference-architectures/virtual-machines-windows/n-tier) (Использование n-уровневого приложения Windows с SQL Server в Azure)
- [Виртуальные машины](https://docs.microsoft.com/azure/virtual-machines/)
- [Что такое Docker?](../microservices/container-docker-introduction/docker-defined.md)
- [The Wingtip Tickets SaaS application](https://docs.microsoft.com/azure/sql-database/saas-tenancy-welcome-wingtip-tickets-app) (Приложение SaaS Wingtip Tickets)

>[!div class="step-by-step"]
>[Назад](architecture-approaches.md)
>[Вперед](serverless-architecture.md)
