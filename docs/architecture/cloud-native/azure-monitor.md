---
title: Azure Monitor
description: Использование Azure Monitor, чтобы получить представление о работающей системе.
ms.date: 09/23/2019
ms.openlocfilehash: fa7b4e103f4d1245710f88319271a9e8b7a24b04
ms.sourcegitcommit: 559fcfbe4871636494870a8b716bf7325df34ac5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/30/2019
ms.locfileid: "73841867"
---
# <a name="azure-monitor"></a>Azure Monitor

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

Ни один другой поставщик облачных решений не является устаревшим решением для мониторинга облачных приложений, как оно было найдено в Azure. Azure Monitor — это имя для набора средств, предназначенных для предоставления сведений о состоянии системы, анализа любых проблем и оптимизации приложения.

![Azure Monitor, коллекцию средств, чтобы получить представление о работе облачного приложения.](./media/azure-monitor.png)
**рис. 7-9**. Azure Monitor, коллекция для инструментов, позволяющая получить представление о работе облачного приложения.

## <a name="gathering-logs-and-metrics"></a>Сбор журналов и метрик

Первым шагом в любом решении для мониторинга является сбор максимально возможного объема данных. Чем больше данных можно собрать, тем более подробная информация может быть получена. Работа с системными инструментами традиционно была сложной задачей. Протокол SNMP был золотым стандартным протоколом для сбора информации на уровне компьютера, но он требовал значительных знаний и настройки. К счастью, большая часть этой жесткой работы была устранена, так как наиболее распространенные метрики автоматически собираются Azure Monitor.

Метрики и события уровня приложения не могут быть инструментированы автоматически, так как они являются локальными для развертываемого приложения. Для сбора этих метрик доступны [пакеты SDK и API](https://docs.microsoft.com/azure/azure-monitor/app/api-custom-events-metrics) , которые позволяют напрямую сообщать такую информацию, например, когда клиент регистрируется или завершает заказ. Исключения также могут быть перехвачены и возвращены в Azure Monitor с помощью Application Insights. Пакеты SDK поддерживают большинство языков в собственных облачных приложениях, в том числе Go, Python, JavaScript и .NET.

Основная цель сбора сведений о состоянии приложения — обеспечить хорошую работу конечных пользователей. Какой лучший способ узнать, возникают ли проблемы у пользователей, чем [за пределами веб-тестов](https://docs.microsoft.com/azure/azure-monitor/app/monitor-web-app-availability)? Эти тесты могут быть простыми при проверке связи с веб-сайтом по всему миру или в том случае, если агенты входят в сайт и выполняют действия.

## <a name="reporting-data"></a>Данные отчетов

После сбора данных их можно обменять, суммировать и отображать на диаграммах, что позволяет пользователям мгновенно видеть, когда возникают проблемы. Эти диаграммы могут быть собраны на панели мониторинга или в книги, многостраничный отчет, предназначенный для описания некоторых аспектов системы.

Ни одно современное приложение не было бы полным без искусственного интеллекта или машинного обучения. Для этого данные [могут быть переданы](https://www.youtube.com/watch?v=Cuza-I1g9tw) различным средствам машинного обучения в Azure, что позволяет извлекать тенденции и информацию, которые в противном случае были бы скрыты.

Application Insights предоставляет мощный язык запросов под названием Kusto, который можно использовать для поиска записей, их суммирования и даже построения диаграмм. Например, этот запрос найдет все записи за месяц ноября 2007, сгруппировать их по состоянию и отобразить 10 лучших в виде круговой диаграммы.

```
StormEvents
| where StartTime >= datetime(2007-11-01) and StartTime < datetime(2007-12-01)
| summarize count() by State
| top 10 by count_
| render piechart
```

![результат Application Insights запроса](./media/azure-monitor.png)
**рис. 7-10**. Результат запроса Application Insights.

Существует [Playground для экспериментов с запросами Kusto](https://dataexplorer.azure.com/clusters/help/databases/Samples) , что является очень значительным местом для траты часа или двух. Для чтения [образцов запросов](https://docs.microsoft.com/azure/kusto/query/samples) также можно использовать инструкции.

## <a name="dashboards"></a>Панели мониторинга

Существует несколько различных технологий панели мониторинга, которые можно использовать для отображения информации от Azure Monitor. Возможно, проще всего просто выполнить запросы в Application Insights и [отобразить данные в диаграмме](https://docs.microsoft.com/azure/azure-monitor/learn/tutorial-app-dashboards).

![пример диаграмм Application Insights, внедренных в основную панель мониторинга Azure](./media/azure-monitor.png)
**рис. 7-11**. Пример Application Insights диаграмм, внедренных в основную панель мониторинга Azure.

Эти диаграммы затем можно внедрить в портал Azure правильно с помощью функции панели мониторинга. Для пользователей с более точными требованиями, такими как возможность детализации на нескольких уровнях данных, Azure Monitor данные доступны для [Power BI](https://powerbi.microsoft.com/). Power BI является ведущим в отрасли, корпоративным классом, средством бизнес-аналитики, которое может выполнять статистическую обработку данных из множества различных источников данных.

![пример панели мониторинга Power BI](./media/azure-monitor.png)
**рис. 7-12**. Пример Power BI панели мониторинга.

## <a name="alerts"></a>Предупреждения

Иногда нет достаточных панелей мониторинга данных. Если никто не находится в спящем режиме для просмотра панелей мониторинга, это может быть несколько часов, прежде чем проблема будет устранена или даже обнаружена. В конце концов, Azure Monitor также предоставляет решение для [оповещений](https://docs.microsoft.com/azure/azure-monitor/platform/alerts-overview)с высшим делением. Оповещения могут инициироваться с помощью широкого диапазона условий, в том числе:

- Значения метрик
- Запросы поиска по журналам
- События журнала действий
- Работоспособность базовой платформы Azure
- Тесты доступности веб-сайта

При активации оповещения могут выполнять разнообразные задачи. С простой стороны, оповещения могут просто отправить уведомление по электронной почте в список рассылки или текстовое сообщение отдельному пользователю. Дополнительные вовлеченные предупреждения могут активировать рабочий процесс в средстве, например PagerDuty, что известно о том, кто находится в вызове конкретного приложения. Оповещения могут активировать действия в [Microsoft Flow](https://flow.microsoft.com/) разблокировки неограниченных возможностей для рабочих процессов.

Как правило, оповещения могут быть расширены с помощью подробных сведений об основных причинах предупреждений и действиях, которые необходимо выполнить для их устранения. Высокозрелые облачные развертывания приложений могут отказаться от самовосстанавливающих задач, которые выполняют такие действия, как удаление неисправных узлов из масштабируемого набора или активация действия автоматического масштабирования. В итоге может больше не потребоваться пробудить сотрудника по телефону в 2AM, чтобы устранить проблему с активным сайтом, так как система сможет скорректировать себя, чтобы компенсировать или по крайней мере ковылять, пока кто-то не приступит к работе на следующий утром.

Azure Monitor автоматически использует машинное обучение, чтобы понять нормальные рабочие параметры развернутых приложений. Это позволяет ему обнаруживать службы, работающие за пределами их обычных параметров. Например, типичный трафик в будний день на сайте может составлять 10 000 запросов в минуту. А затем, в течение данной недели, число запросов в минуту достигнет очень необычных 20 000 запросов. [Интеллектуальное обнаружение](https://docs.microsoft.com/azure/azure-monitor/app/proactive-diagnostics) заметит это отклонение от нормы и выдаст предупреждение. В то же время анализ тенденций достаточно интеллектуально, чтобы избежать срабатывания ложных срабатываний при ожидаемой нагрузке трафика.

>[!div class="step-by-step"]
>[Назад](monitoring-azure-kubernetes.md)
>[Вперед](identity.md)
