---
title: Обзор global.json
description: Узнайте, как использовать файл global.json, чтобы задать версию пакета SDK для .NET Core при выполнении команд .NET Core CLI.
ms.date: 01/14/2020
ms.custom: updateeachrelease
ms.openlocfilehash: f02c9129a707ddddb2c5e1975b75cc35abc5cd55
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/24/2020
ms.locfileid: "76733976"
---
# <a name="globaljson-overview"></a>Обзор global.json

**Эта статья относится к следующему.** ✔️ SDK для .NET Core 2.0 и более поздних версий

С помощью файла *global.json* можно определить, какая версия пакета SDK для .NET Core используется при выполнении команд .NET Core CLI. Выбор пакета SDK для .NET Core не зависит от указания целевой среды выполнения проекта. Версия пакета SDK для .NET Core указывает, какие версии средств .NET Core CLI используются.

Как правило, необходимо использовать последнюю версию средств пакета SDK, поэтому вам нужен файл *global.json*. В некоторых сложных сценариях может потребоваться управление версией средств пакета SDK, и в этой статье объясняется, как это сделать.

Дополнительные сведения о том, как вместо этого указать среду выполнения, см. в разделе [Целевые платформы](../../standard/frameworks.md).

Пакет SDK для .NET Core ищет файл *global.json* в текущем рабочем каталоге (который не обязательно совпадает с каталогом проекта) или в одном из его родительских каталогов.

## <a name="globaljson-schema"></a>Схема файла global.json

### <a name="sdk"></a>sdk

Тип: `object`

Указывает сведения о пакете SDK для .NET Core для выбора.

#### <a name="version"></a>version

- Тип: `string`

- Доступно начиная с пакета SDK для .NET Core 1.0.

Версия пакета SDK для .NET Core для использования.

Это поле:

- Не поддерживает подстановочные знаки, то есть необходимо указать полный номер версии.
- Не поддерживает диапазон версий.

#### <a name="allowprerelease"></a>allowPrerelease

- Тип: `boolean`

- Доступно начиная с пакета SDK для .NET Core 3.0.

Указывает, должен ли сопоставитель пакетов SDK учитывать предварительные версии при выборе версии пакета SDK, которую следует использовать.

Если это значение не задано явно, значение по умолчанию зависит от того, работаете ли вы в Visual Studio:

- Если вы **не** работаете в Visual Studio, значение по умолчанию — `true`.
- Если работаете в Visual Studio, используется запрошенное состояние предварительной версии. То есть если вы используете предварительную версию Visual Studio или включили параметр **Использовать предварительные версии пакета SDK для .NET Core** (в разделе **Сервис** > **Параметры** > **Среда** > **Функции предварительной версии**), значением по умолчанию будет `true`; в противном случае — `false`.

#### <a name="rollforward"></a>rollForward

- Тип: `string`

- Доступно начиная с пакета SDK для .NET Core 3.0.

Политика наката, используемая при выборе версии пакета SDK (либо в качестве резервной, если определенная версия пакета SDK отсутствует, либо в качестве директивы для использования более поздней версии). [Версия](#version) должна быть указана со значением `rollForward`, если только вы не настраиваете ее равной `latestMajor`.

Для понимания доступных политик и их поведения примите во внимание следующие определения для версии пакета SDK в формате `x.y.znn`:

- `x` — основной номер версии.
- `y` — дополнительный номер версии.
- `z` — набор возможностей.
- `nn` — версия исправления.

В следующей таблице описаны возможные значения параметра `rollForward`.

| Значение         | Поведение |
| ------------- | ---------- |
| `patch`       | Использует указанную версию. <br> Если не найдено, выполняет накат до последнего уровня обновления. <br> Если не найдено, происходит сбой. <br><br> Это значение является устаревшим поведением по сравнению с предыдущими версиями пакета SDK. |
| `feature`     | Использует последний уровень обновления для указанного основного номера версии, дополнительного номера версии и набора возможностей. <br> Если не найдено, выполняет накат до следующего набора возможностей более высокого уровня в пределах одного и того же основного или дополнительного номера версии и использует последний уровень обновления для этого набора возможностей. <br> Если не найдено, происходит сбой. |
| `minor`       | Использует последний уровень обновления для указанного основного номера версии, дополнительного номера версии и набора возможностей. <br> Если не найдено, выполняет накат до следующего набора возможностей более высокого уровня в пределах одного и того же основного или дополнительного номера версии и использует последний уровень обновления для этого набора возможностей. <br> Если не найдено, выполняет накат до следующего основного номера версии и набора возможностей более высокого уровня в пределах одного и того же основного номера версии и использует последний уровень обновления для этого набора возможностей. <br> Если не найдено, происходит сбой. |
| `major`       | Использует последний уровень обновления для указанного основного номера версии, дополнительного номера версии и набора возможностей. <br> Если не найдено, выполняет накат до следующего набора возможностей более высокого уровня в пределах одного и того же основного или дополнительного номера версии и использует последний уровень обновления для этого набора возможностей. <br> Если не найдено, выполняет накат до следующего основного номера версии и набора возможностей более высокого уровня в пределах одного и того же основного номера версии и использует последний уровень обновления для этого набора возможностей. <br> Если не найдено, выполняет накат до следующего основного номера версии, дополнительного номера версии и набора возможностей более высокого уровня и использует последний уровень обновления для этого набора возможностей. <br> Если не найдено, происходит сбой. |
| `latestPatch` | Использует последний установленный уровень обновления, соответствующий запрошенному основному номеру версии, дополнительному номеру версии и набору возможностей с уровнем обновления, который соответствует указанному значению или превышает его. <br> Если не найдено, происходит сбой. |
| `latestFeature` | Использует наивысший установленный набор возможностей и уровень обновления, соответствующий запрошенному основному номеру версии и дополнительному номеру версии с набором возможностей, который соответствует указанному значению или превышает его. <br> Если не найдено, происходит сбой. |
| `latestMinor` | Использует наивысший установленный основной номер версии, набор возможностей и уровень обновления, соответствующий запрошенному основному номеру версии с дополнительным номером версии, который соответствует указанному значению или превышает его. <br> Если не найдено, происходит сбой. |
| `latestMajor` | Использует наивысший установленный пакет SDK для .NET Core с основным номером версии, который соответствует указанному значению или превышает его. <br> Если не найдено, происходит сбой. |
| `disable`     | Накат не выполняется. Требуется точное соответствие. |

## <a name="examples"></a>Примеры

В следующем примере показано, как не использовать предварительные версии:

```json
{
  "sdk": {
    "allowPrerelease": false
  }
}
```

В следующем примере показано, как использовать наивысший установленный номер версии, который соответствует указанной версии или больше нее:

```json
{
  "sdk": {
    "version": "3.1.100",
    "rollForward": "latestMajor"
  }
}
```

В следующем примере показано, как использовать точную указанную версию:

```json
{
  "sdk": {
    "version": "3.1.100",
    "rollForward": "disable"
  }
}
```

В следующем примере показано, как использовать наивысшую версию обновления, установленную для конкретной версии (в формате 3.1.1xx):

```json
{
  "sdk": {
    "version": "3.1.100",
    "rollForward": "latestPatch"
  }
}
```

## <a name="globaljson-and-the-net-core-cli"></a>global.json и .NET Core CLI

Полезно знать, какие версии пакета SDK установлены на компьютере, чтобы задать их в файле *global.json*. Дополнительные сведения о том, как это сделать, см. в разделе [Проверка того, установлена ли платформа .NET Core](../install/how-to-detect-installed-versions.md#check-sdk-versions).

Чтобы установить дополнительные версии пакета SDK для .NET Core на компьютере, посетите страницу [скачиваемых файлов .NET Core](https://dotnet.microsoft.com/download/dotnet-core).

Вы можете создать новый файл *global.json* в текущем каталоге, выполнив команду [dotnet new](dotnet-new.md), как в следующем примере:

```dotnetcli
dotnet new globaljson --sdk-version 3.0.100
```

## <a name="matching-rules"></a>Правила сопоставления

> [!NOTE]
> Правила сопоставления определяются точкой входа `dotnet.exe`, которая является общей для всех установленных сред выполнения .NET Core. Правила сопоставления для последней установленной версии среды выполнения .NET Core используются при параллельной установке сразу нескольких сред выполнения.

## <a name="net-core-3xtabnetcore3x"></a>[.NET Core 3.x](#tab/netcore3x)

Начиная с .NET Core 3.0 при определении версии пакета SDK для использования применяются следующие правила:

- Если файл *global.json* не найден или в файле *global.json* не указаны версия пакета SDK или значение `allowPrerelease`, используется наивысшая версия пакета SDK (эквивалентная заданию значения `rollForward` для параметра `latestMajor`). Необходимость учитывать предварительные версии пакета SDK зависит от того, как вызывается `dotnet`.
  - Если вы **не** работаете в Visual Studio, учитываются предварительные версии.
  - Если работаете в Visual Studio, используется запрошенное состояние предварительной версии. То есть если вы используете предварительную версию Visual Studio или включили параметр **Использовать предварительные версии пакета SDK для .NET Core** (в разделе **Сервис** > **Параметры** > **Среда** > **Функции предварительной версии**), учитываются предварительные версии; в противном случае учитываются только выпущенные версии.
- Если найден файл *global.json*, в котором не указана версия пакета SDK, но указано значение `allowPrerelease`, используется наивысшая версия пакета SDK (аналогично заданию значения `rollForward` для параметра `latestMajor`). На то, может ли последняя версия пакета SDK выпускаться или быть предварительным выпуском, влияет значение `allowPrerelease`. `true` указывает на то, что предварительные версии учитываются. `false` указывает на то, что учитываются только выпущенные версии.
- Если файл *global.json* найден и в нем указана версия пакета SDK:

  - Если значение `rollFoward` не задано, в качестве политики `rollForward` по умолчанию используется `latestPatch`. В противном случае проверьте каждое значение и их поведение в разделе [rollForward](#rollforward).
  - Сведения о том, учитываются ли предварительные версии и каково поведение по умолчанию, если параметр `allowPrerelease` не задан, представлены в разделе [allowPrerelease](#allowprerelease).

## <a name="net-core-2xtabnetcore2x"></a>[.NET Core 2.x](#tab/netcore2x)

В пакете SDK для .NET Core 2 при определении версии пакета SDK для использования применяются следующие правила:

- Если файл *global.json* не найден или в файле *global.json* не указана версия пакета SDK, используется последняя установленная версия пакета SDK. Последняя версия пакета SDK может быть обычным или предварительным выпуском — выбирается наибольший номер версии.
- Если в файле *global.json* указана версия пакета SDK:
  - Если указанная версия пакета SDK найдена на компьютере, используется именно эта версия.
  - Если указанная версия пакета SDK не найдена на компьютере, используется последняя установленная **версия исправления** этой версии пакета SDK. Последняя установленная **версия обновления** для пакета SDK может быть обычным или предварительным выпуском — используется наибольший номер версии. В .NET Core 2.1 и более поздних версиях **версии исправления** ниже указанной **версии исправления** не учитываются при выборе пакета SDK.
  - Если указанная версия пакета SDK и соответствующая **версия исправления** пакета SDK не найдена, выдается ошибка.

Версия пакета SDK состоит из следующих частей:

`[.NET Core major version].[.NET Core minor version].[xyz][-optional preview name]`

**Главный выпуск** пакета SDK для .NET Core обозначен первой цифрой (`x`) в последней части номера (`xyz`) для версии пакета SDK 2.1.100 и более поздних версий. Как правило, пакет SDK для .NET Core имеет более короткий цикл выпуска, чем .NET Core.

**Версия исправления** обозначена двумя последними цифрами (`yz`) в последней части номера (`xyz`) для версии пакета SDK 2.1.100 и более поздних версий. Например, если вы указываете `2.1.300` в качестве версии пакета SDK, ищется пакет SDK до версии `2.1.399`, но `2.1.400` не считается версией исправления для `2.1.300`.

Версии пакета SDK для .NET Core с `2.1.100` по `2.1.201` были выпущены во время перехода между схемами номеров версий и некорректно обрабатывают нотацию `xyz`. Если вы указываете эти версии в файле *global.json*, мы рекомендуем убедиться, что указанные версии установлены на целевых компьютерах.

---

## <a name="troubleshooting-build-warnings"></a>Устранение неполадок с оповещениями сборки

> [!WARNING]
> Вы работаете с предварительной версией пакета SDK для .NET Core. Версию пакета SDK можно указать в файле global.json в текущем проекте. Дополнительные сведения см. на странице <https://go.microsoft.com/fwlink/?linkid=869452>

Это предупреждение означает, что проект был скомпилирован с использованием предварительной версии пакета SDK для .NET Core. Версии пакета SDK для .NET Core имеют гарантированное качество. Однако если вы не хотите использовать предварительную версию, ознакомьтесь с различными стратегиями, которые можно применять в отношении пакета SDK для .NET Core 3.0 или более поздней версии, обратившись к разделу [allowPrerelease](#allowprerelease). Для компьютеров, на которые никогда не устанавливалась среда выполнения .NET Core 3.0 или более поздней версии или пакет SDK, необходимо создать файл *global.json* и указать точную версию, которую требуется использовать.

> [!WARNING]
> Запускаемый проект '{startupProject}' нацелен на версию платформы '.NETCoreApp' '{targetFrameworkVersion}'. Эта версия средств командной строки .NET Entity Framework Core поддерживает только версию 2.0 или более позднюю. Сведения об использовании более старой версии средств см. в разделе <https://go.microsoft.com/fwlink/?linkid=871254>

Начиная с пакета SDK для .NET Core 2.1 (версия 2.1.300) поддерживается команда `dotnet ef`. Это предупреждение означает, что проект предназначен для EF Core 1.0 или 1.1, которые несовместимы с пакетом SDK для .NET Core 2.1 и более поздних версий. Чтобы скомпилировать проект, установите пакет SDK для .NET Core 2.0 (версия 2.1.201) или более ранней версии на своем компьютере и определите необходимую версию пакета SDK с помощью файла *global.json*. Дополнительные сведения о команде `dotnet ef` см. в разделе [Утилиты командной строки для EF Core .NET](/ef/core/miscellaneous/cli/dotnet).

## <a name="see-also"></a>См. также

- [Как разрешаются пакеты SDK проекта](/visualstudio/msbuild/how-to-use-project-sdk#how-project-sdks-are-resolved)
