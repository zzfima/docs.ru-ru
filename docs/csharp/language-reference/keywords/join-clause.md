---
title: "Предложение join (Справочник по C#) | Microsoft Docs"
ms.date: "2015-07-20"
ms.prod: ".net"
ms.technology: 
  - "devlang-csharp"
ms.topic: "article"
f1_keywords: 
  - "join"
  - "join_CSharpKeyword"
dev_langs: 
  - "CSharp"
helpviewer_keywords: 
  - "join - предложение [C#]"
  - "join - ключевое слово [C#]"
ms.assetid: 76e9df84-092c-41a6-9537-c3f1cbd7f0fb
caps.latest.revision: 29
author: "BillWagner"
ms.author: "wiwagn"
caps.handback.revision: 29
---
# Предложение join (Справочник по C#)
Предложение `join` используется для связывания элементов из различных последовательностей источников, которые не имеют прямых связей в объектной модели.  Единственное требование – элементы в каждом источнике должны совместно использовать некоторое значение, которое можно сравнить на предмет равенства.  Например, оптовая компания, продающая продукты питания, должна иметь список поставщиков определенного продукта, а также список покупателей.  Предложение `join` можно использовать, например, для создания списка поставщиков и покупателей этого продукта, которые находятся в одном заданном регионе.  
  
 Предложение `join` в качестве ввода принимает две последовательности источников.  Элементы в каждой последовательности должны быть свойством или содержать свойство, которое можно сравнить с соответствующим свойством в другой последовательности.  Предложение `join` сравнивает указанные ключи на предмет равенства при помощи специального ключевого слова `equals`.  Все операции соединения, выполненные предложением `join`, являются уравнивающими соединениями.  Формат результата предложения `join` зависит от определенного типа выполняемого соединения.  Наиболее распространенными типами соединения являются следующие три:  
  
-   Внутреннее соединение  
  
-   Групповое соединение  
  
-   Левое внешнее соединение  
  
## Внутреннее соединение  
 В следующем примере показано простое уравнивающее соединение.  Этот запрос создает плоскую последовательность пары "название продукта\/категория".  Та же строка категории будет присутствовать в нескольких элементах.  Если элемент из `categories` не имеет соответствующих `products`, эта категория не будет включена в результаты.  
  
 [!code-cs[cscsrefQueryKeywords#24](../../../csharp/language-reference/keywords/codesnippet/CSharp/join-clause_1.cs)]  
  
 Дополнительные сведения см. в разделе [Практическое руководство. Выполнение внутренних соединений](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-inner-joins.md).  
  
## Group Join  
 Предложение `join` с выражением `into` называется групповым соединением.  
  
 [!code-cs[cscsrefQueryKeywords#25](../../../csharp/language-reference/keywords/codesnippet/CSharp/join-clause_2.cs)]  
  
 Групповое соединение создает иерархическую последовательность результатов, которая связывает элементы в левой последовательности источников с одним или несколькими совпадающими элементами в правой последовательности источников.  Групповое соединение не имеет эквивалента в плане отношений; по сути, это последовательность массивов объектов.  
  
 Если элементы из правой последовательности источников не совпадают с элементом в левом источнике, предложение `join` создаст пустой массив для такого элемента.  Таким образом, групповое соединение – это также просто внутреннее уравнивающее соединение за исключением того, что последовательность результатов организуется в группы.  
  
 Если просто выбрать результаты группового соединения, можно будет обращаться к элементам, но ключ, по которому они совпадают, найти не удастся.  Таким образом, имеет смысл выбрать результаты группового соединения в новый тип, который также имеет имя ключа, как было показано в предыдущем примере.  
  
 Безусловно, результаты группового соединения можно также использовать в качестве генератора другого вложенного запроса:  
  
 [!code-cs[cscsrefQueryKeywords#26](../../../csharp/language-reference/keywords/codesnippet/CSharp/join-clause_3.cs)]  
  
 Дополнительные сведения см. в разделе [Практическое руководство. Выполнение групповых соединений](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-grouped-joins.md).  
  
## Левое внешнее соединение  
 В левом внешнем соединении возвращаются все элементы в левой последовательности источников, даже если в правой последовательности совпадающих элементов нет.  Для выполнения левого внешнего соединения в [!INCLUDE[vbteclinq](../../../csharp/includes/vbteclinq-md.md)] необходимо в сочетании с групповым соединением использовать метод `DefaultIfEmpty` для указания правого элемента по умолчанию, который будет создан, если совпадающего элемента в левой части найдено не будет.  Значение `null` можно использовать в качестве значения по умолчанию для любого ссылочного типа, или можно указать определяемый пользователем тип по умолчанию.  В следующем примере показан определяемый пользователем тип по умолчанию.  
  
 [!code-cs[cscsrefQueryKeywords#27](../../../csharp/language-reference/keywords/codesnippet/CSharp/join-clause_4.cs)]  
  
 Дополнительные сведения см. в разделе [Практическое руководство. Выполнение левых внешних соединений](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-left-outer-joins.md).  
  
## Оператор equals  
 Предложение `join` выполняет уравнивающее соединение.  Другими словами, совпадения могут основываться только на равенстве двух ключей.  Другие типы сравнений, такие как "больше" или "не равно" не поддерживаются.  Чтобы гарантировать, что все соединения являются уравнивающими соединениями, предложение `join` вместо оператора `==` использует ключевое слово `equals`.  Ключевое слово `equals` можно использовать только в предложении `join` и оно отличается от оператора `==` одним очень важным моментом.  С `equals` левый ключ потребляет последовательность внешних источников, а правый ключ потребляет внутренний источник.  Внешний источник попадает в область слева от `equals`, а последовательность внутренних источников попадает в область справа.  
  
## Не уравнивающие соединения  
 Соединения, не являющиеся уравнивающими, перекрестные соединения и другие операции собственных соединений можно выполнять при помощи нескольких предложений `from` для независимого включения новых последовательностей в запрос.  Дополнительные сведения см. в разделе [Практическое руководство. Выполнение пользовательских операций соединения](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-custom-join-operations.md).  
  
## Соединения коллекций объектов иреляционных таблиц  
 В выражении запроса [!INCLUDE[vbteclinq](../../../csharp/includes/vbteclinq-md.md)] операции соединения выполняются с коллекциями объектов.  Коллекции объектов можно "соединить" в точности так же, как это делается с двумя реляционными таблицами.  В [!INCLUDE[vbteclinq](../../../csharp/includes/vbteclinq-md.md)] явные предложения `join` требуются только когда две последовательности не связаны каким\-либо отношением.  При работе с [!INCLUDE[vbtecdlinq](../../../csharp/includes/vbtecdlinq-md.md)] таблицы внешних ключей представлены в объектной модели как свойства основной таблицы.  Например, в базе данных “Northwind” таблица “Customer” имеет связь внешнего ключа с таблицей “Orders”.  При сопоставлении таблиц с объектной моделью, класс “Customer” имеет свойство “Orders” с коллекцией “Orders”, связанной с таким классом “Customer”.  Фактически, соединение уже было выполнено.  
  
 Дополнительные сведения о создании запросов по связанным таблицам в контексте [!INCLUDE[vbtecdlinq](../../../csharp/includes/vbtecdlinq-md.md)] см. в разделе [Как сопоставить связи базы данных](../Topic/How%20to:%20Map%20Database%20Relationships.md).  
  
## Составные ключи  
 Равенство нескольких значений можно проверить при помощи составного ключа.  Дополнительные сведения см. в разделе [Практическое руководство. Соединение с помощью составных ключей](../../../csharp/programming-guide/linq-query-expressions/how-to-join-by-using-composite-keys.md).  Кроме того, составные ключи можно использовать в предложении `group`.  
  
## Пример  
 В следующем примере сравниваются результаты внутреннего соединения, группового соединения и левого внешнего соединения в одних и тех же источниках данных при помощи тех же совпадающих ключей.  В эти примеры добавлен дополнительный код, поясняющий результаты в окне консоли.  
  
 [!code-cs[cscsrefQueryKeywords#23](../../../csharp/language-reference/keywords/codesnippet/CSharp/join-clause_5.cs)]  
  
## Заметки  
 Предложение `join`, за которым не следует `into`, переводится в вызов метода <xref:System.Linq.Enumerable.Join%2A>.  Предложение `join`, за которым следует `into`, переводится в вызов метода <xref:System.Linq.Enumerable.GroupJoin%2A>.  
  
## См. также  
 [Ключевые слова запроса \(LINQ\)](../../../csharp/language-reference/keywords/query-keywords.md)   
 [Выражения запросов LINQ](../../../csharp/programming-guide/linq-query-expressions/index.md)   
 [Join Operations](../../../visual-basic/programming-guide/concepts/linq/join-operations.md)   
 [Предложение group](../../../csharp/language-reference/keywords/group-clause.md)   
 [Практическое руководство. Выполнение левых внешних соединений](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-left-outer-joins.md)   
 [Практическое руководство. Выполнение внутренних соединений](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-inner-joins.md)   
 [Практическое руководство. Выполнение групповых соединений](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-grouped-joins.md)   
 [Практическое руководство. Упорядочение результатов предложения соединения](../../../csharp/programming-guide/linq-query-expressions/how-to-order-the-results-of-a-join-clause.md)   
 [Практическое руководство. Соединение с помощью составных ключей](../../../csharp/programming-guide/linq-query-expressions/how-to-join-by-using-composite-keys.md)   
 [Практическое руководство. Установка образцов баз данных](../Topic/How%20to:%20Install%20Sample%20Databases.md)