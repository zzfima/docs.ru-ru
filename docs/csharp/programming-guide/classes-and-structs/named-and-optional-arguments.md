---
title: "Именованные и необязательные аргументы (Руководство по программированию на C#) | Microsoft Docs"
ms.date: "2015-07-20"
ms.prod: ".net"
ms.technology: 
  - "devlang-csharp"
ms.topic: "article"
f1_keywords: 
  - "namedParameter_CSharpKeyword"
  - "cs_namedParameter"
dev_langs: 
  - "CSharp"
helpviewer_keywords: 
  - "аргументы [C#], именованные"
  - "аргументы [C#], необязательные"
  - "именованные и необязательные аргументы [C#]"
  - "именованные аргументы [C#]"
  - "необязательные аргументы [C#]"
  - "параметры [C#], именованные"
  - "параметры [C#], необязательные"
ms.assetid: 839c960c-c2dc-4d05-af4d-ca5428e54008
caps.latest.revision: 43
author: "BillWagner"
ms.author: "wiwagn"
caps.handback.revision: 43
---
# Именованные и необязательные аргументы (Руководство по программированию на C#)
В [!INCLUDE[csharp_dev10_long](../../../csharp/programming-guide/classes-and-structs/includes/csharp-dev10-long-md.md)] появились именованные и необязательные аргументы.  *Именованные аргументы* позволяют указать аргумент для определенного параметра, связав аргумент с именем параметра, а не с позицией параметра в списке параметров.  *Необязательные аргументы* позволяют опускать аргументы для некоторых параметров.  Оба подхода можно применять к методам, индексаторам, конструкторам и делегатам.  
  
 При использовании именованных и необязательных аргументов аргументы вычисляются в том порядке, в котором они указаны в списке аргументов, а не в списке параметров.  
  
 При совместном использовании именованных и необязательных параметров разработчик может задавать аргументы лишь для некоторых параметров из списка необязательных параметров.  Эта возможность значительно упрощает вызов интерфейсов COM, например интерфейсов API автоматизации Microsoft Office.  
  
## Именованные аргументы  
 Именованные аргументы освобождают разработчика от необходимости помнить или уточнять порядок следования параметров при вызове методов.  Параметр для каждого из аргументов можно задать с помощью имени параметра.  Например, функцию, которая вычисляет индекс массы тела, можно вызвать обычным способом, путем передачи аргументов для веса и роста по их позиции в том порядке, в котором они заданы в определении функции.  
  
 `CalculateBMI(123, 64);`  
  
 Если разработчик не помнит порядок параметров, но знает их имена, он может передать аргументы в любом порядке, сначала указав вес или рост.  
  
 `CalculateBMI(weight: 123, height: 64);`  
  
 `CalculateBMI(height: 64, weight: 123);`  
  
 Кроме того, именованные аргументы упрощают восприятие кода, поскольку они указывают назначение того или иного аргумента.  
  
 Именованный аргумент можно поместить после позиционных аргументов, как показано ниже.  
  
 `CalculateBMI(123, height: 64);`  
  
 Однако позиционные аргументы нельзя размещать после именованных аргументов.  Следующая инструкция вызывает ошибку компилятора.  
  
 `//CalculateBMI(weight: 123, 64);`  
  
## Пример  
 В следующем коде реализовано несколько примеров данного раздела.  
  
 [!code-cs[csProgGuideNamedAndOptional#1](../../../csharp/programming-guide/classes-and-structs/codesnippet/CSharp/named-and-optional-arguments_1.cs)]  
  
## Необязательные аргументы  
 В определении метода, конструктора, индексатора или делегата можно указать, что параметры являются обязательными или необязательными.  При каждом вызове необходимо указывать аргументы для всех обязательных параметров, но можно опустить аргументы для необязательных параметров.  
  
 В рамках определения каждого необязательного параметра задается его значение по умолчанию.  Если для параметра не передается аргумент, используется значение по умолчанию.  Значение по умолчанию должно быть одним из следующих типов выражений:  
  
-   константное выражение;  
  
-   выражение формы `new ValType()`, где  `ValType` тип значения, например  [перечисления](../../../csharp/language-reference/keywords/enum.md) или a  [структура](../../../csharp/programming-guide/classes-and-structs/structs.md);  
  
-   выражение формы [значение по умолчанию \(ValType\)](../../../csharp/programming-guide/generics/default-keyword-in-generic-code.md), где  `ValType` тип значения.  
  
 Необязательные параметры определяются в конце списка параметров после всех обязательных параметров.  Если вызывающий объект задает аргумент для какого\-либо из последующих необязательных параметров, он должен задать аргументы для всех предшествующих необязательных параметров.  Разделенные запятыми пустые позиции в списке аргументов не поддерживаются.  Например, в следующем коде метод экземпляра `ExampleMethod` определен одним или двумя необязательными параметрами.  
  
 [!code-cs[csProgGuideNamedAndOptional#15](../../../csharp/programming-guide/classes-and-structs/codesnippet/CSharp/named-and-optional-arguments_2.cs)]  
  
 Следующий вызов `ExampleMethod` вызывает ошибку компилятора, поскольку аргумент предоставлен для третьего параметра, а не для второго.  
  
 `//anExample.ExampleMethod(3, ,4);`  
  
 Но если имя третьего параметра известно, задачу можно выполнить с использованием именованного аргумента.  
  
 `anExample.ExampleMethod(3, optionalint: 4);`  
  
 IntelliSense использует квадратные скобки для указания необязательных параметров, как показано на следующем рисунке.  
  
 ![Быстрая справка IntelliSense для метода ExampleMethod.](../../../csharp/programming-guide/classes-and-structs/media/optional-parameters.png "Optional\_Parameters")  
Необязательные параметры в ExampleMethod  
  
> [!NOTE]
>  Кроме того, необязательные параметры можно определить с помощью класса .NET <xref:System.Runtime.InteropServices.OptionalAttribute>.  Для параметров `OptionalAttribute` указывать значение по умолчанию не обязательно.  
  
## Пример  
 В следующем примере у конструктора класса `ExampleClass` имеется один параметр, который является необязательным.  У метода экземпляра `ExampleMethod` имеется один обязательный параметр `required` и два необязательных параметра `optionalstr` и `optionalint`.  В коде в методе `Main` показаны различные способы вызова конструктора и метода.  
  
 [!code-cs[csProgGuideNamedAndOptional#2](../../../csharp/programming-guide/classes-and-structs/codesnippet/CSharp/named-and-optional-arguments_3.cs)]  
  
## Интерфейсы COM  
 Именованные и необязательные аргументы, а также поддержка динамических объектов и другие усовершенствования значительно улучшаю взаимодействие с интерфейсами API COM, например с API автоматизации Office.  
  
 Например, у метода [AutoFormat](http://go.microsoft.com/fwlink/?LinkId=148201) в интерфейсе Microsoft Office Excel [Range](http://go.microsoft.com/fwlink/?LinkId=148196) имеется семь параметров, все из которых необязательны.  Эти параметры показаны на следующем рисунке.  
  
 ![Быстрая справка IntelliSense для метода AutoFormat.](../../../csharp/programming-guide/classes-and-structs/media/autoformat-parameters.png "AutoFormat\_Parameters")  
Параметры AutoFormat  
  
 В C\# 3.0 и предыдущих версиях для каждого параметра требуется аргумент, как показано в следующем примере.  
  
 [!code-cs[csProgGuideNamedAndOptional#3](../../../csharp/programming-guide/classes-and-structs/codesnippet/CSharp/named-and-optional-arguments_4.cs)]  
  
 Однако можно значительно упростить вызов `AutoFormat`, воспользовавшись необязательными и именованными аргументами, представленными в C\# 4.0.  Именованные и необязательные аргументы позволяют опустить аргумент необязательного параметра, если изменять значение параметра по умолчанию не требуется.  В следующем вызове задается значение только для одного из семи параметров.  
  
 [!code-cs[csProgGuideNamedAndOptional#13](../../../csharp/programming-guide/classes-and-structs/codesnippet/CSharp/named-and-optional-arguments_5.cs)]  
  
 Дополнительные сведения и примеры см. в разделах [Практическое руководство. Использование именованных и необязательных аргументов в программировании приложений Office](../../../csharp/programming-guide/classes-and-structs/how-to-use-named-and-optional-arguments-in-office-programming.md) и [Практическое руководство. Доступ к объектам взаимодействия Office с помощью функций языка Visual C\#](../../../csharp/programming-guide/interop/how-to-access-office-onterop-objects.md).  
  
## Разрешение перегрузки  
 Использование именованных и необязательных аргументов следующим образом влияет на разрешение перегрузки:  
  
-   метод, индексатор или конструктор является кандидатом на выполнение, если каждый из его параметров является необязательным или соответствует по имени или позиции одному аргументу в инструкции вызова, а этот аргумент можно преобразовать к типу параметра;  
  
-   если обнаружено более одного кандидата, правила разрешения перегрузки для предпочтительных преобразований применяются к аргументам, которые заданы в явном виде.  Опущенные аргументы для необязательных параметров игнорируются;  
  
-   если два кандидата оказываются одинаково подходящими, предпочтение отдается кандидату, у которого нет необязательных параметров, аргументы которых были опущены в вызове.  Это последовательность общего приоритета при разрешении перегрузки для кандидатов с меньшим числом параметров.  
  
## Спецификация языка C\#  
 [!INCLUDE[CSharplangspec](../../../csharp/language-reference/keywords/includes/csharplangspec-md.md)]  
  
## См. также  
 [Практическое руководство. Использование именованных и необязательных аргументов в программировании приложений Office](../../../csharp/programming-guide/classes-and-structs/how-to-use-named-and-optional-arguments-in-office-programming.md)   
 [Использование типа dynamic](../../../csharp/programming-guide/types/using-type-dynamic.md)   
 [Использование конструкторов](../../../csharp/programming-guide/classes-and-structs/using-constructors.md)   
 [Использование индексаторов](../../../csharp/programming-guide/indexers/using-indexers.md)