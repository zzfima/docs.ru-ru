---
title: Методы. Руководство по программированию на C#
ms.date: 07/20/2015
helpviewer_keywords:
- methods [C#]
- C# language, methods
ms.assetid: cc738f07-e8cd-4683-9585-9f40c0667c37
ms.openlocfilehash: 5955228d51d2f6845a363bcaf32581b6598273f6
ms.sourcegitcommit: 5f236cd78cf09593c8945a7d753e0850e96a0b80
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2020
ms.locfileid: "75714770"
---
# <a name="methods-c-programming-guide"></a><span data-ttu-id="5f0cc-102">Методы (Руководство по программированию на C#)</span><span class="sxs-lookup"><span data-stu-id="5f0cc-102">Methods (C# Programming Guide)</span></span>

<span data-ttu-id="5f0cc-103">Метод — это блок кода, содержащий ряд инструкций.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-103">A method is a code block that contains a series of statements.</span></span> <span data-ttu-id="5f0cc-104">Программа инициирует выполнение инструкций, вызывая метод и указывая все аргументы, необходимые для этого метода.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-104">A program causes the statements to be executed by calling the method and specifying any required method arguments.</span></span> <span data-ttu-id="5f0cc-105">В C# все инструкции выполняются в контексте метода.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-105">In C#, every executed instruction is performed in the context of a method.</span></span> <span data-ttu-id="5f0cc-106">Метод `Main` является точкой входа для каждого приложения C# и вызывается общеязыковой средой выполнения (CLR) при запуске программы.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-106">The `Main` method is the entry point for every C# application and it's called by the common language runtime (CLR) when the program is started.</span></span>

> [!NOTE]
> <span data-ttu-id="5f0cc-107">В этой статье рассматриваются названные методы.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-107">This article discusses named methods.</span></span> <span data-ttu-id="5f0cc-108">Сведения об анонимных функциях см. в разделе [Анонимные функции](../statements-expressions-operators/anonymous-functions.md).</span><span class="sxs-lookup"><span data-stu-id="5f0cc-108">For information about anonymous functions, see [Anonymous Functions](../statements-expressions-operators/anonymous-functions.md).</span></span>

## <a name="method-signatures"></a><span data-ttu-id="5f0cc-109">Сигнатуры методов</span><span class="sxs-lookup"><span data-stu-id="5f0cc-109">Method signatures</span></span>

<span data-ttu-id="5f0cc-110">Методы объявляются в [классе](../../language-reference/keywords/class.md) или в [структуре](../../language-reference/keywords/struct.md) путем указания уровня доступа, такого как `public` или `private`, необязательных модификаторов, таких как `abstract` или `sealed`, возвращаемого значения, имени метода и всех параметров этого метода.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-110">Methods are declared in a [class](../../language-reference/keywords/class.md) or [struct](../../language-reference/keywords/struct.md) by specifying the access level such as `public` or `private`, optional modifiers such as `abstract` or `sealed`, the return value, the name of the method, and any method parameters.</span></span> <span data-ttu-id="5f0cc-111">Все эти части вместе представляют собой сигнатуру метода.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-111">These parts together are the signature of the method.</span></span>

> [!NOTE]
> <span data-ttu-id="5f0cc-112">Тип возврата метода не является частью сигнатуры метода в целях перегрузки метода.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-112">A return type of a method is not part of the signature of the method for the purposes of method overloading.</span></span> <span data-ttu-id="5f0cc-113">Однако он является частью сигнатуры метода при определении совместимости между делегатом и методом, на который он указывает.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-113">However, it is part of the signature of the method when determining the compatibility between a delegate and the method that it points to.</span></span>

<span data-ttu-id="5f0cc-114">Параметры метода заключаются в скобки и разделяются запятыми.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-114">Method parameters are enclosed in parentheses and are separated by commas.</span></span> <span data-ttu-id="5f0cc-115">Пустые скобки указывают, что параметры методу не требуются.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-115">Empty parentheses indicate that the method requires no parameters.</span></span> <span data-ttu-id="5f0cc-116">Этот класс содержит четыре метода:</span><span class="sxs-lookup"><span data-stu-id="5f0cc-116">This class contains four methods:</span></span>

[!code-csharp[csProgGuideObjects#40](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideObjects/CS/Objects.cs#40)]

## <a name="method-access"></a><span data-ttu-id="5f0cc-117">Доступ к методу</span><span class="sxs-lookup"><span data-stu-id="5f0cc-117">Method access</span></span>

<span data-ttu-id="5f0cc-118">Вызов метода в объекте аналогичен доступу к полю.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-118">Calling a method on an object is like accessing a field.</span></span> <span data-ttu-id="5f0cc-119">После имени объекта добавьте точку, имя метода и круглые скобки.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-119">After the object name, add a period, the name of the method, and parentheses.</span></span> <span data-ttu-id="5f0cc-120">Аргументы перечисляются в этих скобках и разделяются запятыми.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-120">Arguments are listed within the parentheses, and are separated by commas.</span></span> <span data-ttu-id="5f0cc-121">Таким образом, методы класса `Motorcycle` могут вызываться, как показано в следующем примере:</span><span class="sxs-lookup"><span data-stu-id="5f0cc-121">The methods of the `Motorcycle` class can therefore be called as in the following example:</span></span>

[!code-csharp[csProgGuideObjects#41](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideObjects/CS/Objects.cs#41)]

## <a name="method-parameters-vs-arguments"></a><span data-ttu-id="5f0cc-122">Параметры и аргументы метода</span><span class="sxs-lookup"><span data-stu-id="5f0cc-122">Method parameters vs. arguments</span></span>

<span data-ttu-id="5f0cc-123">Определение метода задает имена и типы всех необходимых параметров.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-123">The method definition specifies the names and types of any parameters that are required.</span></span> <span data-ttu-id="5f0cc-124">Когда вызывающий код вызывает метод, он предоставляет конкретные значения, называемые аргументами, для каждого параметра.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-124">When calling code calls the method, it provides concrete values called arguments for each parameter.</span></span> <span data-ttu-id="5f0cc-125">Аргументы должны быть совместимы с типом параметра, но имя аргумента (если есть), используемое в вызывающем коде, не обязательно должно совпадать с именем параметра, указанным в методе.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-125">The arguments must be compatible with the parameter type but the argument name (if any) used in the calling code doesn't have to be the same as the parameter named defined in the method.</span></span> <span data-ttu-id="5f0cc-126">Пример:</span><span class="sxs-lookup"><span data-stu-id="5f0cc-126">For example:</span></span>

[!code-csharp[csProgGuideObjects#74](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideObjects/CS/Objects.cs#74)]

## <a name="passing-by-reference-vs-passing-by-value"></a><span data-ttu-id="5f0cc-127">Передача по ссылке и передача по значению</span><span class="sxs-lookup"><span data-stu-id="5f0cc-127">Passing by reference vs. passing by value</span></span>

<span data-ttu-id="5f0cc-128">По умолчанию при передаче в метод типа значения вместо самого объекта передается его копия.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-128">By default, when a value type is passed to a method, a copy is passed instead of the object itself.</span></span> <span data-ttu-id="5f0cc-129">Поэтому изменения в аргументе не оказывают влияния на исходную копию в вызывающем методе.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-129">Therefore, changes to the argument have no effect on the original copy in the calling method.</span></span> <span data-ttu-id="5f0cc-130">Вы можете передавать тип значения по ссылке с помощью ключевого слова ref.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-130">You can pass a value-type by reference by using the ref keyword.</span></span> <span data-ttu-id="5f0cc-131">Дополнительные сведения см. в разделе [Передача параметров типа значения](./passing-value-type-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="5f0cc-131">For more information, see [Passing Value-Type Parameters](./passing-value-type-parameters.md).</span></span> <span data-ttu-id="5f0cc-132">Список встроенных типов значений см. в разделе [Таблица типов значений](../../language-reference/keywords/value-types-table.md).</span><span class="sxs-lookup"><span data-stu-id="5f0cc-132">For a list of built-in value types, see [Value Types Table](../../language-reference/keywords/value-types-table.md).</span></span>

<span data-ttu-id="5f0cc-133">При передаче в метод объекта ссылочного типа передается ссылка на этот объект.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-133">When an object of a reference type is passed to a method, a reference to the object is passed.</span></span> <span data-ttu-id="5f0cc-134">То есть метод получает не сам объект, а аргумент, который указывает расположение объекта.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-134">That is, the method receives not the object itself but an argument that indicates the location of the object.</span></span> <span data-ttu-id="5f0cc-135">При изменении члена объекта с помощью этой ссылки это изменение отражается в аргументе в вызывающем методе, даже если объект передается по значению.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-135">If you change a member of the object by using this reference, the change is reflected in the argument in the calling method, even if you pass the object by value.</span></span>

<span data-ttu-id="5f0cc-136">Ссылочный тип создается с помощью ключевого слова `class`, как показано в следующем примере.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-136">You create a reference type by using the `class` keyword, as the following example shows:</span></span>

[!code-csharp[csProgGuideObjects#42](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideObjects/CS/Objects.cs#42)]

<span data-ttu-id="5f0cc-137">Теперь, если передать объект, основанный на этом типе, в метод, то будет передана ссылка на объект.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-137">Now, if you pass an object that is based on this type to a method, a reference to the object is passed.</span></span> <span data-ttu-id="5f0cc-138">В следующем примере объект типа `SampleRefType` передается в метод `ModifyObject`:</span><span class="sxs-lookup"><span data-stu-id="5f0cc-138">The following example passes an object of type `SampleRefType` to method `ModifyObject`:</span></span>

[!code-csharp[csProgGuideObjects#75](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideObjects/CS/Objects.cs#75)]

<span data-ttu-id="5f0cc-139">В этом примере, в сущности, делается то же, что и в предыдущем примере, — аргумент по значению передается в метод.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-139">The example does essentially the same thing as the previous example in that it passes an argument by value to a method.</span></span> <span data-ttu-id="5f0cc-140">Но поскольку здесь используется ссылочный тип, результат будет другим.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-140">But, because a reference type is used, the result is different.</span></span> <span data-ttu-id="5f0cc-141">В данном случае в методе `ModifyObject` изменено поле `value` параметра `obj`, а также изменено поле `value` аргумента, `rt`в методе `TestRefType` .</span><span class="sxs-lookup"><span data-stu-id="5f0cc-141">The modification that is made in `ModifyObject` to the `value` field of the parameter, `obj`, also changes the `value` field of the argument, `rt`, in the `TestRefType` method.</span></span> <span data-ttu-id="5f0cc-142">В качестве выходных данных метод `TestRefType` отображает 33.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-142">The `TestRefType` method displays 33 as the output.</span></span>

<span data-ttu-id="5f0cc-143">Дополнительные сведения о передаче ссылочных типов по ссылке и по значению см. в разделах [Передача параметров ссылочного типа](./passing-reference-type-parameters.md) и [Ссылочные типы](../../language-reference/keywords/reference-types.md).</span><span class="sxs-lookup"><span data-stu-id="5f0cc-143">For more information about how to pass reference types by reference and by value, see [Passing Reference-Type Parameters](./passing-reference-type-parameters.md) and [Reference Types](../../language-reference/keywords/reference-types.md).</span></span>

## <a name="return-values"></a><span data-ttu-id="5f0cc-144">Возвращаемые значения</span><span class="sxs-lookup"><span data-stu-id="5f0cc-144">Return values</span></span>

<span data-ttu-id="5f0cc-145">Методы могут возвращать значение вызывающему объекту.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-145">Methods can return a value to the caller.</span></span> <span data-ttu-id="5f0cc-146">Если тип возврата, указываемый перед именем метода, не `void`, этот метод может возвращать значение с помощью ключевого слова `return` .</span><span class="sxs-lookup"><span data-stu-id="5f0cc-146">If the return type, the type listed before the method name, is not `void`, the method can return the value by using the `return` keyword.</span></span> <span data-ttu-id="5f0cc-147">Инструкция с ключевым словом `return` , за которым следует значение, соответствующее типу возврата, будет возвращать это значение объекту, вызвавшему метод.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-147">A statement with the `return` keyword followed by a value that matches the return type will return that value to the method caller.</span></span>

<span data-ttu-id="5f0cc-148">Значение может возвращаться вызывающему объекту по значению или, начиная с C# версии 7.0, [по ссылке](ref-returns.md).</span><span class="sxs-lookup"><span data-stu-id="5f0cc-148">The value can be returned to the caller by value or, starting with C# 7.0, [by reference](ref-returns.md).</span></span> <span data-ttu-id="5f0cc-149">Значения возвращаются вызывающему объекту по ссылке, если ключевое слово `ref` используется в сигнатуре метода и указывается после каждого ключевого слова `return`.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-149">Values are returned to the caller by reference if the `ref` keyword is used in the method signature and it follows each `return` keyword.</span></span> <span data-ttu-id="5f0cc-150">Например, следующая сигнатура метода и оператор return указывают, что метод возвращает имена переменных `estDistance` вызывающему объекту по ссылке.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-150">For example, the following method signature and return statement indicate that the method returns a variable names `estDistance` by reference to the caller.</span></span>

```csharp
public ref double GetEstimatedDistance()
{
    return ref estDistance;
}
```

<span data-ttu-id="5f0cc-151">Ключевое слове `return` также останавливает выполнение метода.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-151">The `return` keyword also stops the execution of the method.</span></span> <span data-ttu-id="5f0cc-152">Если тип возврата — `void`, инструкцию `return` без значения по-прежнему можно использовать для завершения выполнения метода.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-152">If the return type is `void`, a `return` statement without a value is still useful to stop the execution of the method.</span></span> <span data-ttu-id="5f0cc-153">Без ключевого слова `return` этот метод будет останавливать выполнение при достижении конца блока кода.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-153">Without the `return` keyword, the method will stop executing when it reaches the end of the code block.</span></span> <span data-ttu-id="5f0cc-154">Методы с типом возврата, отличным от void, должны использовать ключевое слово `return` для возврата значения.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-154">Methods with a non-void return type are required to use the `return` keyword to return a value.</span></span> <span data-ttu-id="5f0cc-155">Например, в следующих двух методах ключевое слово `return` используется для возврата целочисленных значений.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-155">For example, these two methods use the `return` keyword to return integers:</span></span>

[!code-csharp[csProgGuideObjects#44](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideObjects/CS/Objects.cs#44)]

<span data-ttu-id="5f0cc-156">Чтобы использовать значение, возвращаемое из метода, вызывающий метод может применять сам вызов метода везде, где будет достаточно значения того же типа.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-156">To use a value returned from a method, the calling method can use the method call itself anywhere a value of the same type would be sufficient.</span></span> <span data-ttu-id="5f0cc-157">Можно также назначить возвращаемое значение переменной.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-157">You can also assign the return value to a variable.</span></span> <span data-ttu-id="5f0cc-158">Например, следующие два примера кода достигают одной и той же цели.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-158">For example, the following two code examples accomplish the same goal:</span></span>

[!code-csharp[csProgGuideObjects#45](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideObjects/CS/Objects.cs#45)]

[!code-csharp[csProgGuideObjects#46](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideObjects/CS/Objects.cs#46)]

<span data-ttu-id="5f0cc-159">Использование локальной переменной, в данном случае `result`, для сохранения значения является необязательным.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-159">Using a local variable, in this case, `result`, to store a value is optional.</span></span> <span data-ttu-id="5f0cc-160">Это может улучшить читаемость кода или может оказаться необходимым, если нужно сохранить исходное значение аргумента для всей области метода.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-160">It may help the readability of the code, or it may be necessary if you need to store the original value of the argument for the entire scope of the method.</span></span>

<span data-ttu-id="5f0cc-161">Чтобы использовать значение, возвращаемое по ссылке из метода, необходимо объявить [локальную ссылочную переменную](ref-returns.md#ref-locals), если планируется изменение значения.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-161">To use a value returned by reference from a method, you must declare a [ref local](ref-returns.md#ref-locals) variable if you intend to modify its value.</span></span> <span data-ttu-id="5f0cc-162">Например, если метод `Planet.GetEstimatedDistance` возвращает значение <xref:System.Double> по ссылке, можно определить его как локальную ссылочную переменную с использованием кода следующего вида:</span><span class="sxs-lookup"><span data-stu-id="5f0cc-162">For example, if the `Planet.GetEstimatedDistance` method returns a <xref:System.Double> value by reference, you can define it as a ref local variable with code like the following:</span></span>

```csharp
ref int distance = plant
```

<span data-ttu-id="5f0cc-163">Возвращать многомерный массив из метода `M`, который изменяет содержимое массива, необязательно, если вызывающая функция передает массив в `M`.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-163">Returning a multi-dimensional array from a method, `M`, that modifies the array's contents is not necessary if the calling function passed the array into `M`.</span></span>  <span data-ttu-id="5f0cc-164">В целях оптимизации можно возвращать полученный массив из `M` или функциональный поток значений, однако это необязательно. Это связано с тем, что C# передает все ссылочные типы по значению, а значение ссылки на массив представляет собой указатель на массив.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-164">You may return the resulting array from `M` for good style or functional flow of values, but it is not necessary because C# passes all reference types by value, and the value of an array reference is the pointer to the array.</span></span> <span data-ttu-id="5f0cc-165">В методе `M` любые изменения содержимого массива отслеживаются любым кодом, имеющим ссылку на массив, как показано в приведенном ниже примере:</span><span class="sxs-lookup"><span data-stu-id="5f0cc-165">In the method `M`, any changes to the array's contents are observable by any code that has a reference to the array, as shown in the following example:</span></span>

```csharp
static void Main(string[] args)
{
    int[,] matrix = new int[2, 2];
    FillMatrix(matrix);
    // matrix is now full of -1
}

public static void FillMatrix(int[,] matrix)
{
    for (int i = 0; i < matrix.GetLength(0); i++)
    {
        for (int j = 0; j < matrix.GetLength(1); j++)
        {
            matrix[i, j] = -1;
        }
    }
}
```

<span data-ttu-id="5f0cc-166">Для получения дополнительной информации см. [return](../../language-reference/keywords/return.md).</span><span class="sxs-lookup"><span data-stu-id="5f0cc-166">For more information, see [return](../../language-reference/keywords/return.md).</span></span>

## <a name="async-methods"></a><span data-ttu-id="5f0cc-167">Асинхронные методы</span><span class="sxs-lookup"><span data-stu-id="5f0cc-167">Async methods</span></span>

<span data-ttu-id="5f0cc-168">С помощью функции async можно вызывать асинхронные методы, не прибегая к использованию явных обратных вызовов или ручному разделению кода между несколькими методами или лямбда-выражениями.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-168">By using the async feature, you can invoke asynchronous methods without using explicit callbacks or manually splitting your code across multiple methods or lambda expressions.</span></span>

<span data-ttu-id="5f0cc-169">Если пометить метод с помощью модификатора [async](../../language-reference/keywords/async.md) , можно использовать в этом методе инструкцию [await](../../language-reference/operators/await.md) .</span><span class="sxs-lookup"><span data-stu-id="5f0cc-169">If you mark a method with the [async](../../language-reference/keywords/async.md) modifier, you can use the [await](../../language-reference/operators/await.md) operator in the method.</span></span> <span data-ttu-id="5f0cc-170">Когда управление достигает выражения await в асинхронном методе, управление возвращается вызывающему объекту и выполнение метода приостанавливается до завершения выполнения ожидающей задачи.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-170">When control reaches an await expression in the async method, control returns to the caller, and progress in the method is suspended until the awaited task completes.</span></span> <span data-ttu-id="5f0cc-171">После завершения задачи можно возобновить выполнение в методе.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-171">When the task is complete, execution can resume in the method.</span></span>

> [!NOTE]
> <span data-ttu-id="5f0cc-172">Асинхронный метод возвращается в вызывающий объект, когда он встречает первый ожидаемый объект, выполнение которого еще не завершено, или когда выполнение асинхронного метода доходит до конца — в зависимости от того, что происходит раньше.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-172">An async method returns to the caller when either it encounters the first awaited object that’s not yet complete or it gets to the end of the async method, whichever occurs first.</span></span>

<span data-ttu-id="5f0cc-173">Асинхронный метод может иметь тип возврата <xref:System.Threading.Tasks.Task%601>, <xref:System.Threading.Tasks.Task>или void.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-173">An async method can have a return type of <xref:System.Threading.Tasks.Task%601>, <xref:System.Threading.Tasks.Task>, or void.</span></span> <span data-ttu-id="5f0cc-174">Тип возврата void в основном используется для определения обработчиков событий, где требуется тип возврата void.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-174">The void return type is used primarily to define event handlers, where a void return type is required.</span></span> <span data-ttu-id="5f0cc-175">Асинхронный метод, который возвращает тип void, не может быть ожидающим. Вызывающий объект метода, возвращающего значение типа void, не может перехватывать исключения, которые выдает этот метод.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-175">An async method that returns void can't be awaited, and the caller of a void-returning method can't catch exceptions that the method throws.</span></span>

<span data-ttu-id="5f0cc-176">В следующем примере `DelayAsync` является асинхронным методом с типом возврата <xref:System.Threading.Tasks.Task%601>.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-176">In the following example, `DelayAsync` is an async method that has a return type of <xref:System.Threading.Tasks.Task%601>.</span></span> <span data-ttu-id="5f0cc-177">`DelayAsync` имеет инструкцию `return` , которая возвращает целое число.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-177">`DelayAsync` has a `return` statement that returns an integer.</span></span> <span data-ttu-id="5f0cc-178">Поэтому объявление метода `DelayAsync` должно иметь тип возврата `Task<int>`.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-178">Therefore the method declaration of `DelayAsync` must have a return type of `Task<int>`.</span></span> <span data-ttu-id="5f0cc-179">Поскольку тип возврата — `Task<int>`, вычисление выражения `await` в `DoSomethingAsync` создает целое число, как показывает следующая инструкция: `int result = await delayTask`.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-179">Because the return type is `Task<int>`, the evaluation of the `await` expression in `DoSomethingAsync` produces an integer as the following statement demonstrates: `int result = await delayTask`.</span></span>

<span data-ttu-id="5f0cc-180">В следующем примере метод `startButton_Click` служит примером асинхронного метода с типом возврата void.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-180">The `startButton_Click` method is an example of an async method that has a return type of void.</span></span> <span data-ttu-id="5f0cc-181">Поскольку `DoSomethingAsync` является асинхронным методом, задача для вызова `DoSomethingAsync` должна быть ожидаемой, как показывает следующая инструкция: `await DoSomethingAsync();`.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-181">Because `DoSomethingAsync` is an async method, the task for the call to `DoSomethingAsync` must be awaited, as the following statement shows: `await DoSomethingAsync();`.</span></span> <span data-ttu-id="5f0cc-182">Метод `startButton_Click` должен быть определен с модификатором `async` , так как этот метод имеет выражение `await` .</span><span class="sxs-lookup"><span data-stu-id="5f0cc-182">The `startButton_Click` method must be defined with the `async` modifier because the method has an `await` expression.</span></span>

[!code-csharp[csAsyncMethod#2](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csasyncmethod/cs/mainwindow.xaml.cs#2)]

<span data-ttu-id="5f0cc-183">Асинхронный метод не может объявить все параметры [ref](../../language-reference/keywords/ref.md) или [out](../../language-reference/keywords/out-parameter-modifier.md) , но может вызывать методы, которые имеют такие параметры.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-183">An async method can't declare any [ref](../../language-reference/keywords/ref.md) or [out](../../language-reference/keywords/out-parameter-modifier.md) parameters, but it can call methods that have such parameters.</span></span>

<span data-ttu-id="5f0cc-184">Дополнительные сведения об асинхронных методах см. в разделах [Асинхронное программирование с использованием ключевых слов async и await](../concepts/async/index.md), [Поток управления в асинхронных программах](../concepts/async/control-flow-in-async-programs.md) и [Асинхронные типы возврата](../concepts/async/async-return-types.md).</span><span class="sxs-lookup"><span data-stu-id="5f0cc-184">For more information about async methods, see [Asynchronous Programming with async and await](../concepts/async/index.md), [Control Flow in Async Programs](../concepts/async/control-flow-in-async-programs.md), and [Async Return Types](../concepts/async/async-return-types.md).</span></span>

## <a name="expression-body-definitions"></a><span data-ttu-id="5f0cc-185">Определения текста выражений</span><span class="sxs-lookup"><span data-stu-id="5f0cc-185">Expression body definitions</span></span>

<span data-ttu-id="5f0cc-186">Часто используются определения методов, которые просто немедленно возвращаются с результатом выражения или которые имеют единственную инструкцию в тексте метода.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-186">It is common to have method definitions that simply return immediately with the result of an expression, or that have a single statement as the body of the method.</span></span> <span data-ttu-id="5f0cc-187">Для определения таких методов существует сокращенный синтаксис с использованием `=>`:</span><span class="sxs-lookup"><span data-stu-id="5f0cc-187">There is a syntax shortcut for defining such methods using `=>`:</span></span>

```csharp
public Point Move(int dx, int dy) => new Point(x + dx, y + dy);
public void Print() => Console.WriteLine(First + " " + Last);
// Works with operators, properties, and indexers too.
public static Complex operator +(Complex a, Complex b) => a.Add(b);
public string Name => First + " " + Last;
public Customer this[long id] => store.LookupCustomer(id);
```

<span data-ttu-id="5f0cc-188">Если метод возвращает `void` или является асинхронным методом, то текст метода должен быть выражением инструкции (так же, как при использовании лямбда-выражений).</span><span class="sxs-lookup"><span data-stu-id="5f0cc-188">If the method returns `void` or is an async method, then the body of the method must be a statement expression (same as with lambdas).</span></span> <span data-ttu-id="5f0cc-189">Свойства и индексаторы должны быть только для чтения, и вы не должны использовать ключевое слово `get` метода доступа.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-189">For properties and indexers, they must be read only, and you don't use the `get` accessor keyword.</span></span>

## <a name="iterators"></a><span data-ttu-id="5f0cc-190">Iterators</span><span class="sxs-lookup"><span data-stu-id="5f0cc-190">Iterators</span></span>

<span data-ttu-id="5f0cc-191">Итератор выполняет настраиваемую итерацию по коллекции, например по списку или массиву.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-191">An iterator performs a custom iteration over a collection, such as a list or an array.</span></span> <span data-ttu-id="5f0cc-192">Итератор использует инструкцию [yield return](../../language-reference/keywords/yield.md) для возврата всех элементов по одному.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-192">An iterator uses the [yield return](../../language-reference/keywords/yield.md) statement to return each element one at a time.</span></span> <span data-ttu-id="5f0cc-193">Когда достигается инструкция [yield return](../../language-reference/keywords/yield.md) , текущее расположение в коде запоминается.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-193">When a [yield return](../../language-reference/keywords/yield.md) statement is reached, the current location in code is remembered.</span></span> <span data-ttu-id="5f0cc-194">При следующем вызове итератора выполнение возобновляется с этого места.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-194">Execution is restarted from that location when the iterator is called the next time.</span></span>

<span data-ttu-id="5f0cc-195">Итератор вызывается из клиентского кода с помощью инструкции [foreach](../../language-reference/keywords/foreach-in.md) .</span><span class="sxs-lookup"><span data-stu-id="5f0cc-195">You call an iterator from client code by using a [foreach](../../language-reference/keywords/foreach-in.md) statement.</span></span>

<span data-ttu-id="5f0cc-196">Тип возврата итератора может быть <xref:System.Collections.IEnumerable>, <xref:System.Collections.Generic.IEnumerable%601>, <xref:System.Collections.IEnumerator> или <xref:System.Collections.Generic.IEnumerator%601>.</span><span class="sxs-lookup"><span data-stu-id="5f0cc-196">The return type of an iterator can be <xref:System.Collections.IEnumerable>, <xref:System.Collections.Generic.IEnumerable%601>, <xref:System.Collections.IEnumerator>, or <xref:System.Collections.Generic.IEnumerator%601>.</span></span>

<span data-ttu-id="5f0cc-197">Дополнительные сведения см. в разделе [Итераторы](../concepts/iterators.md).</span><span class="sxs-lookup"><span data-stu-id="5f0cc-197">For more information, see [Iterators](../concepts/iterators.md).</span></span>

## <a name="c-language-specification"></a><span data-ttu-id="5f0cc-198">Спецификация языка C#</span><span class="sxs-lookup"><span data-stu-id="5f0cc-198">C# language specification</span></span>

[!INCLUDE[CSharplangspec](~/includes/csharplangspec-md.md)]

## <a name="see-also"></a><span data-ttu-id="5f0cc-199">См. также</span><span class="sxs-lookup"><span data-stu-id="5f0cc-199">See also</span></span>

- [<span data-ttu-id="5f0cc-200">Руководство по программированию на C#</span><span class="sxs-lookup"><span data-stu-id="5f0cc-200">C# Programming Guide</span></span>](../index.md)
- [<span data-ttu-id="5f0cc-201">Классы и структуры</span><span class="sxs-lookup"><span data-stu-id="5f0cc-201">Classes and Structs</span></span>](index.md)
- [<span data-ttu-id="5f0cc-202">Модификаторы доступа</span><span class="sxs-lookup"><span data-stu-id="5f0cc-202">Access Modifiers</span></span>](access-modifiers.md)
- [<span data-ttu-id="5f0cc-203">Статические классы и члены статических классов</span><span class="sxs-lookup"><span data-stu-id="5f0cc-203">Static Classes and Static Class Members</span></span>](static-classes-and-static-class-members.md)
- [<span data-ttu-id="5f0cc-204">Наследование</span><span class="sxs-lookup"><span data-stu-id="5f0cc-204">Inheritance</span></span>](inheritance.md)
- [<span data-ttu-id="5f0cc-205">Абстрактные и запечатанные классы и члены классов</span><span class="sxs-lookup"><span data-stu-id="5f0cc-205">Abstract and Sealed Classes and Class Members</span></span>](abstract-and-sealed-classes-and-class-members.md)
- [<span data-ttu-id="5f0cc-206">params</span><span class="sxs-lookup"><span data-stu-id="5f0cc-206">params</span></span>](../../language-reference/keywords/params.md)
- [<span data-ttu-id="5f0cc-207">return</span><span class="sxs-lookup"><span data-stu-id="5f0cc-207">return</span></span>](../../language-reference/keywords/return.md)
- [<span data-ttu-id="5f0cc-208">out</span><span class="sxs-lookup"><span data-stu-id="5f0cc-208">out</span></span>](../../language-reference/keywords/out.md)
- [<span data-ttu-id="5f0cc-209">ref</span><span class="sxs-lookup"><span data-stu-id="5f0cc-209">ref</span></span>](../../language-reference/keywords/ref.md)
- [<span data-ttu-id="5f0cc-210">Передача параметров</span><span class="sxs-lookup"><span data-stu-id="5f0cc-210">Passing Parameters</span></span>](passing-parameters.md)
