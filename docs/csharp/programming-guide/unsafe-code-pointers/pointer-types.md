---
title: Руководство по программированию на C#. Типы указателей
ms.date: 04/20/2018
helpviewer_keywords:
- unsafe code [C#], pointers
- pointers [C#]
ms.openlocfilehash: 7bbfa6b2238458d3248da830cf9d6ac36551b431
ms.sourcegitcommit: 2514f4e3655081dcfe1b22470c0c28500f952c42
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/18/2020
ms.locfileid: "79507039"
---
# <a name="pointer-types-c-programming-guide"></a>Типы указателей (Руководство по программированию на C#)

В небезопасном контексте тип может быть типом указателя, типом значения или ссылочным типом. Объявления типа указателя выполняется одним из следующих способов:

``` csharp
type* identifier;
void* identifier; //allowed but not recommended
```

Тип, указанный до `*` в типе указателя, называется **ссылочным типом**. Ссылочным типом может быть только [неуправляемый тип](../../language-reference/builtin-types/unmanaged-types.md).

Типы указателей не наследуются от [объекта](../../language-reference/builtin-types/reference-types.md), а типы указателей не преобразуются в `object`. Кроме того, упаковка-преобразование и распаковка-преобразование не поддерживают указатели. Однако можно выполнять преобразования между различными типами указателей, а также между типами указателей и целочисленными типами.

При объявлении нескольких указателей в одном объявлении знак * указывается только с базовым типом; он не используется в качестве префикса для каждого имени указателя. Пример:

```csharp
int* p1, p2, p3;   // Ok
int *p1, *p2, *p3;   // Invalid in C#
```

Указатель не может указывать на ссылку или на [структуру](../../language-reference/builtin-types/struct.md), содержащую ссылки, поскольку ссылка на объект может быть подвергнута сбору мусора, даже если на нее указывает указатель. Сборщик мусора не отслеживает наличие указателей любых типов, указывающих на объекты.

Значением переменной-указателя типа `myType*` является адрес переменной типа `myType`. Ниже приведены примеры объявлений типов указателей.

|Пример|Описание|
|-------------|-----------------|
|`int* p`|`p` — указатель на целое число.|
|`int** p`|`p` — указатель на указатель на целое число.|
|`int*[] p`|`p` — одномерный массив указателей на целые числа.|
|`char* p`|`p` — указатель на тип char.|
|`void* p`|`p` — указатель на неизвестный тип.|

Оператор косвенного обращения указателя * можно использовать для доступа к содержимому, на которое указывает переменная-указатель. В качестве примера рассмотрим следующее объявление:

```csharp
int* myVariable;
```

Выражение `*myVariable` обозначает переменную `int`, находящуюся по адресу, содержащемуся в `myVariable`.

Разделы [Оператор fixed](../../language-reference/keywords/fixed-statement.md) и [Преобразования указателей](./pointer-conversions.md) содержат несколько примеров. В следующем примере используются ключевое слово `unsafe` и оператор `fixed`, а также демонстрируется способ инкрементирования внутреннего указателя.  Этот код можно вставить в функцию Main консольного приложения для его запуска. Эти примеры должны быть скомпилированы с заданным параметром компилятора [-unsafe](../../language-reference/compiler-options/unsafe-compiler-option.md).

[!code-csharp[Using pointer types](../../../../samples/snippets/csharp/keywords/FixedKeywordExamples.cs#5)]

Для указателя типа `void*` использовать оператор косвенного обращения нельзя. Однако можно использовать приведение для преобразования указателя типа void в любой другой тип и наоборот.

Указатель может иметь значение `null`. При применении оператора косвенного обращения к указателю со значением null результат зависит от конкретной реализации.

При передаче указателей между методами может возникнуть неопределенное поведение. Рекомендуется использовать метод, возвращающий указатель в локальную переменную с помощью параметра `in`, `out` или `ref` либо в виде результата функции. Если указатель был задан в фиксированном блоке, переменная, на которую он указывает, больше не может быть фиксированной.

В следующей таблице перечислены операторы, которые можно использовать для указателей в небезопасном контексте.

|Оператор|Использовать|
|-------------------------|---------|
|`*`|Косвенное обращение к указателю.|
|`->`|Доступ к члену структуры через указатель.|
|`[]`|Индексирование указателя.|
|`&`|Получение адреса переменной.|
|`++` и `--`|Увеличение и уменьшение указателей.|
|`+` и `-`|Арифметические действия с указателем.|
|`==`, `!=`, `<`, `>`, `<=` и `>=`|Сравнение указателей.|
|[`stackalloc`](../../language-reference/operators/stackalloc.md)|Выделение памяти в стеке.|
|[Инструкция `fixed`](../../language-reference/keywords/fixed-statement.md)|Временная фиксация переменной, чтобы можно было найти ее адрес.|

Дополнительные сведения об операторах, связанных с указателем, см. в разделе [Операторы, связанные с указателем](../../language-reference/operators/pointer-related-operators.md).

## <a name="c-language-specification"></a>Спецификация языка C#

Дополнительные сведения см. в разделе [Типы указателей](~/_csharplang/spec/unsafe-code.md#pointer-types) в статье [Спецификации языка C#](~/_csharplang/spec/introduction.md).

## <a name="see-also"></a>См. также

- [Руководство по программированию на C#](../index.md)
- [Небезопасный код и указатели](index.md)
- [Преобразования указателей](pointer-conversions.md)
- [Ссылочные типы](../../language-reference/keywords/reference-types.md)
- [Типы значений](../../language-reference/builtin-types/value-types.md)
- [unsafe](../../language-reference/keywords/unsafe.md)
