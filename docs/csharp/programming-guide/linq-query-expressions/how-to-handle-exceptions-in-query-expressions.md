---
title: "Практическое руководство. Обработка исключений в выражениях запросов (Руководство по программированию на C#) | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-csharp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "CSharp"
helpviewer_keywords: 
  - "исключения [C#], запросы LINQ"
  - "запросы [LINQ в C#], исключения"
  - "выражения запросов [LINQ в C#], исключения"
ms.assetid: 4ce6c081-7731-4b8f-b4fa-d947f165a18a
caps.latest.revision: 15
caps.handback.revision: 15
author: "BillWagner"
ms.author: "wiwagn"
manager: "wpickett"
---
# Практическое руководство. Обработка исключений в выражениях запросов (Руководство по программированию на C#)
[!INCLUDE[vs2017banner](../../../csharp/includes/vs2017banner.md)]

В контексте выражения запроса можно вызывать любой метод.  Однако не рекомендуется вызывать в выражении запроса методы, которые могут привести к возникновению побочных эффектов, таких как изменение содержимого источника данных или создание исключения.  В этом примере показано, как избежать создания исключений при вызове методов в выражениях запросов без нарушения общих правил [!INCLUDE[dnprdnshort](../../../csharp/getting-started/includes/dnprdnshort_md.md)] относительно обработки исключений.  Эти правила гласят, что можно перехватывать определенные исключения, если известно, по какой причине они будут созданы в данном контексте.  Дополнительные сведения см. в разделе [Лучшие методики обработки исключений](../Topic/Best%20Practices%20for%20Exceptions.md).  
  
 В итоговом примере показано, как обрабатывать случаи, когда необходимо создать исключение при выполнении запроса.  
  
## Пример  
 В следующем примере показано, как перенести код обработки исключений вне выражения запроса.  Это возможно только в том случае, когда метод не зависит от переменных, являющихся локальными для запроса.  
  
 [!code-cs[csProgGuideLINQ#10](../../../csharp/programming-guide/arrays/codesnippet/CSharp/how-to-handle-exceptions-in-query-expressions_1.cs)]  
  
## Пример  
 В некоторых случаях наилучшим решением при возникновении исключения в запросе является немедленная остановка выполнения запроса.  В следующем примере показано, как обрабатывать исключения, которые могут возникнуть внутри тела запроса.  Предположим, что `SomeMethodThatMightThrow` может вызвать исключение, для которого потребуется остановить выполнение запроса.  
  
 Обратите внимание, что блок `try` заключает в себя цикл `foreach`, а не сам запрос.  Причина заключается в том, что цикл `foreach` — это точка, в которой запрос фактически выполняется.  Дополнительные сведения см. в разделе [Introduction to LINQ Queries \(C\#\)](../../../csharp/programming-guide/concepts/linq/introduction-to-linq-queries.md).  
  
 [!code-cs[csProgGuideLINQ#12](../../../csharp/programming-guide/arrays/codesnippet/CSharp/how-to-handle-exceptions-in-query-expressions_2.cs)]  
  
## Компиляция кода  
  
-   Создайте проект [!INCLUDE[vs_current_short](../../../csharp/programming-guide/classes-and-structs/includes/vs_current_short_md.md)], предназначенный для платформы .NET Framework версии 3.5.  По умолчанию в проекте имеются ссылка на файл System.Core.dll и директива `using` \(C\#\) для пространства имен System.Linq.  
  
-   Скопируйте код в созданный проект.  
  
-   Нажмите клавишу F5, чтобы скомпилировать и выполнить программу.  
  
 Нажмите любую клавишу для выхода из окна консоли.  
  
## См. также  
 [Выражения запросов LINQ](../../../csharp/programming-guide/linq-query-expressions/index.md)