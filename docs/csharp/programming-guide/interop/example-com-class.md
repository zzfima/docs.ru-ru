---
title: "Пример COM-класса (Руководство по программированию на C#) | Microsoft Docs"
ms.date: "2015-07-20"
ms.prod: ".net"
ms.technology: 
  - "devlang-csharp"
ms.topic: "article"
dev_langs: 
  - "CSharp"
helpviewer_keywords: 
  - "COM, предоставление объектов Visual C#"
  - "примеры [C#], COM - классы"
ms.assetid: 6504dea9-ad1c-4993-a794-830fec5270af
caps.latest.revision: 17
author: "BillWagner"
ms.author: "wiwagn"
caps.handback.revision: 17
---
# Пример COM-класса (Руководство по программированию на C#)
Далее приведен пример класса, который можно предоставить в качестве COM\-объекта.  После помещения этого кода в CS\-файл и добавления в проект свойству **Регистрация для COM\-взаимодействия** необходимо присвоить значение **Истина**.  Дополнительные сведения см. в разделе [NIB: How to: Register a Component for COM Interop](http://msdn.microsoft.com/ru-ru/4de7d474-56e8-4027-994d-d47ca4725c5e).  
  
 Предоставление объектов Visual C\# для COM требует объявления интерфейса класса, интерфейса событий \(если необходимо\) и самого класса.  Члены класса должны соответствовать следующим правилам, чтобы стать видимыми COM.  
  
-   Класс должен быть открытым.  
  
-   Свойства, методы и события должны быть открытыми.  
  
-   Свойства и методы должны быть объявлены в интерфейсе классов.  
  
-   События должны быть объявлены в интерфейсе событий.  
  
 Другие открытые члены в классе, которые не объявлены в этих интерфейсах, не будут видимыми для COM, но будут доступным другим объектам .NET Framework.  
  
 Чтобы предоставить свойства и методы COM, их необходимо объявить в интерфейсе классов, пометить атрибутов `DispId` и реализовать в классе.  Порядок объявления членов в интерфейсе это порядок, используемый для виртуальных методов COM.  
  
 Чтобы предоставить события из класса, их необходимо объявить в интерфейсе событий и пометить атрибутом `DispId`.  Класс не должен реализовывать этот интерфейс.  
  
 Класс реализует интерфейс классов; он может реализовывать несколько интерфейсов, но первой реализацией будет интерфейс классов по умолчанию.  Реализуйте методы и свойства, доступные модели COM здесь.  Они должны быть помечены как открытые и должны соответствовать объявлениям в интерфейсе классов.  Также, объявите здесь события, инициируемые классом.  Они должны быть помечены как открытые и должны соответствовать объявлениям в интерфейсе событий.  
  
## Пример  
 [!code-cs[csProgGuideInterop#8](../../../csharp/programming-guide/interop/codesnippet/CSharp/example-com-class_1.cs)]  
  
## См. также  
 [Руководство по программированию на C\#](../../../csharp/programming-guide/index.md)   
 [Взаимодействие](../../../csharp/programming-guide/interop/interoperability.md)   
 [Страница "Построение" в конструкторе проектов \(C\#\)](/visual-studio/ide/reference/build-page-project-designer-csharp)