---
title: Не удается обратиться к члену экземпляра класса из совместно используемого метода или совместно используемого инициализатора без явного указания экземпляра этого класса
ms.date: 07/20/2015
f1_keywords:
- vbc30369
- bc30369
helpviewer_keywords:
- Shared
- BC30369
ms.assetid: 39d9466b-c1f3-4406-91a5-3d6c52d23a3d
ms.openlocfilehash: 9b388685299469d5865d57b698e3a66de912fa84
ms.sourcegitcommit: 9a39f2a06f110c9c7ca54ba216900d038aa14ef3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/23/2019
ms.locfileid: "74451344"
---
# <a name="cannot-refer-to-an-instance-member-of-a-class-from-within-a-shared-method-or-shared-member-initializer-without-an-explicit-instance-of-the-class"></a>Не удается обратиться к члену экземпляра класса из совместно используемого метода или совместно используемого инициализатора без явного указания экземпляра этого класса

Предпринята попытка ссылки на член класса, не являющийся общим, в рамках общей процедуры. В следующем примере демонстрируется такая ситуация:
  
```vb  
Class Sample
    Public x as Integer  
    Public Shared Sub SetX()
        x = 10  
    End Sub  
End Class  
```  
  
 В предыдущем примере инструкция присваивания `x = 10` выдает это сообщение об ошибке. Это связано с тем, что общая процедура пытается получить доступ к переменной экземпляра.  
  
 Переменная `x` является членом экземпляра, так как она не объявлена как [Shared](../modifiers/shared.md). Каждый экземпляр класса `Sample` содержит собственную отдельную переменную `x`. Когда один экземпляр задает или изменяет значение `x`, оно не влияет на значение `x` в любом другом экземпляре.
  
 Однако процедура `SetX` `Shared` всех экземпляров класса `Sample`. Это означает, что он не связан с каким-либо экземпляром класса, а работает независимо от отдельных экземпляров. Так как он не имеет соединения с определенным экземпляром, `setX` не может получить доступ к переменной экземпляра. Он должен действовать только для переменных `Shared`. Когда `SetX` задает или изменяет значение общей переменной, это новое значение доступно для всех экземпляров класса.
  
 **Идентификатор ошибки:** BC30369
  
## <a name="to-correct-this-error"></a>Исправление ошибки
  
1. Решите, должен ли элемент быть общим для всех экземпляров класса или сохранен отдельно для каждого экземпляра.

2. Если необходимо, чтобы одна копия члена была общей для всех экземпляров, добавьте к объявлению члена ключевое слово `Shared`. Оставьте ключевое слово `Shared` в объявлении процедуры.

3. Если требуется, чтобы каждый экземпляр имел собственную отдельную копию элемента, не указывайте `Shared` для объявления члена. Удалите ключевое слово `Shared` из объявления процедуры.
  
## <a name="see-also"></a>См. также

- [Общие](../modifiers/shared.md)
