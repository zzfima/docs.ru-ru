---
title: "Объект My.WebServices | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-visual-basic"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "My.WebServices"
  - "My.MyProject.WebServices"
dev_langs: 
  - "VB"
helpviewer_keywords: 
  - "My.WebServices - объект"
ms.assetid: f188dc05-2c75-41b6-bb68-122d1c3110a2
caps.latest.revision: 17
caps.handback.revision: 17
author: "stevehoag"
ms.author: "shoag"
manager: "wpickett"
---
# Объект My.WebServices
[!INCLUDE[vs2017banner](../../../csharp/includes/vs2017banner.md)]

Предоставляет свойства для создания и доступа к одному экземпляру каждой веб\-службы XML, на которую ссылается текущий проект.  
  
## Заметки  
 Объект `My.WebServices` предоставляет экземпляр каждой веб\-службы, на которую ссылается текущий проект.  Каждый экземпляр создается по запросу.  Доступ к этим веб\-службам можно получить через свойства объекта `My.WebServices`.  Имя свойства совпадает с именем веб\-службы, к которой обращается свойство.  Любой класс, наследуемый от <xref:System.Web.Services.Protocols.SoapHttpClientProtocol> — это веб\-служба.  Сведения о добавлении веб\-служб в проект см. в разделе [Доступ к веб\-службам приложения](../../../visual-basic/developing-apps/programming/accessing-application-web-services.md).  
  
 Объект `My.WebServices` предоставляет только веб\-службы, связанные с текущим проектом.  Он не обеспечивает доступа к веб\-службам, объявленным в присоединенных DLL.  Для доступа к веб\-службе, которую предоставляет библиотека DLL, необходимо использовать полное имя веб\-службы в формате *ИмяDLL*.*ИмяВебСлужбы*.  Дополнительные сведения см. в разделе [Доступ к веб\-службам приложения](../../../visual-basic/developing-apps/programming/accessing-application-web-services.md).  
  
 Объект и его свойства не доступны для приложений Windows.  
  
## Свойства  
 Каждое свойство объекта `My.WebServices` предоставляет доступ к экземпляру веб\-службы, на которую ссылается текущий проект.  Имя свойства совпадает с именем веб\-службы, к которой осуществляется доступ, а тип свойства совпадает с ее типом.  
  
> [!NOTE]
>  Если имеется конфликт имени, именем свойства для доступа к веб\-службе является *КорневоеПространствоИмен*\_*ПространствоИмен*\_*ИмяСлужбы*.  Например, рассмотрим две веб\-службы с именем `Service1`.  Если одна из этих служб находится в корневом пространстве имен `WindowsApplication1` и в пространстве имен `Namespace1`, то доступ к этой службе нужно осуществлять при помощи `My.WebServices.WindowsApplication1_Namespace1_Service1`.  
  
 При первом доступе к одному из свойств объекта `My.WebServices` он создает новый экземпляр веб\-службы и сохраняет его.  Последующие обращения к этим свойствам возвращают этот экземпляр веб\-службы.  
  
 Можно освободить веб\-службу с помощью назначения свойству этой веб\-службы значения `Nothing`.  Установщик свойства назначает значение `Nothing` хранимым значениям.  Если назначить свойству любое значение, отличное от `Nothing`, установщик сгенерирует исключение <xref:System.ArgumentException>.  
  
 Чтобы проверить, хранит ли свойство объекта `My.WebServices` экземпляр веб\-службы, воспользуйтесь операторами `Is` или `IsNot`.  Эти операторы можно использовать для проверки того, имеет ли свойство значение `Nothing`.  
  
> [!NOTE]
>  Обычно оператор `Is` или `IsNot` должен прочитать значение свойства для выполнения сравнения.  При этом если хранимое свойство в настоящее время имеет значение `Nothing`, свойство создает новый экземпляр веб\-службы и затем возвращает этот экземпляр.  Компилятор Visual Basic обрабатывает свойства объекта `My.WebServices` особым образом и позволяет операторам `Is` или `IsNot` проверить состояние свойства без изменения его значения.  
  
## Пример  
 Этот пример вызывает метод `FahrenheitToCelsius` веб\-службы XML `TemperatureConverter`, а затем возвращает результат.  
  
 [!code-vb[VbVbalrMyWebService#1](../../../visual-basic/language-reference/objects/codesnippet/VisualBasic/my-webservices-object_1.vb)]  
  
 Для работы этого примера проект должен ссылаться на веб\-службу с именем `Converter`, а эта веб\-служба должна предоставлять метод `ConvertTemperature`.  Дополнительные сведения см. в разделе [Доступ к веб\-службам приложения](../../../visual-basic/developing-apps/programming/accessing-application-web-services.md).  
  
 Этот код не работает в проекте веб\-приложения.  
  
## Требования  
  
### Доступность по типу проекта  
  
|||  
|-|-|  
|Тип проекта|Доступность|  
|Приложение Windows|**Да**|  
|Библиотека классов|**Да**|  
|Консольное приложение|**Да**|  
|Библиотека элементов управления Windows|**Да**|  
|Библиотека веб\-элементов управления|**Да**|  
|Служба Windows|**Да**|  
|Веб\-узел|Нет|  
  
## См. также  
 <xref:System.Web.Services.Protocols.SoapHttpClientProtocol>   
 <xref:System.ArgumentException>   
 [Доступ к веб\-службам приложения](../../../visual-basic/developing-apps/programming/accessing-application-web-services.md)