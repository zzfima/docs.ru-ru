---
title: Объект My.Forms
ms.date: 07/20/2015
f1_keywords:
- My.Forms
- My.MyProject.Forms
helpviewer_keywords:
- My.Forms object
ms.assetid: f6bff4e6-6769-4294-956b-037aa6106d2a
ms.openlocfilehash: db86704fdc8120ccac5f4489c80a515834ad888f
ms.sourcegitcommit: 17ee6605e01ef32506f8fdc686954244ba6911de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/22/2019
ms.locfileid: "74350375"
---
# <a name="myforms-object"></a>Объект My.Forms

Предоставляет свойства для доступа к экземпляру каждой формы Windows Form, объявленной в текущем проекте.

## <a name="remarks"></a>Примечания

Объект `My.Forms` предоставляет экземпляр каждой формы в текущем проекте. Имя свойства совпадает с именем формы, к которой обращается свойство.

Доступ к формам, предоставляемым объектом `My.Forms`, можно получить с помощью имени формы без уточнения. Так как имя свойства совпадает с именем типа формы, это позволяет получить доступ к форме, как если бы она имела экземпляр по умолчанию. Например, предложение `My.Forms.Form1.Show` эквивалентно предложению `Form1.Show`.

Объект `My.Forms` предоставляет только формы, связанные с текущим проектом. Он не предоставляет доступ к формам, объявленным в упоминаемых библиотеках DLL. Для доступа к форме, предоставляемой библиотекой DLL, необходимо использовать полное имя формы, записанное как *dllname*. *Формнаме*.

Чтобы получить коллекцию всех открытых форм приложения, можно использовать свойство <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.OpenForms%2A>.

Объект и его свойства доступны только для приложений Windows.

## <a name="properties"></a>Свойства

Каждое свойство объекта `My.Forms` предоставляет доступ к экземпляру формы в текущем проекте. Имя свойства совпадает с именем формы, к которой обращается свойство, а тип свойства совпадает с типом формы.

> [!NOTE]
> При конфликте имен имя свойства для доступа к форме — *RootNamespace*_*Namespace*\_*формнаме*. Например, рассмотрим две формы с именем `Form1.`если одна из этих форм находится в корневом пространстве имен `WindowsApplication1` и в пространстве имен `Namespace1`, доступ к этой форме осуществляется через `My.Forms.WindowsApplication1_Namespace1_Form1`.

Объект `My.Forms` предоставляет доступ к экземпляру главной формы приложения, созданному при запуске. Для всех других форм объект `My.Forms` создает новый экземпляр формы при доступе к нему и сохраняет его. Последующие попытки доступа к этому свойству возвращают этот экземпляр формы.

Вы можете удалить форму, назначив `Nothing` свойству этой формы. Средство задания свойств вызывает метод <xref:System.Windows.Forms.Form.Close%2A> формы, а затем присваивает `Nothing` сохраненному значению. Если присвоить свойству любое значение, отличное от `Nothing`, то метод задания выдаст исключение <xref:System.ArgumentException>.

Можно проверить, сохраняет ли свойство объекта `My.Forms` экземпляр формы с помощью оператора `Is` или `IsNot`. С помощью этих операторов можно проверить, является ли значение свойства `Nothing`.

> [!NOTE]
> Как правило, оператор `Is` или `IsNot` должен считывать значение свойства для выполнения сравнения. Однако если свойство в настоящее время хранит `Nothing`, свойство создает новый экземпляр формы, а затем возвращает этот экземпляр. Однако компилятор Visual Basic обрабатывает свойства объекта `My.Forms` по-разному и позволяет оператору `Is` или `IsNot` проверять состояние свойства без изменения его значения.

## <a name="example"></a>Пример

В этом примере изменяется заголовок формы `SidebarMenu` по умолчанию.

[!code-vb[VbVbalrMyForms#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyForms/VB/Class1.vb#2)]

Чтобы этот пример работал, проект должен иметь форму с именем `SidebarMenu`.

Этот код будет работать только в проекте приложения Windows.

## <a name="requirements"></a>Требования

### <a name="availability-by-project-type"></a>Доступность по типу проекта

|Тип проекта|Доступно|
|---|---|
|Приложение Windows|**Да**|
|Библиотека классов|Нет|
|Консольное приложение|Нет|
|Библиотека элементов управления Windows|Нет|
|Библиотека веб-элементов управления|Нет|
|Службы Windows|Нет|
|Веб-сайт|Нет|

## <a name="see-also"></a>См. также

- <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.OpenForms%2A>
- <xref:System.Windows.Forms.Form>
- <xref:System.Windows.Forms.Form.Close%2A>
- [Объекты](../../../visual-basic/language-reference/objects/index.md)
- [Оператор Is](../../../visual-basic/language-reference/operators/is-operator.md)
- [Оператор IsNot](../../../visual-basic/language-reference/operators/isnot-operator.md)
- [Доступ к формам приложения](../../../visual-basic/developing-apps/programming/accessing-application-forms.md)
