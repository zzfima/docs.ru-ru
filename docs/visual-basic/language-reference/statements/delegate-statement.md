---
title: "Оператор Delegate | Microsoft Docs"
ms.date: "2015-07-20"
ms.prod: ".net"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-visual-basic"
ms.topic: "article"
f1_keywords: 
  - "vb.Delegate"
dev_langs: 
  - "VB"
helpviewer_keywords: 
  - "delegate - ключевое слово"
  - "Delegate - оператор"
ms.assetid: f799c518-0817-40cc-ad0b-4da846fdba57
caps.latest.revision: 27
author: "stevehoag"
ms.author: "shoag"
caps.handback.revision: 27
---
# Оператор Delegate
[!INCLUDE[vs2017banner](../../../visual-basic/includes/vs2017banner.md)]

Используется для объявления делегата.  Делегат — это ссылочный тип, ссылающийся на метод типа `Shared` или на метод экземпляра объекта.  Для создания экземпляра класса данного делегата может использоваться любая процедура с соответствующим параметром и типом возвращаемого значения.  Затем эта процедура может быть вызвана через экземпляр делегата.  
  
## Синтаксис  
  
```  
[ <attrlist> ] [ accessmodifier ] _  
[ Shadows ] Delegate [ Sub | Function ] name [( Of typeparamlist )] [([ parameterlist ])] [ As type ]  
```  
  
## Части  
  
|||  
|-|-|  
|Термин|Определение|  
|`attrlist`|Необязательный.  Список атрибутов, которые применяются для данного делегата.  Несколько атрибутов разделяются запятыми.  Необходимо заключить [Список атрибутов](../../../visual-basic/language-reference/statements/attribute-list.md) в угловые скобки \("`<`" и "`>`"\).|  
|`accessmodifier`|Необязательный.  Указывает код, который может получить доступ к делегату.  Может принимать следующие значения:<br /><br /> -   [Public](../../../visual-basic/language-reference/modifiers/public.md).  Любой код, который имеет доступ к объявляемому делегатом элементу, также имеет доступ к самому элементу.<br />-   [Protected](../../../visual-basic/language-reference/modifiers/protected.md).  Только код в пределах класса делегата или производного класса может обратиться к делегату.<br />-   [Friend](../../../visual-basic/language-reference/modifiers/friend.md).  Только код внутри одной и той же сборки имеет доступ к делегату.<br />-   [Private](../../../visual-basic/language-reference/modifiers/private.md).  Только код внутри объявляемого делегатом элемента имеет доступ к самому делегату.<br /><br /> Можно указать `Protected Friend`, чтобы разрешить доступ из кода внутри класса делегата, производного класса или той же сборки.|  
|`Shadows`|Необязательный.  Указывает, что данный делегат повторно объявляет и скрывает в базовом классе идентично именованный программный элемент или набор перегружаемых элементов.  Можно скрыть любой тип объявленного элемента с помощью любого другого типа.<br /><br /> Скрытый элемент недоступен из производного класса, в котором он скрыт, за исключением местоположений, где он является недоступным.  Например, если элемент `Private` скрывает элемент базового класса, код, который не имеет разрешение на доступ к элементу `Private`, обращается к элементу базового класса.|  
|`Sub`|Необязательно, но требуется наличие `Sub` или `Function`.  Объявляет процедуру делегатом\-подпрограммой `Sub`, которая не возвращает значения.|  
|`Function`|Необязательно, но требуется наличие `Sub` или `Function`.  Объявляет процедуру делегатом\-подпрограммой `Function`, которая не возвращает значения.|  
|`name`|Обязательный.  Имя типа делегата, следует стандартным правилам именования переменных.|  
|`typeparamlist`|Необязательный.  Список параметров типа для данного делегата.  Несколько параметров типа разделяются запятыми.  При желании каждый параметр типа можно объявить как вариант с помощью универсальных модификаторов `In` и `Out`.  Необходимо заключить [Список типов](../../../visual-basic/language-reference/statements/type-list.md) в круглые скобки и ввести его вместе с ключевым словом `Of`.|  
|`parameterlist`|Необязательный.  Список параметров, передаваемых в процедуру при ее вызове.  Необходимо заключить [Список параметров](../../../visual-basic/language-reference/statements/parameter-list.md) в круглые скобки.|  
|`type`|Требуется, если указана процедура `Function`.  Тип данных возвращаемого значения.|  
  
## Заметки  
 Типы параметров и значения, возвращаемые классом делегата, определяются оператором `Delegate`.  Для создания экземпляра класса данного делегата может использоваться любая процедура с соответствующим параметром и типом возвращаемого значения.  Затем процедура может быть вызвана через экземпляр делегата путем вызова метода делегата `Invoke`.  
  
 Делегат может быть объявлен на уровне пространства имен, модуля, класса или уровне структуры, но не внутри процедуры.  
  
 Каждый класс делегата определяет конструктор, которому передается спецификация метода объекта.  Аргумент конструктора делегата должен быть ссылкой на метод или лямбда выражение.  
  
 Чтобы указать ссылку на метод, используйте следующий синтаксис:  
  
 `AddressOf` \[`expression`.\]`methodname`  
  
 Тип выражения времени компиляции `expression` должен быть классом или интерфейсом который включает метод с указанным именем, сигнатура которого соответствует сигнатуре класса делегата.  Параметр `methodname` должен быть совместно используемым методом или методом экземпляра.  Параметр `methodname` не является обязательным, даже если создается делегат для метода класса, используемого по умолчанию.  
  
 Чтобы указать выражение лямбда, используйте следующий синтаксис:  
  
 `Function` \(\[`parm` As `type`, `parm2` As `type2`, ...\]\) `expression`  
  
 Сигнатура функции должна соответствовать типу делегата.  Дополнительные сведения о лямбда\-выражениях см. в разделе [Лямбда\-выражения](../../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md).  
  
 Дополнительные сведения о делегатах см. в разделе [Делегаты](../../../visual-basic/programming-guide/language-features/delegates/delegates.md).  
  
## Пример  
 Следующий пример использует оператор `Delegate`, чтобы объявить делегат для работы с двумя числами, и возвращает число.  Метод `DelegateTest` принимает экземпляр делегата этого типа и использует его для работы с парой чисел.  
  
 [!code-vb[VbVbalrDelegates#14](../../../visual-basic/language-reference/operators/codesnippet/visualbasic/delegate-statement_1.vb)]  
  
## См. также  
 [Оператор AddressOf](../../../visual-basic/language-reference/operators/addressof-operator.md)   
 [Of](../../../visual-basic/language-reference/statements/of-clause.md)   
 [Делегаты](../../../visual-basic/programming-guide/language-features/delegates/delegates.md)   
 [Практическое руководство. Использование универсального класса](../../../visual-basic/programming-guide/language-features/data-types/how-to-use-a-generic-class.md)   
 [Универсальные типы в Visual Basic](../../../visual-basic/programming-guide/language-features/data-types/generic-types.md)   
 [Ковариация и контрвариация](../Topic/Covariance%20and%20Contravariance%20\(C%23%20and%20Visual%20Basic\).md)   
 [In](../../../visual-basic/language-reference/modifiers/in-generic-modifier.md)   
 [Out](../../../visual-basic/language-reference/modifiers/out-generic-modifier.md)