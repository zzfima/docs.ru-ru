---
title: "Оператор Option Strict | Microsoft Docs"
ms.date: "2015-07-20"
ms.prod: ".net"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-visual-basic"
ms.topic: "article"
f1_keywords: 
  - "vb.Strict"
  - "vb.OptionStrict"
dev_langs: 
  - "VB"
helpviewer_keywords: 
  - "преобразования, неявные"
  - "неявные преобразования"
  - "позднее связывание"
  - "Option Strict - оператор"
  - "Strict - ключевое слово"
ms.assetid: 5883e0c1-a920-4274-8e46-b0ff047eaee5
caps.latest.revision: 49
author: "stevehoag"
ms.author: "shoag"
caps.handback.revision: 49
---
# Оператор Option Strict
[!INCLUDE[vs2017banner](../../../visual-basic/includes/vs2017banner.md)]

Ограничивает преобразования неявных типов данных только расширяющими преобразованиями; запрещает позднее связывание и запрещает неявную типизации, приводящую к типу `Object`.  
  
## Синтаксис  
  
```  
Option Strict { On | Off }  
```  
  
## Части  
  
|||  
|-|-|  
|Термин|Определение|  
|`On`|Необязательный.  Включает проверку `Option Strict`.|  
|`Off`|Необязательный.  Отключает проверку `Option Strict`.|  
  
## Заметки  
 Если `Option Strict On` или `Option Strict` отображается в файле, следующие условия вызывают ошибку времени компиляции:  
  
-   Неявные сужающие преобразования  
  
-   Позднее связывание  
  
-   Неявная типизация, которая приводит к типу `Object`  
  
> [!NOTE]
>  В конфигурациях предупреждений, которые можно задать на [Страница "Компиляция" в конструкторе проектов \(Visual Basic\)](/visual-studio/ide/reference/compile-page-project-designer-visual-basic), есть три параметра, соответствующие трем условиям, которые вызывают ошибки времени компиляции.  Дополнительные сведения об использовании этих параметров см. в подразделе [Задание конфигураций предупреждений в IDE](../../../visual-basic/language-reference/statements/option-strict-statement.md#conditions) далее в этом разделе.  
  
 Оператор `Option Strict Off` отключает проверку ошибок и предупреждений для всех трех условий, даже если связанные параметры IDE задают включение этих ошибок и предупреждений.  Оператор `Option Strict On` будет содержать ошибки и предупреждения проверки для всех 3 условий, даже если связанные параметры интегрированной среды разработки определяют, чтобы отключить эти ошибки или предупреждения.  
  
 При использовании оператор `Option Strict` должен находиться перед всеми остальными операторами в файле.  
  
 При установке `Option Strict` к `On`Visual Basic проверяет, что типы данных определяются для всех элементов программирования.  Типы данных можно задать явно или указать с помощью вывод локального типа.  Определение типов данных для всех элементов программирования рекомендуется по следующим причинам:  
  
-   Это позволяет IntelliSense поддерживать переменные и параметры.  Это позволяет видеть вводимые в код свойства и другие члены этих переменных.  
  
-   Это позволяет компилятору выполнять проверку типов.  Проверка типа поможет найти операторы, которые во время выполнения могут дат сбой из\-за ошибок преобразования типа.  Она также определяет вызовы методов для объектов, которые не поддерживают эти методы.  
  
-   Оно ускоряется по выполнению кода.  Одна причина этого в том, что если не указать тип данных для элемента программирования, компилятор Visual Basic присвоит ей тип `Object`.  Компилированный код может выполнить преобразование между `Object` и другими типами данных, что снижает производительность.  
  
## Ошибки неявных сужающих преобразований  
 Ошибки неявных сужающих преобразований возникают при наличии неявного преобразования типа данных, которое является сужающим преобразованием.  
  
 [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb-md.md)] может преобразовывать много типов данных в другие типы данных.  При преобразовании значения одного типа данных в тип данных с меньшим размером или точностью возможна потеря данных.  Ошибка времени выполнения возникает, если происходит сбой такого сужающего преобразования.  `Option Strict` обеспечивает во время компиляции уведомление об этих сужающих преобразованиях таким образом, чтобы их можно было избежать.  Дополнительные сведения см. в разделах [Явные и неявные преобразования](../../../visual-basic/programming-guide/language-features/data-types/implicit-and-explicit-conversions.md) и [Расширяющие и сужающие преобразования](../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md).  
  
 К преобразованиям, которые могут привести к ошибкам, относятся неявные преобразования, которые происходят в выражениях.  Дополнительные сведения см. в следующих разделах.  
  
-   [Оператор \+](../../../visual-basic/language-reference/operators/addition-operator.md)  
  
-   [Оператор \+\=](../../../visual-basic/language-reference/operators/addition-assignment-operator.md)  
  
-   [Оператор \\](../Topic/-%20Operator%20\(Visual%20Basic\)2.md)  
  
-   [Оператор \/\=](../../../visual-basic/language-reference/operators/floating-point-division-assignment-operator.md)  
  
-   [Тип данных Char](../../../visual-basic/language-reference/data-types/char-data-type.md)  
  
 При объединении строк с помощью оператора [Оператор &](../../../visual-basic/language-reference/operators/concatenation-operator.md) все преобразования в строки считаются расширенными.  Так что эти преобразования не создают ошибки неявного сужающего преобразования, даже если `Option Strict` включено.  
  
 При вызове метода с аргументом, тип данных которого отличается от соответствующего параметра, сужающее преобразование создает ошибку времени компиляции, если параметр `Option Strict` включен.  Ошибки во время компиляции можно избежать с помощью расширяющего преобразования или явного преобразования.  
  
 Ошибки неявных сужающих преобразований подавляются во время компиляции для преобразований элементов коллекции `For Each…Next` в переменную управления циклом.  Это происходит, даже если включен параметр `Option Strict`.  Дополнительные сведения см. в подразделе "Сужающие преобразования" раздела [Оператор For Each...Next](../../../visual-basic/language-reference/statements/for-each-next-statement.md).  
  
## Ошибки позднего связывания  
 Позднее связывание объекта возникает при его присваивании свойству или методу переменной, объявленной с типом `Object`.  Дополнительные сведения см. в разделе [Раннее и позднее связывание](../../../visual-basic/programming-guide/language-features/early-late-binding/early-and-late-binding.md).  
  
## Ошибки неявных типов объектов  
 Ошибки неявных типов объектов возникают, когда для объявленной переменной не может быть выведен соответствующий тип, поэтому выводится тип `Object`.  Это происходит в основном при использовании оператора `Dim` для объявления переменной без использования предложения `As`, если параметр `Option Infer` отключен.  Дополнительные сведения см. в разделах [Option Infer \- оператор](../../../visual-basic/language-reference/statements/option-infer-statement.md) и [Спецификация языка Visual Basic](../../../visual-basic/reference/language-specification.md).  
  
 Для параметров методов предложение `As` не является обязательным, если параметр `Option Strict` отключен.  Однако, если любой из параметров использует предложение `As`, для других также необходимо его использование.  Если `Option Strict` имеет значение "включен", предложение `As` является обязательным для каждого определения параметра.  
  
 Если объявить переменную без использования предложения `As` и задать ей значение `Nothing`, переменная имеет тип `Object`.  В этом случае ошибка времени компиляции, когда `Option Strict` включен и `Option Infer` включен, не возникает.  Примером этого является `Dim something = Nothing`.  
  
### Значения и типы данных по умолчанию  
 В следующей таблице описаны результаты различных комбинаций указания типа данных и инициализации в операторе [Оператор Dim](../../../visual-basic/language-reference/statements/dim-statement.md).  
  
|||||  
|-|-|-|-|  
|Указан тип данных?|Инициализатор указан?|Пример|Результат|  
|Нет|Нет|`Dim qty`|Если значение `Option Strict` равно off \(по умолчанию\), переменной задается значение `Nothing`.<br /><br /> Если `Option Strict` равен on, то во время компиляции возникает ошибка.|  
|Нет|Да|`Dim qty = 5`|Если `Option Infer` включен \(по умолчанию\), переменная получает тип данных от инициализатора.  Дополнительные сведения см. в разделе [Вывод локального типа](../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md).<br /><br /> Если `Option Infer` отключен и `Option Strict` отключен, переменная получает тип данных от `Object`.<br /><br /> Если выключен `Option Infer` и включен `Option Strict`, то во время компиляции возникает ошибка.|  
|Да|Нет|`Dim qty As Integer`|Переменная инициализируется со значением по умолчанию для типа данных.  Дополнительные сведения см. в разделе [Оператор Dim](../../../visual-basic/language-reference/statements/dim-statement.md).|  
|Да|Да|`Dim qty  As Integer = 5`|Если тип данных инициализатора не преобразовать в указанный тип данных, то во время компиляции возникает ошибка.|  
  
## При отсутствии оператора Option Strict  
 Если исходный код не содержит оператор `Option Strict` , используется параметр **Option strict** [Страница "Компиляция" в конструкторе проектов \(Visual Basic\)](/visual-studio/ide/reference/compile-page-project-designer-visual-basic).  **Компилировать страницы** имеет параметры, которые обеспечивают дополнительный контроль над условиями, которые генерируют ошибку.  
  
 Если используется компилятор командной строки, можно воспользоваться параметром компилятора [\/optionstrict](../../../visual-basic/reference/command-line-compiler/optionstrict.md), чтобы задать параметр `Option Strict`.  
  
### Настройка Option Strict в IDE  
 [!INCLUDE[note_settings_general](../../../csharp/language-reference/compiler-messages/includes/note-settings-general-md.md)]  
  
1.  Выберите проект в **обозревателе решений**.  В меню **Проект** выберите пункт **Свойства**.  Дополнительные сведения см. в разделе [Introduction to the Project Designer](http://msdn.microsoft.com/ru-ru/898dd854-c98d-430c-ba1b-a913ce3c73d7).  
  
2.  На вкладке **Компилировать** задайте значение в поле **Option Strict**.  
  
###  <a name="conditions"></a> Задание конфигураций предупреждений в IDE  
 При использовании [Страница "Компиляция" в конструкторе проектов \(Visual Basic\)](/visual-studio/ide/reference/compile-page-project-designer-visual-basic) вместо оператора `Option Strict` пользователь имеет дополнительный контроль над условиями, создающими ошибки.  Раздел **Конфигурации предупреждений** на странице **Компиляция** имеет параметры, соответствующие трем условиям, вызывающим ошибку времени компиляции при включенном параметре `Option Strict`.  Ниже перечислены эти параметры:  
  
-   **Неявное преобразование**  
  
-   **Позднее связывание; вызов может завершиться сбоем во время выполнения**  
  
-   **Неявный тип; объект предполагается**  
  
 При задании для параметра **Option Strict** значения **On** для всех трех параметров конфигурации предупреждений задается значение **Ошибка**.  При задании для параметра **Option Strict** значения **Off** для всех трех параметров задается значение **Нет**.  
  
 Можно индивидуально изменить каждый параметр конфигурации предупреждений для свойство **Нет**, **Предупреждение** или **Ошибка**.  Если всем трем параметрам конфигурации предупреждения задано значение **Ошибка**, `On` появляется в поле `Option strict`.  Если всем трем параметрам задано значение **Нет**, в этом поле появляется `Off`.  Для любого другого сочетания этих параметров отображается **\(другой\)**.  
  
### Задание значения по умолчанию параметра Option Strict для новых проектов  
 При создании проекта для параметра **Option Strict** на вкладке **Компиляция** задается значение параметра **Option Strict** в диалоговом окне **Параметры**.  
  
 Чтобы задать параметр `Option Strict` в этом диалоговом окне, в меню **Сервис** выберите команду **Параметры**.  В диалоговом окне **Параметры** разверните узел **Проекты и решения** и выберите пункт **Параметры VB по умолчанию**.  Исходный параметр по умолчанию в**Параметры VB по умолчанию** \- `Off`.  
  
### Установка Option Strict в командной строке  
 Включите параметр компилятора [\/optionstrict](../../../visual-basic/reference/command-line-compiler/optionstrict.md) в команду **vbc**.  
  
## Пример  
 В следующих примерах покаханы ошибки времени компиляции, вызванные неявными преобразования типов, которые являются сужающими преобразованиями.  Эта категория ошибок соответствует состоянию **неявного преобразования** на странице **Компиляция**.  
  
 [!code-vb[VbVbalrStatements#161](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/option-strict-statement_1.vb)]  
  
## Пример  
 В следующем примере демонстрируется ошибка во время компиляции, вызванная поздним связывание.  Эта категория ошибок соответствует состоянию **Позднее связывание; возможный сбой вызова во время выполнения** на странице **Компиляция**.  
  
 [!code-vb[VbVbalrStatements#162](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/option-strict-statement_2.vb)]  
  
## Пример  
 В следующих примерах показаны ошибки, вызванные переменными, объявленные с неявным типом `Object`.  Эта категория ошибок соответствует состоянию **Неявный тип; предполагается объект** на странице **Компиляция**.  
  
 [!code-vb[VbVbalrStatements#163](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/option-strict-statement_3.vb)]  
  
 [!code-vb[VbVbalrStatements#164](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/option-strict-statement_4.vb)]  
  
## См. также  
 [Расширяющие и сужающие преобразования](../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)   
 [Явные и неявные преобразования](../../../visual-basic/programming-guide/language-features/data-types/implicit-and-explicit-conversions.md)   
 [Страница "Компиляция" в конструкторе проектов \(Visual Basic\)](/visual-studio/ide/reference/compile-page-project-designer-visual-basic)   
 [Оператор Option Explicit](../../../visual-basic/language-reference/statements/option-explicit-statement.md)   
 [Функции преобразования типов](../../../visual-basic/language-reference/functions/type-conversion-functions.md)   
 [Практическое руководство. Доступ к членам объекта](../../../visual-basic/programming-guide/language-features/variables/how-to-access-members-of-an-object.md)   
 [Встроенные выражения в XML](../../../visual-basic/programming-guide/language-features/xml/embedded-expressions-in-xml.md)   
 [Неявное преобразование делегата](../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md)   
 [Позднее связывание в решениях Office](/office-dev/office-dev/late-binding-in-office-solutions)   
 [\/optionstrict](../../../visual-basic/reference/command-line-compiler/optionstrict.md)   
 [Страница "Параметры Visual Basic по умолчанию", папка "Проекты", диалоговое окно "Параметры"](/visual-studio/ide/reference/visual-basic-defaults-projects-options-dialog-box)