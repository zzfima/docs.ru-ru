---
title: "Оператор ReDim (Visual Basic) | Microsoft Docs"
ms.date: "2015-07-20"
ms.prod: ".net"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-visual-basic"
ms.topic: "article"
f1_keywords: 
  - "vb.ReDim"
  - "vb.Preserve"
dev_langs: 
  - "VB"
helpviewer_keywords: 
  - "массивы [Visual Basic], и скаляры"
  - "массивы [Visual Basic], объявление"
  - "массивы [Visual Basic], измерения"
  - "массивы [Visual Basic], повторное выделение"
  - "массивы [Visual Basic], повторная инициализация"
  - "As - ключевое слово, в операторе ReDim"
  - "типы данных [Visual Basic], назначение"
  - "операторы объявления"
  - "декларации, динамические массивы"
  - "динамические массивы, ReDim - оператор"
  - "строки фиксированной длины, объявление"
  - "Preserve - ключевое слово, ReDim - оператор"
  - "ReDim - оператор"
  - "ReDim - оператор, синтаксис"
  - "скалярные переменные"
  - "скаляры"
  - "скаляры, и массивы"
  - "storage, выделение"
  - "To - ключевое слово, ReDim - оператор"
  - "переменные [Visual Basic], скалярный"
ms.assetid: ad1c5e07-dcd7-4ae1-a79e-ad3f2dcc2083
caps.latest.revision: 25
author: "stevehoag"
ms.author: "shoag"
caps.handback.revision: 25
---
# Оператор ReDim (Visual Basic)
[!INCLUDE[vs2017banner](../../../visual-basic/includes/vs2017banner.md)]

Перераспределяет область хранения для переменной массива.  
  
## Синтаксис  
  
```  
ReDim [ Preserve ] name(boundlist) [ ,  name(boundlist) [, ... ] ]  
```  
  
## Части  
  
|Термин|Определение|  
|------------|-----------------|  
|`Preserve`|Необязательно.  Модификатор, используемый для сохранения данных в существующем массиве при изменении размера только последнего измерения.|  
|`name`|Обязательный.  Имя переменной массива.  См. раздел [Имена объявленных элементов](../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md).|  
|`boundlist`|Обязательный.  Список границ для всех измерений переопределенного массива.|  
  
## Заметки  
 Для изменения размера одного или нескольких из уже объявленных измерений массива можно использовать оператор `ReDim`.  Если у вас есть большой массив и некоторые из входящих в него элементов больше не требуются, `ReDim` позволяет освободить память, уменьшив размер массива.  Если же массив требует дополнительных элементов, `ReDim` может их добавить.  
  
 Оператор `ReDim` предназначен только для массивов.  Он не подходит для скалярных величин \(переменных, содержащих единственное значение\), коллекций или структур.  Обратите внимание, что при объявлении переменной типа `Array` у оператора `ReDim` не будет достаточной информации о типе для создания нового массива.  
  
 Оператор `ReDim` можно использовать только на уровне процедуры.  В связи с этим контекст объявления для переменной должен быть процедурой; он не может быть исходным файлом, пространством имен, интерфейсом, классом, структурой, модулем или блоком.  Дополнительные сведения см. в разделе [Контексты объявления и уровни доступа по умолчанию](../../../visual-basic/language-reference/statements/declaration-contexts-and-default-access-levels.md).  
  
## Правила  
  
-   **Множество переменных.** В одном операторе объявления можно изменить сразу несколько переменных массива и указать для каждой части `name` и `boundlist`.  Переменные разделяются запятыми.  
  
-   **Границы массива.** Каждая запись в `boundlist` может задавать нижнюю и верхнюю границу измерения.  Нижняя граница всегда 0 \(ноль\).  Верхняя граница представляет собой наибольшее возможное значение индекса для этого измерения, но не длину измерения \(она равна верхней границе плюс один\).  Индекс для каждого измерения может варьироваться от 0 до значения верхней границы.  
  
     Число измерений в `boundlist` должно совпадать с исходным числом измерений \(рангом\) массива.  
  
-   **Типы данных.** Оператор `ReDim` не может изменить тип данных переменной массива или ее элементов.  
  
-   **Инициализация.** Оператор `ReDim` не может предоставить новые значения инициализации для элементов массива.  
  
-   **Ранг.** Оператор `ReDim` не может изменить ранг \(число измерений\) массива.  
  
-   **Изменение размера с помощью оператора Preserve.** Используя оператор `Preserve`, можно изменить только последнее измерение массива.  Для всех остальных измерений необходимо указывать привязку существующего массива.  
  
     Например, в одномерных массивах можно изменить это измерение и в то же время сохранить все содержимое массива, поскольку изменяется только одно, последнее, измерение.  Если же массив имеет два или больше измерений, то с помощью оператора Preserve можно изменить только последнее измерение массива.`Preserve`  
  
-   **Свойства.** Оператор `ReDim` можно использовать для свойства, которое содержит массив значений.  
  
## Поведение  
  
-   **Замена массива.** Оператор `ReDim` освобождает существующий массив и создает новый массив с тем же рангом.  Новый массив заменяет освобожденный массив в переменной массива.  
  
-   **Инициализация без использования оператора Preserve.** Если оператор `Preserve` не указан, `ReDim` инициализирует элементы нового массива, используя значение по умолчанию для соответствующего типа данных.  
  
-   **Инициализация с использованием оператора Preserve.** Если оператор `Preserve` указан, Visual Basic копирует элементы из существующего массива в новый массив.  
  
## Пример  
 В приведенном ниже примере производится увеличение размера последнего измерения динамического массива без потери существующих данных, а затем уменьшение размера массива с частичной потерей данных.  Кроме того, размер массива уменьшается до исходного значения и все элементы массива инициализируются повторно.  
  
 [!code-vb[VbVbalrStatements#52](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/redim-statement_1.vb)]  
  
 Оператор `Dim` создает новый массив с тремя измерениями.  Каждое измерение объявляется с границей 10, поэтому индекс массива для каждого измерения может варьироваться в диапазоне от 0 до 10.  В приведенном ниже описании эти три измерения называются слоем, строкой и столбцом.  
  
 Первый оператор `ReDim` создает новый массив, который заменяет существующий массив в переменной `intArray`.  Оператор `ReDim` копирует все элементы из существующего массива в новый массив.  Кроме того, он добавляет по десять столбцов в конец каждой строки каждого слоя и инициализирует элементы в этих новых столбцах со значением 0 \(значение параметра `Integer`, который является типом элемента массива, по умолчанию\).  
  
 Второй оператор `ReDim` создает еще один массив и копирует в него все подходящие элементы.  При этом в каждой строке каждого слоя теряются пять последних столбцов.  Это не проблема, если данные столбцы вам больше не нужны.  Уменьшение размера большого массива позволяет освободить память, которая больше не требуется.  
  
 Третий оператор `ReDim` создает еще один массив и удаляет еще пять столбцов в конце каждой строки каждого слоя.  В данном случае он не копирует существующие элементы.  Этот оператор возвращает массиву первоначальный размер.  Поскольку оператор не включает модификатор `Preserve`, он приводит все элементы массива к исходным значениям по умолчанию.  
  
 Дополнительные примеры см. в разделе [Массивы](../../../visual-basic/programming-guide/language-features/arrays/index.md).  
  
## См. также  
 <xref:System.IndexOutOfRangeException>   
 [Оператор Const](../../../visual-basic/language-reference/statements/const-statement.md)   
 [Оператор Dim](../../../visual-basic/language-reference/statements/dim-statement.md)   
 [Оператор Erase](../../../visual-basic/language-reference/statements/erase-statement.md)   
 [Nothing](../../../visual-basic/language-reference/nothing.md)   
 [Массивы](../../../visual-basic/programming-guide/language-features/arrays/index.md)