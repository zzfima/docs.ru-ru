---
title: "Оператор Operator | Microsoft Docs"
ms.date: "2015-07-20"
ms.prod: ".net"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-visual-basic"
ms.topic: "article"
f1_keywords: 
  - "vb.operator"
dev_langs: 
  - "VB"
helpviewer_keywords: 
  - "CType - функция, Operator - оператор"
  - "Narrowing - ключевое слово, операторы преобразования"
  - "перегрузка операторов"
  - "процедуры операторов"
  - "Operator - оператор"
  - "операторы [Visual Basic]"
  - "операторы [Visual Basic], перегрузка"
  - "перегруженные операторы"
  - "процедуры, оператор"
  - "синтаксис, Процедуры операторов"
  - "код Visual Basic, операторы"
  - "Widening - ключевое слово, операторы преобразования"
ms.assetid: b12ec4af-1ad7-4a17-865b-c5ee96320ae5
caps.latest.revision: 28
author: "stevehoag"
ms.author: "shoag"
caps.handback.revision: 28
---
# Оператор Operator
[!INCLUDE[vs2017banner](../../../visual-basic/includes/vs2017banner.md)]

Объявляет символ оператора, операнды и код, определяющие процедуру оператора с классом или структурой.  
  
## Синтаксис  
  
```  
[ <attrlist> ] Public [ Overloads ] Shared [ Shadows ] [ Widening | Narrowing ]   
Operator operatorsymbol ( operand1 [, operand2 ]) [ As [ <attrlist> ] type ]  
    [ statements ]  
    [ statements ]  
    Return returnvalue  
    [ statements ]  
End Operator  
```  
  
## Части  
 `attrlist`  
 Необязательный.  См. [Список атрибутов](../../../visual-basic/language-reference/statements/attribute-list.md).  
  
 `Public`  
 Обязательный.  Означает, что эта процедура оператора имеет доступ [Public](../../../visual-basic/language-reference/modifiers/public.md).  
  
 `Overloads`  
 Необязательный.  Дополнительные сведения см. в разделе [Overloads](../../../visual-basic/language-reference/modifiers/overloads.md).  
  
 `Shared`  
 Обязательный.  Указывает, что эта процедура оператора является процедурой [Shared](../../../visual-basic/language-reference/modifiers/shared.md).  
  
 `Shadows`  
 Необязательный.  Дополнительные сведения см. в разделе [Shadows](../../../visual-basic/language-reference/modifiers/shadows.md).  
  
 `Widening`  
 Требуется для оператора преобразования, если не указан `Narrowing`.  Указывает, что эта процедура оператора определяет преобразование [Widening](../../../visual-basic/language-reference/modifiers/widening.md).  См. раздел "Расширяющие и сужающие преобразования" на этой странице справки.  
  
 `Narrowing`  
 Требуется для оператора преобразования, если не указан `Widening`.  Указывает, что эта процедура оператора определяет преобразование [Narrowing](../../../visual-basic/language-reference/modifiers/narrowing.md).  См. раздел "Расширяющие и сужающие преобразования" на этой странице справки.  
  
 `operatorsymbol`  
 Обязательный.  Символ или идентификатор оператора, который определяет эта процедура оператора.  
  
 `operand1`  
 Обязательный.  Имя и тип одного операнда унарного оператора \(включая оператор преобразования\) или левого операнда бинарного оператора.  
  
 `operand2`  
 Требуется для бинарных операторов.  Имя и тип правого операнда бинарного оператора.  
  
 `operand1` and `operand2` имеют следующий синтаксис и составляющие:  
  
 `[ ByVal ] operandname [ As operandtype ]`  
  
|Часть|Описание|  
|-----------|--------------|  
|`ByVal`|Необязательно, но механизм передачи должен быть [ByVal](../../../visual-basic/language-reference/modifiers/byval.md).|  
|`operandname`|Обязательный.  Имя переменной, представляющей этот операнд.  См. раздел [Имена объявленных элементов](../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md).|  
|`operandtype`|Необязательно, если `Option Strict` не установлен в `On`.  Тип данных этого операнда.|  
  
 `type`  
 Необязательно, если `Option Strict` не установлен в `On`.  Тип данных значения, возвращаемый процедурой оператора.  
  
 `statements`  
 Необязательный.  Блок операторов, который возвращает процедура оператора.  
  
 `returnvalue`  
 Обязательный.  Значение, которое процедура оператора возвращает в вызывающий код.  
  
 `End` `Operator`  
 Обязательный.  Завершает определение данной процедуры оператора.  
  
## Заметки  
 `Operator` можно использовать только в классе или структуре.  Это означает, что *контекст объявления* для оператора не может быть исходным файлом, пространством имен, модулем, интерфейсом, процедурой или блоком.  Дополнительные сведения см. в разделе [Контексты объявления и уровни доступа по умолчанию](../../../visual-basic/language-reference/statements/declaration-contexts-and-default-access-levels.md).  
  
 Все операторы должны быть `Public Shared`.  Нельзя указывать `ByRef` `Optional` или `ParamArray` ни для одно из операндов.  
  
 Нельзя использовать символ оператора или идентификатор для хранения возвращаемого значения.  Оператор `Return` необходимо использовать и он должен задавать значение.  В любом месте процедуры может присутствовать любое количество операторов `Return`.  
  
 Определение оператора таким образом называется *перегрузкой оператора* независимо от того, используется ли ключевое слово `Overloads`.  В следующей таблице перечислены операторы, которые можно определить.  
  
|Тип|Операторы|  
|---------|---------------|  
|Унарный|`+`, `-`, `IsFalse`, `IsTrue`, `Not`|  
|Binary|`+`, `-`, `*`, `/`, `\`, `&`, `^`, `>>`, `<<`, `=`, `<>`, `>`, `>=`, `<`, `<=`, `And`, `Like`, `Mod`, `Or`, `Xor`|  
|Преобразование \(унарный\)|`CType`|  
  
 Обратите внимание, что оператор `=` в списке бинарных является оператором сравнения, а не оператором присваивания.  
  
 При определении `CType` необходимо указать либо `Widening`, либо `Narrowing`.  
  
## Совпадающие пары  
 Необходимо определить конкретные операторы в виде совпадающих пар.  Если определен один оператор такой пары, необходимо определить и другой.  Следующие пары являются соответствующими:  
  
-   `=` и `<>`.  
  
-   `>` и `<`.  
  
-   `>=` и `<=`.  
  
-   `IsTrue` и `IsFalse`.  
  
## Ограничения типа данных  
 Каждый определенный оператор должен включать класс или структуру, по которой он определяется.  Это значит, что класс или структура должны фигурировать как тип данных следующих:  
  
-   Операнд унарного оператора.  
  
-   По крайней мере один из операндов бинарного оператора.  
  
-   Или операнд или тип возвращаемого оператором преобразования значения.  
  
 Некоторые операторы имеют дополнительные ограничения типа данных, как показано ниже:  
  
-   Если определить операторы `IsTrue` и `IsFalse`, они должны о возвращать тип `Boolean`.  
  
-   Если определены операторы `<<` и `>>`, они оба должны задавать тип `Integer` для `operandtype` `operand2`.  
  
 Возвращаемый тип не должен в обязательном порядке соответствовать типу одного из операндов.  Например, такое оператор сравнения, как `=` или `<>`, может возвращать событие `Boolean` даже в том случае, если ни один операнд не имеет тип `Boolean`.  
  
## Логические и побитовые операторы  
 Операторы `And`, `Or` `Not` и `Xor` могут выполнять в Visual Basic логические или побитовые операции.  Однако, если определить один из этих операторов на классе или структуре, можно определить только его побитовую операцию.  
  
 Невозможно определить оператор `AndAlso` непосредственно оператором `Operator`.  Однако, можно использовать `AndAlso`, если выполнены следующие условия:  
  
-   Определен `And` на одинаковых типах операндов, которые требуется использовать для `AndAlso`.  
  
-   Определение `And` возвращает тот же тип, как и класс или структура, на которой вы определили его.  
  
-   Определен оператор `IsFalse` класса или структуры, на котором Вы определили `And`.  
  
 Аналогично можно использовать `OrElse`, если определены `Or` на одних и тех же операндах с типом возвращаемого класса или структуры, и определено `IsTrue` на классе или структуре.  
  
## Расширяющие и сужающие преобразования  
 *Расширяющее преобразование* всегда успешно во время выполнения, а в *сужающем преобразовании* во время выполнения может возникать сбой.  Дополнительные сведения см. в разделе [Расширяющие и сужающие преобразования](../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md).  
  
 Если объявить процедуру преобразования `Widening`, ваш код процедуры не должен давать сбои.  Это означает следующее:  
  
-   Он должен всегда возвращать допустимое значение типа `type`.  
  
-   Он должен обрабатывать все возможные исключения и другие условия возникновения ошибок.  
  
-   Он должен обрабатывать любую ошибку, возвращаемую из любой процедуры, которую он вызывает.  
  
 Если есть вероятность того, что процедура преобразования может не завершиться или что она может вызвать необработанное исключение, необходимо объявить ее как `Narrowing`.  
  
## Пример  
 В следующем примере кода с помощью оператора `Operator` определяется контур структуры, содержащей процедуры для операторов `And`, `Or`, `IsFalse` и `IsTrue`.  Операторы `And` и `Or` принимают по два операнда типа `abc` и возвращают значения типа `abc`.  Операторы `IsFalse` и `IsTrue` принимают по одному операнду типа `abc` и возвращают значения типа `Boolean`.  Эти определения позволяют вызывающему коду использовать `And` `AndAlso`, `Or` и `OrElse` с операндами типа `abc`.  
  
 [!code-vb[VbVbalrStatements#44](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/operator-statement_1.vb)]  
  
## См. также  
 [Оператор IsFalse](../../../visual-basic/language-reference/operators/isfalse-operator.md)   
 [Оператор IsTrue](../../../visual-basic/language-reference/operators/istrue-operator.md)   
 [Widening](../../../visual-basic/language-reference/modifiers/widening.md)   
 [Narrowing](../../../visual-basic/language-reference/modifiers/narrowing.md)   
 [Расширяющие и сужающие преобразования](../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)   
 [Процедуры операторов](../../../visual-basic/programming-guide/language-features/procedures/operator-procedures.md)   
 [Практическое руководство. Определение оператора](../../../visual-basic/programming-guide/language-features/procedures/how-to-define-an-operator.md)   
 [Практическое руководство. Определение оператора преобразования](../../../visual-basic/programming-guide/language-features/procedures/how-to-define-a-conversion-operator.md)   
 [Практическое руководство. Вызов процедуры оператора](../../../visual-basic/programming-guide/language-features/procedures/how-to-call-an-operator-procedure.md)   
 [Практическое руководство. Использование класса, в котором определяются операторы](../../../visual-basic/programming-guide/language-features/procedures/how-to-use-a-class-that-defines-operators.md)