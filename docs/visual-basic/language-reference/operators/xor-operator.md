---
title: "Оператор Xor (Visual Basic) | Microsoft Docs"
ms.date: "2015-07-20"
ms.prod: ".net"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-visual-basic"
ms.topic: "article"
f1_keywords: 
  - "vb.Xor"
dev_langs: 
  - "VB"
helpviewer_keywords: 
  - "поразрядное сравнение"
  - "побитовые операторы, XOR - оператор"
  - "оператор исключения"
  - "исключающий оператор OR"
  - "логическое исключение"
  - "операторы [Visual Basic], побитовые"
  - "операторы [Visual Basic], исключающий оператор or"
  - "Xor - ключевое слово"
  - "Xor - оператор [Visual Basic]"
ms.assetid: 036000a9-3934-4e7f-a9d0-a816de3d84a6
caps.latest.revision: 17
author: "stevehoag"
ms.author: "shoag"
caps.handback.revision: 17
---
# Оператор Xor (Visual Basic)
[!INCLUDE[vs2017banner](../../../visual-basic/includes/vs2017banner.md)]

Выполняется логическое исключение с двумя выражениями `Boolean` или побитовое исключение с двумя числовыми выражениями.  
  
## Синтаксис  
  
```  
  
result = expression1 Xor expression2  
```  
  
## Части  
 `result`  
 Обязательный.  Какая\-либо переменная типа `Boolean` или числового типа.  При логическом сравнении `result` является логическим исключением \(исключающая логическая дизъюнкция\) из двух значений типа `Boolean`.  При битовом сравнении `result` является числовым значением, представляющим побитовое исключение \(исключающая побитовая дизъюнкция\) из двух числовых битовых шаблонов.  
  
 `expression1`  
 Обязательный.  Произвольное выражение типа `Boolean` или числового типа.  
  
 `expression2`  
 Обязательный.  Произвольное выражение типа `Boolean` или числового типа.  
  
## Заметки  
 При логическом сравнении `result` равен `True` только в том случае, если одно из `expression1` и `expression2` имеет значение `True`.  То есть только в том случае, если `expression1` и `expression2` имеют противоположные значения типа `Boolean`.  В следующей таблице показан порядок определения результата `result`.  
  
|Если `expression1` имеет значение|И выражение `expression2` имеет значение|значение `result` будет следующим:|  
|---------------------------------------|----------------------------------------------|----------------------------------------|  
|`True`|`True`|`False`|  
|`True`|`False`|`True`|  
|`False`|`True`|`True`|  
|`False`|`False`|`False`|  
  
> [!NOTE]
>  При логическом сравнении оператор `Xor` всегда вычисляет оба выражения, которые могут включать вызовы процедур.  Не выполняется сокращенное вычисление эквивалентной величины для `Xor`, поскольку результат всегда зависит от обоих операндов.  Сведения о логических операторах *сокращенного вычисления* см. в разделах [Оператор AndAlso](../../../visual-basic/language-reference/operators/andalso-operator.md) и [Оператор OrElse](../../../visual-basic/language-reference/operators/orelse-operator.md).  
  
 При побитовых операциях оператор `Xor` выполняет поразрядное сравнение одинаково расположенных битов в двух числовых выражениях и задает соответствующий бит в элементе `result` согласно следующей таблице:  
  
|Если бит в `expression1` имеет значение|И бит в `expression2` имеет значение|Бит в `result` имеет значение|  
|---------------------------------------------|------------------------------------------|-----------------------------------|  
|1|1|0|  
|1|0|1|  
|0|1|1|  
|0|0|0|  
  
> [!NOTE]
>  Поскольку логические и битовые операторы имеют более низкий приоритет по сравнению с другими арифметическими и сравнительными операторами, битовые операции следует заключать в круглые скобки, чтобы обеспечить правильное выполнение.  
  
 Например, 5 `Xor` 3 равняется 6.  Чтобы убедиться в этом, преобразуйте 5 и 3 в двоичные представления — 101 и 011.  Затем воспользуйтесь предыдущей таблицей, чтобы определить, что 101 Xor 011 равняется 110, что является двоичным представление числа 6.  
  
## Типы данных  
 Если операнды состоят из одного выражения типа `Boolean` и одного числового выражения, Visual Basic преобразует выражение типа `Boolean` в числовое значение \(–1 для `True` и 0 для `False`\) и выполняет битовую операцию.  
  
 Для сравнения `Boolean` используется тип данных результата `Boolean`.  Тип данных результата для побитового сравнения является числовым типом, соответствующим типам данных `expression1` и `expression2`.  См. таблицу "Относительное и побитовое сравнение" в разделе [Типы данных результатов оператора](../../../visual-basic/language-reference/operators/data-types-of-operator-results.md).  
  
## Перегрузка  
 Оператор `Xor` может быть *перегружен*; это означает, что класс или структура может переопределить его поведение, если операнд имеет тип соответствующего класса или структуры.  Если в коде используется этот оператор для такого класса или структуры, убедитесь, что его переопределенное поведение вам понятно.  Дополнительные сведения см. в разделе [Процедуры операторов](../../../visual-basic/programming-guide/language-features/procedures/operator-procedures.md).  
  
## Пример  
 В приведенном ниже примере используется оператор `Xor` для выполнения логического исключения \(исключающая логическая дизъюнкция\) для двух выражений.  Результатом является значение типа `Boolean`, которое указывает, в точности ли одно из выражений имеет значение `True`.  
  
 [!code-vb[VbVbalrOperators#40](../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/xor-operator_1.vb)]  
  
 В предыдущем примере получаются результаты `False`, `True` и `False` соответственно.  
  
## Пример  
 В следующем примере оператор `Xor` используется для выполнения логического исключения \(исключающая логическая дизъюнкция\) для отдельных битов двух числовых выражений.  Бит в результирующем шаблоне задается, если только один из соответствующих битов в операндах равен 1.  
  
 [!code-vb[VbVbalrOperators#41](../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/xor-operator_2.vb)]  
  
 В предыдущем примере получаются результаты 2, 12 и 14 соответственно.  
  
## См. также  
 [Логические \(побитовые\) операторы](../../../visual-basic/language-reference/operators/logical-bitwise-operators.md)   
 [Порядок применения операторов в Visual Basic](../../../visual-basic/language-reference/operators/operator-precedence.md)   
 [Список операторов, сгруппированных по функциональному назначению](../../../visual-basic/language-reference/operators/operators-listed-by-functionality.md)   
 [Логические и побитовые операторы в Visual Basic](../../../visual-basic/programming-guide/language-features/operators-and-expressions/logical-and-bitwise-operators.md)