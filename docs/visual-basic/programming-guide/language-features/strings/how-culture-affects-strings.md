---
title: "Влияние языка и региональных параметров на строки в Visual Basic | Microsoft Docs"
ms.custom: ""
ms.date: "2015-07-20"
ms.prod: ".net"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-visual-basic"
ms.topic: "article"
dev_langs: 
  - "VB"
helpviewer_keywords: 
  - "языковой стандарт, эффект в строках"
  - "строки [Visual Basic], зависимость от языкового стандарта"
ms.assetid: c4664444-ee0d-47bf-bef1-eaa3c54bdd7f
caps.latest.revision: 20
author: "stevehoag"
ms.author: "shoag"
caps.handback.revision: 20
---
# Влияние языка и региональных параметров на строки в Visual Basic
[!INCLUDE[vs2017banner](../../../../visual-basic/includes/vs2017banner.md)]

В этом разделе справки рассматривается, как [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb-md.md)] использует информацию о языковых и региональных параметрах для выполнения строковых преобразований и сравнений.  
  
## Когда использовать строки, специфичные для языковых и региональных параметров  
 Обычно следует использовать строки, специфичные для языковых и региональных параметров, для всех данных, адресованных пользователям, и строки, не зависящие от языковых и региональных параметров, для внутренних данных приложения.  
  
 Например, если приложение запрашивает пользователя на ввод данных как строки, оно должно ожидать, что пользователь введет строку, соответствующую формату его языковых и региональных параметров, и приложение должно соответственно конвертировать эту строку.  Если приложение затем представляет эти данные в пользовательский интерфейс, оно должно представлять их в формате языковых и региональных параметров пользователя.  
  
 Однако, если приложение загружает данные на центральный сервер, оно должно отформатировать строку в соответствии с одними определенными языковыми и региональными параметрами для предотвращения путаницы между потенциально разными форматами данных.  
  
## Функции, чувствительные к языковым и региональным параметрам  
 Все функции преобразования строк [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb-md.md)] \(кроме `Str` и `Val`\) используют информацию о языковых и региональных параметрах, к которой принадлежит пользователь, чтобы проверить, что преобразования и сравнения соответствуют ей.  
  
 Ключом к успеху в использовании функций преобразования строк в приложениях, выполняющихся на компьютерах с разными настройками языковых и региональных параметров является понимание того, какие функции используют специфичные установки для языковых и региональных параметров, а какие — текущие.  Следует иметь ввиду, что установки приложения для языковых и региональных параметров по умолчанию наследуются из установок для языковых и региональных параметров операционной системы.  Дополнительные сведения см. в разделах <xref:Microsoft.VisualBasic.Strings.Asc%2A>, <xref:Microsoft.VisualBasic.Strings.AscW%2A>, <xref:Microsoft.VisualBasic.Strings.Chr%2A>, <xref:Microsoft.VisualBasic.Strings.ChrW%2A>, <xref:Microsoft.VisualBasic.Strings.Format%2A>, <xref:Microsoft.VisualBasic.Conversion.Hex%2A>, <xref:Microsoft.VisualBasic.Conversion.Oct%2A> и [Функции преобразования типов](../../../../visual-basic/language-reference/functions/type-conversion-functions.md).  
  
 Функции `Str` \(преобразование чисел в строки\) и `Val` \(преобразование строк в числа\) не используют информацию приложения о языковых и региональных параметрах при преобразовании между строками и числами.  Напротив, они распознают только точку \(.\) в качестве допустимого десятичного разделителя.  Аналогами этих функций, учитывающими особенности языковых и региональных параметров, являются:  
  
-   **Преобразования, использующие текущие установки языковых и региональных параметров.** Функции `CStr` и `Format` преобразуют число в строку, а функции `CDbl` и `CInt` преобразуют строку в число.  
  
-   **Преобразования, использующие специфические установки языковых и региональных параметров.** Каждый числовой объект имеет метод `ToString(IFormatProvider)`, который преобразует число в строку, и метод `Parse(String, IFormatProvider)`, преобразовывающий строку в число.  Например, тип `Double` предоставляет методы <xref:System.Double.ToString%28System.IFormatProvider%29> и <xref:System.Double.Parse%28System.String%2CSystem.IFormatProvider%29>.  
  
 Дополнительные сведения см. в разделах <xref:Microsoft.VisualBasic.Conversion.Str%2A> и <xref:Microsoft.VisualBasic.Conversion.Val%2A>.  
  
## Использование определенных языковых и региональных параметров  
 Допустим, что разрабатывается приложение, которое отправляет дату \(форматированную как строку\) веб\-службе.  В этом случае приложение должно использовать определенные языковые и региональные параметры для преобразования строки.  Чтобы объяснить, зачем это нужно, рассмотрим результат использования метода даты <xref:System.DateTime.ToString>: если приложение использует этот метод для форматирования даты "July 4, 2005", он возвращает "7\/4\/2005 12:00:00 AM" при работе с установкой "United States English \(en\-US\)" и "04.07.2005 00:00:00" при работе с установкой "German \(de\-DE\)".  
  
 При необходимости переобразовать строку в специфичный для языковых и региональных параметров формат, следует использовать класс `CultureInfo`, встроенный в [!INCLUDE[dnprdnshort](../../../../csharp/getting-started/includes/dnprdnshort-md.md)].  Можно создать новый объект `CultureInfo` для определенных языковых и региональных параметров, передав имя этих параметров конструктору <xref:System.Globalization.CultureInfo.%23ctor%2A>.  Поддерживаемые имена языковых и региональных параметров приведены в разделе справки для класса <xref:System.Globalization.CultureInfo>.  
  
 С другой стороны, можно получить экземпляр *независимых языковых и региональных параметров* от свойства <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=fullName>.  Независимые языковые и региональные параметры основаны на английских языковых и региональных параметрах, но существуют некоторые различия.  Например, независимые языковые и региональные параметры использует 24\-часовой формат времени вместо 12\-часового.  
  
 Для преобразования даты в строку, специфичную для определенных языковых и региональных параметров, передайте объект <xref:System.Globalization.CultureInfo> методу объекта данных <xref:System.DateTime.ToString%28System.IFormatProvider%29>.  Например, следующий код отображает "07\/04\/2005 00:00:00" независимо от установок приложения для языковых и региональных параметров.  
  
 [!code-vb[VbVbalrConcepts#1](../../../../visual-basic/programming-guide/language-features/operators-and-expressions/codesnippet/visualbasic/how-culture-affects-stri_1.vb)]  
  
> [!NOTE]
>  Буквы даты всегда преобразуются в соответствии с английскими языковыми и региональными параметрами.  
  
## Сравнение строк  
 Существуют две важные ситуации, когда необходимы сравнения строк:  
  
-   **Сортировка данных для отображения пользователю.** Используйте операции, основанные на текущих установках языковых и региональных параметров, чтобы строки можно было соответственно отсортировать.  
  
-   **Принятие решения о том, существует ли точное соответствие между двумя строками, используемыми внутри приложения \(обычно для целей безопасности\).** Используйте операции, которые не зависят от текущих установок языковых и региональных параметров.  
  
 Оба типа сравнений можно выполнить с помощью функции [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb-md.md)] <xref:Microsoft.VisualBasic.Strings.StrComp%2A>.  Опишите дополнительный аргумент `Compare` для управления типом сравнения: `Text` для большей части ввода и вывода, `Binary` для определения точных соответствий.  
  
 Функция `StrComp` возвращает целочисленное значение, отражающее связь между двумя сравниваемыми строками на основе порядка сортировки.  Положительное значение означает, что первая строка "больше" второй.  Отрицательный результат возвращается в случае, если первая строка "меньше" второй, а нулевое значение отражает равенство между строками.  
  
 [!code-vb[VbVbalrStrings#22](../../../../visual-basic/language-reference/functions/codesnippet/visualbasic/how-culture-affects-stri_2.vb)]  
  
 Можно также использовать подобный функции `StrComp` метод <xref:System.String.Compare%2A?displayProperty=fullName> [!INCLUDE[dnprdnshort](../../../../csharp/getting-started/includes/dnprdnshort-md.md)].  Это статический перегруженный метод базового строкового класса.  Следующий пример иллюстрирует использование этого метода:  
  
 [!code-vb[VbVbalrStrings#48](../../../../visual-basic/language-reference/functions/codesnippet/visualbasic/how-culture-affects-stri_3.vb)]  
  
 Для более совершенного управления способом выполнения сравнений можно использовать дополнительные перегрузки метода <xref:System.String.Compare%2A>.  С методом <xref:System.String.Compare%2A?displayProperty=fullName> можно использовать аргумент `comparisonType` для указания используемого типа сравнения.  
  
||||  
|-|-|-|  
|Значение для аргумента `comparisonType`|Тип сравнения|Условия использования|  
|`Ordinal`|Сравнение на основе байтов, составляющих строку.|Используйте это значение при сравнении: идентификаторов, чувствительных к регистру, установок, относящихся к безопасности, или других нелингвистических идентификаторов, где байты должны точно соответствовать.|  
|`OrdinalIgnoreCase`|Сравнение на основе байтов, составляющих строку.<br /><br /> `OrdinalIgnoreCase` использует информацию независимых языковых и региональных параметров для определения того, что два символа отличаются только регистром.|Используйте это значение при сравнении: идентификаторов, не чувствительных к регистру, установок, относящихся к безопасности, или данных, хранящихся в Windows.|  
|`CurrentCulture` или `CurrentCultureIgnoreCase`|Сравнение на основе интерпретации строк с текущей установкой языковых и региональных параметров.|Используйте это значение при сравнении: данных, отображаемых пользователю, большинства пользовательского ввода и других данных, требующих лингвистической интерпретации.|  
|`InvariantCulture` или `InvariantCultureIgnoreCase`|Сравнение на основе интерпретации строк с независимой установкой языковых и региональных параметров.<br /><br /> Оно отличается от `Ordinal` и `OrdinalIgnoreCase`, поскольку независимые языковые и региональные параметры рассматривают символы, не входящие в их диапазон установок, как эквиваленты независимых символов.|Используйте эти значения только при сравнении сохраняемых данных или отображении лингвистических данных, требующих фиксированного порядка сортировки.|  
  
### Вопросы безопасности  
 Если приложение принимает решение, связанное с безопасностью, на основе результата сравнения или операции изменения регистра, то необходимо использовать метод <xref:System.String.Compare%2A?displayProperty=fullName> и передать `Ordinal` или `OrdinalIgnoreCase` в качестве аргумента `comparisonType`.  
  
## См. также  
 <xref:System.Globalization.CultureInfo>   
 [Знакомство со строками в Visual Basic](../../../../visual-basic/programming-guide/language-features/strings/introduction-to-strings.md)   
 [Функции преобразования типов](../../../../visual-basic/language-reference/functions/type-conversion-functions.md)