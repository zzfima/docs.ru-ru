---
title: "Практическое руководство. Присвоение одного массива другому (Visual Basic) | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-visual-basic"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
helpviewer_keywords: 
  - "массивы [Visual Basic], назначение"
  - "массивы [Visual Basic], ковариация"
  - "ковариация, массивы"
ms.assetid: 1ae89ea5-f292-4282-bcfc-e9b06b37fbd5
caps.latest.revision: 18
caps.handback.revision: 18
author: "stevehoag"
ms.author: "shoag"
manager: "wpickett"
---
# Практическое руководство. Присвоение одного массива другому (Visual Basic)
[!INCLUDE[vs2017banner](../../../../csharp/includes/vs2017banner.md)]

Поскольку массивы являются объектами, их можно использовать в операторах присвоения, как и другие типы объектов.  Если переменная массива содержит указатель на данные, составляющие элементы массива, и сведения о ранге и длине, операция присвоения копирует только этот указатель.  
  
### Чтобы присвоить один массив другому  
  
1.  Убедитесь, что два массива имеют одинаковый ранг \(число измерений\) и совместимый тип данных элементов.  
  
2.  Для присваивания исходного массива массиву назначения используйте стандартный оператор присваивания.  Не указывайте скобки после имени массива.  
  
    ```  
    Dim formArray() As System.Windows.Forms.Form  
    Dim controlArray() As System.Windows.Forms.Control  
    controlArray = formArray  
    ```  
  
 При присвоении одного массива другому действуют следующие правила:  
  
-   **Равенство ранга**. Ранг \(число измерений\) конечного массива должен быть равен рангу исходного.  
  
     Если массивы имеют равные ранги, их размерности не обязательно должны совпадать.  Число элементов в определенном измерении может изменяться в ходе присвоения.  
  
-   **Типы элементов**. Оба массива должны состоять из элементов либо *ссылочного типа*, либо *типа значений*.  Дополнительные сведения см. в разделе [Типы значений и ссылочные типы](../../../../visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types.md).  
  
    -   Если оба массива состоят из элементов типа значения, типы их элементов должны в точности совпадать.  Единственным исключением является присваивание массива элементов `Enum` массиву базового для заданного типа `Enum` типа.  
  
    -   Если оба массива содержат элементы ссылочного типа, исходный тип элементов должен быть производным от конечного типа элементов.  В этом случае два массива имеют такое же отношение наследования, что и их элементы.  Эта зависимость называется *ковариацией массивов*.  
  
 Компилятор выдает ошибку, если вышеперечисленные правила нарушены, например, если не совместимы типы данных или не совпадают ранги массивов.  Перед присвоением можно добавить функцию обработки ошибок для проверки совместимости массивов.  Можно также использовать ключевое слово [Оператор TryCast](../../../../visual-basic/language-reference/operators/trycast-operator.md), если необходимо не допустить возникновения исключения.  
  
## См. также  
 [Массивы](../../../../visual-basic/programming-guide/language-features/arrays/index.md)   
 [Устранение неполадок, связанных с массивами](../../../../visual-basic/programming-guide/language-features/arrays/troubleshooting-arrays.md)   
 [Оператор Enum](../../../../visual-basic/language-reference/statements/enum-statement.md)   
 [Преобразования массивов](../../../../visual-basic/programming-guide/language-features/data-types/array-conversions.md)