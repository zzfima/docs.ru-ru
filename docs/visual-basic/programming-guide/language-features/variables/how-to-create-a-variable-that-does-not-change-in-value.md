---
title: "Практическое руководство. Создание переменной, которая не изменяет значение (Visual Basic) | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-visual-basic"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
helpviewer_keywords: 
  - "переменные [Visual Basic], значение константы"
  - "переменные [Visual Basic], только для чтения"
ms.assetid: 86b59266-25df-4635-ae15-9b59c411d036
caps.latest.revision: 15
caps.handback.revision: 15
author: "stevehoag"
ms.author: "shoag"
manager: "wpickett"
---
# Практическое руководство. Создание переменной, которая не изменяет значение (Visual Basic)
[!INCLUDE[vs2017banner](../../../../csharp/includes/vs2017banner.md)]

Понятие переменной, которая не изменяет свое значение, может показаться противоречивым.  Но существуют ситуации, когда константа не подходит и полезно иметь переменную с фиксированным значением.  В таком случае можно определить переменную\-член с ключевым словом [ReadOnly](../../../../visual-basic/language-reference/modifiers/readonly.md).  
  
 [Оператор Const](../../../../visual-basic/language-reference/statements/const-statement.md) нельзя использовать для объявления и присвоения постоянного значения в следующих случаях:  
  
-   Инструкция `Const` не принимает тип данных, который требуется использовать  
  
-   Вы не знаете значение во время компиляции  
  
-   Не удается вычислить постоянное значение во время компиляции  
  
### Создание переменной, которая не изменяет значение  
  
1.  На уровне модуля объявите переменную\-член при помощи [Оператор Dim](../../../../visual-basic/language-reference/statements/dim-statement.md) и используйте ключевое слово [ReadOnly](../../../../visual-basic/language-reference/modifiers/readonly.md).  
  
    ```  
  
    Dim ReadOnly timeStarted  
    ```  
  
     Можно указать `ReadOnly` только для переменной\-члена.  Это означает, что необходимо определить переменную на уровне модуля, вне любой процедуры.  
  
2.  Если можно вычислить значение в одной инструкции во время компиляции, используйте предложение инициализации в инструкции `Dim`.  Используйте предложение [As](../../../../visual-basic/language-reference/statements/as-clause.md) со знаком равенства \(`=`\), за которым следует выражение.  Убедитесь, что компилятор может вычислить это выражение с постоянным значением.  
  
    ```  
    Dim ReadOnly timeStarted As Date = Now  
    ```  
  
     Можно присвоить значение переменной `ReadOnly` только один раз.  После этого код никогда не сможет изменять ее значение.  
  
     Если не знаете значения во время компиляции или невозможно вычислить его во время компиляции в одной инструкции, можно по\-прежнему назначить его в конструкторе во время выполнения.  Чтобы сделать это, необходимо объявить переменную `ReadOnly` на уровне класса или структуры.  В конструкторе для класса или структуры вычисляется значение фиксированной переменной, и оно присваивается переменной перед возвратом из конструктора.  
  
## См. также  
 [WriteOnly](../../../../visual-basic/language-reference/modifiers/writeonly.md)   
 [Оператор Const](../../../../visual-basic/language-reference/statements/const-statement.md)