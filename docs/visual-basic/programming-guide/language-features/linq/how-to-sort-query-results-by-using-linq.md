---
title: "Практическое руководство. Сортировка результатов запроса с помощью LINQ (Visual Basic) | Microsoft Docs"
ms.custom: ""
ms.date: "2015-07-20"
ms.prod: ".net"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-visual-basic"
ms.topic: "article"
dev_langs: 
  - "VB"
helpviewer_keywords: 
  - "запросы [LINQ в Visual Basic], разделы практического руководства"
  - "запросы [LINQ в Visual Basic], сортировка результатов"
  - "примеры запросов [Visual Basic]"
  - "запрос баз данных [LINQ]"
  - "сортировка данных [LINQ в Visual Basic]"
  - "сортировка данных [Visual Basic]"
  - "сортировка результатов запроса [LINQ в Visual Basic]"
  - "сортировка результатов запроса, несколько столбцов"
ms.assetid: 07a4584d-9fd8-4a1d-b7d9-ccf2efa5c84e
caps.latest.revision: 5
author: "stevehoag"
ms.author: "shoag"
caps.handback.revision: 5
---
# Практическое руководство. Сортировка результатов запроса с помощью LINQ (Visual Basic)
[!INCLUDE[vs2017banner](../../../../visual-basic/includes/vs2017banner.md)]

Запросы, интегрированные в язык программирования \(Language\-Integrated Query, LINQ\), упрощают доступ к содержимому базы данных и обеспечивают выполнение запросов.  
  
 В приведенном ниже примере показано, как создать новое приложение, в котором выполняются запросы к базе данных SQL Server и сортируются результаты по множеству полей с помощью ключевого слова `Order By`.  Порядок сортировки для каждого поля может быть возрастающим или убывающим.  Дополнительные сведения см. в разделе [Предложение Order By](../../../../visual-basic/language-reference/queries/order-by-clause.md).  
  
 В примерах этого раздела используется учебная база данных "Борей".  При отсутствии учебной базы данных "Борей" на компьютере разработчика ее можно загрузить с веб\-узла [Центра загрузки Майкрософт](http://go.microsoft.com/fwlink/?LinkID=98088).  Подробные инструкции см. в разделе [Загрузка образцов баз данных](../Topic/Downloading%20Sample%20Databases.md).  
  
 [!INCLUDE[note_settings_general](../../../../csharp/language-reference/compiler-messages/includes/note-settings-general-md.md)]  
  
### Создание подключения к базе данных  
  
1.  В Visual Studio откройте **обозреватель серверов** или **обозреватель баз данных**. Для этого в меню **Вид** выберите пункт **Обозреватель серверов** или **Обозреватель баз данных**.  
  
2.  В **обозревателе серверов** или **обозревателе баз данных** щелкните правой кнопкой мыши **Подключения данных**, а затем выберите команду **Добавить подключение**.  
  
3.  Укажите допустимое подключение к учебной базе данных "Northwind".  
  
### Добавление проекта, содержащего файл LINQ\-SQL  
  
1.  В меню **Файл** окна Visual Studio выберите команду **Создать** и щелкните **Проект**.  Выберите **Приложение Windows Forms** в качестве типа проекта Visual Basic.  
  
2.  В меню **Проект** выберите команду **Добавить новый элемент**.  Выберите шаблон элемента **Классы LINQ\-SQL**.  
  
3.  Назовите файл `northwind.dbml`.  Нажмите кнопку **Добавить**.  Откроется реляционный конструктор объектов для файла northwind.dbml.  
  
### Добавление таблицы к запросу в объектно\-реляционном конструкторе  
  
1.  В представлении **Обозреватель серверов** или **Обозреватель баз данных** разверните подключение к базе данных "Northwind".  Разверните папку **Таблицы**.  
  
     Если реляционный конструктор объектов закрыт, откройте его снова, дважды щелкнув файл northwind.dbml, который был добавлен ранее.  
  
2.  Щелкните таблицу "Клиенты" и перетащите ее в левую область конструктора.  Щелкните таблицу "Заказы" и перетащите ее в левую область конструктора.  
  
     Для проекта в конструкторе создаются новые объекты `Customer` и `Order`.  Обратите внимание, что конструктор автоматически обнаруживает связи между таблицами и создает дочерние свойства для связанных объектов.  Например, функция IntelliSense покажет, что в объекте `Customer` имеется свойство `Orders` для всех заказов, связанных с клиентом.  
  
3.  Сохраните изменения и закройте конструктор.  
  
4.  Сохраните проект.  
  
### Добавление кода в запрос к базе данных и отображение результатов  
  
1.  С **панели элементов** перетащите элемент управления <xref:System.Windows.Forms.DataGridView> в заданную по умолчанию форму Windows Forms для проекта \(Form1\).  
  
2.  Дважды щелкните Form1, чтобы добавить код в событие формы `Load`.  
  
3.  При добавлении таблиц в реляционный конструктор объектов конструктор добавил объект <xref:System.Data.Linq.DataContext> в проект.  Этот объект содержит код, необходимый для доступа к этим таблицам и доступа к отдельным объектам и коллекциям для каждой таблицы.  Объекту <xref:System.Data.Linq.DataContext> для проекта присвоено имя на основе имени файла .dbml.  Для данного проекта объект <xref:System.Data.Linq.DataContext> называется `northwindDataContext`.  
  
     Можно создать экземпляр <xref:System.Data.Linq.DataContext> в коде и запросить таблицы, указанные реляционным конструктором объектов.  
  
     Добавьте приведенный ниже код к событию `Load`, чтобы выполнить запрос к таблицам, которые представлены в виде свойств контекста данных, и отсортировать результаты.  В запросе результаты сортируются по числу заказов клиентов в порядке убывания.  Клиенты, имеющие одинаковое количество заказов, упорядочены по названию компании в возрастающем порядке \(по умолчанию\).  
  
     [!code-vb[VbLINQToSQLHowTos#10](../../../../visual-basic/programming-guide/language-features/linq/codesnippet/visualbasic/StoredProcedureHowTo/Form4.vb#10)]  
  
4.  Нажмите клавишу F5, чтобы запустить проект и просмотреть результаты.  
  
## См. также  
 [LINQ](../../../../visual-basic/programming-guide/language-features/linq/index.md)   
 [Запросы](../../../../visual-basic/language-reference/queries/queries.md)   
 [LINQ to SQL](../Topic/LINQ%20to%20SQL.md)   
 [Методы DataContext \(реляционный конструктор объектов\)](/visual-studio/data-tools/datacontext-methods-o-r-designer)   
 [Пошаговое руководство. Создание классов LINQ to SQL \(реляционный конструктор объектов\)](../Topic/Walkthrough:%20Creating%20LINQ%20to%20SQL%20Classes%20\(O-R%20Designer\).md)