---
title: "Практическое руководство. Возвращение результата запроса LINQ в виде определенного типа (Visual Basic) | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-visual-basic"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
helpviewer_keywords: 
  - "анонимные типы [Visual Basic]"
  - "проекция [LINQ в Visual Basic]"
  - "запросы [LINQ в Visual Basic], разделы практического руководства"
  - "запросы [LINQ в Visual Basic], возврат указанного типа"
  - "примеры запросов [Visual Basic]"
  - "запрос баз данных [LINQ]"
ms.assetid: 621bb10a-e5d7-44fb-a025-317964b19d92
caps.latest.revision: 8
caps.handback.revision: 8
author: "stevehoag"
ms.author: "shoag"
manager: "wpickett"
---
# Практическое руководство. Возвращение результата запроса LINQ в виде определенного типа (Visual Basic)
[!INCLUDE[vs2017banner](../../../../csharp/includes/vs2017banner.md)]

Запросы, интегрированные в язык программирования \(Language\-Integrated Query, LINQ\), упрощают доступ к содержимому базы данных и обеспечивают выполнение запросов.  По умолчанию LINQ\-запросы возвращают список объектов как анонимный тип.  Можно также указать, чтобы запрос возвращал список определенного типа с помощью предложения `Select`.  
  
 Пример способа создания нового приложения, которое выполняет запросы в базе данных SQL Server и формирует результаты, как конкретный именованный тип.  Дополнительные сведения см. в разделах [Анонимные типы](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md) и [Предложение Select](../../../../visual-basic/language-reference/queries/select-clause.md).  
  
 В примерах этого раздела используется учебная база данных "Борей".  При отсутствии учебной базы данных "Борей" на компьютере разработчика ее можно загрузить с веб\-узла [Центра загрузки Майкрософт](http://go.microsoft.com/fwlink/?LinkID=98088).  Подробные инструкции см. в разделе [Загрузка образцов баз данных](../Topic/Downloading%20Sample%20Databases.md).  
  
 [!INCLUDE[note_settings_general](../../../../csharp/language-reference/compiler-messages/includes/note_settings_general_md.md)]  
  
### Создание подключения к базе данных  
  
1.  В Visual Studio откройте **обозреватель серверов** или **обозреватель баз данных**. Для этого в меню **Вид** выберите пункт **Обозреватель серверов** или **Обозреватель баз данных**.  
  
2.  В **обозревателе серверов** или **обозревателе баз данных** щелкните правой кнопкой мыши **Подключения данных**, а затем выберите команду **Добавить подключение**.  
  
3.  Укажите допустимое подключение к учебной базе данных "Northwind".  
  
### Добавление проекта, содержащего файл LINQ\-SQL  
  
1.  В меню **Файл** окна Visual Studio выберите команду **Создать** и щелкните **Проект**.  Выберите **Приложение Windows Forms** в качестве типа проекта Visual Basic.  
  
2.  В меню **Проект** выберите команду **Добавить новый элемент**.  Выберите шаблон элемента **Классы LINQ\-SQL**.  
  
3.  Назовите файл `northwind.dbml`.  Нажмите кнопку **Добавить**.  Откроется реляционный конструктор объектов для файла northwind.dbml.  
  
### Добавление таблицы к запросу в объектно\-реляционном конструкторе  
  
1.  В представлении **Обозреватель серверов** или **Обозреватель баз данных** разверните подключение к базе данных "Northwind".  Разверните папку **Таблицы**.  
  
     Если реляционный конструктор объектов закрыт, откройте его снова, дважды щелкнув файл northwind.dbml, который был добавлен ранее.  
  
2.  Щелкните таблицу "Клиенты" и перетащите ее в левую область конструктора.  
  
     Конструктор создает новый объект `Customer` для проекта.  Можно указать результат запроса как тип `Customer` или тип, созданный пользователем.  В этом примере будет создан новый тип в процедуре более поздней версии и сформирован результат запроса как тип.  
  
3.  Сохраните изменения и закройте конструктор.  
  
4.  Сохраните проект.  
  
### Добавление кода в запрос к базе данных и отображение результатов  
  
1.  С **панели элементов** перетащите элемент управления <xref:System.Windows.Forms.DataGridView> в заданную по умолчанию форму Windows Forms для проекта \(Form1\).  
  
2.  Дважды щелкните на форме Form1, чтобы изменить класс Form1.  
  
3.  После оператора `End Class` класса Form1 добавьте следующий код для создания типа `CustomerInfo`, чтобы сохранить результаты запроса для этого примера.  
  
     [!code-vb[VbLINQToSQLHowTos#16](../../../../visual-basic/programming-guide/language-features/linq/codesnippet/VisualBasic/how-to-return-a-linq-query-result-as-a-specific-type_1.vb)]  
  
4.  При добавлении таблиц в реляционный конструктор объектов конструктор добавил объект <xref:System.Data.Linq.DataContext> в проект.  Этот объект содержит код, необходимый для доступа к этим таблицам и доступа к отдельным объектам и коллекциям для каждой таблицы.  Объекту <xref:System.Data.Linq.DataContext> для проекта присвоено имя на основе имени файла .dbml.  Для данного проекта объект <xref:System.Data.Linq.DataContext> называется `northwindDataContext`.  
  
     Можно создать экземпляр <xref:System.Data.Linq.DataContext> в коде и запросить таблицы, указанные реляционным конструктором объектов.  
  
     В событии `Load` класса Form1 добавьте следующий код для запроса к таблицам, которые отображаются как свойства контекста данных.  Предложение `Select` запроса создает новый тип `CustomerInfo` вместо анонимного типа для каждого элемента результата запроса.  
  
     [!code-vb[VbLINQToSQLHowTos#15](../../../../visual-basic/programming-guide/language-features/linq/codesnippet/VisualBasic/how-to-return-a-linq-query-result-as-a-specific-type_2.vb)]  
  
5.  Нажмите клавишу F5, чтобы запустить проект и просмотреть результаты.  
  
## См. также  
 [LINQ](../../../../visual-basic/programming-guide/language-features/linq/index.md)   
 [Запросы](../../../../visual-basic/language-reference/queries/queries.md)   
 [LINQ to SQL](../Topic/LINQ%20to%20SQL.md)   
 [Методы DataContext \(реляционный конструктор объектов\)](/visual-studio/data-tools/datacontext-methods-o-r-designer)   
 [Пошаговое руководство. Создание классов LINQ to SQL \(реляционный конструктор объектов\)](../Topic/Walkthrough:%20Creating%20LINQ%20to%20SQL%20Classes%20\(O-R%20Designer\).md)