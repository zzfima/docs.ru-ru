---
title: "Практическое руководство. Вызов хранимой процедуры с помощью LINQ (Visual Basic) | Microsoft Docs"
ms.custom: ""
ms.date: "2015-07-20"
ms.prod: ".net"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-visual-basic"
ms.topic: "article"
dev_langs: 
  - "VB"
helpviewer_keywords: 
  - "запросы [LINQ в Visual Basic], разделы практического руководства"
  - "запросы [LINQ в Visual Basic], вызовы хранимой процедуры"
  - "хранимые процедуры [LINQ to SQL]"
  - "пример хранимых процедуры [Visual Basic]"
ms.assetid: 6436d384-d1e0-40aa-8afd-451007477260
caps.latest.revision: 12
author: "stevehoag"
ms.author: "shoag"
caps.handback.revision: 12
---
# Практическое руководство. Вызов хранимой процедуры с помощью LINQ (Visual Basic)
[!INCLUDE[vs2017banner](../../../../visual-basic/includes/vs2017banner.md)]

Интегрированный язык запросов \(LINQ\) позволяет легко получать доступ к сведениям базы данных, в том числе к объектам, например, хранимым процедурам.  
  
 Ниже приведен пример способа создания приложения, вызывающего хранимую процедуру в базе данных SQL Server.  В примере показано, как вызвать две различные хранимые процедуры в базе данных.  Каждая процедура возвращает результаты запроса.  Одна процедура принимает входные параметры, а другая процедура — не принимает.  
  
 В примерах этого раздела используется учебная база данных "Борей".  При отсутствии учебной базы данных "Борей" на компьютере разработчика ее можно загрузить с веб\-узла [Центра загрузки Майкрософт](http://go.microsoft.com/fwlink/?LinkID=98088).  Подробные инструкции см. в разделе [Загрузка образцов баз данных](../Topic/Downloading%20Sample%20Databases.md).  
  
 [!INCLUDE[note_settings_general](../../../../csharp/language-reference/compiler-messages/includes/note-settings-general-md.md)]  
  
### Создание подключения к базе данных  
  
1.  В Visual Studio откройте **обозреватель серверов** или **обозреватель баз данных**. Для этого в меню **Вид** выберите пункт **Обозреватель серверов** или **Обозреватель баз данных**.  
  
2.  В **обозревателе серверов** или **обозревателе баз данных** щелкните правой кнопкой мыши **Подключения данных**, а затем выберите команду **Добавить подключение**.  
  
3.  Укажите допустимое подключение к учебной базе данных "Northwind".  
  
### Добавление проекта, содержащего файл LINQ\-SQL  
  
1.  В меню **Файл** окна Visual Studio выберите команду **Создать** и щелкните **Проект**.  Выберите **Приложение Windows Forms** в качестве типа проекта Visual Basic.  
  
2.  В меню **Проект** выберите команду **Добавить новый элемент**.  Выберите шаблон элемента **Классы LINQ\-SQL**.  
  
3.  Назовите файл `northwind.dbml`.  Нажмите кнопку **Добавить**.  Откроется реляционный конструктор объектов для файла northwind.dbml.  
  
### Чтобы добавить в конструктор O\/R хранимые процедуры  
  
1.  В представлении **Обозреватель серверов** или **Обозреватель баз данных** разверните подключение к базе данных "Northwind".  Разверните папку **Хранимые процедуры**.  
  
     Если реляционный конструктор объектов закрыт, откройте его снова, дважды щелкнув файл northwind.dbml, который был добавлен ранее.  
  
2.  Нажмите кнопку **Sales by Year** хранимой процедуры и перетащите ее в правую область конструктора.  Нажмите кнопку **Ten Most Expensive Products** хранимой процедуры и перетащите ее в правую область конструктора.  
  
3.  Сохраните изменения и закройте конструктор.  
  
4.  Сохраните проект.  
  
### Чтобы добавить код для отображения результатов хранимых процедур  
  
1.  С **панели элементов** перетащите элемент управления <xref:System.Windows.Forms.DataGridView> в заданную по умолчанию форму Windows Forms для проекта \(Form1\).  
  
2.  Дважды щелкните значок Form1 для добавления кода для ее события `Load`.  
  
3.  После добавления таблицы в O\/R Конструктор, разработчик добавил объект <xref:System.Data.Linq.DataContext> в проект.  Этот объект содержит код, необходимый для доступа к этим процедурам.  Объекту <xref:System.Data.Linq.DataContext> присваивается имя на основе имени файла .dbml.  Для данного проекта объект <xref:System.Data.Linq.DataContext> называется `northwindDataContext`.  
  
     Можно создать экземпляр <xref:System.Data.Linq.DataContext> в коде и вызывать методы хранимой процедуры, определяемые в конструкторе O\/R.  Для привязки объекта <xref:System.Windows.Forms.DataGridView> может потребоваться немедленное выполнение запроса путем вызова метода <xref:System.Linq.Enumerable.ToList%2A> для результатов выполнения хранимой процедуры.  
  
     Добавьте следующий код в событие `Load` для вызова одной из процедур, предоставленных как методы в контексте данных.  
  
     [!code-vb[VbLINQtoSQLHowTos#1](../../../../visual-basic/programming-guide/language-features/linq/codesnippet/visualbasic/StoredProcedureHowTo/Form3.vb#1)]  
    [!code-vb[VbLINQtoSQLHowTos#2](../../../../visual-basic/programming-guide/language-features/linq/codesnippet/visualbasic/StoredProcedureHowTo/Form3.vb#2)]  
  
4.  Нажмите клавишу F5, чтобы запустить проект и просмотреть результаты.  
  
## См. также  
 [LINQ](../../../../visual-basic/programming-guide/language-features/linq/index.md)   
 [Запросы](../../../../visual-basic/language-reference/queries/queries.md)   
 [LINQ to SQL](../Topic/LINQ%20to%20SQL.md)   
 [Методы DataContext \(реляционный конструктор объектов\)](/visual-studio/data-tools/datacontext-methods-o-r-designer)   
 [Как назначить хранимые процедуры для выполнения обновлений, вставок и удалений \(реляционный конструктор объектов\)](../Topic/How%20to:%20Assign%20stored%20procedures%20to%20perform%20updates,%20inserts,%20and%20deletes%20\(O-R%20Designer\).md)   
 [Пошаговое руководство. Создание классов LINQ to SQL \(реляционный конструктор объектов\)](../Topic/Walkthrough:%20Creating%20LINQ%20to%20SQL%20Classes%20\(O-R%20Designer\).md)