---
title: "Вопросы, связанные с перегрузкой процедур (Visual Basic) | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-visual-basic"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
helpviewer_keywords: 
  - "аргументы [Visual Basic], необязательные"
  - "аргументы [Visual Basic], массивы параметров"
  - "перегрузка функции, неявные перегрузки ParamArray"
  - "перегрузка функции, ограничения"
  - "перегрузка функции, программирование без использования типов"
  - "Option Explicit - оператор"
  - "необязательные аргументы, перегрузка"
  - "ParamArray - ключевое слово, аргументы и подписи"
  - "ParamArray - ключевое слово, массивы параметров"
  - "ParamArray - ключевое слово, подписи"
  - "массивы параметров, перегрузка аргументов"
  - "списки параметров"
  - "параметры, списки"
  - "перегрузка процедур, характеристики"
  - "процедуры, перегрузка"
  - "процедуры, списки параметров"
  - "ограничения, перегрузка процедур"
  - "подписи, ParamArray - аргументы"
  - "подписи, процедура"
  - "программирование без использования типов"
  - "код Visual Basic, списки параметров"
  - "код Visual Basic, процедуры"
ms.assetid: a2001248-10d0-42c5-b0ce-eeedc987319f
caps.latest.revision: 26
caps.handback.revision: 26
author: "stevehoag"
ms.author: "shoag"
manager: "wpickett"
---
# Вопросы, связанные с перегрузкой процедур (Visual Basic)
[!INCLUDE[vs2017banner](../../../../csharp/includes/vs2017banner.md)]

При перегрузке процедур необходимо использовать отдельную *сигнатуру* для каждой из перегруженных версий.  Это обычно означает, что для каждой версии должен быть задан отдельный список параметров.  Дополнительные сведения см. в разделе "Другие сигнатуры" в [Перегрузка процедур](../../../../visual-basic/programming-guide/language-features/procedures/procedure-overloading.md).  
  
 Процедура `Function` может быть перегружена процедурой `Sub` и наоборот, если они имеют разные сигнатуры.  Две перегрузки не отличаются только тем, что одна имеет возвращаемое значение, а другая нет.  
  
 Свойство может быть перегружено таким же образом, каким перегружается процедура, и с тем же ограничениями.  Однако нельзя перегрузить процедуру свойством или свойство процедурой.  
  
## Альтернативы перегруженных версий  
 Иногда существуют альтернативы перегруженных версий, особенно если наличие аргументов является необязательным или их количество может меняться.  
  
 Следует учитывать, что необязательные аргументы могут не поддерживаться всеми языками, а массивы параметров ограничены [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)].  При написании процедуры, которая вероятнее всего будет вызываться из кода, написанного на любом из нескольких различных языков, перегруженные версии предоставляют наибольшую гибкость.  
  
### Перегрузки и необязательные аргументы  
 Вызывающий код может при необходимости предоставить или пропустить один или несколько аргументов, поэтому можно определить несколько перегруженных версий или использовать дополнительные параметры.  
  
#### Когда следует использовать перегруженные версии  
 Можно определять наборы перегруженных версий в следующих случаях:  
  
-   Логика в коде процедуры существенно отличается в зависимости от того, предоставляет ли вызывающий код дополнительный аргумент или нет.  
  
-   Код процедуры не может быть надежно проверен или вызывающий код имеет указанный необязательный аргумент.  Это происходит в том случае, если вызывающий код не может предоставить ни одного значения и нет ни одного кандидата на значение по умолчанию.  
  
#### Когда следует использовать дополнительные параметры  
 В следующих случаях может потребоваться использование одного или нескольких дополнительных параметров.  
  
-   Единственное действие, которое необходимо выполнить, когда вызывающий код не предоставляет дополнительный аргумент — это установить для параметра значение по умолчанию.  В таком случае код процедуры можно упростить, если определить одну версию с одним или несколькими параметрами `Optional`.  
  
 Дополнительные сведения см. в разделе [Необязательные параметры](../../../../visual-basic/programming-guide/language-features/procedures/optional-parameters.md).  
  
### Перегрузки и массивы параметров  
 Если вызывающий код может передавать переменное число аргументов, можно определить несколько перегруженных версий или использовать массив параметров.  
  
#### Когда следует использовать перегруженные версии  
 Можно определять наборы перегруженных версий в следующих случаях:  
  
-   Известно, что вызывающий код передает в массив параметров только небольшое количество значений.  
  
-   Логика в коде процедуры значительно отличается в зависимости от количества значений, которые передает вызывающий код.  
  
-   Вызывающий код может передавать значения различных типов данных.  
  
#### Когда следует использовать массив параметров  
 Параметр `ParamArray` рекомендуется использовать в следующих случаях:  
  
-   Невозможно предсказать количество значений, которые вызывающий код может передать в массив параметров; оно может быть большим числом.  
  
-   Логика процедуры предоставляет саму себя для итерации по всем значениям, которые предает вызовающий код, выполняя фактически одинаковые операции над каждым значением.  
  
 Дополнительные сведения см. в разделе [Массивы параметров](../../../../visual-basic/programming-guide/language-features/procedures/parameter-arrays.md).  
  
## Неявные перегрузки для дополнительных параметров  
 Процедура с параметром [Optional](../../../../visual-basic/language-reference/modifiers/optional.md) эквивалентна двум перегруженным процедурам, у одной из которых имеется дополнительный параметр, а у другой — нет.  Невозможно перегрузить такую процедуру с помощью списка параметров, соответствующего любой из них.  Это показано в следующих объявлениях:  
  
 [!code-vb[VbVbcnProcedures#58](../../../../visual-basic/programming-guide/language-features/procedures/codesnippet/VisualBasic/considerations-in-overloading-procedures_1.vb)]  
  
 [!code-vb[VbVbcnProcedures#60](../../../../visual-basic/programming-guide/language-features/procedures/codesnippet/VisualBasic/considerations-in-overloading-procedures_2.vb)]  
  
 [!code-vb[VbVbcnProcedures#61](../../../../visual-basic/programming-guide/language-features/procedures/codesnippet/VisualBasic/considerations-in-overloading-procedures_3.vb)]  
  
 Для процедуры с несколькими необязательными параметрами существует набор неявных перегрузок, получающихся по той же схеме, которая приведена в предыдущем примере.  
  
## Неявные перегрузки для параметра ParamArray  
 Компилятор рассматривает процедуру с параметром [ParamArray](../../../../visual-basic/language-reference/modifiers/paramarray.md) как процедуру с бесконечным числом перегрузок, отличающихся друг от друга тем, что именно передает вызывающий код в массив параметров:  
  
-   Одна перегрузка, когда вызывающий код не передает аргумент в `ParamArray`  
  
-   Одна перегрузка, когда вызывающий код предоставляет одномерный массив типа элемента `ParamArray`  
  
-   Одна перегрузка для каждого положительного целого числа, когда вызывающий код предоставляет количество аргументов, каждый из которых относится к типу элемента `ParamArray`  
  
 Эти неявные перегрузки иллюстрируются в следующем примере:  
  
 [!code-vb[VbVbcnProcedures#68](../../../../visual-basic/programming-guide/language-features/procedures/codesnippet/VisualBasic/considerations-in-overloading-procedures_4.vb)]  
  
 [!code-vb[VbVbcnProcedures#70](../../../../visual-basic/programming-guide/language-features/procedures/codesnippet/VisualBasic/considerations-in-overloading-procedures_5.vb)]  
  
 Нельзя перегрузить процедуру со списком параметров, который принимает одномерный массив для массива параметров.  Однако можно использовать описания других неявных перегрузок.  Это показано в следующих объявлениях:  
  
 [!code-vb[VbVbcnProcedures#71](../../../../visual-basic/programming-guide/language-features/procedures/codesnippet/VisualBasic/considerations-in-overloading-procedures_6.vb)]  
  
## Программирование без типов как альтернатива перегрузке  
 Если нужно разрешить вызывающему коду передавать различным типам данных на параметр, то альтернативный подход программирование без типов.  Можно отключить проверку типов, установив значение `Off`, используя параметр компилятора [Оператор Option Strict](../../../../visual-basic/language-reference/statements/option-strict-statement.md) или [\/optionstrict](../../../../visual-basic/reference/command-line-compiler/optionstrict.md).  В этом случае нет необходимости объявлять тип данных параметра.  Однако у такого подхода есть ряд недостатков по сравнению с перегрузкой:  
  
-   Код, получающийся в результате программирования без типов, выполняется менее эффективно.  
  
-   Процедура должна проверять каждый тип данных, который может быть ей передан.  
  
-   Компилятор не может сообщить об ошибке, если вызывающий код передает тип данных, не поддерживаемый процедурой.  
  
## См. также  
 [Процедуры](../../../../visual-basic/programming-guide/language-features/procedures/index.md)   
 [Параметры и аргументы процедуры](../../../../visual-basic/programming-guide/language-features/procedures/procedure-parameters-and-arguments.md)   
 [Устранение неполадок в процедурах](../../../../visual-basic/programming-guide/language-features/procedures/troubleshooting-procedures.md)   
 [Практическое руководство. Определение различных версий процедуры](../../../../visual-basic/programming-guide/language-features/procedures/how-to-define-multiple-versions-of-a-procedure.md)   
 [Практическое руководство. Вызов перегруженной процедуры](../../../../visual-basic/programming-guide/language-features/procedures/how-to-call-an-overloaded-procedure.md)   
 [Практическое руководство. Перегрузка процедуры, которая принимает один необязательный параметр](../../../../visual-basic/programming-guide/language-features/procedures/how-to-overload-a-procedure-that-takes-optional-parameters.md)   
 [Практическое руководство. Перегрузка процедуры, принимающей неопределенное число параметров](../../../../visual-basic/programming-guide/language-features/procedures/how-to-overload-a-procedure-that-takes-an-indefinite-number-of-parameters.md)   
 [Разрешение перегрузки](../../../../visual-basic/programming-guide/language-features/procedures/overload-resolution.md)   
 [Overloads](../../../../visual-basic/language-reference/modifiers/overloads.md)