---
title: "Передача аргументов по значению и по ссылке (Visual Basic) | Microsoft Docs"
ms.custom: ""
ms.date: "2015-07-20"
ms.prod: ".net"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-visual-basic"
ms.topic: "article"
dev_langs: 
  - "VB"
helpviewer_keywords: 
  - "передача аргументов, по значению или по ссылке"
  - "аргументы [Visual Basic], передача по значению или по ссылке"
  - "ByRef - ключевое слово, передача аргументов по ссылке"
  - "ByVal - ключевое слово, передача аргументов по значению"
  - "передача аргументов, по значению или по ссылке"
  - "код Visual Basic, процедуры"
ms.assetid: fd8a9de6-7178-44d5-a9bf-458d4ad907c2
caps.latest.revision: 23
author: "stevehoag"
ms.author: "shoag"
caps.handback.revision: 23
---
# Передача аргументов по значению и по ссылке (Visual Basic)
[!INCLUDE[vs2017banner](../../../../visual-basic/includes/vs2017banner.md)]

В [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb-md.md)] можно передать аргумент в процедуру *по значению* или *по ссылке*.  Это называется *механизмом передачи*. Он определяет, может ли процедура изменять элемент программирования, содержащийся в аргументе кода вызова.  Объявление процедуры определяет механизм передачи для каждого параметра путем указания ключевого слова [ByVal](../../../../visual-basic/language-reference/modifiers/byval.md) или [ByRef](../../../../visual-basic/language-reference/modifiers/byref.md).  
  
## Различия  
 При передаче аргумента в процедуру, нужно принять во внимание несколько отличительных особенностей, которые взаимодействуют друг с другом.  
  
-   Является ли базовый элемент программирования изменяемым или неизменяемым  
  
-   Является ли сам аргумент изменяемым или неизменяемым  
  
-   Аргумент передается по значению или по ссылке  
  
-   Является ли тип данных аргумента типом значения или ссылочным типом  
  
 Дополнительные сведения см. в разделах [Различия между аргументами Modifiable и Nonmodifiable](../../../../visual-basic/programming-guide/language-features/procedures/differences-between-modifiable-and-nonmodifiable-arguments.md) и [Различия между передачей аргумента по значению и по ссылке](../../../../visual-basic/programming-guide/language-features/procedures/differences-between-passing-an-argument-by-value-and-by-reference.md).  
  
## Выбор механизма передачи  
 Необходимо осторожно выбирать механизм передачи для каждого аргумента.  
  
-   **Защита**.  Наиболее важным критерием выбора между двумя механизмами передачи является требуемая степень доступности исходных переменных для изменения.  Преимущество передачи аргумента `ByRef` заключается в том, что процедура может возвратить значение в вызывающий код через этот аргумент.  Преимущество передачи аргумента `ByVal` состоит в том, что в этом случае переменная защищена от изменений, вносимых процедурой.  
  
-   **Производительность**.  Хотя механизм передачи также может повлиять на производительность кода, разница практически не заметна.  Единственным исключением является передача типа значения `ByVal`.  В этом случае [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb-md.md)] копирует все содержимое аргумента.  Таким образом, большие аргументы типа значения \(например структуру\) целесообразнее передавать `ByRef`.  
  
     Для ссылочных типов копируется только указатель на данные \(четыре байта на 32\-разрядных платформах, восемь байтов на 64\-разрядных платформах\).  Таким образом можно передавать аргументы типа `String` или `Object` по значению без потери производительности.  
  
## Определение механизма передачи  
 Объявление процедуры определяет механизм передачи для каждого параметра.  Вызывающий код не может переопределить механизм `ByVal`.  
  
 Если параметр объявлен с `ByRef`, то вызывающий код может применять механизм для `ByVal`, заключив имя аргумента в круглые скобки в вызове.  Дополнительные сведения см. в разделе [Практическое руководство. Принудительная передача аргумента по значению](../../../../visual-basic/programming-guide/language-features/procedures/how-to-force-an-argument-to-be-passed-by-value.md).  
  
 По умолчанию в [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb-md.md)] для передачи аргументов используется передача по значению.  
  
## Когда передавать аргумент по значению  
  
-   Если элемент кода вызова, содержащийся в аргументе, является неизменяемым, объявите соответствующий параметр [ByVal](../../../../visual-basic/language-reference/modifiers/byval.md).  Никакой код не может изменить значение неизменяемого элемента.  
  
-   Если элемент является изменяемым, но процедура не должна изменить его значение, объявите параметр `ByVal`.  Только вызывающий код может изменить значение изменяемого элемента, который передается по значению.  
  
## Когда передавать аргумент по ссылке  
  
-   Если процедуре необходимо изменить базовый элемент в коде вызова, объявите соответствующий параметр [ByRef](../../../../visual-basic/language-reference/modifiers/byref.md).  
  
-   Если правильное выполнение кода зависит от изменения базового элемента в коде вызывающей процедуры, объявите параметр `ByRef`.  Если параметр передается его по значению или код вызова переопределяет `ByRef` механизма передачи, заключив аргумент в круглые скобки, вызов процедуры может привести к непредсказуемым результатам.  
  
## Пример  
  
### Описание  
 Следующий пример показывает, когда следует передавать аргументы по значению, а когда передавать их по ссылке.  Процедура `Calculate` имеет два параметра: `ByVal` и `ByRef`.  Если дана процентная ставка `rate` и сумма средств `debt`, задачей процедуры является вычисление нового значения `debt`, которое будет результатом применения процентной ставки к исходному значению `debt`.  Поскольку `debt` является параметром `ByRef`, новая сумма отражается в значении аргумента в вызывающем коде, соответствующем `debt`.  Параметр `rate` является параметром `ByVal`, так как процедура `Calculate` не должна менять его значение.  
  
### Код  
 [!code-vb[VbVbcnProcedures#74](../../../../visual-basic/programming-guide/language-features/procedures/codesnippet/visualbasic/passing-arguments-by-val_1.vb)]  
  
## См. также  
 [Процедуры](../../../../visual-basic/programming-guide/language-features/procedures/index.md)   
 [Параметры и аргументы процедуры](../../../../visual-basic/programming-guide/language-features/procedures/procedure-parameters-and-arguments.md)   
 [Практическое руководство. Передача аргументов в процедуру](../../../../visual-basic/programming-guide/language-features/procedures/how-to-pass-arguments-to-a-procedure.md)   
 [Практическое руководство. Изменение значения аргумента процедуры](../../../../visual-basic/programming-guide/language-features/procedures/how-to-change-the-value-of-a-procedure-argument.md)   
 [Практическое руководство. Защита аргумента процедуры от изменения значения](../../../../visual-basic/programming-guide/language-features/procedures/how-to-protect-a-procedure-argument-against-value-changes.md)   
 [Практическое руководство. Принудительная передача аргумента по значению](../../../../visual-basic/programming-guide/language-features/procedures/how-to-force-an-argument-to-be-passed-by-value.md)   
 [Передача аргументов по позиции и по имени](../../../../visual-basic/programming-guide/language-features/procedures/passing-arguments-by-position-and-by-name.md)   
 [Типы значений и ссылочные типы](../../../../visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types.md)