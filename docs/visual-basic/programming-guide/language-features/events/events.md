---
title: "События (Visual Basic) | Microsoft Docs"
ms.custom: ""
ms.date: "02/25/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-visual-basic"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
helpviewer_keywords: 
  - "события [Visual Basic]"
  - "события [Visual Basic], сведения о событиях"
ms.assetid: 8fb0353a-e41b-4e23-b78f-da65db832f70
caps.latest.revision: 12
author: "stevehoag"
ms.author: "shoag"
manager: "wpickett"
---
# События (Visual Basic)
[!INCLUDE[vs2017banner](../../../../visual-basic/includes/vs2017banner.md)]

Хотя можно представить проект [!INCLUDE[vsprvs](../../../../csharp/includes/vsprvs-md.md)] как набор процедур, выполняемых в определенной последовательности, на самом деле, большинство программ управляются событиями, то есть поток выполнения определяется внешними воздействиями, называемыми *событиями*.  
  
 Под событием в данном случае подразумевается сигнал, сообщающий приложению, что произошло нечто важное.  Например, когда пользователь щелкает элемент управления на форме, форма может инициировать событие `Click` и вызывать процедуру, обрабатывающую событие.  События также допускают взаимодействие отдельных задач.  Например, пользовательское приложение выполняет задачу по сортировке отдельно от основного приложения.  Если пользователь отменяет сортировку, то приложение может послать событие отмены, которое остановит процесс сортировки.  
  
## Термины и основные понятия для событий  
 В этом разделе описываются термины и понятия, связанные с использованием событий в [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb-md.md)].  
  
### Объявление событий  
 События в классах, структурах, модулях и интерфейсах объявляются с помощью ключевого слова `Event`, как показано в следующем примере.  
  
 [!code-vb[VbVbalrEvents#24](../../../../visual-basic/language-reference/statements/codesnippet/visualbasic/VbVbalrEvents/Class1.vb#24)]  
  
### Создание событий  
 Событие похоже на сообщение о том, что случилось что\-то важное.  Рассылка сообщения называется *созданием* события.  В [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb-md.md)] события вызываются с помощью инструкции `RaiseEvent`, как в следующем примере:  
  
 [!code-vb[VbVbalrEvents#25](../../../../visual-basic/language-reference/statements/codesnippet/visualbasic/VbVbalrEvents/Class1.vb#25)]  
  
 События должны вызываться в рамках класса, модуля или структуры, где они объявлены.  Например, производный класс не может вызывать события, унаследованные из базового класса.  
  
### Отправители событий  
 Любой объект, способный вызывать события, является *отправителем событий*, также называемым *источником событий*.  Формы, элементы управления и пользовательские объекты являются примерами отправителей событий.  
  
### Обработчики событий  
 *Обработчики событий* — это процедуры, вызываемые при возникновении соответствующего события.  Можно использовать любые допустимые подпрограммы с соответствующей сигнатурой в качестве обработчика событий.  Функция, тем не менее, не может быть использована в качестве обработчика событий, так как возвращение значения в источник события с ее помощью невозможно.  
  
 В [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb-md.md)] используется стандартное положение об именовании обработчиков событий. Имя должно состоять из имени отправителя события, знака подчеркивания и имени события.  Например, событие `Click` кнопки с именем `button1` будет иметь имя `Sub button1_Click`.  
  
> [!NOTE]
>  Рекомендуется следовать положению об именовании при определении обработчиков событий для пользовательских событий, но это необязательно, можно использовать любое допустимое имя подпрограммы.  
  
## Связывание событий с их обработчиками  
 Для того, чтобы обработчик событий был готов к использованию, его необходимо связать с событием посредством оператора `Handles` или `AddHandler`.  
  
### Оператор WithEvents и предложение Clause  
 Инструкция `WithEvents` и условие `Handles` предоставляют декларативный способ задания обработчиков событий.  Событие, инициированное объектом, который объявлен с помощью ключевого слова `WithEvents`, могут обрабатываться любой процедурой с оператором `Handles` для данного события, как показано в следующем примере:  
  
 [!code-vb[VbVbalrEvents#1](../../../../visual-basic/language-reference/statements/codesnippet/visualbasic/VbVbalrEvents/Class1.vb#1)]  
  
 Применение оператора `WithEvents` и предложения `Handles` часто является лучшим вариантом для обработчиков событий, поскольку используемый ими декларативный синтаксис делает обработку события проще для кодирования, чтения и отладки.  Однако при использовании переменных `WithEvents` необходимо помнить о следующих ограничениях:  
  
-   Нельзя использовать переменную `WithEvents` как объектную переменную.  То есть ее невозможно объявить как `Object` — при объявлении переменной необходимо указать имя класса.  
  
-   Поскольку общие события `` не связываются с экземплярами класса, нельзя использовать `WithEvents` для декларативной обработки общих событий.  Нельзя также использовать `WithEvents` или `Handles` для обработки событий из `Structure`.  В обоих случаях для обработки этих событий можно использовать оператор `AddHandler`.  
  
-   Невозможно создать массивы переменных `WithEvents`.  
  
 Переменные `WithEvents` позволяют одному обработчику событий обрабатывать один или несколько видов событий или нескольким обработчикам событий обрабатывать один вид событий.  
  
 Хотя условие `Handles` является стандартным способом связывания события с обработчиком, связь посредством него может осуществляться только во время компиляции.  
  
 В некоторых случаях, например, когда события связаны с формами или элементами управления, [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb-md.md)] автоматически задействует пустой обработчик событий и сопоставляет его с событием.  Например, при двойном щелчке мышью командной кнопки на форме в режиме разработки [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb-md.md)] создает пустой обработчик событий и переменную `WithEvents` для командной кнопки, как в следующем коде:  
  
 [!code-vb[VbVbalrEvents#26](../../../../visual-basic/language-reference/statements/codesnippet/visualbasic/VbVbalrEvents/Class1.vb#26)]  
  
### Операторы AddHandler и RemoveHandler  
 Оператор `AddHandler` аналогичен условию `Handles` в том, что оба позволяют задавать обработчик события.  Однако `AddHandler`, использованный с `RemoveHandler`, обеспечивает большую гибкость, чем условие `Handles`,и позволяет динамически добавлять, удалять и изменять обработчик событий, связанный с событием.  Если необходимо обработать общие события или события из структуры, следует использовать `AddHandler`.  
  
 `AddHandler` принимает два аргумента: имя события от отправителя событий, например элемента управления, и выражение, определяющее делегат.  Не требуется явного определения класса делегата при использовании `AddHandler`, так как оператор `AddressOf` всегда возвращает ссылку на делегат.  В следующем примере обработчик событий связывается с событием, вызванным объектом.  
  
 [!code-vb[VbVbalrEvents#28](../../../../visual-basic/language-reference/statements/codesnippet/visualbasic/VbVbalrEvents/Class1.vb#28)]  
  
 `RemoveHandler`, отсоединяет событие от обработчика событий, используя при этом тот же синтаксис, что и `AddHandler`.  Примеры.  
  
 [!code-vb[VbVbalrEvents#29](../../../../visual-basic/language-reference/statements/codesnippet/visualbasic/VbVbalrEvents/Class1.vb#29)]  
  
 В следующем примере обработчик событий связывается с событием, событие происходит.  Обработчик событий перехватывает событие и выводит сообщение.  
  
 Затем первый обработчик событий удаляется и с событием сопоставляется другой обработчик событий.  Когда событие происходит во второй раз, выводится другое сообщение.  
  
 Наконец, второй обработчик событий удаляется, а событие происходит в третий раз.  Поскольку теперь нет связанного с событием обработчика событий, ничего не происходит.  
  
 [!code-vb[VbVbalrEvents#38](../../../../visual-basic/language-reference/statements/codesnippet/visualbasic/VbVbalrEvents/Class2.vb#38)]  
  
## Обработка событий, унаследованных из базового класса  
 *Производные классы* — это классы, которые наследуют характеристики из базового класса и могут обрабатывать события, инициированные их базовым классом, при помощи оператора `Handles` `MyBase`.  
  
#### Обработка событий базового класса  
  
-   Объявите обработчик событий в производном классе путем добавления оператора `Handles MyBase.`*имя\_события* в строку объявления процедуры обработчика события, где *имя\_события* является именем события в обрабатываемом базовом классе.  Примеры.  
  
     [!code-vb[VbVbalrEvents#12](../../../../visual-basic/language-reference/statements/codesnippet/visualbasic/VbVbalrEvents/Class1.vb#12)]  
  
## Связанные разделы  
  
|Заголовок|Описание|  
|---------------|--------------|  
|[Пошаговое руководство. Объявление и создание событий](../../../../visual-basic/programming-guide/language-features/events/walkthrough-declaring-and-raising-events.md)|Предоставляет пошаговое описание объявления и возникновения событий для класса.|  
|[Пошаговое руководство. Обработка событий](../../../../visual-basic/programming-guide/language-features/events/walkthrough-handling-events.md)|Описание процесса создания процедуры обработчика событий.|  
|[Практическое руководство. Объявление пользовательских событий для предотвращения блокировки](../../../../visual-basic/programming-guide/language-features/events/how-to-declare-custom-events-to-avoid-blocking.md)|Показано, как определить пользовательское событие, позволяющее его обработчикам событий вызываться асинхронно.|  
|[Практическое руководство. Объявление пользовательских событий для экономии памяти](../../../../visual-basic/programming-guide/language-features/events/how-to-declare-custom-events-to-conserve-memory.md)|Показано, как определить пользовательское событие, которое использует память только при обработке события.|  
|[Устранение неполадок, связанных с унаследованными обработчиками событий, в Visual Basic](../../../../visual-basic/programming-guide/language-features/events/troubleshooting-inherited-event-handlers.md)|Список общих вопросов, связанных с обработчиками событий в унаследованных компонентах.|  
|[События](../Topic/Handling%20and%20Raising%20Events.md)|Содержит общие сведения о модели событий в [!INCLUDE[dnprdnshort](../../../../csharp/getting-started/includes/dnprdnshort-md.md)].|  
|[Creating Event Handlers in Windows Forms](../Topic/Creating%20Event%20Handlers%20in%20Windows%20Forms.md)|Описывает приемы работы с событиями, связанными с объектами Windows Forms.|  
|[Делегаты](../../../../visual-basic/programming-guide/language-features/delegates/delegates.md)|Содержит общие сведения о делегатах в Visual Basic.|