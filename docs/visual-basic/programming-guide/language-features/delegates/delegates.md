---
title: "Делегаты (Visual Basic) | Microsoft Docs"
ms.custom: ""
ms.date: "02/25/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-visual-basic"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
helpviewer_keywords: 
  - "делегаты [Visual Basic]"
  - "код Visual Basic, делегаты"
ms.assetid: 410b60dc-5e60-4ec0-bfae-426755a2ee28
caps.latest.revision: 10
author: "stevehoag"
ms.author: "shoag"
manager: "wpickett"
---
# Делегаты (Visual Basic)
[!INCLUDE[vs2017banner](../../../../visual-basic/includes/vs2017banner.md)]

Делегаты — это объекты, которые ссылаются на методы.  Иногда их описывают как *type\-safe function pointers*, поскольку они аналогичны указателям на функции, используемым в других языках программирования.  Но в отличие от указателей на функции, делегаты [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb-md.md)] являются ссылочными типами, основанными на классе, <xref:System.Delegate?displayProperty=fullName>.  Делегаты могут ссылаться на оба вида общих методов — методы, которые могут вызываться без определенного экземпляра класса, и методы экземпляров.  
  
## Делегаты и события  
 Применение делегатов особенно эффективно в случаях, когда необходимо посредничество между вызывающей и вызываемой процедурами.  Например, необходимо, чтобы объект, инициирующий события, мог вызывать различные обработчики событий при различных условиях.  К несчастью, объект, вызывающий события, не может заранее знать время, когда обработчик событий обрабатывает конкретное событие.  [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb-md.md)] позволяет динамически связывать обработчики событий с событиями путем создания делегата при использовании оператора `AddHandler`.  Во время выполнения делегат передает вызовы соответствующему обработчику событий.  
  
 Хотя пользователь может создавать свои собственные делегаты, в большинстве случаев [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb-md.md)] создает делегат в соответствии с имеющимися условиями.  Например, оператор `Event` неявно определяет класс делегата с именем `<EventName>EventHandler` как вложенный класс класса, содержащего инструкцию `Event` и с той же сигнатурой, что событие.  Оператор `AddressOf` неявно создает экземпляр делегата, который ссылается на конкретную процедуру.  Приведенные далее две строки кода равнозначны.  В первой строке можно видеть явное создание экземпляра `Eventhandler` со ссылкой на метод `Button1_Click`, отправленной в качестве аргумента.  Вторая строка представляет более удобный способ получения того же результата.  
  
 [!code-vb[VbVbalrDelegates#6](../../../../visual-basic/language-reference/operators/codesnippet/visualbasic/delegates_1.vb)]  
  
 В тех случаях, когда компилятор может определить тип делегата по контексту, может быть применен быстрый способ создания делегатов.  
  
## Объявление событий, использующих существующий тип делегата  
 В некоторых случаях бывает необходимо объявить событие для использования существующего типа делегата в качестве основного делегата.  Это делается при помощи следующего синтаксиса:  
  
 [!code-vb[VbVbalrDelegates#7](../../../../visual-basic/language-reference/operators/codesnippet/visualbasic/delegates_2.vb)]  
  
 Такой прием наиболее эффективен, когда нужно направить множество событий к одному и тому же обработчику.  
  
## Переменные и параметры делегата  
 Делегаты можно использовать также для других, не связанных с событиями задач, таких как свободная работа с потоками. Они могут использоваться и с процедурами, требующими вызова различных версий функций во время выполнения.  
  
 Например, имеется приложение рекламного характера, содержащее список с моделями автомобилей.  Статьи об автомобилях отсортированы по заголовку, в качестве которого обычно выступает модель автомобиля.  Затруднение возникает, если у некоторых автомобилей в имени перед названием модели стоит год их выпуска.  Встроенные функции сортируют список по кодам знаков; таким образом, все статьи с годами помещаются в начало списка, а за ними следуют статьи, начинающиеся с модели.  
  
 Для исправления данной ошибки в классе можно создать процедуру сортировки, которая использует стандартную сортировку по алфавиту в большинстве списков, но также во время выполнения может переключаться на пользовательскую процедуру сортировки статей об автомобилях.  Для этого необходимо передать пользовательскую процедуру сортировки классу сортировки во время выполнения при помощи делегатов.  
  
## AddressOf и лямбда\-выражения  
 Каждый класс делегата определяет конструктор, которому передается спецификация метода объекта.  Аргумент конструктора делегата должен быть ссылкой на метод или лямбда выражение.  
  
 Чтобы указать ссылку на метод, используйте следующий синтаксис:  
  
 `AddressOf` \[`expression`.\]`methodName`  
  
 Тип выражения времени компиляции `expression` должен быть классом или интерфейсом который включает метод с указанным именем, сигнатура которого соответствует сигнатуре класса делегата.  Параметр `methodName` должен быть совместно используемым методом или методом экземпляра.  Параметр `methodName` не является обязательным, даже если создается делегат для метода класса, используемого по умолчанию.  
  
 Чтобы указать выражение лямбда, используйте следующий синтаксис:  
  
 `Function` \(\[`parm` As `type`, `parm2` As `type2`, ...\]\) `expression`  
  
 В следующем примере показано задание ссылки для делегата с помощью `AddressOf` и лямбда\-выражений.  
  
 [!code-vb[VbVbalrDelegates#15](../../../../visual-basic/language-reference/operators/codesnippet/visualbasic/delegates_3.vb)]  
  
 Сигнатура функции должна соответствовать типу делегата.  Дополнительные сведения о лямбда\-выражениях см. в разделе [Лямбда\-выражения](../../../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md).  Дополнительные примеры назначения делегатам лямбда\-выражений и `AddressOf` см. в разделе [Неявное преобразование делегата](../../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md).  
  
## Связанные разделы  
  
|Заголовок|Описание|  
|---------------|--------------|  
|[Практическое руководство. Вызов метода делегата](../../../../visual-basic/programming-guide/language-features/delegates/how-to-invoke-a-delegate-method.md)|Содержит пример, в котором показано, как связать метод с делегатом, а затем вызвать метод через делегат.|  
|[Практическое руководство. Передача процедур другой процедуре в Visual Basic](../../../../visual-basic/programming-guide/language-features/delegates/how-to-pass-procedures-to-another-procedure.md)|Демонстрирует использование делегатов для передачи одной процедуры в другую.|  
|[Неявное преобразование делегата](../../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md)|Описание способов присвоения делегатам или обработчикам подпрограмм и функций, даже когда их подписи не идентичны.|  
|[События](../../../../visual-basic/programming-guide/language-features/events/events.md)|Содержит общие сведения о событиях в Visual Basic.|