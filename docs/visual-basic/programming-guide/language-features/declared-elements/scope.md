---
title: '`Scope`'
ms.date: 07/20/2015
helpviewer_keywords:
- module scope [Visual Basic]
- scope [Visual Basic], levels
- module level
- procedures [Visual Basic], scope
- declared elements [Visual Basic], scope
- namespaces [Visual Basic], scope
- scope [Visual Basic], declared elements
- scope [Visual Basic], about scope
- levels of scope [Visual Basic]
- block scope [Visual Basic]
- scope [Visual Basic], Visual Basic
- procedure scope [Visual Basic]
ms.assetid: 208106fe-79c9-4eec-93c6-55f08548895f
ms.openlocfilehash: 37fcfa897accb23e9c8c56407ce4ebd956b39c4d
ms.sourcegitcommit: 17ee6605e01ef32506f8fdc686954244ba6911de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/22/2019
ms.locfileid: "74345292"
---
# <a name="scope-in-visual-basic"></a>Область видимости в Visual Basic

*Областью видимости* объявленного элемента является набор всего кода, который может ссылаться на него без уточнения его имени или предоставления доступа с помощью [оператора Imports (пространство имен .NET и тип)](../../../../visual-basic/language-reference/statements/imports-statement-net-namespace-and-type.md). Элемент может иметь область действия на одном из следующих уровней:

|Уровень|Описание|
|-----------|-----------------|
|Область действия блока|Доступно только в блоке кода, в котором он объявлен|
|Область действия процедуры|Доступен для всего кода в процедуре, в которой он объявлен|
|Область модуля|Доступен для всего кода в модуле, классе или структуре, в которой он объявлен|
|Область пространства имен|Доступен для всего кода в пространстве имен, в котором оно объявлено|

Эти уровни области выполняются от самого узкого (блока) до самого широкого (пространства имен), где *самая узкие области* означает наименьший набор кода, который может ссылаться на элемент без квалификации. Дополнительные сведения см. в разделе уровни области на этой странице.

## <a name="specifying-scope-and-defining-variables"></a>Указание области и определение переменных

Вы указываете область элемента при его объявлении. Область может зависеть от следующих факторов:

- Область (блок, процедура, модуль, класс или структура), в которой объявляется элемент

- Пространство имен, содержащее объявление элемента

- Уровень доступа, объявленный для элемента

Используйте осторожность при определении переменных с одинаковым именем, но с разными областями, так как это может привести к непредвиденным результатам. Для получения дополнительной информации см. [References to Declared Elements](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md).

## <a name="levels-of-scope"></a>Уровни области

Программный элемент доступен по всему региону, в котором он объявлен. Весь код в одном регионе может ссылаться на элемент без уточнения его имени.

### <a name="block-scope"></a>Область блока

Блок — это набор инструкций, заключенных в операторы инициирования и завершения объявления, как показано ниже:

- `Do` и `Loop`

- `For` [`Each`] и `Next`

- `If` и `End If`

- `Select` и `End Select`

- `SyncLock` и `End SyncLock`

- `Try` и `End Try`

- `While` и `End While`

- `With` и `End With`

Если переменная объявлена в блоке, ее можно использовать только в пределах этого блока. В следующем примере областью целочисленной переменной `cube` является блок между `If` и `End If`, и вы больше не можете ссылаться на `cube`, когда выполнение передается из блока.

```vb
If n < 1291 Then
    Dim cube As Integer
    cube = n ^ 3
End If
```

> [!NOTE]
> Даже если область действия переменной ограничена блоком, ее время существования все равно будет содержаться во всей процедуре. Если вы вводите блок несколько раз во время процедуры, каждая переменная блока удерживает свое предыдущее значение. Чтобы избежать непредвиденных результатов в таком случае, разумно инициализировать блочные переменные в начале блока.

### <a name="procedure-scope"></a>Область действия процедуры

Элемент, объявленный внутри процедуры, недоступен за пределами этой процедуры. Только процедура, содержащая объявление, может использовать его. Переменные на этом уровне также называются *локальными переменными*. Они объявляются с помощью [оператора Dim](../../../../visual-basic/language-reference/statements/dim-statement.md)с ключевым словом [static](../../../../visual-basic/language-reference/modifiers/static.md) или без него.

Область действия процедуры и блока тесно связана. При объявлении переменной внутри процедуры, но вне любого блока внутри этой процедуры можно считать, что переменная имеет область видимости блока, где блоком является вся процедура.

> [!NOTE]
> Все локальные элементы, даже если они являются `Static` переменными, являются частными для процедуры, в которой они отображаются. Нельзя объявить какой-либо элемент с помощью ключевого слова [Public](../../../../visual-basic/language-reference/modifiers/public.md) в процедуре.

### <a name="module-scope"></a>Область модуля

Для удобства *уровень модуля* единого термина применяется в равной степени к модулям, классам и структурам. Вы можете объявить элементы на этом уровне, поместив оператор объявления за пределы любой процедуры или блока, но внутри модуля, класса или структуры.

При создании объявления на уровне модуля этот уровень доступа определяет область. Пространство имен, содержащее модуль, класс или структуру, также влияет на область.

Элементы, для которых объявлен [частный](../../../../visual-basic/language-reference/modifiers/private.md) уровень доступа, доступны для каждой процедуры в этом модуле, но не для кода в другом модуле. Инструкция `Dim` на уровне модуля по умолчанию имеет значение `Private`, если не используются ключевые слова уровня доступа. Тем не менее можно сделать область и уровень доступа более очевидными с помощью ключевого слова `Private` в инструкции `Dim`.

В следующем примере все процедуры, определенные в модуле, могут ссылаться на строковую переменную `strMsg`. При вызове второй процедуры она отображает содержимое строковой переменной, `strMsg` в диалоговом окне.

```vb
' Put the following declaration at module level (not in any procedure).
Private strMsg As String
' Put the following Sub procedure in the same module.
Sub initializePrivateVariable()
    strMsg = "This variable cannot be used outside this module."
End Sub
' Put the following Sub procedure in the same module.
Sub usePrivateVariable()
    MsgBox(strMsg)
End Sub
```

### <a name="namespace-scope"></a>Область пространства имен

Если элемент объявляется на уровне модуля с помощью ключевого слова [Friend](../../../../visual-basic/language-reference/modifiers/friend.md) или [Public](../../../../visual-basic/language-reference/modifiers/public.md) , он становится доступным для всех процедур в пространстве имен, в котором объявлен элемент. После приведения к предыдущему примеру изменений, строковая переменная `strMsg` может называться кодом в любом месте пространства имен его объявления.

```vb
' Include this declaration at module level (not inside any procedure).
Public strMsg As String
```

Область пространства имен включает вложенные пространства имен. Элемент, доступный из пространства имен, также доступен из любого пространства имен, вложенного в это пространство имен.

Если проект не содержит [операторов пространства имен](../../../../visual-basic/language-reference/statements/namespace-statement.md), все в проекте находится в том же пространстве имен. В этом случае область пространства имен может рассматриваться как область проекта. `Public` элементы в модуле, классе или структуре также доступны для любого проекта, который ссылается на свой проект.

## <a name="choice-of-scope"></a>Выбора области

При определении переменной следует учитывать следующие моменты при выборе ее области действия.

### <a name="advantages-of-local-variables"></a>Преимущества локальных переменных

Локальные переменные являются хорошим выбором для любого временного вычисления по следующим причинам.

- **Конфликт имен — избежать.** Имена локальных переменных не подвержены конфликтам. Например, можно создать несколько различных процедур, содержащих переменную с именем `intTemp`. При условии, что каждая `intTemp` объявлена как локальная переменная, каждая процедура распознает только собственную версию `intTemp`. Любая процедура может изменить значение в локальной `intTemp`, не влияя на `intTemp` переменные в других процедурах.

- **Потребление памяти.** Локальные переменные потребляют память только во время выполнения процедуры. Их память освобождается, когда процедура возвращается в вызывающий код. В отличие от этого, [Общие](../../../../visual-basic/language-reference/modifiers/shared.md) и [статические](../../../../visual-basic/language-reference/modifiers/static.md) переменные потребляют ресурсы памяти до тех пор, пока приложение не прекратит работу, поэтому используйте их только при необходимости. *Переменные экземпляра* потребляют память, пока их экземпляры продолжают существовать, что делает их менее эффективными, чем локальные переменные, но потенциально эффективнее, чем `Shared` или `Static` переменных.

### <a name="minimizing-scope"></a>Минимизация области

Как правило, при объявлении любой переменной или константы рекомендуется сделать область как можно более узким (область блока является самой узким). Это помогает экономить память и минимизирует вероятность того, что код ошибочно ссылался на неверную переменную. Аналогично, следует объявить переменную как [статическую](../../../../visual-basic/language-reference/modifiers/static.md) , только если необходимо сохранить ее значение между вызовами процедур.

## <a name="see-also"></a>См. также

- [Характеристики объявленных элементов](../../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-characteristics.md)
- [Практическое руководство. Управление областью действия переменной](../../../../visual-basic/programming-guide/language-features/declared-elements/how-to-control-the-scope-of-a-variable.md)
- [Время существования в Visual Basic](../../../../visual-basic/programming-guide/language-features/declared-elements/lifetime.md)
- [Уровни доступа в Visual Basic](../../../../visual-basic/programming-guide/language-features/declared-elements/access-levels.md)
- [Ссылки на объявленные элементы](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md)
- [Объявление переменных](../../../../visual-basic/programming-guide/language-features/variables/variable-declaration.md)
