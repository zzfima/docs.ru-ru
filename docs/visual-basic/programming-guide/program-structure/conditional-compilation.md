---
title: "Условная компиляция в Visual Basic | Microsoft Docs"
ms.custom: ""
ms.date: "2015-07-20"
ms.prod: ".net"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-visual-basic"
ms.topic: "article"
dev_langs: 
  - "VB"
helpviewer_keywords: 
  - "компиляция, условный"
  - "условная компиляция, сведения об условной компиляции"
ms.assetid: 9c35e55e-7eee-44fb-a586-dad1f1884848
caps.latest.revision: 15
author: "stevehoag"
ms.author: "shoag"
caps.handback.revision: 15
---
# Условная компиляция в Visual Basic
[!INCLUDE[vs2017banner](../../../visual-basic/includes/vs2017banner.md)]

При *условной компиляции* одни блоки кода в программе компилируются, в то время как другие блоки игнорируются.  
  
 Например, при необходимости написания инструкций отладки, которые сравнивают скорость выполнения одной и той же задачи при различных подходах, либо при необходимости локализации приложения для нескольких языков.  Инструкции условной компиляции разработаны для выполнения во время компиляции, а не во время выполнения.  
  
 Блоки кода для условной компиляции обозначаются директивой `#If...Then...#Else`.  Например, для создания версий одного и того же приложения на французском и немецком языках из одного исходного кода, необходимо внедрить зависимые от платформы сегменты кода в инструкции `#If...Then` с помощью определенных ранее констант `FrenchVersion` и `GermanVersion`.  Как это сделать, показано в следующем примере:  
  
 [!code-vb[VbVbalrConditionalComp#5](../../../visual-basic/language-reference/directives/codesnippet/visualbasic/conditional-compilation_1.vb)]  
  
 Если для константы условной компиляции `FrenchVersion` задается значение `True` во время компиляции, компилируется условный код для французской версии.  Если установить для константы `GermanVersion` значение `True`, компилятор использует немецкую версию.  Если ни одна константа не имеет значения `True`, выполняется код в последнем блоке `Else`.  
  
> [!NOTE]
>  Автозавершение не работает при редактировании кода и использовании директив условной компиляции, если код не является частью текущей ветви.  
  
## Объявление констант условной компиляции  
 Константы условной компиляции могут быть заданы одним из следующих способов.  
  
-   В **Конструкторе проектов**  
  
-   В командной строке при работе с компилятором командной строки  
  
-   В коде  
  
 Константы условной компиляции находятся в отдельной области и недоступны из обычного кода.  Область действия констант условной компиляции зависит от способа их задания.  В следующей таблице приведен список областей действия констант, объявленных при помощи каждого из трех описанных выше методов.  
  
|||  
|-|-|  
|Способ задания константы|Область действия константы|  
|**Конструктор проектов**|Открыта для всех файлов в проекте|  
|Командная строка|Открыта для всех файлов, переданных компилятору командной строки|  
|Инструкция `#Const` в коде|Открыта только для файла, в котором объявлена|  
  
||  
|-|  
|Чтобы задать константы через конструктор проектов|  
|-   До создания исполняемого файла установите константы в **Конструкторе проектов** согласно указаниям, приведенным в разделе [Практическое руководство. Изменение свойств проекта и параметров конфигурации](http://msdn.microsoft.com/ru-ru/e7184bc5-2f2b-4b4f-aa9a-3ecfcbc48b67).|  
  
||  
|-|  
|Для задания констант в командной строке выполните следующие действия|  
|-   С помощью параметра **\/d** вставьте константы условной компиляции, как показано в следующем примере:<br />     `vbc MyProj.vb /d:conFrenchVersion=–1:conANSI=0`<br />     Между параметром **\/d** и первой константой не должно быть пробела.  Дополнительные сведения см. в разделе [\/define](../../../visual-basic/reference/command-line-compiler/define.md).<br />     Объявления из командной строки переопределяют объявления в **Конструкторе проектов**, но не удаляют их.  Аргументы в **Конструкторе проектов** остаются в силе для последующих компиляций.<br />     При описании констант непосредственно в самом коде не существует строгих правил по их расположению, однако их область действия ограничивается модулем, в котором они объявлены.|  
  
||  
|-|  
|Для задания констант в вашем коде выполните следующие действия|  
|-   Поместите константы в блок объявлений того модуля, где они используются.  Это позволяет структурировать код и облегчить его чтение.|  
  
## Связанные разделы  
  
|||  
|-|-|  
|Заголовок|Описание|  
|[Соглашения о структуре программы и коде](../../../visual-basic/programming-guide/program-structure/program-structure-and-code-conventions.md)|Рекомендации по упрощению чтения и использования кода.|  
  
## Ссылки  
 [Директива \#Const](../../../visual-basic/language-reference/directives/const-directive.md)  
  
 [Директивы \#If...Then...\#Else](../../../visual-basic/language-reference/directives/if-then-else-directives.md)  
  
 [\/define](../../../visual-basic/reference/command-line-compiler/define.md)