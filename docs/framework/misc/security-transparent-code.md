---
title: Прозрачный для системы безопасности код
ms.date: 03/30/2017
helpviewer_keywords:
- transparent code
- security-transparent code
ms.assetid: 4f3dd841-82f7-4659-aab0-6d2db2166c65
author: mairaw
ms.author: mairaw
ms.openlocfilehash: 6a491a87c896c76fa62f1702d1ef0e99fc404607
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
---
# <a name="security-transparent-code"></a><span data-ttu-id="cc146-102">Прозрачный для системы безопасности код</span><span class="sxs-lookup"><span data-stu-id="cc146-102">Security-Transparent Code</span></span>
<a name="top"></a>
[!INCLUDE[net_security_note](../../../includes/net-security-note-md.md)]  
  
 <span data-ttu-id="cc146-103">Система безопасности включает в себя три основных компонента, взаимодействующих друг с другом: песочницы, разрешения и компоненты обеспечения безопасности.</span><span class="sxs-lookup"><span data-stu-id="cc146-103">Security involves three interacting pieces: sandboxing, permissions, and enforcement.</span></span> <span data-ttu-id="cc146-104">Технология песочниц включает в себя процесс создания изолированных доменов, в которых определенный код рассматривается как код с полным доверием, а другой код ограничивается набором разрешений, предоставленных песочнице.</span><span class="sxs-lookup"><span data-stu-id="cc146-104">Sandboxing refers to the practice of creating isolated domains where some code is treated as fully trusted and other code is restricted to the permissions in the grant set for the sandbox.</span></span> <span data-ttu-id="cc146-105">Код приложения, выполняемый с набором прав песочницы, считается прозрачным (то есть неспособным выполнять действия, влияющие на безопасность).</span><span class="sxs-lookup"><span data-stu-id="cc146-105">The application code that runs within the grant set of the sandbox is considered to be transparent; that is, it cannot perform any operations that can affect security.</span></span> <span data-ttu-id="cc146-106">Набор прав, предоставленных песочнице, определяется свидетельством (класс <xref:System.Security.Policy.Evidence>).</span><span class="sxs-lookup"><span data-stu-id="cc146-106">The grant set for the sandbox is determined by evidence (<xref:System.Security.Policy.Evidence> class).</span></span> <span data-ttu-id="cc146-107">Свидетельство определяет разрешения, необходимые для песочниц, а также возможные типы создаваемых песочниц.</span><span class="sxs-lookup"><span data-stu-id="cc146-107">Evidence identifies what specific permissions are required by sandboxes, and what kinds of sandboxes can be created.</span></span> <span data-ttu-id="cc146-108">Технологии обеспечения безопасности позволяют прозрачному коду выполнять только те действия, которые соответствуют набору предоставленных прав.</span><span class="sxs-lookup"><span data-stu-id="cc146-108">Enforcement refers to allowing transparent code to execute only within its grant set.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="cc146-109">Политика безопасности была ключевым элементом в предыдущих версиях платформы .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="cc146-109">Security policy was a key element in previous versions of the .NET Framework.</span></span> <span data-ttu-id="cc146-110">Начиная с [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)], политика безопасности считается устаревшей.</span><span class="sxs-lookup"><span data-stu-id="cc146-110">Starting with the [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)], security policy is obsolete.</span></span> <span data-ttu-id="cc146-111">Устранение политики безопасности выполняется независимо от прозрачности безопасности.</span><span class="sxs-lookup"><span data-stu-id="cc146-111">The elimination of security policy is separate from security transparency.</span></span> <span data-ttu-id="cc146-112">Сведения о последствиях этого изменения см. в разделе [совместимость политики разграничения доступа кода и миграции](../../../docs/framework/misc/code-access-security-policy-compatibility-and-migration.md).</span><span class="sxs-lookup"><span data-stu-id="cc146-112">For information about the effects of this change, see [Code Access Security Policy Compatibility and Migration](../../../docs/framework/misc/code-access-security-policy-compatibility-and-migration.md).</span></span>  
  
 <span data-ttu-id="cc146-113">В этом разделе подробно описывается модель прозрачности.</span><span class="sxs-lookup"><span data-stu-id="cc146-113">This topic describes the transparency model in more detail.</span></span> <span data-ttu-id="cc146-114">Он содержит следующие подразделы:</span><span class="sxs-lookup"><span data-stu-id="cc146-114">It contains the following sections:</span></span>  
  
-   [<span data-ttu-id="cc146-115">Назначение модели прозрачности</span><span class="sxs-lookup"><span data-stu-id="cc146-115">Purpose of the Transparency Model</span></span>](#purpose)  
  
-   [<span data-ttu-id="cc146-116">Указание уровня прозрачности</span><span class="sxs-lookup"><span data-stu-id="cc146-116">Specifying the Transparency Level</span></span>](#level)  
  
-   [<span data-ttu-id="cc146-117">Обеспечение прозрачности</span><span class="sxs-lookup"><span data-stu-id="cc146-117">Transparency Enforcement</span></span>](#enforcement)  
  
<a name="purpose"></a>   
## <a name="purpose-of-the-transparency-model"></a><span data-ttu-id="cc146-118">Назначение модели прозрачности</span><span class="sxs-lookup"><span data-stu-id="cc146-118">Purpose of the Transparency Model</span></span>  
 <span data-ttu-id="cc146-119">Прозрачность — это механизм обеспечения безопасности, который отделяет код, выполняемый в рамках приложения, от кода, выполняемого в рамках инфраструктуры.</span><span class="sxs-lookup"><span data-stu-id="cc146-119">Transparency is an enforcement mechanism that separates code that runs as part of the application from code that runs as part of the infrastructure.</span></span> <span data-ttu-id="cc146-120">Технология прозрачности разделяет код, которому разрешено выполнять привилегированные действия (критически важный код, например вызов машинного кода), и код, не имеющий такого разрешения (прозрачный код).</span><span class="sxs-lookup"><span data-stu-id="cc146-120">Transparency draws a barrier between code that can do privileged things (critical code), such as calling native code, and code that cannot (transparent code).</span></span> <span data-ttu-id="cc146-121">Прозрачный код может выполнять команды в рамках используемого набора разрешений, но не может выполнять и содержать критический код, а также быть образованным от него.</span><span class="sxs-lookup"><span data-stu-id="cc146-121">Transparent code can execute commands within the bounds of the permission set it is operating in, but cannot execute, derive from, or contain critical code.</span></span>  
  
 <span data-ttu-id="cc146-122">Основной целью функции прозрачности является обеспечение простого и эффективного механизма для изоляции различных групп кода на основе привилегий.</span><span class="sxs-lookup"><span data-stu-id="cc146-122">The primary goal of transparency enforcement is to provide a simple, effective mechanism for isolating different groups of code based on privilege.</span></span> <span data-ttu-id="cc146-123">В контексте модели песочницы такие группы привилегий имеют полное доверие (то есть не ограничены) или частичное доверие (то есть ограничены набором разрешений, предоставленных песочнице).</span><span class="sxs-lookup"><span data-stu-id="cc146-123">Within the context of the sandboxing model, these privilege groups are either fully trusted (that is, not restricted) or partially trusted (that is, restricted to the permission set granted to the sandbox).</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="cc146-124">Модель прозрачности служит не только для управления доступом для кода.</span><span class="sxs-lookup"><span data-stu-id="cc146-124">The transparency model transcends code access security.</span></span> <span data-ttu-id="cc146-125">Прозрачность обеспечивается JIT-компилятором и действует вне зависимости от набора прав, предоставленного сборке (включая полное доверие).</span><span class="sxs-lookup"><span data-stu-id="cc146-125">Transparency is enforced by the just-in-time compiler and remains in effect regardless of the grant set for an assembly, including full trust.</span></span>  
  
 <span data-ttu-id="cc146-126">Прозрачность появилась в .NET Framework версии 2.0 для упрощения модели безопасности и для облегчения создания и развертывания безопасных библиотек и приложений.</span><span class="sxs-lookup"><span data-stu-id="cc146-126">Transparency was introduced in the .NET Framework version 2.0 to simplify the security model, and to make it easier to write and deploy secure libraries and applications.</span></span> <span data-ttu-id="cc146-127">Прозрачный код также используется в Microsoft Silverlight для упрощения разработки приложений с частичным доверием.</span><span class="sxs-lookup"><span data-stu-id="cc146-127">Transparent code is also used in Microsoft Silverlight, to simplify the development of partially trusted applications.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="cc146-128">При разработке частично доверенного приложения следует помнить о требованиях безопасности для целевых узлов.</span><span class="sxs-lookup"><span data-stu-id="cc146-128">When you develop a partially trusted application, you have to be aware of the permission requirements for your target hosts.</span></span> <span data-ttu-id="cc146-129">Вы можете создать приложение, использующее ресурсы, не разрешенные некоторыми узлами.</span><span class="sxs-lookup"><span data-stu-id="cc146-129">You can develop an application that uses resources that are not allowed by some hosts.</span></span> <span data-ttu-id="cc146-130">Компиляция приложения пройдет без ошибок, но при его загрузке в размещенную среду возникнет ошибка.</span><span class="sxs-lookup"><span data-stu-id="cc146-130">This application will compile without error, but will fail when it is loaded into the hosted environment.</span></span> <span data-ttu-id="cc146-131">Если приложение создано с помощью Visual Studio, вы можете включить отладку в режиме частичного доверия или с ограниченным набором разрешений из среды разработки.</span><span class="sxs-lookup"><span data-stu-id="cc146-131">If you have developed your application using Visual Studio, you can enable debugging in partial trust or in a restricted permission set from the development environment.</span></span> <span data-ttu-id="cc146-132">Для получения дополнительной информации см. [Практическое руководство. Отладка ClickOnce-приложения с ограниченными разрешениями](/visualstudio/deployment/how-to-debug-a-clickonce-application-with-restricted-permissions).</span><span class="sxs-lookup"><span data-stu-id="cc146-132">For more information, see [How to: Debug a ClickOnce Application with Restricted Permissions](/visualstudio/deployment/how-to-debug-a-clickonce-application-with-restricted-permissions).</span></span> <span data-ttu-id="cc146-133">Функция вычисления разрешений, предоставляемая для приложений ClickOnce, также доступна для любого приложения с частичным доверием.</span><span class="sxs-lookup"><span data-stu-id="cc146-133">The Calculate Permissions feature provided for ClickOnce applications is also available for any partially trusted application.</span></span>  
  
 [<span data-ttu-id="cc146-134">К началу</span><span class="sxs-lookup"><span data-stu-id="cc146-134">Back to top</span></span>](#top)  
  
<a name="level"></a>   
## <a name="specifying-the-transparency-level"></a><span data-ttu-id="cc146-135">Указание уровня прозрачности</span><span class="sxs-lookup"><span data-stu-id="cc146-135">Specifying the Transparency Level</span></span>  
 <span data-ttu-id="cc146-136">Атрибут уровня сборки <xref:System.Security.SecurityRulesAttribute> явным образом выбирает правила <xref:System.Security.SecurityRuleSet>, которым будет следовать сборка.</span><span class="sxs-lookup"><span data-stu-id="cc146-136">The assembly-level <xref:System.Security.SecurityRulesAttribute> attribute explicitly selects the <xref:System.Security.SecurityRuleSet> rules that the assembly will follow.</span></span> <span data-ttu-id="cc146-137">Правила организованы в многоуровневую систему, где более высокий уровень обеспечивает более строгое применение правил безопасности.</span><span class="sxs-lookup"><span data-stu-id="cc146-137">The rules are organized under a numeric level system, where higher levels mean tighter enforcement of security rules.</span></span>  
  
 <span data-ttu-id="cc146-138">Возможны следующие уровни:</span><span class="sxs-lookup"><span data-stu-id="cc146-138">The levels are as follows:</span></span>  
  
-   <span data-ttu-id="cc146-139">уровень 2 (<xref:System.Security.SecurityRuleSet.Level2>) — правила прозрачности [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)];</span><span class="sxs-lookup"><span data-stu-id="cc146-139">Level 2 (<xref:System.Security.SecurityRuleSet.Level2>) – the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)] transparency rules.</span></span>  
  
-   <span data-ttu-id="cc146-140">уровень 1 (<xref:System.Security.SecurityRuleSet.Level1>) — правила прозрачности .NET Framework 2.0.</span><span class="sxs-lookup"><span data-stu-id="cc146-140">Level 1 (<xref:System.Security.SecurityRuleSet.Level1>) – the .NET Framework 2.0 transparency rules.</span></span>  
  
 <span data-ttu-id="cc146-141">Основным различием между двумя уровнями безопасности является то, что уровень 1 не применяет правила безопасности для вызовов извне и предназначен только для обеспечения совместимости.</span><span class="sxs-lookup"><span data-stu-id="cc146-141">The primary difference between the two transparency levels is that level 1 does not enforce transparency rules for calls from outside the assembly and is intended only for compatibility.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="cc146-142">Прозрачность уровня 1 следует указывать только для совместимости, то есть уровень 1 следует задавать только для кода, разработанного на платформе .NET Framework 3.5 или более ранней версии и использующего атрибут <xref:System.Security.AllowPartiallyTrustedCallersAttribute> или не использующего модель прозрачности.</span><span class="sxs-lookup"><span data-stu-id="cc146-142">You should specify level 1 transparency for compatibility only; that is, specify level 1 only for code that was developed with the .NET Framework 3.5 or earlier that uses the <xref:System.Security.AllowPartiallyTrustedCallersAttribute> attribute or does not use the transparency model.</span></span> <span data-ttu-id="cc146-143">Например, используйте прозрачность уровня 1 для сборок .NET Framework 2.0, которые допускают вызовы из частично доверенных вызывающих объектов (APTCA).</span><span class="sxs-lookup"><span data-stu-id="cc146-143">For example, use level 1 transparency for .NET Framework 2.0 assemblies that allow calls from partially trusted callers (APTCA).</span></span> <span data-ttu-id="cc146-144">Для кода, разработанного для [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)], следует использовать прозрачность уровня 2.</span><span class="sxs-lookup"><span data-stu-id="cc146-144">For code that is developed for the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)], always use level 2 transparency.</span></span>  
  
### <a name="level-2-transparency"></a><span data-ttu-id="cc146-145">Прозрачность уровня 2</span><span class="sxs-lookup"><span data-stu-id="cc146-145">Level 2 Transparency</span></span>  
 <span data-ttu-id="cc146-146">Прозрачность уровня 2 появилась в версии [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cc146-146">Level 2 transparency was introduced in the [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)].</span></span> <span data-ttu-id="cc146-147">Ключевыми элементами этой модели являются следующие компоненты: прозрачный код, надежный с точки зрения безопасности код и критический с точки зрения безопасности код.</span><span class="sxs-lookup"><span data-stu-id="cc146-147">The three tenets of this model are transparent code, security-safe-critical code, and security-critical code.</span></span>  
  
-   <span data-ttu-id="cc146-148">Прозрачный код (вне зависимости от предоставленных разрешений, в том числе код с полным доверием) может вызывать только другой прозрачный или надежный с точки зрения безопасности код.</span><span class="sxs-lookup"><span data-stu-id="cc146-148">Transparent code, regardless of the permissions it is granted (including full trust), can call only other transparent code or security-safe-critical code.</span></span> <span data-ttu-id="cc146-149">Если код имеет частичное доверие, то он может выполнять только действия, разрешенные набором разрешений домена.</span><span class="sxs-lookup"><span data-stu-id="cc146-149">If the code is partially trusted, it can only perform actions that are allowed by the domain’s permission set.</span></span> <span data-ttu-id="cc146-150">Прозрачный код не может выполнять следующие действия:</span><span class="sxs-lookup"><span data-stu-id="cc146-150">Transparent code cannot do the following:</span></span>  
  
    -   <span data-ttu-id="cc146-151">выполнять операцию <xref:System.Security.CodeAccessPermission.Assert%2A> или повышение привилегий;</span><span class="sxs-lookup"><span data-stu-id="cc146-151">Perform an <xref:System.Security.CodeAccessPermission.Assert%2A> operation or elevation of privilege.</span></span>  
  
    -   <span data-ttu-id="cc146-152">содержать небезопасный или непроверяемый код;</span><span class="sxs-lookup"><span data-stu-id="cc146-152">Contain unsafe or unverifiable code.</span></span>  
  
    -   <span data-ttu-id="cc146-153">напрямую вызывать критический код;</span><span class="sxs-lookup"><span data-stu-id="cc146-153">Directly call critical code.</span></span>  
  
    -   <span data-ttu-id="cc146-154">вызывать машинный код или код с атрибутом <xref:System.Security.SuppressUnmanagedCodeSecurityAttribute>;</span><span class="sxs-lookup"><span data-stu-id="cc146-154">Call native code or code that has the <xref:System.Security.SuppressUnmanagedCodeSecurityAttribute> attribute.</span></span>  
  
    -   <span data-ttu-id="cc146-155">вызывать член, защищенный с помощью <xref:System.Security.Permissions.SecurityAction.LinkDemand>;</span><span class="sxs-lookup"><span data-stu-id="cc146-155">Call a member that is protected by a <xref:System.Security.Permissions.SecurityAction.LinkDemand>.</span></span>  
  
    -   <span data-ttu-id="cc146-156">наследовать от критических типов.</span><span class="sxs-lookup"><span data-stu-id="cc146-156">Inherit from critical types.</span></span>  
  
     <span data-ttu-id="cc146-157">Кроме того, прозрачные методы не могут переопределять критические виртуальные методы или реализовывать критические методы интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="cc146-157">In addition, transparent methods cannot override critical virtual methods or implement critical interface methods.</span></span>  
  
-   <span data-ttu-id="cc146-158">Надежный с точки зрения безопасности код имеет полное доверие, но может вызываться прозрачным кодом.</span><span class="sxs-lookup"><span data-stu-id="cc146-158">Security-safe-critical code is fully trusted but is callable by transparent code.</span></span> <span data-ttu-id="cc146-159">Он предоставляет ограниченный объем кода с полным доверием.</span><span class="sxs-lookup"><span data-stu-id="cc146-159">It exposes a limited surface area of full-trust code.</span></span> <span data-ttu-id="cc146-160">В надежном с точки зрения безопасности коде выполняются проверки на правильность и безопасность.</span><span class="sxs-lookup"><span data-stu-id="cc146-160">Correctness and security verifications happen in safe-critical code.</span></span>  
  
-   <span data-ttu-id="cc146-161">Критический с точки зрения безопасности код может вызывать любой код, но не может вызываться из прозрачного кода.</span><span class="sxs-lookup"><span data-stu-id="cc146-161">Security-critical code can call any code and is fully trusted, but it cannot be called by transparent code.</span></span>  
  
### <a name="level-1-transparency"></a><span data-ttu-id="cc146-162">Прозрачность уровня 1</span><span class="sxs-lookup"><span data-stu-id="cc146-162">Level 1 Transparency</span></span>  
 <span data-ttu-id="cc146-163">Модель прозрачности уровня 1 появилась в .NET Framework версии 2.0 и позволяла разработчикам сократить объем кода, требующего аудита безопасности.</span><span class="sxs-lookup"><span data-stu-id="cc146-163">The level 1 transparency model was introduced in the .NET Framework version 2.0 to enable developers to reduce the amount of code that is subject to a security audit.</span></span> <span data-ttu-id="cc146-164">Несмотря на то, что прозрачность уровня 1 стала общедоступной в версии 2.0, она в основном использовалась только в корпорации Майкрософт для аудита безопасности.</span><span class="sxs-lookup"><span data-stu-id="cc146-164">Although level 1 transparency was publicly available in version 2.0, it was primarily used only within Microsoft for security auditing purposes.</span></span> <span data-ttu-id="cc146-165">Заметки позволяют разработчикам объявлять типы и члены, которые могут повышать уровень разрешений и выполнять другие доверенные (критические с точки зрения безопасности) действия, а также типы и члены, которые не могут выполнять такие действия (прозрачные с точки зрения безопасности).</span><span class="sxs-lookup"><span data-stu-id="cc146-165">Through annotations, developers are able to declare which types and members can perform security elevations and other trusted actions (security-critical) and which cannot (security-transparent).</span></span> <span data-ttu-id="cc146-166">Код, определенный как прозрачный, не требует подробного аудита безопасности.</span><span class="sxs-lookup"><span data-stu-id="cc146-166">Code that is identified as transparent does not require a high degree of security auditing.</span></span> <span data-ttu-id="cc146-167">Прозрачность уровня 1 ограничивает применение прозрачности пределами сборки.</span><span class="sxs-lookup"><span data-stu-id="cc146-167">Level 1 transparency states that the transparency enforcement is limited to within the assembly.</span></span> <span data-ttu-id="cc146-168">Другими словами, все открытые типы или члены, которые считаются критическими с точки зрения безопасности, являются таковыми только в пределах сборки.</span><span class="sxs-lookup"><span data-stu-id="cc146-168">In other words, any public types or members that are identified as security-critical are security-critical only within the assembly.</span></span> <span data-ttu-id="cc146-169">Чтобы обеспечить безопасность для этих типов и членов, когда они вызываются извне, необходимо использовать запросы компоновки с полным доверием.</span><span class="sxs-lookup"><span data-stu-id="cc146-169">If you want to enforce security for those types and members when they are called from outside the assembly, you must use link demands for full trust.</span></span> <span data-ttu-id="cc146-170">В противном случае открытые видимые критические типы и члены рассматриваются как надежные с точки зрения безопасности и могут вызываться частично доверенным кодом вне сборки.</span><span class="sxs-lookup"><span data-stu-id="cc146-170">If you do not, publicly visible security-critical types and members are treated as security-safe-critical and can be called by partially trusted code outside the assembly.</span></span>  
  
 <span data-ttu-id="cc146-171">Модель прозрачности уровня 1 имеет перечисленные ниже ограничения.</span><span class="sxs-lookup"><span data-stu-id="cc146-171">The level 1 transparency model has the following limitations:</span></span>  
  
-   <span data-ttu-id="cc146-172">Открытые критические с точки зрения безопасности типы и члены доступны из прозрачного с точки зрения безопасности кода.</span><span class="sxs-lookup"><span data-stu-id="cc146-172">Security-critical types and members that are public are accessible from security-transparent code.</span></span>  
  
-   <span data-ttu-id="cc146-173">Заметки прозрачности применяются только внутри сборки.</span><span class="sxs-lookup"><span data-stu-id="cc146-173">The transparency annotations are enforced only within an assembly.</span></span>  
  
-   <span data-ttu-id="cc146-174">Критические типы и члены должны использовать запросы компоновки для обеспечения безопасности при вызовах извне.</span><span class="sxs-lookup"><span data-stu-id="cc146-174">Security-critical types and members must use link demands to enforce security for calls from outside the assembly.</span></span>  
  
-   <span data-ttu-id="cc146-175">Правила наследования не применяются.</span><span class="sxs-lookup"><span data-stu-id="cc146-175">Inheritance rules are not enforced.</span></span>  
  
-   <span data-ttu-id="cc146-176">Прозрачный код потенциально способен выполнить вредоносные действия при его запуске с полным доверием.</span><span class="sxs-lookup"><span data-stu-id="cc146-176">The potential exists for transparent code to do harmful things when run in full trust.</span></span>  
  
 [<span data-ttu-id="cc146-177">К началу</span><span class="sxs-lookup"><span data-stu-id="cc146-177">Back to top</span></span>](#top)  
  
<a name="enforcement"></a>   
## <a name="transparency-enforcement"></a><span data-ttu-id="cc146-178">Обеспечение прозрачности</span><span class="sxs-lookup"><span data-stu-id="cc146-178">Transparency Enforcement</span></span>  
 <span data-ttu-id="cc146-179">Правила прозрачности не применяются до вычисления прозрачности.</span><span class="sxs-lookup"><span data-stu-id="cc146-179">Transparency rules are not enforced until transparency is calculated.</span></span> <span data-ttu-id="cc146-180">При нарушении правила прозрачности возникает исключение <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="cc146-180">At that time, an <xref:System.InvalidOperationException> is thrown if a transparency rule is violated.</span></span> <span data-ttu-id="cc146-181">Время расчета прозрачности зависит от различных факторов и не может быть предсказано заранее.</span><span class="sxs-lookup"><span data-stu-id="cc146-181">The time that transparency is calculated depends on multiple factors and cannot be predicted.</span></span> <span data-ttu-id="cc146-182">Расчет происходит в последний возможный момент.</span><span class="sxs-lookup"><span data-stu-id="cc146-182">It is calculated as late as possible.</span></span> <span data-ttu-id="cc146-183">В версии [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)] расчет прозрачности на уровне сборки выполняется раньше, чем в платформе .NET Framework 2.0.</span><span class="sxs-lookup"><span data-stu-id="cc146-183">In the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)], assembly-level transparency calculation occurs sooner than it does in the .NET Framework 2.0.</span></span> <span data-ttu-id="cc146-184">Гарантируется только то, что расчет прозрачности будет выполнен к тому моменту, когда он понадобится.</span><span class="sxs-lookup"><span data-stu-id="cc146-184">The only guarantee is that transparency calculation will occur by the time it is needed.</span></span> <span data-ttu-id="cc146-185">Этот похоже на то, как JIT-компилятор изменяет момент компиляции метода и обнаружения всех ошибок в нем.</span><span class="sxs-lookup"><span data-stu-id="cc146-185">This is similar to how the just-in-time (JIT) compiler can change the point when a method is compiled and any errors in that method are detected.</span></span> <span data-ttu-id="cc146-186">Расчет прозрачности выполняется без внешних проявлений, если в коде нет ошибок прозрачности.</span><span class="sxs-lookup"><span data-stu-id="cc146-186">Transparency calculation is invisible if your code does not have any transparency errors.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="cc146-187">См. также</span><span class="sxs-lookup"><span data-stu-id="cc146-187">See Also</span></span>  
 [<span data-ttu-id="cc146-188">Прозрачный с точки зрения безопасности код, уровень 1</span><span class="sxs-lookup"><span data-stu-id="cc146-188">Security-Transparent Code, Level 1</span></span>](../../../docs/framework/misc/security-transparent-code-level-1.md)  
 [<span data-ttu-id="cc146-189">Прозрачный с точки зрения безопасности код, уровень 2</span><span class="sxs-lookup"><span data-stu-id="cc146-189">Security-Transparent Code, Level 2</span></span>](../../../docs/framework/misc/security-transparent-code-level-2.md)
