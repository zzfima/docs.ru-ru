---
title: Реализация поставщика автоматизации пользовательского интерфейса на стороне сервера
ms.date: 03/30/2017
helpviewer_keywords:
- server-side UI Automation provider implementation
- UI Automation, server-side provider implementation
- provider implementation, UI Automation
ms.assetid: 6acc6d08-bd67-4e2e-915c-9c1d34eb86fe
ms.openlocfilehash: 25f22d5e8caacc69643f6d79e109ebaa94159d80
ms.sourcegitcommit: 7bc6887ab658550baa78f1520ea735838249345e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/03/2020
ms.locfileid: "75632321"
---
# <a name="server-side-ui-automation-provider-implementation"></a><span data-ttu-id="1f9fd-102">Реализация поставщика автоматизации пользовательского интерфейса на стороне сервера</span><span class="sxs-lookup"><span data-stu-id="1f9fd-102">Server-Side UI Automation Provider Implementation</span></span>

> [!NOTE]
> <span data-ttu-id="1f9fd-103">Эта документация предназначена для разработчиков .NET Framework, желающих использовать управляемые классы [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] , заданные в пространстве имен <xref:System.Windows.Automation> .</span><span class="sxs-lookup"><span data-stu-id="1f9fd-103">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="1f9fd-104">Последние сведения о [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]см. в разделе [API автоматизации Windows. Автоматизация пользовательского интерфейса](/windows/win32/winauto/entry-uiauto-win32).</span><span class="sxs-lookup"><span data-stu-id="1f9fd-104">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>

<span data-ttu-id="1f9fd-105">В этом разделе описывается реализация серверного поставщика автоматизации пользовательского интерфейса для пользовательского элемента управления.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-105">This section describes how to implement a server-side UI Automation provider for a custom control.</span></span>

<span data-ttu-id="1f9fd-106">Реализация для элементов Windows Presentation Foundation (WPF) и элементов, отличных от WPF (например, разработанных для [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)]), является принципиально отличающимся.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-106">The implementation for Windows Presentation Foundation (WPF) elements and non-WPF elements (such as those designed for [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)]) is fundamentally different.</span></span> <span data-ttu-id="1f9fd-107">Элементы WPF обеспечивают поддержку [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] через класс, производный от <xref:System.Windows.Automation.Peers.AutomationPeer>.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-107">WPF elements provide support for [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] through a class derived from <xref:System.Windows.Automation.Peers.AutomationPeer>.</span></span> <span data-ttu-id="1f9fd-108">Элементы, не являющиеся элементами WPF, обеспечивают поддержку через реализации интерфейсов поставщиков.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-108">Non-WPF elements provide support through implementations of provider interfaces.</span></span>

<a name="Security_Considerations"></a>

## <a name="security-considerations"></a><span data-ttu-id="1f9fd-109">Вопросы безопасности</span><span class="sxs-lookup"><span data-stu-id="1f9fd-109">Security Considerations</span></span>

<span data-ttu-id="1f9fd-110">Поставщики должны быть написаны так, чтобы они могли работать в среде с частичным доверием.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-110">Providers should be written so that they can work in a partial-trust environment.</span></span> <span data-ttu-id="1f9fd-111">Поскольку библиотека UIAutomationClient.dll не настроена для запуска в режиме частичного доверия, код поставщика не должен ссылаться эту сборку.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-111">Because UIAutomationClient.dll is not configured to run under partial trust, your provider code should not reference that assembly.</span></span> <span data-ttu-id="1f9fd-112">Если это происходит, код может выполняться в среде с полным доверием, но в среде с частичным доверием произойдет сбой.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-112">If it does so, the code may run in a full-trust environment but then fail in a partial-trust environment.</span></span>

<span data-ttu-id="1f9fd-113">В частности, не используйте поля из классов в UIAutomationClient.dll, такие как в <xref:System.Windows.Automation.AutomationElement>.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-113">In particular, do not use fields from classes in UIAutomationClient.dll such as those in <xref:System.Windows.Automation.AutomationElement>.</span></span> <span data-ttu-id="1f9fd-114">Вместо этого используйте эквивалентные поля из классов в UIAutomationTypes.dll, такие как <xref:System.Windows.Automation.AutomationElementIdentifiers>.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-114">Instead, use the equivalent fields from classes in UIAutomationTypes.dll, such as <xref:System.Windows.Automation.AutomationElementIdentifiers>.</span></span>

<a name="Provider_Implementation_by_WPF_Elements"></a>

## <a name="provider-implementation-by-windows-presentation-foundation-elements"></a><span data-ttu-id="1f9fd-115">Реализация поставщика элементами Windows Presentation Foundation</span><span class="sxs-lookup"><span data-stu-id="1f9fd-115">Provider Implementation by Windows Presentation Foundation Elements</span></span>

<span data-ttu-id="1f9fd-116">Дополнительные сведения по этой теме см. в разделе [Модель автоматизации пользовательского интерфейса пользовательского элемента управления WPF](../wpf/controls/ui-automation-of-a-wpf-custom-control.md).</span><span class="sxs-lookup"><span data-stu-id="1f9fd-116">For more information on this topic, please see [UI Automation of a WPF Custom Control](../wpf/controls/ui-automation-of-a-wpf-custom-control.md).</span></span>

<a name="Provider_Implementation_by_non_WPF_Elements"></a>

## <a name="provider-implementation-by-non-wpf-elements"></a><span data-ttu-id="1f9fd-117">Реализация поставщика элементами, отличными от WPF</span><span class="sxs-lookup"><span data-stu-id="1f9fd-117">Provider Implementation by non-WPF Elements</span></span>

<span data-ttu-id="1f9fd-118">Пользовательские элементы управления, которые не являются частью платформы WPF, но написаны в управляемом коде (чаще всего это [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)] элементы управления), обеспечивают поддержку [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] путем реализации интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-118">Custom controls that are not part of the WPF framework, but that are written in managed code (most often these are [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)] controls), provide support for [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] by implementing interfaces.</span></span> <span data-ttu-id="1f9fd-119">Каждый элемент должен реализовывать по крайней мере один из интерфейсов, перечисленных в первой таблице в следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-119">Every element must implement at least one of the interfaces listed in the first table in the next section.</span></span> <span data-ttu-id="1f9fd-120">Кроме того, если элемент поддерживает один или несколько шаблонов элементов управления, он должен реализовать соответствующий интерфейс для каждого шаблона элемента управления.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-120">In addition, if the element supports one or more control patterns, it must implement the appropriate interface for each control pattern.</span></span>

<span data-ttu-id="1f9fd-121">Проект поставщика [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] должен содержать ссылки на следующие сборки:</span><span class="sxs-lookup"><span data-stu-id="1f9fd-121">Your [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] provider project must reference the following assemblies:</span></span>

- <span data-ttu-id="1f9fd-122">UIAutomationProviders.dll</span><span class="sxs-lookup"><span data-stu-id="1f9fd-122">UIAutomationProviders.dll</span></span>

- <span data-ttu-id="1f9fd-123">UIAutomationTypes.dll</span><span class="sxs-lookup"><span data-stu-id="1f9fd-123">UIAutomationTypes.dll</span></span>

- <span data-ttu-id="1f9fd-124">WindowsBase.dll</span><span class="sxs-lookup"><span data-stu-id="1f9fd-124">WindowsBase.dll</span></span>

<a name="Provider_Interfaces"></a>

### <a name="provider-interfaces"></a><span data-ttu-id="1f9fd-125">Интерфейсы поставщика</span><span class="sxs-lookup"><span data-stu-id="1f9fd-125">Provider Interfaces</span></span>

<span data-ttu-id="1f9fd-126">Каждый поставщик [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] должен реализовывать один из следующих интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-126">Every [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] provider must implement one of the following interfaces.</span></span>

|<span data-ttu-id="1f9fd-127">Интерфейс</span><span class="sxs-lookup"><span data-stu-id="1f9fd-127">Interface</span></span>|<span data-ttu-id="1f9fd-128">Описание</span><span class="sxs-lookup"><span data-stu-id="1f9fd-128">Description</span></span>|
|---------------|-----------------|
|<xref:System.Windows.Automation.Provider.IRawElementProviderSimple>|<span data-ttu-id="1f9fd-129">Предоставляет функциональные возможности для простого элемента управления, размещенного в окне, включая поддержку для шаблонов и свойств элементов управления.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-129">Provides functionality for a simple control hosted in a window, including support for control patterns and properties.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderFragment>|<span data-ttu-id="1f9fd-130">Наследует от <xref:System.Windows.Automation.Provider.IRawElementProviderSimple>.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-130">Inherits from <xref:System.Windows.Automation.Provider.IRawElementProviderSimple>.</span></span> <span data-ttu-id="1f9fd-131">Добавляет функциональные возможности для элемента в сложном элементе управления, включая навигацию внутри фрагмента, установку фокуса и возврат ограничивающего прямоугольника элемента.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-131">Adds functionality for an element in a complex control, including navigation within the fragment, setting focus, and returning the bounding rectangle of the element.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>|<span data-ttu-id="1f9fd-132">Наследует от <xref:System.Windows.Automation.Provider.IRawElementProviderFragment>.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-132">Inherits from <xref:System.Windows.Automation.Provider.IRawElementProviderFragment>.</span></span> <span data-ttu-id="1f9fd-133">Добавляет функциональные возможности для корневого элемента в сложном элементе управления, включая поиск дочернего элемента по указанным координатам и установку состояния фокуса для всего элемента управления.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-133">Adds functionality for the root element in a complex control, including locating a child element at specified coordinates and setting the focus state for the entire control.</span></span>|

<span data-ttu-id="1f9fd-134">Следующие интерфейсы поддерживают добавленные функциональные возможности, но необязательно должны быть реализованы.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-134">The following interfaces provide added functionality but are not required to be implemented.</span></span>

|<span data-ttu-id="1f9fd-135">Интерфейс</span><span class="sxs-lookup"><span data-stu-id="1f9fd-135">Interface</span></span>|<span data-ttu-id="1f9fd-136">Описание</span><span class="sxs-lookup"><span data-stu-id="1f9fd-136">Description</span></span>|
|---------------|-----------------|
|<xref:System.Windows.Automation.Provider.IRawElementProviderAdviseEvents>|<span data-ttu-id="1f9fd-137">Позволяет поставщику отслеживать запросы событий.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-137">Enables the provider to track requests for events.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride>|<span data-ttu-id="1f9fd-138">Позволяет изменять положение элементов на основе окна в дереве [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] фрагмента.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-138">Enables repositioning of window-based elements within the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree of a fragment.</span></span>|

<span data-ttu-id="1f9fd-139">Все другие интерфейсы в пространстве имен <xref:System.Windows.Automation.Provider> используются для поддержки шаблона элемента управления.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-139">All other interfaces in the <xref:System.Windows.Automation.Provider> namespace are for control pattern support.</span></span>

<a name="Requirements_for_Non_WPF_Providers"></a>

### <a name="requirements-for-non-wpf-providers"></a><span data-ttu-id="1f9fd-140">Требования для поставщиков, отличных от WPF</span><span class="sxs-lookup"><span data-stu-id="1f9fd-140">Requirements for Non-WPF Providers</span></span>

<span data-ttu-id="1f9fd-141">Для взаимодействия с [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]элемент управления должен реализовать следующие основные функциональные области:</span><span class="sxs-lookup"><span data-stu-id="1f9fd-141">In order to communicate with [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], your control must implement the following main areas of functionality:</span></span>

|<span data-ttu-id="1f9fd-142">Функция</span><span class="sxs-lookup"><span data-stu-id="1f9fd-142">Functionality</span></span>|<span data-ttu-id="1f9fd-143">Реализация</span><span class="sxs-lookup"><span data-stu-id="1f9fd-143">Implementation</span></span>|
|-------------------|--------------------|
|<span data-ttu-id="1f9fd-144">Предоставление поставщика для [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</span><span class="sxs-lookup"><span data-stu-id="1f9fd-144">Expose the provider to [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</span></span>|<span data-ttu-id="1f9fd-145">В ответ на сообщение WM_GETOBJECT, отправленное окну элемента управления, возвращается объект, реализующий <xref:System.Windows.Automation.Provider.IRawElementProviderSimple> (или производный интерфейс).</span><span class="sxs-lookup"><span data-stu-id="1f9fd-145">In response to a WM_GETOBJECT message sent to the control window, return the object that implements <xref:System.Windows.Automation.Provider.IRawElementProviderSimple> (or a derived interface).</span></span> <span data-ttu-id="1f9fd-146">Для фрагментов это должен быть поставщик для корневого фрагмента.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-146">For fragments, this must be the provider for the fragment root.</span></span>|
|<span data-ttu-id="1f9fd-147">Указание значений свойств</span><span class="sxs-lookup"><span data-stu-id="1f9fd-147">Provide property values</span></span>|<span data-ttu-id="1f9fd-148">Реализуйте <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPropertyValue%2A> для предоставления или переопределения значений.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-148">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPropertyValue%2A> to provide or override values.</span></span>|
|<span data-ttu-id="1f9fd-149">Включение клиента для взаимодействия с элементом управления</span><span class="sxs-lookup"><span data-stu-id="1f9fd-149">Enable the client to interact with the control</span></span>|<span data-ttu-id="1f9fd-150">Реализуйте интерфейсы, поддерживающие шаблоны элементов управления, такие как <xref:System.Windows.Automation.Provider.IInvokeProvider>.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-150">Implement interfaces that support control patterns, such as <xref:System.Windows.Automation.Provider.IInvokeProvider>.</span></span> <span data-ttu-id="1f9fd-151">Верните эти поставщики шаблонов в реализации <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPatternProvider%2A>.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-151">Return these pattern providers in your implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPatternProvider%2A>.</span></span>|
|<span data-ttu-id="1f9fd-152">Создание событий</span><span class="sxs-lookup"><span data-stu-id="1f9fd-152">Raise events</span></span>|<span data-ttu-id="1f9fd-153">Вызовите один из статических методов <xref:System.Windows.Automation.Provider.AutomationInteropProvider> , чтобы создать событие, которое клиент может прослушивать.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-153">Call one of the static methods of <xref:System.Windows.Automation.Provider.AutomationInteropProvider> to raise an event that a client can listen for.</span></span>|
|<span data-ttu-id="1f9fd-154">Включение навигации и установка фокуса внутри фрагмента</span><span class="sxs-lookup"><span data-stu-id="1f9fd-154">Enable navigation and focusing within a fragment</span></span>|<span data-ttu-id="1f9fd-155">Реализуйте <xref:System.Windows.Automation.Provider.IRawElementProviderFragment> для каждого элемента в фрагменте.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-155">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragment> for each element within the fragment.</span></span> <span data-ttu-id="1f9fd-156">(Необязательно для элементов, которые не являются частью фрагмента.)</span><span class="sxs-lookup"><span data-stu-id="1f9fd-156">(Not necessary for elements that are not part of a fragment.)</span></span>|
|<span data-ttu-id="1f9fd-157">Включение установки фокуса и поиска дочерних элементов в фрагменте</span><span class="sxs-lookup"><span data-stu-id="1f9fd-157">Enable focusing and location of child element in a fragment</span></span>|<span data-ttu-id="1f9fd-158">Реализуйте расширение <xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-158">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>.</span></span> <span data-ttu-id="1f9fd-159">(Необязательно для корневых элементов фрагмента.)</span><span class="sxs-lookup"><span data-stu-id="1f9fd-159">(Not necessary for elements that are not fragment roots.)</span></span>|

<a name="Property_Values_in_Non_WPF_Providers"></a>

### <a name="property-values-in-non-wpf-providers"></a><span data-ttu-id="1f9fd-160">Значения свойств в поставщиках, отличных от WPF</span><span class="sxs-lookup"><span data-stu-id="1f9fd-160">Property Values in Non-WPF Providers</span></span>

<span data-ttu-id="1f9fd-161">Поставщики[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] для пользовательских элементов управления должны поддерживать определенные свойства, которые могут использовать система автоматизации и клиентские приложения.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-161">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] providers for custom controls must support certain properties that can be used by the automation system as well as by client applications.</span></span> <span data-ttu-id="1f9fd-162">Для элементов, которые располагаются в окнах (HWND), [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] может получить некоторые свойства от поставщика окна по умолчанию, но другие необходимо получить от пользовательского поставщика.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-162">For elements that are hosted in windows (HWNDs), [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] can retrieve some properties from the default window provider, but must obtain others from the custom provider.</span></span>

<span data-ttu-id="1f9fd-163">Поставщикам для элементов управления на основе HWND обычно не требуется предоставлять следующие свойства (определяется значениями полей):</span><span class="sxs-lookup"><span data-stu-id="1f9fd-163">Providers for HWND based controls do not usually need to provide the following properties (identified by field values):</span></span>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.BoundingRectangleProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.ClickablePointProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.ProcessIdProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.ClassNameProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.HasKeyboardFocusProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.IsEnabledProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.IsPasswordProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty>

> [!NOTE]
> <span data-ttu-id="1f9fd-164">Простой элемент <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty> или корневой элемент фрагмента, размещенного в окне, извлекается из окна. Однако элементам фрагмента ниже корневого элемента (например, элементы списка в поле со списком) необходимо предоставлять собственные идентификаторы.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-164">The <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty> of a simple element or fragment root hosted in a window is obtained from the window; however, fragment elements below the root (such as list items in a list box) must provide their own identifiers.</span></span> <span data-ttu-id="1f9fd-165">Для получения дополнительной информации см. <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A>.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-165">For more information, see <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A>.</span></span>
>
> <span data-ttu-id="1f9fd-166">Для поставщиков, размещенных в элементе управления <xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty> , должен возвращаться [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="1f9fd-166">The <xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty> should be returned for providers hosted in a [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)] control.</span></span> <span data-ttu-id="1f9fd-167">В этом случае поставщику окна по умолчанию может не удастся получить правильное значение.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-167">In this case, the default window provider may be unable to retrieve the correct value.</span></span>
>
> <span data-ttu-id="1f9fd-168"><xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty> обычно предоставляется поставщиком главного окна.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-168">The <xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty> is usually supplied by the host provider.</span></span> <span data-ttu-id="1f9fd-169">Например, если пользовательский элемент управления является производным от <xref:System.Windows.Forms.Control>, имя будет производным от свойства `Text` элемента управления.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-169">For example, if a custom control is derived from <xref:System.Windows.Forms.Control>, the name is derived from the `Text` property of the control.</span></span>

<span data-ttu-id="1f9fd-170">Пример кода см. в разделе [Return Properties from a UI Automation Provider](return-properties-from-a-ui-automation-provider.md).</span><span class="sxs-lookup"><span data-stu-id="1f9fd-170">For example code, see [Return Properties from a UI Automation Provider](return-properties-from-a-ui-automation-provider.md).</span></span>

<a name="Events_in_Non_WPF_Providers"></a>

### <a name="events-in-non-wpf-providers"></a><span data-ttu-id="1f9fd-171">События в поставщиках, отличных от WPF</span><span class="sxs-lookup"><span data-stu-id="1f9fd-171">Events in Non-WPF Providers</span></span>

<span data-ttu-id="1f9fd-172">Поставщики[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] должны вызывать события, чтобы уведомлять клиентские приложения об изменениях состояния пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-172">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] providers should raise events to notify client applications of changes in the state of the UI.</span></span> <span data-ttu-id="1f9fd-173">Для создания событий используются следующие методы.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-173">The following methods are used to raise events.</span></span>

|<span data-ttu-id="1f9fd-174">Метод</span><span class="sxs-lookup"><span data-stu-id="1f9fd-174">Method</span></span>|<span data-ttu-id="1f9fd-175">Описание</span><span class="sxs-lookup"><span data-stu-id="1f9fd-175">Description</span></span>|
|------------|-----------------|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseAutomationEvent%2A>|<span data-ttu-id="1f9fd-176">Создает различные события, включая события, вызываемые шаблонами элементов управления.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-176">Raises various events, including events triggered by control patterns.</span></span>|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseAutomationPropertyChangedEvent%2A>|<span data-ttu-id="1f9fd-177">Вызывает событие при изменении свойства [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1f9fd-177">Raises an event when a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] property has changed.</span></span>|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseStructureChangedEvent%2A>|<span data-ttu-id="1f9fd-178">Вызывает событие при изменении структуры дерева [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] , например при удалении или добавлении элемента.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-178">Raises an event when the structure of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree has changed; for example, by the removal or addition of an element.</span></span>|

<span data-ttu-id="1f9fd-179">Событие предназначено для уведомления клиента о каких-то действиях, происходящих в [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)], независимо от того, инициируется ли действие самой системой [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="1f9fd-179">The purpose of an event is to notify the client of something taking place in the [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)], whether or not the activity is triggered by the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] system itself.</span></span> <span data-ttu-id="1f9fd-180">Например, событие, обозначенное <xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent> , должно инициироваться при каждом вызове элемента управления, например когда пользователь вводит данные или клиентское приложение вызывает <xref:System.Windows.Automation.InvokePattern.Invoke%2A>.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-180">For example, the event identified by <xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent> should be raised whenever the control is invoked, either through direct user input or by the client application calling <xref:System.Windows.Automation.InvokePattern.Invoke%2A>.</span></span>

<span data-ttu-id="1f9fd-181">Для оптимизации производительности поставщик можно выборочно вызывать события или вообще не создавать события, если отсутствует клиентское приложение, зарегистрированное для их получения.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-181">To optimize performance, a provider can selectively raise events, or raise no events at all if no client application is registered to receive them.</span></span> <span data-ttu-id="1f9fd-182">Для оптимизации используются следующие методы.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-182">The following methods are used for optimization.</span></span>

|<span data-ttu-id="1f9fd-183">Метод</span><span class="sxs-lookup"><span data-stu-id="1f9fd-183">Method</span></span>|<span data-ttu-id="1f9fd-184">Описание</span><span class="sxs-lookup"><span data-stu-id="1f9fd-184">Description</span></span>|
|------------|-----------------|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.ClientsAreListening%2A>|<span data-ttu-id="1f9fd-185">Это статическое свойство указывает, подписано ли какое-либо клиентское приложение на события [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="1f9fd-185">This static property specifies whether any client applications have subscribed to [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] events.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderAdviseEvents>|<span data-ttu-id="1f9fd-186">Реализация поставщика этого интерфейса в корневом элементе фрагмента позволяет ему знать, когда клиенты регистрируют и отменяют регистрацию обработчиков событий для событий фрагмента.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-186">The provider's implementation of this interface on a fragment root enables it to be advised when clients register and unregister event handlers for events on the fragment.</span></span>|

<a name="Non_WPF_Provider_Navigation"></a>

### <a name="non-wpf-provider-navigation"></a><span data-ttu-id="1f9fd-187">Навигация в поставщике, отличном от WPF</span><span class="sxs-lookup"><span data-stu-id="1f9fd-187">Non-WPF Provider Navigation</span></span>

<span data-ttu-id="1f9fd-188">Поставщики простых элементов управления, таких как пользовательская кнопка, размещенная в окне (HWND), не требуется поддерживать навигацию в дереве [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="1f9fd-188">Providers for simple controls such as a custom button hosted in a window (HWND) do not need to support navigation within the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree.</span></span> <span data-ttu-id="1f9fd-189">Переход между элемент обрабатывается поставщиком по умолчанию для главного окна, который указывается в реализации <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-189">Navigation to and from the element is handled by the default provider for the host window, which is specified in the implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>.</span></span> <span data-ttu-id="1f9fd-190">Однако при реализации поставщика сложного пользовательского элемента управления необходимо поддерживать навигацию между корневым узлом фрагмента и его потомками, а также между одноуровневыми узлами.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-190">When you implement a provider for a complex custom control, however, you must support navigation between the root node of the fragment and its descendants, and between sibling nodes.</span></span>

> [!NOTE]
> <span data-ttu-id="1f9fd-191">Элементы фрагмента, отличные от корневого, должны возвращать ссылку `null` из <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>, так как они размещаются не непосредственно в окне, а никакой поставщик по умолчанию не может поддерживать переходы между ними.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-191">Elements of a fragment other than the root must return a `null` reference  from <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>, because they are not directly hosted in a window, and no default provider can support navigation to and from them.</span></span>

<span data-ttu-id="1f9fd-192">Структура фрагмента определяется реализацией <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A>.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-192">The structure of the fragment is determined by your implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A>.</span></span> <span data-ttu-id="1f9fd-193">Для каждого возможного направления из каждого фрагмента этот метод возвращает объект поставщика для элемента в указанном направлении.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-193">For each possible direction from each fragment, this method returns the provider object for the element in that direction.</span></span> <span data-ttu-id="1f9fd-194">Если в этом направлении нет элемента, метод возвращает ссылку `null` .</span><span class="sxs-lookup"><span data-stu-id="1f9fd-194">If there is no element in that direction, the method returns a `null` reference.</span></span>

<span data-ttu-id="1f9fd-195">Корневой элемент фрагмента поддерживает переход только к дочерним элементам.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-195">The fragment root supports navigation only to child elements.</span></span> <span data-ttu-id="1f9fd-196">Например, поле со списком возвращает первый элемент в списке, если задано направление <xref:System.Windows.Automation.Provider.NavigateDirection.FirstChild>, и последний элемент, если задано направление <xref:System.Windows.Automation.Provider.NavigateDirection.LastChild>.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-196">For example, a list box returns the first item in the list when the direction is <xref:System.Windows.Automation.Provider.NavigateDirection.FirstChild>, and the last item when the direction is <xref:System.Windows.Automation.Provider.NavigateDirection.LastChild>.</span></span> <span data-ttu-id="1f9fd-197">Корневой элемент фрагмента не поддерживает переход к родительскому элементу или одноуровневым элементам. Этим управляет поставщик главного окна.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-197">The fragment root does not support navigation to a parent or siblings; this is handled by the host window provider.</span></span>

<span data-ttu-id="1f9fd-198">Элементы фрагмента, отличные от корневого, должны поддерживать переходы к родительскому элементу, а также любым одноуровневым и дочерним элементам.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-198">Elements of a fragment that are not the root must support navigation to the parent, and to any siblings and children they have.</span></span>

<a name="Non_WPF_Provider_Reparenting"></a>

### <a name="non-wpf-provider-reparenting"></a><span data-ttu-id="1f9fd-199">Переподчинение поставщика, отличного от WPF</span><span class="sxs-lookup"><span data-stu-id="1f9fd-199">Non-WPF Provider Reparenting</span></span>

<span data-ttu-id="1f9fd-200">Всплывающие окна — это фактически окна верхнего уровня, поэтому по умолчанию они отображаются в дереве [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] как дочерние элементы рабочего стола.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-200">Pop-up windows are actually top-level windows, and so by default appear in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree as children of the desktop.</span></span> <span data-ttu-id="1f9fd-201">Однако во многих случаях всплывающие окна логически являются потомками других элементов управления.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-201">In many cases, however, pop-up windows are logically children of some other control.</span></span> <span data-ttu-id="1f9fd-202">Например, раскрывающийся список поля со списком логически является дочерним элементом поля со списком.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-202">For example, the drop-down list of a combo box is logically a child of the combo box.</span></span> <span data-ttu-id="1f9fd-203">Аналогичным образом всплывающее окно меню логически является дочерним элементом меню.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-203">Similarly, a menu pop-up window is logically a child of the menu.</span></span> [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="1f9fd-204">обеспечивает поддержку переподчинения всплывающих окон, чтобы они отображались как дочерние элементы связанного элемента управления.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-204">provides support to reparent pop-up windows so that they appear to be children of the associated control.</span></span>

<span data-ttu-id="1f9fd-205">Переподчинение всплывающего окна:</span><span class="sxs-lookup"><span data-stu-id="1f9fd-205">To reparent a pop-up window:</span></span>

1. <span data-ttu-id="1f9fd-206">Создайте поставщик для всплывающего окна.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-206">Create a provider for the pop-up window.</span></span> <span data-ttu-id="1f9fd-207">Для этого класс всплывающего окна должен быть известен заранее.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-207">This requires that the class of the pop-up window is known in advance.</span></span>

2. <span data-ttu-id="1f9fd-208">Реализуйте все свойства и шаблоны для всплывающего окна так, будто бы оно является элементом управления.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-208">Implement all properties and patterns as usual for that pop-up, as though it were a control in its own right.</span></span>

3. <span data-ttu-id="1f9fd-209">Реализуйте свойство <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A> , возвращающее значение, полученное от <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>, где параметр — это дескриптор всплывающего окна.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-209">Implement the <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A> property so that it returns the value obtained from <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>, where the parameter is the window handle of the pop-up window.</span></span>

4. <span data-ttu-id="1f9fd-210">Реализуйте <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A> для всплывающего окна и его родительского элемента, чтобы переход от логического родительского элемента к логическим дочерних элементов, а также между одноуровневыми потомками обрабатывался правильно.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-210">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A> for the pop-up window and its parent so that navigation is handled properly from the logical parent to the logical children, and between sibling children.</span></span>

<span data-ttu-id="1f9fd-211">Когда модель [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] обнаруживает всплывающее окно, она распознает, что навигация по умолчанию переопределена, и пропускает всплывающее окно, если оно обнаружено как дочерний элемент рабочего стола.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-211">When [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] encounters the pop-up window, it recognizes that navigation is being overridden from the default, and skips over the pop-up window when it is encountered as a child of the desktop.</span></span> <span data-ttu-id="1f9fd-212">Вместо этого узел будет доступен только через фрагмент.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-212">Instead, the node will only be reachable through the fragment.</span></span>

<span data-ttu-id="1f9fd-213">Переподчинение не подходит для случаев, когда в элементе управления может разместиться окно любого класса.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-213">Reparenting is not suitable for cases where a control can host a window of any class.</span></span> <span data-ttu-id="1f9fd-214">Например, главная панель может содержать любой тип HWND в своей зоне.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-214">For example, a rebar can host any type of HWND in its bands.</span></span> <span data-ttu-id="1f9fd-215">Для обработки таких случаев [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] поддерживает альтернативную форму перемещения HWND, как описано в следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-215">To handle these cases, [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] supports an alternative form of HWND relocation, as described in the next section.</span></span>

<a name="Non_WPF_Provider_Repositioning"></a>

### <a name="non-wpf-provider-repositioning"></a><span data-ttu-id="1f9fd-216">Изменение положения поставщика, отличного от WPF</span><span class="sxs-lookup"><span data-stu-id="1f9fd-216">Non-WPF Provider Repositioning</span></span>

<span data-ttu-id="1f9fd-217">Фрагменты[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] могут содержать два или более элементов, каждый из которых размещается в окне (HWND).</span><span class="sxs-lookup"><span data-stu-id="1f9fd-217">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] fragments may contain two or more elements that are each contained in a window (HWND).</span></span> <span data-ttu-id="1f9fd-218">Так как у каждого HWND есть собственный поставщик по умолчанию, который рассматривает HWND как дочерний элемент содержащего его HWND, дерево [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] по умолчанию будет отображать HWND в фрагменте как дочерний элемент родительского окна.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-218">Because each HWND has its own default provider that considers the HWND to be a child of a containing HWND, the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree will, by default, show the HWNDs in the fragment as children of the parent window.</span></span> <span data-ttu-id="1f9fd-219">В большинстве случаев это желательное поведение, но иногда оно может привести к путанице, поскольку не соответствует логической структуре [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1f9fd-219">In most cases this is desirable behavior, but sometimes it can lead to confusion because it does not match the logical structure of the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span>

<span data-ttu-id="1f9fd-220">Хорошим примером служит элемент управления главной панели.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-220">A good example of this is a rebar control.</span></span> <span data-ttu-id="1f9fd-221">Элемент управления главной панели содержит зоны, каждая из которых в свою очередь может содержать элемент управления на основе HWND, например панель инструментов, текстовое поле или поле со списком.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-221">A rebar contains bands, each of which can in turn contain an HWND-based control such as a toolbar, an edit box, or a combo box.</span></span> <span data-ttu-id="1f9fd-222">Поставщик окна по умолчанию для HWND главной панели видит дескрипторы HWND элемента управления зоны как дочерние элементы, а поставщик главной панели видит эти зоны как дочерние элементы.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-222">The default window provider for the rebar HWND sees the band control HWNDs as children, and the rebar provider sees the bands as children.</span></span> <span data-ttu-id="1f9fd-223">Поскольку поставщик HWND и поставщик главной панели работают совместно и объединяют свои дочерние элементы, зоны и элементы управления HWND отображаются как дочерние элементы главной панели.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-223">Because the HWND provider and the rebar provider are working in tandem and combining their children, both the bands and the HWND-based controls appear as children of the rebar.</span></span> <span data-ttu-id="1f9fd-224">Но логически только зоны должны отображаться в качестве дочерних элементов главной панели, а каждый поставщик зоны должен быть связан с поставщиком HWND по умолчанию для элемента управления, который он содержит.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-224">Logically, however, only the bands should appear as children of the rebar, and each band provider should be coupled with the default HWND provider for the control it contains.</span></span>

<span data-ttu-id="1f9fd-225">Для этого поставщик корневого элемента фрагмента главной панели предоставляет набор дочерних элементов, представляющих зоны.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-225">To accomplish this, the fragment root provider for the rebar exposes a set of children representing the bands.</span></span> <span data-ttu-id="1f9fd-226">У каждой зоны один поставщик, который может предоставлять свойства и шаблоны.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-226">Each band has a single provider that may expose properties and patterns.</span></span> <span data-ttu-id="1f9fd-227">В своей реализации <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>поставщик зоны возвращает поставщика окна по умолчанию для HWND элемента управления, который он получает путем вызова <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>, передавая дескриптор окна элемента управления.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-227">In its implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>, the band provider returns the default window provider for the control HWND, which it obtains by calling <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>, passing in the control's window handle.</span></span> <span data-ttu-id="1f9fd-228">Наконец, поставщик корневого элемента фрагмента главной панели реализует интерфейс <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride> и в своей реализации <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride.GetOverrideProviderForHwnd%2A> возвращает соответствующий внешний поставщик для элемента управления, размещенного в указанном HWND.</span><span class="sxs-lookup"><span data-stu-id="1f9fd-228">Finally, the fragment root provider for the rebar implements the <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride> interface, and in its implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride.GetOverrideProviderForHwnd%2A> it returns the appropriate band provider for the control contained in the specified HWND.</span></span>

## <a name="see-also"></a><span data-ttu-id="1f9fd-229">См. также:</span><span class="sxs-lookup"><span data-stu-id="1f9fd-229">See also</span></span>

- [<span data-ttu-id="1f9fd-230">Общие сведения о поставщиках автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="1f9fd-230">UI Automation Providers Overview</span></span>](ui-automation-providers-overview.md)
- [<span data-ttu-id="1f9fd-231">Предоставление серверного поставщика автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="1f9fd-231">Expose a Server-side UI Automation Provider</span></span>](expose-a-server-side-ui-automation-provider.md)
- [<span data-ttu-id="1f9fd-232">Возврат свойств от поставщика автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="1f9fd-232">Return Properties from a UI Automation Provider</span></span>](return-properties-from-a-ui-automation-provider.md)
- [<span data-ttu-id="1f9fd-233">Вызов событий из поставщика автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="1f9fd-233">Raise Events from a UI Automation Provider</span></span>](raise-events-from-a-ui-automation-provider.md)
- [<span data-ttu-id="1f9fd-234">Включение навигации в поставщике фрагментов автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="1f9fd-234">Enable Navigation in a UI Automation Fragment Provider</span></span>](enable-navigation-in-a-ui-automation-fragment-provider.md)
- [<span data-ttu-id="1f9fd-235">Поддержка шаблонов элементов управления в поставщике автоматизации пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="1f9fd-235">Support Control Patterns in a UI Automation Provider</span></span>](support-control-patterns-in-a-ui-automation-provider.md)
