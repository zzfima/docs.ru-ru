---
title: Практическое руководство. Отладка приложений и служб с помощью трассировки WIF
ms.date: 03/30/2017
ms.assetid: 3d51ba59-3adb-4ca4-bd33-5027531af687
author: BrucePerlerMS
ms.openlocfilehash: e10d8d2ea869b03586b4680ad8320aeb2de90620
ms.sourcegitcommit: daa8788af67ac2d1cecd24f9f3409babb2f978c9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/01/2018
ms.locfileid: "47862979"
---
# <a name="how-to-debug-claims-aware-applications-and-services-using-wif-tracing"></a>Практическое руководство. Отладка приложений и служб с помощью трассировки WIF
## <a name="applies-to"></a>Применение  
  
-   Microsoft® Windows® Identity Foundation (WIF)  
  
-   Программа Service Trace Viewer (SvcTraceViewer.exe)  
  
-   Устранение неполадок и отладка приложений WIF  
  
## <a name="summary"></a>Сводка  
 В этом практическом руководстве описаны действия, необходимые для настройки трассировки WIF, сбора журналов трассировки и анализа журналов трассировки с помощью средства Trace Viewer. Здесь предоставляется общее сопоставление записей трассировки с действиями, необходимыми для устранения проблем, связанных с WIF.  
  
## <a name="contents"></a>Описание  
  
-   Цели  
  
-   Сводка действий  
  
-   Шаг 1. Настройка трассировки WIF с помощью файла конфигурации Web.config  
  
-   Шаг 2. Анализ файлов трассировки WIF с помощью средства Trace Viewer  
  
-   Шаг 3. Определение решений для устранения проблем WIF  
  
-   Связанные темы  
  
## <a name="objectives"></a>Цели  
  
-   Настройка трассировки WIF.  
  
-   Просмотр журналов трассировки в средстве Trace Viewer.  
  
-   Определение проблем, связанных с WIF, в журналах трассировки.  
  
-   Применение корректирующих действий для проблем, связанных с WIF, которые обнаружены в журналах трассировки.  
  
## <a name="summary-of-steps"></a>Сводка действий  
  
-   Шаг 1. Настройка трассировки WIF с помощью файла конфигурации Web.config  
  
-   Шаг 2. Анализ файлов трассировки WIF с помощью средства Trace Viewer  
  
-   Шаг 3. Определение решений для устранения проблем WIF  
  
## <a name="step-1--configure-wif-tracing-using-webconfig-configuration-file"></a>Шаг 1. Настройка трассировки WIF с помощью файла конфигурации Web.config  
 На этом шаге вы будете добавлять изменения в разделы конфигурации файла *Web.config*, которые включают в WIF трассировку событий и сохранение их в журнале трассировки.  
  
#### <a name="to-configure-wif-tracing-using-webconfig-configuration-file"></a>Настройка трассировки WIF с помощью файла конфигурации Web.config  
  
1.  Откройте корневой файл конфигурации **Web.config** или **App.config** в редакторе Visual Studio, дважды щелкнув его в **обозревателе решений**. Если в решении отсутствует файл конфигурации **Web.config** или **App.config**, добавьте его, щелкнув правой кнопкой мыши решение в **обозревателе решений**, выбрав пункт **Добавить**, а затем **Новый элемент...** В диалоговом окне **создания элемента** выберите в списке **файл конфигурации приложения**, чтобы создать **App.config**, или **файл веб-конфигурации**, чтобы создать **Web.config**, и нажмите кнопку **ОК**.  
  
2.  Добавьте записи конфигурации, аналогичные приведенным ниже, в узле **\<configuration>** в конце файла конфигурации.  
  
    ```xml  
    <system.diagnostics>  
        <sources>  
            <source name="System.IdentityModel" switchValue="Verbose">  
                <listeners>  
                    <add name="xml" type="System.Diagnostics.XmlWriterTraceListener" initializeData="WIFTrace.e2e"/>  
                </listeners>  
            </source>  
        </sources>  
        <trace autoflush="true"/>  
    </system.diagnostics>  
    ```  
  
3.  Приведенная выше конфигурация предписывает WIF создавать подробные события трассировки и регистрировать их в файле *WIFTrace.e2e*. Полный список значений для параметра **switchValue** см. в таблице "Уровень трассировки" в разделе [Настройка трассировки](../wcf/diagnostics/tracing/configuring-tracing.md).  
  
## <a name="step-2--analyze-wif-trace-files-using-trace-viewer-tool"></a>Шаг 2. Анализ файлов трассировки WIF с помощью средства Trace Viewer  
 На этом шаге вы будете использовать средство Trace Viewer (SvcTraceViewer.exe) для анализа журналов трассировки WIF.  
  
#### <a name="to-analyze-wif-trace-logs-using-trace-viewer-tool-svctraceviewerexe"></a>Анализ журналов трассировки WIF с помощью средства Trace Viewer (SvcTraceViewer.exe)  
  
1.  Средство Trace Viewer (SvcTraceViewer.exe) поставляется в составе пакета Windows SDK. Если вы еще не установили пакет Windows SDK, его можно скачать здесь: [Пакет Windows SDK](https://www.microsoft.com/download/en/details.aspx?id=8279).  
  
2.  Запустите средство Trace Viewer (SvcTraceViewer.exe) Обычно оно находится в папке **Bin** по пути установки.  
  
3.  Откройте файл журнала трассировки WIF, например WIFTrace.e2e, выбрав в меню пункты **Файл** и **Открыть...** или нажав клавиши **CTRL+O**. Файл журнала трассировки откроется в средстве Trace Viewer.  
  
4.  Просмотрите записи на вкладке **Действия**. Каждая запись должна содержать номер действия, количество зарегистрированных трассировок, длительность действия и метки времени его начала и окончания.  
  
5.  Перейдите на вкладку **Действия**. Вы увидите подробные записи трассировки в главной области средства. Используйте раскрывающийся список **Уровень** в меню, чтобы отфильтровать конкретный уровень трассировки, например: **Все**, **Предупреждение**, **Ошибки**, **Сведения** и т. п.  
  
6.  Щелкните конкретные записи трассировки, чтобы просмотреть сведения в нижней области средства. Подробные сведения можно просматривать с помощью представления **Форматированный** и **XML**, выбрав соответствующую вкладку.  
  
## <a name="step-3--identify-solutions-to-fix-wif-related-issues"></a>Шаг 3. Определение решений для устранения проблем WIF  
 На этом шаге можно определить решения для проблем, связанных с WIF, обнаруженных с помощью журнала трассировки WIF и средства Trace Viewer. Здесь представляется общее сопоставление исключений, связанных с WIF, с потенциальными решениями или необходимыми действиями для устранения проблем.  
  
#### <a name="to-identify-solutions-to-fix-wif-related-issues"></a>Определение решений для устранения проблем WIF  
  
1.  Ознакомьтесь со следующей таблицей исключений WIF и необходимых действий для исправления проблем.  
  
|**Идентификатор ошибки**|**Сообщение об ошибке**|**Действие, необходимое для исправления ошибки**|  
|-|-|-|  
|ID4175|Издатель токена безопасности не был распознан IssuerNameRegistry.  Чтобы принимать токены безопасности от этого издателя, настройте IssuerNameRegistry для возврата допустимого имени этого издателя.|Это ошибка может быть вызвана копированием отпечатка из оснастки MMC и вставкой его в файл *Web.config*. В частности, при копировании из окна свойств сертификата можно получить лишний непечатаемый символ в текстовой строке. Этот лишний символ приводит к сбою отпечатка. Процедуру правильного копирования отпечатка можно найти здесь: [http://msdn.microsoft.com/library/ff359102.aspx](https://msdn.microsoft.com/library/ff359102.aspx)|  
  
## <a name="related-items"></a>Связанные темы  
  
-   [Использование программы Service Trace Viewer для просмотра скоррелированных трассировок и устранения неполадок](../wcf/diagnostics/tracing/using-service-trace-viewer-for-viewing-correlated-traces-and-troubleshooting.md)
