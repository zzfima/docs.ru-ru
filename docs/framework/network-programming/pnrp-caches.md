---
title: Кэши PNRP
ms.date: 03/30/2017
ms.assetid: 270068d9-1b6b-4eb9-9e14-e02326bb88df
ms.openlocfilehash: 3ed3e11e702c8933b500421de5654b212cdd80d8
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/15/2020
ms.locfileid: "64622994"
---
# <a name="pnrp-caches"></a>Кэши PNRP
Кэши протокола однорангового разрешения имен (PNRP) представляют собой локальные коллекции выбираемых по определенному алгоритму одноранговых конечных точек, которые хранятся на одноранговом узле.  
  
## <a name="pnrp-cache-initialization"></a>Инициализация кэша PNRP  
 Чтобы инициализировать кэш PNRP или коллекцию записей имен одноранговых узлов при запуске однорангового узла, узел может использовать следующие методы:  
  
- Записи постоянного кэша, которые были сохранены на момент отключения узла или загружены с жесткого диска.  
  
- Если приложение использует инфраструктуру совместной работы P2P, сведения для совместной работы будут доступны в диспетчере контактов для соответствующего узла.  
  
## <a name="scaling-peer-name-resolution-with-a-multi-level-cache"></a>Масштабирование однорангового разрешения имен с использованием многоуровневого кэша  
 Чтобы минимизировать размер кэшей PNRP, одноранговые узлы используют многоуровневый кэш, в котором на каждом уровне содержится максимальное количество записей. Каждый уровень кэша представляет в десять раз меньшую часть числового пространства идентификаторов PNRP (2<sup>256</sup>). На самом нижнем уровне кэша находятся локально зарегистрированный идентификатор PNRP и другие близкие к нему по значению идентификаторы PNRP. После того как уровень кэша будет заполнен 20 записями, создается новый нижний уровень. Максимальное число уровней в кэше определяется как десятичный логарифм от общего числа идентификаторов PNRP в облаке. Например, для глобального облака со 100 миллионами идентификаторов PNRP число уровней кэша (и, соответственно, число переходов при разрешении идентификатора PNRP) не превышает 8 (десятичный логарифм от 100 000 000). Такой механизм обеспечивает реализацию распределенной хэш-таблицы, для которой произвольный идентификатор PNRP может быть разрешен путем перенаправления сообщений запроса PNRP на следующий ближайший одноранговый узел до тех пор, пока не будет найден соответствующий сертифицированный адрес однорангового узла.  
  
 Чтобы гарантировать полное разрешение, каждый раз, как узел добавляет запись на самый нижний уровень своего кэша, копия этой записи распространяется на все узлы, находящиеся на последнем уровне кэша.  
  
 Записи кэша периодически обновляются. Устаревшие записи удаляются из кэша. В результате этого получается распределенная хэш-таблица идентификаторов PNRP для активных конечных точек. В этом заключается отличие от службы DNS, записи адресов и протокол DNS которой не гарантируют, что узел, связанный с адресом, активен в сети.  
  
## <a name="other-pnrp-caches"></a>Другие кэши PNRP  
 Также для постоянного хранения данных используется локальный кэш.  В дополнение к другим объектам, необходимым для реализации PNRP, он может содержать записи, связанные с сеансом совместной работы или облаком PNRP, которые безопасно публикуются и синхронизируются между всеми членами облака. Это реплицированное хранилище содержит представление данных группы, которые должны быть одинаковыми для всех ее членов. Технически эти объекты не являются записями, однако содержат сведения о присутствии приложений и данные объектов, предназначенные для локального кэша. Благодаря применению облака PNRP гарантируется распространение объектов на все узлы в сеансе совместной работы или облаке PNRP.  Чтобы обеспечить шифрование и целостность данных при репликации записей между членами облака, используется протокол SSL.  
  
 Одноранговый узел, который присоединяется к облаку, не будет автоматически получать данные локального кэша от ведущего однорангового узла, к которому он присоединяется. В этом случае оформляется подписка на ведущий одноранговый узел для получения обновлений сведений о присутствии приложений и данных объектов. После первоначальной синхронизации одноранговые узлы периодически выполняют повторную синхронизацию реплицированных хранилищ, чтобы обеспечить согласованность представлений для каждого члена группы.  Аналогичные функции могут выполняться посредством сеансов совместной работы или приложений в рамках таких сеансов.  
  
 После начала сеанса совместной работы для облака приложения могут регистрировать одноранговые узлы и начинают публикацию сведений о них, используя параметры безопасности, определенные для области облака. Когда одноранговый узел присоединяется к облаку, к нему применяются механизмы безопасности облака, в результате чего определяется область, в которой он будет участвовать.  После этого возможна публикация записей узла в области облака. Обратите внимание, что области облака и приложения для совместной работы могут различаться.  
  
 Одноранговые узлы могут регистрировать намерение получать объекты от других таких узлов. При обновлении объекта приложение для совместной работы получает соответствующее уведомление, а новый объект передается всем подписчикам приложения. Например, одноранговый узел в приложении группового чата может регистрировать намерение получать данные приложения (все записи чата).  Такой механизм позволяет отслеживать использование чата в облаке.  
  
## <a name="see-also"></a>См. также раздел

- <xref:System.Net.PeerToPeer>
