---
title: Вопросы миграции (Entity Framework)
ms.date: 03/30/2017
ms.assetid: c85b6fe8-cc32-4642-8f0a-dc0e5a695936
ms.openlocfilehash: 168aec6ef369f446cfac22ee5c4361fa06aaf16d
ms.sourcegitcommit: 79a2d6a07ba4ed08979819666a0ee6927bbf1b01
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2019
ms.locfileid: "74569442"
---
# <a name="migration-considerations-entity-framework"></a>Вопросы миграции (Entity Framework)
Entity Framework ADO.NET предоставляет несколько преимуществ для существующего приложения. Наиболее важным из них является возможность использования концептуальной модели для отделения структур данных, используемых приложением, от схемы в источнике данных. Это позволяет в дальнейшем значительно упростить внесение изменений в модель хранения или сам источник данных, устранив необходимость внесения соответствующих изменений в приложение. Дополнительные сведения о преимуществах использования Entity Framework см. в разделе [Entity Framework Overview](overview.md) and [EDM](../entity-data-model.md).  
  
 Чтобы воспользоваться преимуществами Entity Framework, можно перенести существующее приложение в Entity Framework. Некоторые задачи являются общими для всех перенесенных приложений. Эти распространенные задачи включают обновление приложения для использования .NET Framework, начиная с версии 3,5 с пакетом обновления 1 (SP1), определяя модели и сопоставление, а также настраивая Entity Framework. При переносе приложения в Entity Framework существуют дополнительные рекомендации. Каких именно - зависит от типа переносимого приложения и реализуемых им функциональных возможностей. Этот раздел содержит сведения, которые помогут подобрать наилучший подход при обновлении существующих приложений.  
  
## <a name="general-migration-considerations"></a>Общие рекомендации по переносу  
 При переносе любого приложения в Entity Framework необходимо учитывать следующие моменты.  
  
- Любое приложение, использующее .NET Framework, начиная с версии 3,5 с пакетом обновления 1 (SP1), может быть перенесено на Entity Framework, если поставщик данных для источника данных, используемый приложением, поддерживает Entity Framework.  
  
- Платформа Entity Framework может поддерживать не все функции поставщика источника данных, даже если поставщик поддерживает платформу Entity Framework.  
  
- Большие и сложные приложения не обязательно переносить на платформу Entity Framework сразу и полностью. При этом, однако, те части приложения, которые не используют Entity Framework, будут по-прежнему требовать изменения при изменении источника данных.  
  
- Подключение поставщика данных, используемое Entity Framework, может использоваться совместно с другими частями приложения, поскольку Entity Framework использует поставщики данных ADO.NET для доступа к источнику данных. Например, поставщик SqlClient используется платформой Entity Framework для доступа к базе данных SQL Server. Дополнительные сведения см. [в разделе Поставщик EntityClient для Entity Framework](entityclient-provider-for-the-entity-framework.md).  
  
## <a name="common-migration-tasks"></a>Типичные задачи переноса  
 Путь для переноса существующего приложения в Entity Framework зависит как от типа приложения, так и от существующей стратегии доступа к данным. Однако при переносе существующего приложения в Entity Framework необходимо всегда выполнять следующие задачи.  
  
> [!NOTE]
> Все эти задачи выполняются автоматически при использовании средств EDM, начиная с Visual Studio 2008. Дополнительные сведения см. в разделе [инструкции. Использование мастера EDM](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb738677(v=vs.100)).  
  
1. Обновление приложения.  
  
     Проект, созданный с помощью более ранней версии Visual Studio и .NET Framework должен быть обновлен для использования Visual Studio 2008 с пакетом обновления 1 (SP1) и .NET Framework начиная с версии 3,5 с пакетом обновления 1 (SP1).  
  
2. Определение моделей и сопоставлений.  
  
     Файлы модели и сопоставления определяют сущности в концептуальной модели, структуры в источнике данных (таблицы, хранимые процедуры, представления и т. д.), а также сопоставление между сущностями и структурами источника данных. Дополнительные сведения см. в разделе [руководство. Определение файлов модели и сопоставления вручную](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb399785(v=vs.100)).  
  
     Типы, определенные в модели хранения, должны соответствовать именам объектов в источнике данных. Если существующее приложение предоставляет доступ к данным в виде объектов, необходимо убедиться в том, что сущности и свойства, определенные в концептуальной модели, соответствуют именам существующих классов и свойств данных. Дополнительные сведения см. [в разделе инструкции. Настройка файлов моделирования и сопоставления для работы с пользовательскими объектами](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb738625(v=vs.100)).  
  
    > [!NOTE]
    > Конструктор моделей EDM позволяет переименовывать сущности концептуальной модели для обеспечения соответствия существующим объектам. Дополнительные сведения см. в разделе [конструктор EDM](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/cc716685(v=vs.100)).  
  
3. Определение строки соединения.  
  
     Entity Framework использует специально отформатированную строку соединения при выполнении запросов к концептуальной модели. В нее инкапсулированы сведения о файлах модели и сопоставления, а также о соединении с источником данных. Дополнительные сведения см. в разделе [инструкции. определение строки подключения](how-to-define-the-connection-string.md).  
  
4. Настройте проект Visual Studio.  
  
     В проект Visual Studio должны быть добавлены ссылки на Entity Framework сборки, а также файлы модели и сопоставления. Можно также добавить в проект файлы сопоставления, чтобы выполнялось их развертывание в каталоге, указанном в строке соединения. Дополнительные сведения см. [в разделе как вручную настроить проект Entity Framework](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb738546(v=vs.100)).  
  
## <a name="considerations-for-applications-with-existing-objects"></a>Приложения с существующими объектами  
 Начиная с .NET Framework 4 Entity Framework поддерживает "обычные старые объекты CLR (POCO), которые также называются объектами сохраняемости-игнорирующих. В большинстве случаев существующие объекты могут работать с Entity Framework путем внесения незначительных изменений. Дополнительные сведения см. в разделе [Работа с сущностями POCO](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/dd456853(v=vs.100)). Можно также перенести приложение в Entity Framework и использовать классы данных, созданные средствами Entity Framework. Дополнительные сведения см. в разделе [инструкции. Использование мастера EDM](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb738677(v=vs.100)).  
  
## <a name="considerations-for-applications-that-use-adonet-providers"></a>Приложения, использующие поставщики ADO.NET  
 Поставщики ADO.NET, такие как SqlClient, позволяют запрашивать источник данных для возврата табличных данных. Данные также могут быть загружены в набор данных ADO.NET. В следующем списке приводятся рекомендации по обновлению приложения, использующего существующего поставщика ADO.NET:  
  
- Отображение табличных данных с помощью модуля чтения данных.  

  Вы можете выполнить запрос [!INCLUDE[esql](../../../../../includes/esql-md.md)] с помощью поставщика EntityClient и перечислить возвращенный <xref:System.Data.EntityClient.EntityDataReader> объект. Сделайте это только в том случае, если приложение отображает табличные данные с помощью модуля чтения данных и не требует средств, предоставляемых Entity Framework для материализации данных в объекты, отслеживания изменений и внесения обновлений. Можно продолжать пользоваться существующим кодом доступа к данным, который выполняет обновления источника данных, но пользоваться для этого соединением, доступным через свойство <xref:System.Data.EntityClient.EntityConnection.StoreConnection%2A> объекта <xref:System.Data.EntityClient.EntityConnection>. Дополнительные сведения см. [в разделе Поставщик EntityClient для Entity Framework](entityclient-provider-for-the-entity-framework.md).  
  
- Работа с DataSet.  

  Entity Framework предоставляет множество функций, предоставляемых набором данных, включая сохраняемость в памяти, отслеживание изменений, привязку данных и сериализацию объектов в виде XML-данных. Дополнительные сведения см. в разделе [Работа с объектами](working-with-objects.md).  
  
  Если Entity Framework не предоставляет функции набора данных, необходимой для приложения, можно воспользоваться преимуществами запросов LINQ с помощью LINQ to DataSet. Дополнительные сведения см. в разделе [LINQ to DataSet](../linq-to-dataset.md).  
  
## <a name="considerations-for-applications-that-bind-data-to-controls"></a>Приложения с привязкой данных к элементам управления  
 .NET Framework позволяет инкапсулировать данные в источнике данных, таком как набор данных или элемент управления источника данных ASP.NET, а затем привязывать элементы пользовательского интерфейса к этим элементам управления данными. В следующем списке приведены соображения, касающиеся привязки элементов управления к данным платформы Entity Framework.  
  
- Привязка данных к элементам управления.  

  При запросе к концептуальной модели Entity Framework возвращает данные в виде объектов, являющихся экземплярами типов сущностей. Эти объекты могут быть привязаны непосредственно к элементам управления, и эта привязка поддерживает обновления. Это означает, что изменения данных в элементе управления, например строки в <xref:System.Windows.Forms.DataGridView>, автоматически сохраняются в базе данных при вызове метода <xref:System.Data.Objects.ObjectContext.SaveChanges%2A>.  
  
  Если в приложении применяется перечисление результатов запроса для отображения данных в <xref:System.Windows.Forms.DataGridView> или любом другом элементе управления, поддерживающем привязку к данным, то можно модифицировать это приложение для привязки элемента управления к результату <xref:System.Data.Objects.ObjectQuery%601>.  
  
  Дополнительные сведения см. [в разделе Привязка объектов к элементам управления](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb738469(v=vs.100)).  
  
- ASP.NET элементы управления источниками данных.  

  Entity Framework включает элемент управления источниками данных, предназначенный для упрощения привязки данных в веб-приложениях ASP.NET. Дополнительные сведения см. в разделе [Общие сведения об элементе управления EntityDataSource веб-сервера](https://docs.microsoft.com/previous-versions/aspnet/cc488502(v=vs.100)).  
  
## <a name="other-considerations"></a>Другие вопросы  
 Далее приведены вопросы, которые могут потребовать рассмотрения при переносе на платформу Entity Framework некоторых типов приложений.  
  
- Приложения, реализующие службы данных.  

  Веб-службы и приложения, созданные на основе технологии WCF, предоставляют доступ к данным из базового источника данных с использованием формата обмена сообщениями «запрос-ответ» XML. Entity Framework поддерживает сериализацию объектов сущностей с помощью двоичной, XML или сериализации контракта данных WCF. Двоичная сериализация и сериализация WCF поддерживают полную сериализацию графов объектов. Дополнительные сведения см. в разделе [Создание N-уровневых приложений](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb896304(v=vs.100)).  
  
- Приложения, использующие XML-данные.  

  Сериализация объектов позволяет создавать службы Entity Framework данных. Такие службы поставляют данные приложениям, принимающим XML-данные, например, интернет-приложениям на основе технологии AJAX. В таких случаях рекомендуется использовать WCF Data Services. Эти службы данных основаны на EDM и предоставляют динамический доступ к данным сущности с помощью стандартных действий HTTP, таких как GET, WHERE и POST. Дополнительные сведения см. в разделе [Службы данных WCF 4.5](../../wcf/index.md).  
  
  Entity Framework не поддерживает тип данных Native-XML. Это означает, что если сущность сопоставлена с таблицей, имеющей XML-столбец, то эквивалентное свойство сущности для столбца XML является строковым. Объекты могут быть отсоединены и сериализованы в виде XML. Дополнительные сведения см. в разделе [сериализация объектов](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb738446(v=vs.100)).  
  
  Если в приложении необходимо предусмотреть возможность запрашивать XML-данных, то можно воспользоваться преимуществами запросов LINQ на основе применения LINQ to XML. Дополнительные сведения см. в разделе [LINQ to XMLC#()](../../../../csharp/programming-guide/concepts/linq/linq-to-xml-overview.md) или [LINQ to XML (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-to-xml.md).  
  
- Приложения, сохраняющие состояние.  

  Веб-приложения ASP.NET часто должны поддерживать состояние веб-страницы или сеанса пользователя. Объекты в экземпляре <xref:System.Data.Objects.ObjectContext> могут храниться в состоянии представления клиента или в состоянии сеанса на сервере, а затем получены и повторно присоединены к новому контексту объекта. Дополнительные сведения см. в разделе [Присоединение и отсоединение объектов](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb896271(v=vs.100)).  
  
## <a name="see-also"></a>См. также:

- [Требования к развертыванию](deployment-considerations.md)
- [Терминология платформы Entity Framework](terminology.md)
