---
title: Стандартные операторы в запросах LINQ to Entities
ms.date: 08/21/2018
ms.assetid: 7fa55a9b-6219-473d-b1e5-2884a32dcdff
ms.openlocfilehash: 302fa281767fc95e9a9a2192382034b3a519cd92
ms.sourcegitcommit: 64f4baed249341e5bf64d1385bf48e3f2e1a0211
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/07/2018
ms.locfileid: "44128382"
---
# <a name="standard-query-operators-in-linq-to-entities-queries"></a>Стандартные операторы в запросах LINQ to Entities
В запросе указывается, какие данные надо получить из источника. В запросе можно также указать, как следует сортировать, группировать и формировать возвращаемую информацию. Технология LINQ предоставляет набор стандартных методов запросов, которые можно использовать в запросах. Большинство этих методов работают с последовательностями; в данном контексте последовательность — это объект, тип которого реализует <xref:System.Collections.Generic.IEnumerable%601> интерфейс или <xref:System.Linq.IQueryable%601> интерфейс. Функциональные возможности стандартных операторов запросов включают фильтрацию, проекцию, статистическую обработку, сортировку, группирование, разбиение на страницы и т. д. У некоторых наиболее часто используемых стандартных операторов запросов существует выделенный синтаксис ключевого слова, поэтому оператор можно вызвать с помощью синтаксиса выражения запроса. Выражение запроса - это другой, более легко читаемый способ создания запросов, отличающийся от способа, основанного на использовании методов. Предложения выражений запросов преобразуются в вызовы методов запросов во время компиляции. Список стандартных операторов запросов, имеющих эквивалентные предложения выражений запросов, см. в разделе [Общие сведения о стандартных операторах запроса](https://msdn.microsoft.com/library/24cda21e-8af8-4632-b519-c404a839b9b2).  
  
 В запросах [!INCLUDE[linq_entities](../../../../../../includes/linq-entities-md.md)] поддерживаются не все стандартные операторы запросов. Дополнительные сведения см. в разделе [поддерживаемые и неподдерживаемые методы LINQ (LINQ to Entities)](../../../../../../docs/framework/data/adonet/ef/language-reference/supported-and-unsupported-linq-methods-linq-to-entities.md). В этом разделе предоставлены сведения о стандартных операторах запросов, уникальных для запросов [!INCLUDE[linq_entities](../../../../../../includes/linq-entities-md.md)]. Дополнительные сведения об известных проблемах в [!INCLUDE[linq_entities](../../../../../../includes/linq-entities-md.md)] запросы, см. в разделе [известные проблемы и вопросы в LINQ to Entities](../../../../../../docs/framework/data/adonet/ef/language-reference/known-issues-and-considerations-in-linq-to-entities.md).  
  
## <a name="projection-and-filtering-methods"></a>Методы проекции и фильтрации  
 *Проекция* — это преобразование элементов результирующего набора в нужную форму. Например, можно проецировать необходимое подмножество свойств из каждого объекта в результирующем наборе, или свойство и произвести с ним математическое вычисление, или целый объект из результирующего набора. Методами проекции являются методы `Select` и `SelectMany`.  
  
 *Фильтрация* ссылается операция по ограничению значений в результирующем наборе только элементами, которые соответствуют заданному условию. Методом фильтрации является метод `Where`.  
  
 Большинство перегрузок методов проекции и фильтрации поддерживаются в [!INCLUDE[linq_entities](../../../../../../includes/linq-entities-md.md)], за исключением тех, которые принимают позиционные аргументы.  
  
## <a name="join-methods"></a>Методы соединения  
 Соединение является важной операцией в запросах, обращающихся к целевым источникам данных, не имеющим связей друг с другом, по которым можно перемещаться. Соединение двух источников данных - это ассоциация объектов в одном источнике данных с объектами в другом источнике, имеющем общий атрибут или свойство. Методами соединения являются методы `Join` и `GroupJoin`.  
  
 Поддерживается большинство перегрузок методов соединения, за исключением тех, в которых используется интерфейс <xref:System.Collections.Generic.IEqualityComparer%601>. Это происходит потому, что сравнивающий класс нельзя преобразовать в источник данных.  
  
## <a name="set-methods"></a>Методы наборов  
 Операции с наборами в LINQ — это операции запросов, результирующие наборы которых основываются на наличии или отсутствии эквивалентных элементов в одной или другой коллекции (или наборе). Методами наборов являются методы `All`, `Any`, `Concat`, `Contains`, `DefaultIfEmpty`, `Distinct`, `EqualAll`, `Except`, `Intersect` и `Union`.  
  
 Большинство перегрузок методов наборов поддерживаются в [!INCLUDE[linq_entities](../../../../../../includes/linq-entities-md.md)], хотя и существуют некоторые отличия в поведении по сравнению с технологией LINQ to Objects. Тем не менее, задать методы, использующие <xref:System.Collections.Generic.IEqualityComparer%601> не поддерживаются, поскольку сравнивающий класс нельзя преобразовать в источник данных.  
  
## <a name="ordering-methods"></a>Методы упорядочивания  
 Упорядочение (или сортировка) — это упорядочение элементов в результирующем наборе на основе одного или нескольких атрибутов. Указав более одного критерия сортировки, можно разорвать связи внутри группы.  
  
 Поддерживается большинство перегрузок методов упорядочивания, за исключением тех, в которых используется интерфейс <xref:System.Collections.Generic.IComparer%601>. Это происходит потому, что сравнивающий класс нельзя преобразовать в источник данных. Методами упорядочивания являются методы `OrderBy`, `OrderByDescending`, `ThenBy`, `ThenByDescending` и `Reverse`.  
  
 Поскольку запрос выполняется к источнику данных, поведение упорядочивания может отличаться от поведения запросов, выполненных в среде CLR. Это происходит, потому что в источнике данных могут быть заданы параметры упорядочения, такие как упорядочение с учетом регистра, упорядочение с учетом символов кандзи и упорядочение значений null. В зависимости от источника данных эти параметры упорядочения могут приводить к результатам, отличающимся от результатов в среде CLR.  
  
 Если один и тот же селектор ключа будет указан в более чем одной операции сортировки, будет выполнена повторяющаяся сортировка. Это недопустимо, поэтому будет выдано исключение.  
  
## <a name="grouping-methods"></a>Методы группирования  
 Группирование — это размещение данных в группах таким образом, чтобы у элементов в каждой группе был общий атрибут. Методом группирования является метод `GroupBy`.  
  
 Поддерживается большинство перегрузок методов группирования, за исключением тех, в которых используется интерфейс <xref:System.Collections.Generic.IEqualityComparer%601>. Это происходит потому, что сравнивающий класс нельзя преобразовать в источник данных.  
  
 Методы группирования сопоставляются с источником данных с помощью отдельного вложенного запроса для селектора ключа. Вложенный запрос сравнения селектора ключа выполняется с использованием семантики источника данных, включая и вопросы, связанные со сравнением значений `null`.  
  
## <a name="aggregate-methods"></a>Методы статистической обработки  
 Статистическая операция вычисляет одно значение по коллекции значений. Например, статистической операцией является вычисление средней дневной температуры с использованием значений дневной температуры за месяц. Статистическими методами являются методы `Aggregate`, `Average`, `Count`, `LongCount`, `Max`, `Min` и `Sum`.  
  
 Поддерживается перегрузка большинства статистических методов. Поведение методов статистической обработки, связанное со значениями null, определяется семантикой источника данных. Поведение методов статистической обработки может отличаться в том случае, если присутствуют значения null. Это зависит от используемого конечного источника данных. Поведение методов статистической обработки с использованием семантики источника данных также может отличаться от поведения, ожидаемого от методов среды CLR. Например, по умолчанию метод `Sum` на SQL Server пропускает значения null, а не вызывает исключение.  
  
 Любые исключения, являющиеся результатом статистической обработки, например переполнение, вызванное функцией `Sum`, вызываются как исключения источников данных или как исключения платформы Entity Framework во время материализации результатов запросов.  
  
 В методах, в которых выполняется вычисление над последовательностью, таких как `Sum` или `Average`, реальное вычисление выполняется на сервере. В результате на сервере могут произойти преобразования типов и потеря точности, а результаты могут отличаться от результатов, ожидаемых при использовании семантики среды CLR.  
  
 Поведение по умолчанию методов статистической обработки, по отношению к значениям NULL и значениям, отличным от NULL, отображено в следующей таблице:  
  
|Метод|Нет данных|Все значения NULL|Некоторые значения NULL|Нет значений NULL|  
|------------|-------------|---------------------|----------------------|--------------------|  
|`Average`|Возвращает значение NULL.|Возвращает значение NULL.|Возвращает среднее значение от значений последовательности, отличных от NULL.|Вычисляет среднее значение для последовательности числовых значений.|  
|`Count`|Возвращает значение 0|Возвращает число значений null в последовательности.|Возвращает число значений null и значений, отличных от null, в последовательности.|Возвращает число элементов в последовательности.|  
|`Max`|Возвращает значение NULL.|Возвращает значение NULL.|Возвращает максимальное значение, отличное от NULL, в последовательности.|Возвращает максимальное значение в последовательности.|  
|`Min`|Возвращает значение NULL.|Возвращает значение NULL.|Возвращает минимальное значение, отличное от NULL, в последовательности.|Возвращает минимальное значение в последовательности.|  
|`Sum`|Возвращает значение NULL.|Возвращает значение NULL.|Возвращает сумму значений, отличных от NULL, в последовательности.|Вычисляет сумму последовательности числовых значений.|  
  
## <a name="type-methods"></a>Методы типов  
 В контексте [!INCLUDE[adonet_ef](../../../../../../includes/adonet-ef-md.md)] поддерживаются два метода LINQ, выполняющие преобразование и проверку типов. Это значит, что поддерживаются только те типы, которые сопоставляются с подходящими типами [!INCLUDE[adonet_ef](../../../../../../includes/adonet-ef-md.md)]. Список этих типов, см. в разделе [типов концептуальной модели (CSDL)](https://msdn.microsoft.com/library/987b995f-e429-4569-9559-b4146744def4). Методами типов являются методы `Convert` и `OfType`.  
  
 `OfType` поддерживается для типов сущностей. `Convert` поддерживается для типов-примитивов концептуальной модели.  Методы C# `is` и `as` также поддерживаются.  
  
## <a name="paging-methods"></a>Методы постраничного просмотра  
 Операции постраничного просмотра возвращают единственный элемент или несколько элементов из последовательности. Поддерживаемые методы разбиения по страницам: `First`, `FirstOrDefault`, `Single`, `SingleOrDefault`, `Skip`, и `Take`.  
  
 Ряд методов постраничного просмотра не поддерживаются, из-за невозможности сопоставления функций с источником данных или ввиду отсутствия неявного упорядочивания наборов в источнике данных. Методы, возвращающие значения по умолчанию, ограничены типами-примитивами концептуальной модели и ссылочными типами со значениями по умолчанию, равными null. Методы постраничного просмотра, примененные к пустой последовательности, возвращают значение NULL.  
  
## <a name="see-also"></a>См. также  
 [Поддерживаемые и неподдерживаемые методы LINQ (LINQ to Entities)](../../../../../../docs/framework/data/adonet/ef/language-reference/supported-and-unsupported-linq-methods-linq-to-entities.md)  
 [Общие сведения о стандартных операторах запроса](https://msdn.microsoft.com/library/24cda21e-8af8-4632-b519-c404a839b9b2)
