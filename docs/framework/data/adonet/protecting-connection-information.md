---
title: Защита сведений о подключении
ms.date: 03/30/2017
ms.assetid: 1471f580-bcd4-4046-bdaf-d2541ecda2f4
ms.openlocfilehash: 1039d3fd797a16391876b59aa018b30b7f397aeb
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/12/2020
ms.locfileid: "79149223"
---
# <a name="protecting-connection-information"></a><span data-ttu-id="bea8d-102">Защита сведений о подключении</span><span class="sxs-lookup"><span data-stu-id="bea8d-102">Protecting Connection Information</span></span>
<span data-ttu-id="bea8d-103">Защита доступа к источникам данным - одна из важнейших целей защиты приложения.</span><span class="sxs-lookup"><span data-stu-id="bea8d-103">Protecting access to your data source is one of the most important goals when securing an application.</span></span> <span data-ttu-id="bea8d-104">Строка соединения представляет собой потенциальную уязвимость, если она не защищена.</span><span class="sxs-lookup"><span data-stu-id="bea8d-104">A connection string presents a potential vulnerability if it is not secured.</span></span> <span data-ttu-id="bea8d-105">Сохранение сведений о соединении в виде простого текста или сохранение их в памяти представляет угрозу безопасности всей системы.</span><span class="sxs-lookup"><span data-stu-id="bea8d-105">Storing connection information in plain text or persisting it in memory risks compromising your entire system.</span></span> <span data-ttu-id="bea8d-106">Строки подключения, встроенные в исходный код, можно прочитать с помощью [Ildasm.exe (IL Disassembler)](../../tools/ildasm-exe-il-disassembler.md) для просмотра промежуточного языка Майкрософт (MSIL) в компилированной сборке.</span><span class="sxs-lookup"><span data-stu-id="bea8d-106">Connection strings embedded in your source code can be read using the [Ildasm.exe (IL Disassembler)](../../tools/ildasm-exe-il-disassembler.md) to view Microsoft intermediate language (MSIL) in a compiled assembly.</span></span>  
  
 <span data-ttu-id="bea8d-107">Уязвимые места системы безопасности, связанные со строками соединения, могут возникать в зависимости от используемого типа проверки подлинности, способа сохранения строк соединения в памяти или на диске, и методов, используемых для их конструирования </span><span class="sxs-lookup"><span data-stu-id="bea8d-107">Security vulnerabilities involving connection strings can arise based on the type of authentication used, how connection strings are persisted in memory and on disk, and the techniques used to construct them at run time.</span></span>  
  
## <a name="use-windows-authentication"></a><span data-ttu-id="bea8d-108">Использовать проверку подлинности Windows</span><span class="sxs-lookup"><span data-stu-id="bea8d-108">Use Windows Authentication</span></span>  
 <span data-ttu-id="bea8d-109">Чтобы ограничить доступ к источнику данных, необходимо защитить сведения о безопасном соединении, например, идентификатор пользователя, пароль и имя источника данных.</span><span class="sxs-lookup"><span data-stu-id="bea8d-109">To help limit access to your data source, you must secure connection information such as user ID, password, and data source name.</span></span> <span data-ttu-id="bea8d-110">Чтобы избежать раскрытия пользовательской информации, мы рекомендуем использовать проверку подлинности Windows (иногда называемую *интегрированной безопасностью),* где это возможно.</span><span class="sxs-lookup"><span data-stu-id="bea8d-110">In order to avoid exposing user information, we recommend using Windows authentication (sometimes referred to as *integrated security*) wherever possible.</span></span> <span data-ttu-id="bea8d-111">Проверка подлинности Windows указывается в строке соединения с помощью ключевых слов `Integrated Security` или `Trusted_Connection`, что исключает необходимость указывать идентификатор пользователя и пароль.</span><span class="sxs-lookup"><span data-stu-id="bea8d-111">Windows authentication is specified in a connection string by using the `Integrated Security` or `Trusted_Connection` keywords, eliminating the need to use a user ID and password.</span></span> <span data-ttu-id="bea8d-112">Когда используется проверка подлинности Windows, пользователей проверяет операционная система Windows, а доступ к ресурсам сервера и базы данных определяется предоставлением разрешений пользователям и группам Windows.</span><span class="sxs-lookup"><span data-stu-id="bea8d-112">When using Windows authentication, users are authenticated by Windows, and access to server and database resources is determined by granting permissions to Windows users and groups.</span></span>  
  
 <span data-ttu-id="bea8d-113">В ситуациях, когда невозможно использовать проверку подлинности Windows, необходимо проявлять дополнительную осторожность, так как учетные данные пользователя представлены в строке соединения.</span><span class="sxs-lookup"><span data-stu-id="bea8d-113">For situations where it is not possible to use Windows authentication, you must use extra care because user credentials are exposed in the connection string.</span></span> <span data-ttu-id="bea8d-114">В приложении ASP.NET можно настроить учетную запись Windows как фиксированное удостоверение, которое используется для подключения к базам данных и другим сетевым ресурсам.</span><span class="sxs-lookup"><span data-stu-id="bea8d-114">In an ASP.NET application, you can configure a Windows account as a fixed identity that is used to connect to databases and other network resources.</span></span> <span data-ttu-id="bea8d-115">Вы позволяете олицетворение в элементе идентификации в файле **web.config** и указать имя пользователя и пароль.</span><span class="sxs-lookup"><span data-stu-id="bea8d-115">You enable impersonation in the identity element in the **web.config** file and specify a user name and password.</span></span>  
  
```xml  
<identity impersonate="true"
        userName="MyDomain\UserAccount"
        password="*****" />  
```  
  
 <span data-ttu-id="bea8d-116">Фиксированная учетная запись идентификации должна быть учетной записью с ограниченными правами, которой предоставлены только необходимые разрешения в базе данных.</span><span class="sxs-lookup"><span data-stu-id="bea8d-116">The fixed identity account should be a low-privilege account that has been granted only necessary permissions in the database.</span></span> <span data-ttu-id="bea8d-117">Кроме того, нужно зашифровать файл конфигурации, чтобы имя пользователя и пароль не были представлены в виде открытого текста.</span><span class="sxs-lookup"><span data-stu-id="bea8d-117">In addition, you should encrypt the configuration file so that the user name and password are not exposed in clear text.</span></span>  
  
## <a name="do-not-use-universal-data-link-udl-files"></a><span data-ttu-id="bea8d-118">Не используйте файлы в формате UDL (Universal Data Link)</span><span class="sxs-lookup"><span data-stu-id="bea8d-118">Do Not Use Universal Data Link (UDL) files</span></span>  
 <span data-ttu-id="bea8d-119">Не храните строки соединения для <xref:System.Data.OleDb.OleDbConnection> в UDL-файле.</span><span class="sxs-lookup"><span data-stu-id="bea8d-119">Avoid storing connection strings for an <xref:System.Data.OleDb.OleDbConnection> in a Universal Data Link (UDL) file.</span></span> <span data-ttu-id="bea8d-120">Универсальные связи данных хранятся в виде открытого текста и не могут быть зашифрованы.</span><span class="sxs-lookup"><span data-stu-id="bea8d-120">UDLs are stored in clear text and cannot be encrypted.</span></span> <span data-ttu-id="bea8d-121">UDL-файл — внешний файловый ресурс для приложения, его нельзя защитить или зашифровать с помощью платформы .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="bea8d-121">A UDL file is an external file-based resource to your application, and it cannot be secured or encrypted using the .NET Framework.</span></span>  
  
## <a name="avoid-injection-attacks-with-connection-string-builders"></a><span data-ttu-id="bea8d-122">Защититесь от атак путем внедрения кода SQL с помощью построителей строк подключения</span><span class="sxs-lookup"><span data-stu-id="bea8d-122">Avoid Injection Attacks with Connection String Builders</span></span>  
 <span data-ttu-id="bea8d-123">Атака путем внедрения кода в строку соединения может произойти, когда для построения строк соединения на основе ввода пользователя используется динамическое объединение строк.</span><span class="sxs-lookup"><span data-stu-id="bea8d-123">A connection string injection attack can occur when dynamic string concatenation is used to build connection strings based on user input.</span></span> <span data-ttu-id="bea8d-124">Если входные данные пользователя не проверяются и опасный текст или символы не экранированы, то злоумышленник может получить доступ к конфиденциальным данным или другим ресурсам на сервере.</span><span class="sxs-lookup"><span data-stu-id="bea8d-124">If the user input is not validated and malicious text or characters not escaped, an attacker can potentially access sensitive data or other resources on the server.</span></span> <span data-ttu-id="bea8d-125">Чтобы устранить эту проблему, в ADO.NET 2.0 добавлены новые классы построителя строк подключения, позволяющие проверить синтаксис строки подключения и убедиться, что в нее не внесены дополнительные параметры.</span><span class="sxs-lookup"><span data-stu-id="bea8d-125">To address this problem, ADO.NET 2.0 introduced new connection string builder classes to validate connection string syntax and ensure that additional parameters are not introduced.</span></span> <span data-ttu-id="bea8d-126">Дополнительные сведения см. в статье [Connection String Builders](connection-string-builders.md) (Построители строк подключения).</span><span class="sxs-lookup"><span data-stu-id="bea8d-126">For more information, see [Connection String Builders](connection-string-builders.md).</span></span>  
  
## <a name="use-persist-security-infofalse"></a><span data-ttu-id="bea8d-127">Используйте значение False параметра Persist Security Info</span><span class="sxs-lookup"><span data-stu-id="bea8d-127">Use Persist Security Info=False</span></span>  
 <span data-ttu-id="bea8d-128">По умолчанию параметр `Persist Security Info` имеет значение false. Рекомендуется использовать это значение по умолчанию во всех строках соединения.</span><span class="sxs-lookup"><span data-stu-id="bea8d-128">The default value for `Persist Security Info` is false; we recommend using this default in all connection strings.</span></span> <span data-ttu-id="bea8d-129">Присвоение параметру `Persist Security Info` значения `true` или `yes` позволяет получить конфиденциальные сведения, в том числе идентификатор пользователя и пароль, из соединения после того, как оно будет открыто.</span><span class="sxs-lookup"><span data-stu-id="bea8d-129">Setting `Persist Security Info` to `true` or `yes` allows security-sensitive information, including the user ID and password, to be obtained from a connection after it has been opened.</span></span> <span data-ttu-id="bea8d-130">Если параметру `Persist Security Info` присвоено значение `false` или `no`, то сведения безопасности отбрасываются после того, как они используются для открытия соединения. Таким образом, ненадежный источник не получает доступа к конфиденциальным данным.</span><span class="sxs-lookup"><span data-stu-id="bea8d-130">When `Persist Security Info` is set to `false` or `no`, security information is discarded after it is used to open the connection, ensuring that an untrusted source does not have access to security-sensitive information.</span></span>  
  
## <a name="encrypt-configuration-files"></a><span data-ttu-id="bea8d-131">Шифрование файлов конфигурации</span><span class="sxs-lookup"><span data-stu-id="bea8d-131">Encrypt Configuration Files</span></span>  
 <span data-ttu-id="bea8d-132">Строки соединения можно сохранить в файлах конфигурации, что исключает необходимость внедрять их в код приложения.</span><span class="sxs-lookup"><span data-stu-id="bea8d-132">You can also store connection strings in configuration files, which eliminates the need to embed them in your application's code.</span></span> <span data-ttu-id="bea8d-133">Файлы конфигурации представляют собой стандартные XML-файлы, для которых в платформе .NET Framework определен типовой набор элементов.</span><span class="sxs-lookup"><span data-stu-id="bea8d-133">Configuration files are standard XML files for which the .NET Framework has defined a common set of elements.</span></span> <span data-ttu-id="bea8d-134">Строки подключения в файлах конфигурации обычно хранятся внутри \*\* \<соединений,>\*\* элемент в **app.config** для приложения Windows или файл **web.config** для ASP.NET приложения.</span><span class="sxs-lookup"><span data-stu-id="bea8d-134">Connection strings in configuration files are typically stored inside the **\<connectionStrings>** element in the **app.config** for a Windows application, or the **web.config** file for an ASP.NET application.</span></span> <span data-ttu-id="bea8d-135">Для получения дополнительной информации об основах хранения, извлечения и шифрования [Connection Strings and Configuration Files](connection-strings-and-configuration-files.md)строк соединения из файлов конфигурации см.</span><span class="sxs-lookup"><span data-stu-id="bea8d-135">For more information on the basics of storing, retrieving and encrypting connection strings from configuration files, see [Connection Strings and Configuration Files](connection-strings-and-configuration-files.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="bea8d-136">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="bea8d-136">See also</span></span>

- [<span data-ttu-id="bea8d-137">Защита приложений ADO.NET</span><span class="sxs-lookup"><span data-stu-id="bea8d-137">Securing ADO.NET Applications</span></span>](securing-ado-net-applications.md)
- <span data-ttu-id="bea8d-138">[Шифрование информации о конфигурации с использованием защищенной конфигурации](https://docs.microsoft.com/previous-versions/aspnet/53tyfkaw(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="bea8d-138">[Encrypting Configuration Information Using Protected Configuration](https://docs.microsoft.com/previous-versions/aspnet/53tyfkaw(v=vs.100))</span></span>
- [<span data-ttu-id="bea8d-139">Безопасность в .NET</span><span class="sxs-lookup"><span data-stu-id="bea8d-139">Security in .NET</span></span>](../../../standard/security/index.md)
- [<span data-ttu-id="bea8d-140">Общие сведения об ADO.NET</span><span class="sxs-lookup"><span data-stu-id="bea8d-140">ADO.NET Overview</span></span>](ado-net-overview.md)
