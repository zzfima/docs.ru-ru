---
title: Вопросы и ответы
ms.custom: ''
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: ''
ms.suite: ''
ms.technology:
- dotnet-ado
ms.tgt_pltfrm: ''
ms.topic: article
dev_langs:
- csharp
- vb
ms.assetid: 252ed666-0679-4eea-b71b-2f14117ef443
caps.latest.revision: 3
author: douglaslMS
ms.author: douglasl
manager: craigg
ms.workload:
- dotnet
ms.openlocfilehash: caccbb76f32c38f29fa4f49adc9b7b1c8fe4045d
ms.sourcegitcommit: 86adcc06e35390f13c1e372c36d2e044f1fc31ef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/26/2018
---
# <a name="frequently-asked-questions"></a><span data-ttu-id="d5cda-102">Вопросы и ответы</span><span class="sxs-lookup"><span data-stu-id="d5cda-102">Frequently Asked Questions</span></span>
<span data-ttu-id="d5cda-103">В следующих разделах даны ответы на некоторые вопросы, которые могут возникнуть при реализации [!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d5cda-103">The following sections answer some common issues that you might encounter when you implement [!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)].</span></span>  
  
 <span data-ttu-id="d5cda-104">Дополнительные проблемы рассматриваются в [Устранение неполадок](../../../../../../docs/framework/data/adonet/sql/linq/troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="d5cda-104">Additional issues are addressed in [Troubleshooting](../../../../../../docs/framework/data/adonet/sql/linq/troubleshooting.md).</span></span>  
  
## <a name="cannot-connect"></a><span data-ttu-id="d5cda-105">Не удается подключиться</span><span class="sxs-lookup"><span data-stu-id="d5cda-105">Cannot Connect</span></span>  
 <span data-ttu-id="d5cda-106">В.</span><span class="sxs-lookup"><span data-stu-id="d5cda-106">Q.</span></span> <span data-ttu-id="d5cda-107">Не удается соединиться с базой данных.</span><span class="sxs-lookup"><span data-stu-id="d5cda-107">I cannot connect to my database.</span></span>  
  
 <span data-ttu-id="d5cda-108">О.</span><span class="sxs-lookup"><span data-stu-id="d5cda-108">A.</span></span> <span data-ttu-id="d5cda-109">Убедитесь в строке подключения указано правильно и что экземпляр SQL Server запущена.</span><span class="sxs-lookup"><span data-stu-id="d5cda-109">Make sure your connection string is correct and that your SQL Server instance is running.</span></span> <span data-ttu-id="d5cda-110">Обратите внимание, что для [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] требуется включенный протокол именованных каналов.</span><span class="sxs-lookup"><span data-stu-id="d5cda-110">Note also that [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] requires the Named Pipes protocol to be enabled.</span></span> <span data-ttu-id="d5cda-111">Дополнительные сведения см. в разделе [обучения с использованием пошаговых руководств](../../../../../../docs/framework/data/adonet/sql/linq/learning-by-walkthroughs.md).</span><span class="sxs-lookup"><span data-stu-id="d5cda-111">For more information, see [Learning by Walkthroughs](../../../../../../docs/framework/data/adonet/sql/linq/learning-by-walkthroughs.md).</span></span>  
  
## <a name="changes-to-database-lost"></a><span data-ttu-id="d5cda-112">Потеряны изменения, внесенные в базу данных</span><span class="sxs-lookup"><span data-stu-id="d5cda-112">Changes to Database Lost</span></span>  
 <span data-ttu-id="d5cda-113">В.</span><span class="sxs-lookup"><span data-stu-id="d5cda-113">Q.</span></span> <span data-ttu-id="d5cda-114">В базу данных были внесены изменения, однако при повторном запуске приложения их там не оказалось.</span><span class="sxs-lookup"><span data-stu-id="d5cda-114">I made a change to data in the database, but when I reran my application, the change was no longer there.</span></span>  
  
 <span data-ttu-id="d5cda-115">О.</span><span class="sxs-lookup"><span data-stu-id="d5cda-115">A.</span></span> <span data-ttu-id="d5cda-116">Проверьте, что для сохранения результатов в базе данных был вызван метод <xref:System.Data.Linq.DataContext.SubmitChanges%2A>.</span><span class="sxs-lookup"><span data-stu-id="d5cda-116">Make sure that you call <xref:System.Data.Linq.DataContext.SubmitChanges%2A> to save results to the database.</span></span>  
  
## <a name="database-connection-open-how-long"></a><span data-ttu-id="d5cda-117">Как долго сохраняется открытым соединение с базой данных?</span><span class="sxs-lookup"><span data-stu-id="d5cda-117">Database Connection: Open How Long?</span></span>  
 <span data-ttu-id="d5cda-118">В.</span><span class="sxs-lookup"><span data-stu-id="d5cda-118">Q.</span></span> <span data-ttu-id="d5cda-119">Как долго соединение с базой данных будет оставаться открытым?</span><span class="sxs-lookup"><span data-stu-id="d5cda-119">How long does my database connection remain open?</span></span>  
  
 <span data-ttu-id="d5cda-120">О.</span><span class="sxs-lookup"><span data-stu-id="d5cda-120">A.</span></span> <span data-ttu-id="d5cda-121">Как правило, подключение остается открытым до тех пор, пока не будут использованы результаты запроса.</span><span class="sxs-lookup"><span data-stu-id="d5cda-121">A connection typically remains open until you consume the query results.</span></span> <span data-ttu-id="d5cda-122">Если планируется выделить время для обработки и кэширования всех результатов, к запросу следует применить <xref:System.Linq.Enumerable.ToList%2A>.</span><span class="sxs-lookup"><span data-stu-id="d5cda-122">If you expect to take time to process all the results and are not opposed to caching the results, apply <xref:System.Linq.Enumerable.ToList%2A> to the query.</span></span> <span data-ttu-id="d5cda-123">В типичных сценариях, где каждый объект обрабатывается только один раз, потоковая модель является предпочтительной в `DataReader` и [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d5cda-123">In common scenarios where each object is processed only one time, the streaming model is superior in both `DataReader` and [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)].</span></span>  
  
 <span data-ttu-id="d5cda-124">Точные сведения об использовании подключения зависят от следующих моментов.</span><span class="sxs-lookup"><span data-stu-id="d5cda-124">The exact details of connection usage depend on the following:</span></span>  
  
-   <span data-ttu-id="d5cda-125">Состояние подключения, если <xref:System.Data.Linq.DataContext> создан с помощью объекта подключения.</span><span class="sxs-lookup"><span data-stu-id="d5cda-125">Connection status if the <xref:System.Data.Linq.DataContext> is constructed with a connection object.</span></span>  
  
-   <span data-ttu-id="d5cda-126">Параметры строки подключения (например, включение режима MARS).</span><span class="sxs-lookup"><span data-stu-id="d5cda-126">Connection string settings (for example, enabling Multiple Active Result Sets (MARS).</span></span> <span data-ttu-id="d5cda-127">Дополнительные сведения см. в разделе [Несколько активных результирующих наборов (MARS)](../../../../../../docs/framework/data/adonet/sql/multiple-active-result-sets-mars.md).</span><span class="sxs-lookup"><span data-stu-id="d5cda-127">For more information, see [Multiple Active Result Sets (MARS)](../../../../../../docs/framework/data/adonet/sql/multiple-active-result-sets-mars.md).</span></span>  
  
## <a name="updating-without-querying"></a><span data-ttu-id="d5cda-128">Обновление без выполнения запросов</span><span class="sxs-lookup"><span data-stu-id="d5cda-128">Updating Without Querying</span></span>  
 <span data-ttu-id="d5cda-129">В.</span><span class="sxs-lookup"><span data-stu-id="d5cda-129">Q.</span></span> <span data-ttu-id="d5cda-130">Можно ли обновить данные таблицы, не отправляя запрос в базу данных?</span><span class="sxs-lookup"><span data-stu-id="d5cda-130">Can I update table data without first querying the database?</span></span>  
  
 <span data-ttu-id="d5cda-131">О.</span><span class="sxs-lookup"><span data-stu-id="d5cda-131">A.</span></span> <span data-ttu-id="d5cda-132">Хотя в [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] отсутствуют команды обновления на основе наборов, для обновления без выполнения запроса можно воспользоваться любым из следующих способов.</span><span class="sxs-lookup"><span data-stu-id="d5cda-132">Although [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] does not have set-based update commands, you can use either of the following techniques to update without first querying:</span></span>  
  
-   <span data-ttu-id="d5cda-133">Чтобы отправить код SQL, используйте <xref:System.Data.Linq.DataContext.ExecuteCommand%2A>.</span><span class="sxs-lookup"><span data-stu-id="d5cda-133">Use <xref:System.Data.Linq.DataContext.ExecuteCommand%2A> to send SQL code.</span></span>  
  
-   <span data-ttu-id="d5cda-134">Создайте новый экземпляр объекта и инициализируйте все текущие значения (поля), влияющие на обновление.</span><span class="sxs-lookup"><span data-stu-id="d5cda-134">Create a new instance of the object and initialize all the current values (fields) that affect the update.</span></span> <span data-ttu-id="d5cda-135">Затем прикрепите объект к <xref:System.Data.Linq.DataContext> с помощью <xref:System.Data.Linq.Table%601.Attach%2A> и отредактируйте поле, которое нужно изменить.</span><span class="sxs-lookup"><span data-stu-id="d5cda-135">Then attach the object to the <xref:System.Data.Linq.DataContext> by using <xref:System.Data.Linq.Table%601.Attach%2A> and modify the field you want to change.</span></span>  
  
## <a name="unexpected-query-results"></a><span data-ttu-id="d5cda-136">Неожиданные результаты запроса</span><span class="sxs-lookup"><span data-stu-id="d5cda-136">Unexpected Query Results</span></span>  
 <span data-ttu-id="d5cda-137">В.</span><span class="sxs-lookup"><span data-stu-id="d5cda-137">Q.</span></span> <span data-ttu-id="d5cda-138">Запрос возвращает непредвиденные результаты.</span><span class="sxs-lookup"><span data-stu-id="d5cda-138">My query is returning unexpected results.</span></span> <span data-ttu-id="d5cda-139">Как узнать, что случилось?</span><span class="sxs-lookup"><span data-stu-id="d5cda-139">How can I inspect what is occurring?</span></span>  
  
 <span data-ttu-id="d5cda-140">О.</span><span class="sxs-lookup"><span data-stu-id="d5cda-140">A.</span></span> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="d5cda-141"> предусматривает несколько средств для проверки создаваемого кода SQL.</span><span class="sxs-lookup"><span data-stu-id="d5cda-141"> provides several tools for inspecting the SQL code it generates.</span></span> <span data-ttu-id="d5cda-142">Одним из наиболее важных <xref:System.Data.Linq.DataContext.Log%2A>.</span><span class="sxs-lookup"><span data-stu-id="d5cda-142">One of the most important is <xref:System.Data.Linq.DataContext.Log%2A>.</span></span> <span data-ttu-id="d5cda-143">Дополнительные сведения см. в разделе [поддержка отладки](../../../../../../docs/framework/data/adonet/sql/linq/debugging-support.md).</span><span class="sxs-lookup"><span data-stu-id="d5cda-143">For more information, see [Debugging Support](../../../../../../docs/framework/data/adonet/sql/linq/debugging-support.md).</span></span>  
  
## <a name="unexpected-stored-procedure-results"></a><span data-ttu-id="d5cda-144">Неожиданные результаты хранимой процедуры</span><span class="sxs-lookup"><span data-stu-id="d5cda-144">Unexpected Stored Procedure Results</span></span>  
 <span data-ttu-id="d5cda-145">В.</span><span class="sxs-lookup"><span data-stu-id="d5cda-145">Q.</span></span> <span data-ttu-id="d5cda-146">Имеется хранимая процедура, возвращаемое значение которой вычислено с помощью функции `MAX()`.</span><span class="sxs-lookup"><span data-stu-id="d5cda-146">I have a stored procedure whose return value is calculated by `MAX()`.</span></span> <span data-ttu-id="d5cda-147">При перетаскивании процедуры в область [!INCLUDE[vs_ordesigner_short](../../../../../../includes/vs-ordesigner-short-md.md)] возвращаемое значение становится неверным.</span><span class="sxs-lookup"><span data-stu-id="d5cda-147">When I drag the stored procedure to the [!INCLUDE[vs_ordesigner_short](../../../../../../includes/vs-ordesigner-short-md.md)] surface, the return value is not correct.</span></span>  
  
 <span data-ttu-id="d5cda-148">О.</span><span class="sxs-lookup"><span data-stu-id="d5cda-148">A.</span></span> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="d5cda-149"> обеспечивает два способа возврата значений, сформированных в базе данных, с помощью хранимых процедур.</span><span class="sxs-lookup"><span data-stu-id="d5cda-149"> provides two ways to return database-generated values by way of stored procedures:</span></span>  
  
-   <span data-ttu-id="d5cda-150">Путем именования выходного результата.</span><span class="sxs-lookup"><span data-stu-id="d5cda-150">By naming the output result.</span></span>  
  
-   <span data-ttu-id="d5cda-151">Путем явного указания выходного параметра.</span><span class="sxs-lookup"><span data-stu-id="d5cda-151">By explicitly specifying an output parameter.</span></span>  
  
 <span data-ttu-id="d5cda-152">Ниже представлен пример неверных выходных данных.</span><span class="sxs-lookup"><span data-stu-id="d5cda-152">The following is an example of incorrect output.</span></span> <span data-ttu-id="d5cda-153">Поскольку [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] не может сопоставить результаты, он всегда возвращает 0.</span><span class="sxs-lookup"><span data-stu-id="d5cda-153">Because [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] cannot map the results, it always returns 0:</span></span>  
  
 `create procedure proc2`  
  
 `as`  
  
 `begin`  
  
 `select max(i) from t where name like 'hello'`  
  
 `end`  
  
 <span data-ttu-id="d5cda-154">Ниже представлен пример правильных выходных данных с использованием выходного параметра.</span><span class="sxs-lookup"><span data-stu-id="d5cda-154">The following is an example of correct output by using an output parameter:</span></span>  
  
 `create procedure proc2`  
  
 `@result int OUTPUT`  
  
 `as`  
  
 `select @result = MAX(i) from t where name like 'hello'`  
  
 `go`  
  
 <span data-ttu-id="d5cda-155">Ниже представлен пример правильных выходных данных с именованием выходного результата.</span><span class="sxs-lookup"><span data-stu-id="d5cda-155">The following is an example of correct output by naming the output result:</span></span>  
  
 `create procedure proc2`  
  
 `as`  
  
 `begin`  
  
 `select nax(i) AS MaxResult from t where name like 'hello'`  
  
 `end`  
  
 <span data-ttu-id="d5cda-156">Дополнительные сведения см. в разделе [Настройка операций за счет хранимых процедур](../../../../../../docs/framework/data/adonet/sql/linq/customizing-operations-by-using-stored-procedures.md).</span><span class="sxs-lookup"><span data-stu-id="d5cda-156">For more information, see [Customizing Operations By Using Stored Procedures](../../../../../../docs/framework/data/adonet/sql/linq/customizing-operations-by-using-stored-procedures.md).</span></span>  
  
## <a name="serialization-errors"></a><span data-ttu-id="d5cda-157">Ошибки сериализации</span><span class="sxs-lookup"><span data-stu-id="d5cda-157">Serialization Errors</span></span>  
 <span data-ttu-id="d5cda-158">В.</span><span class="sxs-lookup"><span data-stu-id="d5cda-158">Q.</span></span> <span data-ttu-id="d5cda-159">При попытке сериализации возникает следующая ошибка: «тип «System.Data.Linq.ChangeTracker+StandardChangeTracker»... не помечен как сериализуемый.»</span><span class="sxs-lookup"><span data-stu-id="d5cda-159">When I try to serialize, I get the following error: "Type 'System.Data.Linq.ChangeTracker+StandardChangeTracker' ... is not marked as serializable."</span></span>  
  
 <span data-ttu-id="d5cda-160">О.</span><span class="sxs-lookup"><span data-stu-id="d5cda-160">A.</span></span> <span data-ttu-id="d5cda-161">Формирование кода в [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] поддерживает сериализацию <xref:System.Runtime.Serialization.DataContractSerializer>.</span><span class="sxs-lookup"><span data-stu-id="d5cda-161">Code generation in [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] supports <xref:System.Runtime.Serialization.DataContractSerializer> serialization.</span></span> <span data-ttu-id="d5cda-162">Оно не поддерживает <xref:System.Xml.Serialization.XmlSerializer> или <xref:System.Runtime.Serialization.Formatters.Binary.BinaryFormatter>.</span><span class="sxs-lookup"><span data-stu-id="d5cda-162">It does not support <xref:System.Xml.Serialization.XmlSerializer> or <xref:System.Runtime.Serialization.Formatters.Binary.BinaryFormatter>.</span></span> <span data-ttu-id="d5cda-163">Дополнительные сведения см. в разделе [Сериализация](../../../../../../docs/framework/data/adonet/sql/linq/serialization.md).</span><span class="sxs-lookup"><span data-stu-id="d5cda-163">For more information, see [Serialization](../../../../../../docs/framework/data/adonet/sql/linq/serialization.md).</span></span>  
  
## <a name="multiple-dbml-files"></a><span data-ttu-id="d5cda-164">Несколько DBML-файлов</span><span class="sxs-lookup"><span data-stu-id="d5cda-164">Multiple DBML Files</span></span>  
 <span data-ttu-id="d5cda-165">В.</span><span class="sxs-lookup"><span data-stu-id="d5cda-165">Q.</span></span> <span data-ttu-id="d5cda-166">При работе с несколькими DBML-файлами, использующими общие таблицы, возникает ошибка компилятора.</span><span class="sxs-lookup"><span data-stu-id="d5cda-166">When I have multiple DBML files that share some tables in common, I get a compiler error.</span></span>  
  
 <span data-ttu-id="d5cda-167">О.</span><span class="sxs-lookup"><span data-stu-id="d5cda-167">A.</span></span> <span data-ttu-id="d5cda-168">Задать **контекстное пространство имен** и **пространство имен сущностей** свойства из [!INCLUDE[vs_ordesigner_long](../../../../../../includes/vs-ordesigner-long-md.md)] в разные значения в каждом DBML-файле.</span><span class="sxs-lookup"><span data-stu-id="d5cda-168">Set the **Context Namespace** and **Entity Namespace** properties from the [!INCLUDE[vs_ordesigner_long](../../../../../../includes/vs-ordesigner-long-md.md)] to a distinct value for each DBML file.</span></span> <span data-ttu-id="d5cda-169">Это способ исключает конфликты имен/пространств имен.</span><span class="sxs-lookup"><span data-stu-id="d5cda-169">This approach eliminates the name/namespace collision.</span></span>  
  
## <a name="avoiding-explicit-setting-of-database-generated-values-on-insert-or-update"></a><span data-ttu-id="d5cda-170">Предупреждение явного задания значений, созданных базой данных, в Insert или Update</span><span class="sxs-lookup"><span data-stu-id="d5cda-170">Avoiding Explicit Setting of Database-Generated Values on Insert or Update</span></span>  
 <span data-ttu-id="d5cda-171">В.</span><span class="sxs-lookup"><span data-stu-id="d5cda-171">Q.</span></span> <span data-ttu-id="d5cda-172">В базе данных имеется таблица со столбцом `DateCreated`, в качестве значения по умолчанию которой указана функция SQL `Getdate()`.</span><span class="sxs-lookup"><span data-stu-id="d5cda-172">I have a database table with a `DateCreated` column that defaults to SQL `Getdate()`.</span></span> <span data-ttu-id="d5cda-173">При попытке вставить новую запись с помощью [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] возвращается значение `NULL`.</span><span class="sxs-lookup"><span data-stu-id="d5cda-173">When I try to insert a new record by using [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)], the value gets set to `NULL`.</span></span> <span data-ttu-id="d5cda-174">Хотя ожидается заданное по умолчанию значение базы данных.</span><span class="sxs-lookup"><span data-stu-id="d5cda-174">I would expect it to be set to the database default.</span></span>  
  
 <span data-ttu-id="d5cda-175">О.</span><span class="sxs-lookup"><span data-stu-id="d5cda-175">A.</span></span> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="d5cda-176"> автоматически обрабатывает данную ситуацию для столбцов identity (автоувеличение), rowguidcol (формируемые базой данных идентификаторы GUID) и timestamp.</span><span class="sxs-lookup"><span data-stu-id="d5cda-176"> handles this situation automatically for identity (auto-increment) and rowguidcol (database-generated GUID) and timestamp columns.</span></span> <span data-ttu-id="d5cda-177">В других случаях необходимо вручную задать <xref:System.Data.Linq.Mapping.ColumnAttribute.IsDbGenerated%2A> = `true` и <xref:System.Data.Linq.Mapping.ColumnAttribute.AutoSync%2A> = <xref:System.Data.Linq.Mapping.AutoSync.Always> / <xref:System.Data.Linq.Mapping.AutoSync.OnInsert> / <xref:System.Data.Linq.Mapping.AutoSync.OnUpdate> свойства.</span><span class="sxs-lookup"><span data-stu-id="d5cda-177">In other cases, you should manually set <xref:System.Data.Linq.Mapping.ColumnAttribute.IsDbGenerated%2A>=`true` and <xref:System.Data.Linq.Mapping.ColumnAttribute.AutoSync%2A>=<xref:System.Data.Linq.Mapping.AutoSync.Always>/<xref:System.Data.Linq.Mapping.AutoSync.OnInsert>/<xref:System.Data.Linq.Mapping.AutoSync.OnUpdate> properties.</span></span>  
  
## <a name="multiple-dataloadoptions"></a><span data-ttu-id="d5cda-178">Несколько параметров DataLoadOptions</span><span class="sxs-lookup"><span data-stu-id="d5cda-178">Multiple DataLoadOptions</span></span>  
 <span data-ttu-id="d5cda-179">В.</span><span class="sxs-lookup"><span data-stu-id="d5cda-179">Q.</span></span> <span data-ttu-id="d5cda-180">Можно ли задать дополнительные параметры загрузки, не переопределяя исходные?</span><span class="sxs-lookup"><span data-stu-id="d5cda-180">Can I specify additional load options without overwriting the first?</span></span>  
  
 <span data-ttu-id="d5cda-181">О.</span><span class="sxs-lookup"><span data-stu-id="d5cda-181">A.</span></span> <span data-ttu-id="d5cda-182">Да.</span><span class="sxs-lookup"><span data-stu-id="d5cda-182">Yes.</span></span> <span data-ttu-id="d5cda-183">Исходные параметры не переопределяются, как показано в следующем примере.</span><span class="sxs-lookup"><span data-stu-id="d5cda-183">The first is not overwritten, as in the following example:</span></span>  
  
```vb  
Dim dlo As New DataLoadOptions()  
dlo.LoadWith(Of Order)(Function(o As Order) o.Customer)  
dlo.LoadWith(Of Order)(Function(o As Order) o.OrderDetails)  
```  
  
```csharp  
DataLoadOptions dlo = new DataLoadOptions();  
dlo.LoadWith<Order>(o => o.Customer);  
dlo.LoadWith<Order>(o => o.OrderDetails);  
```  
  
## <a name="errors-using-sql-compact-35"></a><span data-ttu-id="d5cda-184">Ошибки при использовании SQL Compact 3.5</span><span class="sxs-lookup"><span data-stu-id="d5cda-184">Errors Using SQL Compact 3.5</span></span>  
 <span data-ttu-id="d5cda-185">В.</span><span class="sxs-lookup"><span data-stu-id="d5cda-185">Q.</span></span> <span data-ttu-id="d5cda-186">При перетаскивании таблиц из базы данных [!INCLUDE[ssEW](../../../../../../includes/ssew-md.md)] возникает ошибка.</span><span class="sxs-lookup"><span data-stu-id="d5cda-186">I get an error when I drag tables out of a [!INCLUDE[ssEW](../../../../../../includes/ssew-md.md)] database.</span></span>  
  
 <span data-ttu-id="d5cda-187">О.</span><span class="sxs-lookup"><span data-stu-id="d5cda-187">A.</span></span> <span data-ttu-id="d5cda-188">[!INCLUDE[vs_ordesigner_long](../../../../../../includes/vs-ordesigner-long-md.md)], в отличие от среды выполнения [!INCLUDE[ssEW](../../../../../../includes/ssew-md.md)], не поддерживает [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d5cda-188">The [!INCLUDE[vs_ordesigner_long](../../../../../../includes/vs-ordesigner-long-md.md)] does not support [!INCLUDE[ssEW](../../../../../../includes/ssew-md.md)], although the [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] runtime does.</span></span> <span data-ttu-id="d5cda-189">В этом случае необходимо создать собственные классы сущностей и добавить соответствующие атрибуты.</span><span class="sxs-lookup"><span data-stu-id="d5cda-189">In this situation, you must create your own entity classes and add the appropriate attributes.</span></span>  
  
## <a name="errors-in-inheritance-relationships"></a><span data-ttu-id="d5cda-190">Ошибки в связях наследования</span><span class="sxs-lookup"><span data-stu-id="d5cda-190">Errors in Inheritance Relationships</span></span>  
 <span data-ttu-id="d5cda-191">В.</span><span class="sxs-lookup"><span data-stu-id="d5cda-191">Q.</span></span> <span data-ttu-id="d5cda-192">При использовании фигуры наследования панели элементов в [!INCLUDE[vs_ordesigner_long](../../../../../../includes/vs-ordesigner-long-md.md)] для соединения двух объектов возникают ошибки.</span><span class="sxs-lookup"><span data-stu-id="d5cda-192">I used the toolbox inheritance shape in the [!INCLUDE[vs_ordesigner_long](../../../../../../includes/vs-ordesigner-long-md.md)] to connect two entities, but I get errors.</span></span>  
  
 <span data-ttu-id="d5cda-193">О.</span><span class="sxs-lookup"><span data-stu-id="d5cda-193">A.</span></span> <span data-ttu-id="d5cda-194">Простого создания связи недостаточно.</span><span class="sxs-lookup"><span data-stu-id="d5cda-194">Creating the relationship is not enough.</span></span> <span data-ttu-id="d5cda-195">Необходимо предоставить сведения, такие как столбец дискриминатора, значение дискриминатора базового класса и значение дискриминатора производного класса.</span><span class="sxs-lookup"><span data-stu-id="d5cda-195">You must provide information such as the discriminator column, base class discriminator value, and derived class discriminator value.</span></span>  
  
## <a name="provider-model"></a><span data-ttu-id="d5cda-196">Модель поставщика</span><span class="sxs-lookup"><span data-stu-id="d5cda-196">Provider Model</span></span>  
 <span data-ttu-id="d5cda-197">В.</span><span class="sxs-lookup"><span data-stu-id="d5cda-197">Q.</span></span> <span data-ttu-id="d5cda-198">Доступна ли модель общего поставщика?</span><span class="sxs-lookup"><span data-stu-id="d5cda-198">Is a public provider model available?</span></span>  
  
 <span data-ttu-id="d5cda-199">О.</span><span class="sxs-lookup"><span data-stu-id="d5cda-199">A.</span></span> <span data-ttu-id="d5cda-200">Такая модель отсутствует.</span><span class="sxs-lookup"><span data-stu-id="d5cda-200">No public provider model is available.</span></span> <span data-ttu-id="d5cda-201">В настоящее время [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] поддерживает SQL Server и [!INCLUDE[ssEW](../../../../../../includes/ssew-md.md)] только.</span><span class="sxs-lookup"><span data-stu-id="d5cda-201">At this time, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] supports SQL Server and [!INCLUDE[ssEW](../../../../../../includes/ssew-md.md)] only.</span></span>  
  
## <a name="sql-injection-attacks"></a><span data-ttu-id="d5cda-202">Атаки путем внедрения кода SQL</span><span class="sxs-lookup"><span data-stu-id="d5cda-202">SQL-Injection Attacks</span></span>  
 <span data-ttu-id="d5cda-203">В.</span><span class="sxs-lookup"><span data-stu-id="d5cda-203">Q.</span></span> <span data-ttu-id="d5cda-204">Каким образом [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] защищен от атак путем внедрения кода SQL?</span><span class="sxs-lookup"><span data-stu-id="d5cda-204">How is [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] protected from SQL-injection attacks?</span></span>  
  
 <span data-ttu-id="d5cda-205">О.</span><span class="sxs-lookup"><span data-stu-id="d5cda-205">A.</span></span> <span data-ttu-id="d5cda-206">Внедрение SQL-кода представляло серьезную угрозу для традиционных SQL-запросов, создаваемых путем объединения данных, вводимых пользователем.</span><span class="sxs-lookup"><span data-stu-id="d5cda-206">SQL injection has been a significant risk for traditional SQL queries formed by concatenating user input.</span></span> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="d5cda-207"> предотвращает подобное внедрение за счет использования в запросах объектов <xref:System.Data.SqlClient.SqlParameter>.</span><span class="sxs-lookup"><span data-stu-id="d5cda-207"> avoids such injection by using <xref:System.Data.SqlClient.SqlParameter> in queries.</span></span> <span data-ttu-id="d5cda-208">Вводимые данные преобразуются в значения параметров.</span><span class="sxs-lookup"><span data-stu-id="d5cda-208">User input is turned into parameter values.</span></span> <span data-ttu-id="d5cda-209">Этот способ исключает использование вредоносных команд из введенных данных.</span><span class="sxs-lookup"><span data-stu-id="d5cda-209">This approach prevents malicious commands from being used from customer input.</span></span>  
  
## <a name="changing-read-only-flag-in-dbml-files"></a><span data-ttu-id="d5cda-210">Создание флага "Только чтение" в файлах DBML.</span><span class="sxs-lookup"><span data-stu-id="d5cda-210">Changing Read-only Flag in DBML Files</span></span>  
 <span data-ttu-id="d5cda-211">В.</span><span class="sxs-lookup"><span data-stu-id="d5cda-211">Q.</span></span> <span data-ttu-id="d5cda-212">Как можно избавиться от некоторых методов задания свойств при создании объектной модели из файла DBM?</span><span class="sxs-lookup"><span data-stu-id="d5cda-212">How do I eliminate setters from some properties when I create an object model from a DBML file?</span></span>  
  
 <span data-ttu-id="d5cda-213">О.</span><span class="sxs-lookup"><span data-stu-id="d5cda-213">A.</span></span> <span data-ttu-id="d5cda-214">Выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="d5cda-214">Take the following steps for this advanced scenario:</span></span>  
  
1.  <span data-ttu-id="d5cda-215">В файле DBML измените свойство, присвоив флагу <xref:System.Data.Linq.ITable.IsReadOnly%2A> значение `True`.</span><span class="sxs-lookup"><span data-stu-id="d5cda-215">In the .dbml file, modify the property by changing the <xref:System.Data.Linq.ITable.IsReadOnly%2A> flag to `True`.</span></span>  
  
2.  <span data-ttu-id="d5cda-216">Добавьте разделяемый класс.</span><span class="sxs-lookup"><span data-stu-id="d5cda-216">Add a partial class.</span></span> <span data-ttu-id="d5cda-217">Создайте конструктор с параметрами для членов, доступных только для чтения.</span><span class="sxs-lookup"><span data-stu-id="d5cda-217">Create a constructor with parameters for the read-only members.</span></span>  
  
3.  <span data-ttu-id="d5cda-218">Проверьте значение по умолчанию <xref:System.Data.Linq.Mapping.UpdateCheck> (<xref:System.Data.Linq.Mapping.UpdateCheck.Never>), чтобы определить, является ли оно правильным для приложения.</span><span class="sxs-lookup"><span data-stu-id="d5cda-218">Review the default <xref:System.Data.Linq.Mapping.UpdateCheck> value (<xref:System.Data.Linq.Mapping.UpdateCheck.Never>) to determine whether that is the correct value for your application.</span></span>  
  
    > [!CAUTION]
    >  <span data-ttu-id="d5cda-219">Если вы используете [!INCLUDE[vs_ordesigner_long](../../../../../../includes/vs-ordesigner-long-md.md)] в Visual Studio изменения могут быть перезаписаны.</span><span class="sxs-lookup"><span data-stu-id="d5cda-219">If you are using the [!INCLUDE[vs_ordesigner_long](../../../../../../includes/vs-ordesigner-long-md.md)] in Visual Studio, your changes might be overwritten.</span></span>  
  
## <a name="aptca"></a><span data-ttu-id="d5cda-220">APTCA</span><span class="sxs-lookup"><span data-stu-id="d5cda-220">APTCA</span></span>  
 <span data-ttu-id="d5cda-221">В.</span><span class="sxs-lookup"><span data-stu-id="d5cda-221">Q.</span></span> <span data-ttu-id="d5cda-222">Помечена ли сборка System.Data.Linq для использования кодом с частичным доверием?</span><span class="sxs-lookup"><span data-stu-id="d5cda-222">Is System.Data.Linq marked for use by partially trusted code?</span></span>  
  
 <span data-ttu-id="d5cda-223">О.</span><span class="sxs-lookup"><span data-stu-id="d5cda-223">A.</span></span> <span data-ttu-id="d5cda-224">Да, сборка System.Data.Linq.dll входит в число сборок [!INCLUDE[dnprdnshort](../../../../../../includes/dnprdnshort-md.md)], отмеченных атрибутом <xref:System.Security.AllowPartiallyTrustedCallersAttribute>.</span><span class="sxs-lookup"><span data-stu-id="d5cda-224">Yes, the System.Data.Linq.dll assembly is among those [!INCLUDE[dnprdnshort](../../../../../../includes/dnprdnshort-md.md)] assemblies marked with the <xref:System.Security.AllowPartiallyTrustedCallersAttribute> attribute.</span></span> <span data-ttu-id="d5cda-225">Без данной отметки сборки в [!INCLUDE[dnprdnshort](../../../../../../includes/dnprdnshort-md.md)] предназначены для использования только полностью доверенным кодом.</span><span class="sxs-lookup"><span data-stu-id="d5cda-225">Without this marking, assemblies in the [!INCLUDE[dnprdnshort](../../../../../../includes/dnprdnshort-md.md)] are intended for use only by fully trusted code.</span></span>  
  
 <span data-ttu-id="d5cda-226">Основной сценарий в [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] разрешающий частично доверенный вызывающий код, предусматривает Включение [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] сборке доступны из веб-приложений, где *доверия* конфигурации используется значение Medium.</span><span class="sxs-lookup"><span data-stu-id="d5cda-226">The principal scenario in [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] for allowing partially trusted callers is to enable the [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] assembly to be accessed from Web applications, where the *trust* configuration is Medium.</span></span>  
  
## <a name="mapping-data-from-multiple-tables"></a><span data-ttu-id="d5cda-227">Сопоставление данных из нескольких таблиц</span><span class="sxs-lookup"><span data-stu-id="d5cda-227">Mapping Data from Multiple Tables</span></span>  
 <span data-ttu-id="d5cda-228">В.</span><span class="sxs-lookup"><span data-stu-id="d5cda-228">Q.</span></span> <span data-ttu-id="d5cda-229">Данные в сущность поступают из нескольких таблиц.</span><span class="sxs-lookup"><span data-stu-id="d5cda-229">The data in my entity comes from multiple tables.</span></span> <span data-ttu-id="d5cda-230">Как их сопоставить?</span><span class="sxs-lookup"><span data-stu-id="d5cda-230">How do I map it?</span></span>  
  
 <span data-ttu-id="d5cda-231">О.</span><span class="sxs-lookup"><span data-stu-id="d5cda-231">A.</span></span> <span data-ttu-id="d5cda-232">В базе данных можно создать представление и сопоставить с ним сущность.</span><span class="sxs-lookup"><span data-stu-id="d5cda-232">You can create a view in a database and map the entity to the view.</span></span> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="d5cda-233"> создает одинаковый SQL-код для представлений и таблиц.</span><span class="sxs-lookup"><span data-stu-id="d5cda-233"> generates the same SQL for views as it does for tables.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="d5cda-234">В данном сценарии использование представлений имеет ограничения.</span><span class="sxs-lookup"><span data-stu-id="d5cda-234">The use of views in this scenario has limitations.</span></span> <span data-ttu-id="d5cda-235">Способ работает с максимальной безопасностью, если операции, выполняемые в <xref:System.Data.Linq.Table%601>, поддерживаются базовым представлением.</span><span class="sxs-lookup"><span data-stu-id="d5cda-235">This approach works most safely when the operations performed on <xref:System.Data.Linq.Table%601> are supported by the underlying view.</span></span> <span data-ttu-id="d5cda-236">Операции, которые предполагается использовать, известны только вам.</span><span class="sxs-lookup"><span data-stu-id="d5cda-236">Only you know which operations are intended.</span></span> <span data-ttu-id="d5cda-237">Например, большинство приложений доступно только для чтения, а другая значительная часть выполняет `Create` / `Update` / `Delete` операции только с помощью хранимых процедур в представлениях.</span><span class="sxs-lookup"><span data-stu-id="d5cda-237">For example, most applications are read-only, and another sizeable number perform `Create`/`Update`/`Delete` operations only by using stored procedures against views.</span></span>  
  
## <a name="connection-pooling"></a><span data-ttu-id="d5cda-238">Объединение подключений в пул</span><span class="sxs-lookup"><span data-stu-id="d5cda-238">Connection Pooling</span></span>  
 <span data-ttu-id="d5cda-239">В.</span><span class="sxs-lookup"><span data-stu-id="d5cda-239">Q.</span></span> <span data-ttu-id="d5cda-240">Существует ли конструкция, которая поможет в организации пула объектов <xref:System.Data.Linq.DataContext>?</span><span class="sxs-lookup"><span data-stu-id="d5cda-240">Is there a construct that can help with <xref:System.Data.Linq.DataContext> pooling?</span></span>  
  
 <span data-ttu-id="d5cda-241">О.</span><span class="sxs-lookup"><span data-stu-id="d5cda-241">A.</span></span> <span data-ttu-id="d5cda-242">Не пытайтесь повторно использовать экземпляры <xref:System.Data.Linq.DataContext>.</span><span class="sxs-lookup"><span data-stu-id="d5cda-242">Do not try to reuse instances of <xref:System.Data.Linq.DataContext>.</span></span> <span data-ttu-id="d5cda-243">Каждый <xref:System.Data.Linq.DataContext> сохраняет состояние (включая кэш идентификации) для одного определенного сеанса редактирования/запроса.</span><span class="sxs-lookup"><span data-stu-id="d5cda-243">Each <xref:System.Data.Linq.DataContext> maintains state (including an identity cache) for one particular edit/query session.</span></span> <span data-ttu-id="d5cda-244">Для получения новых экземпляров на основе текущего состояния базы данных используйте новый <xref:System.Data.Linq.DataContext>.</span><span class="sxs-lookup"><span data-stu-id="d5cda-244">To obtain new instances based on the current state of the database, use a new <xref:System.Data.Linq.DataContext>.</span></span>  
  
 <span data-ttu-id="d5cda-245">Можно по-прежнему использовать базовое объединение подключений [!INCLUDE[vstecado](../../../../../../includes/vstecado-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d5cda-245">You can still use underlying [!INCLUDE[vstecado](../../../../../../includes/vstecado-md.md)] connection pooling.</span></span> <span data-ttu-id="d5cda-246">Дополнительные сведения см. в разделе [Пулы подключений SQL Server (ADO.NET)](../../../../../../docs/framework/data/adonet/sql-server-connection-pooling.md).</span><span class="sxs-lookup"><span data-stu-id="d5cda-246">For more information, see [SQL Server Connection Pooling (ADO.NET)](../../../../../../docs/framework/data/adonet/sql-server-connection-pooling.md).</span></span>  
  
## <a name="second-datacontext-is-not-updated"></a><span data-ttu-id="d5cda-247">Не выполняется обновление второго DataContext</span><span class="sxs-lookup"><span data-stu-id="d5cda-247">Second DataContext Is Not Updated</span></span>  
 <span data-ttu-id="d5cda-248">В.</span><span class="sxs-lookup"><span data-stu-id="d5cda-248">Q.</span></span> <span data-ttu-id="d5cda-249">Для хранения значения в базе данных использовался один экземпляр <xref:System.Data.Linq.DataContext>.</span><span class="sxs-lookup"><span data-stu-id="d5cda-249">I used one instance of <xref:System.Data.Linq.DataContext> to store values in the database.</span></span> <span data-ttu-id="d5cda-250">Однако второй <xref:System.Data.Linq.DataContext> в той же базе данных не отражает обновленные значения.</span><span class="sxs-lookup"><span data-stu-id="d5cda-250">However, a second <xref:System.Data.Linq.DataContext> on the same database does not reflect the updated values.</span></span> <span data-ttu-id="d5cda-251">Второй экземпляр <xref:System.Data.Linq.DataContext>, вероятно, возвращает кэшированные значения.</span><span class="sxs-lookup"><span data-stu-id="d5cda-251">The second <xref:System.Data.Linq.DataContext> instance seems to return cached values.</span></span>  
  
 <span data-ttu-id="d5cda-252">О.</span><span class="sxs-lookup"><span data-stu-id="d5cda-252">A.</span></span> <span data-ttu-id="d5cda-253">Это сделано намеренно.</span><span class="sxs-lookup"><span data-stu-id="d5cda-253">This behavior is by design.</span></span> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="d5cda-254"> по-прежнему возвращает те же экземпляры и значения, которые отображались в первом экземпляре.</span><span class="sxs-lookup"><span data-stu-id="d5cda-254"> continues to return the same instances/values that you saw in the first instance.</span></span> <span data-ttu-id="d5cda-255">При выполнении обновлений используется оптимистическая блокировка.</span><span class="sxs-lookup"><span data-stu-id="d5cda-255">When you make updates, you use optimistic concurrency.</span></span> <span data-ttu-id="d5cda-256">Для проверки текущего состояния базы данных используются исходные данные, которые подтверждают неизменность ее состояния.</span><span class="sxs-lookup"><span data-stu-id="d5cda-256">The original data is used to check against the current database state to assert that it is in fact still unchanged.</span></span> <span data-ttu-id="d5cda-257">Если состояние изменилось, возникает конфликт, который должен быть устранен приложением.</span><span class="sxs-lookup"><span data-stu-id="d5cda-257">If it has changed, a conflict occurs and your application must resolve it.</span></span> <span data-ttu-id="d5cda-258">Одним вариантом является сброс исходного состояния до текущего состояния базы данных и повторная попытка обновления.</span><span class="sxs-lookup"><span data-stu-id="d5cda-258">One option of your application is to reset the original state to the current database state and to try the update again.</span></span> <span data-ttu-id="d5cda-259">Дополнительные сведения см. в разделе [как: управление конфликтами изменений](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md).</span><span class="sxs-lookup"><span data-stu-id="d5cda-259">For more information, see [How to: Manage Change Conflicts](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md).</span></span>  
  
 <span data-ttu-id="d5cda-260">Кроме того, <xref:System.Data.Linq.DataContext.ObjectTrackingEnabled%2A> можно задать значение «false», которое отключает кэширование и отслеживание изменений.</span><span class="sxs-lookup"><span data-stu-id="d5cda-260">You can also set <xref:System.Data.Linq.DataContext.ObjectTrackingEnabled%2A> to false, which turns off caching and change tracking.</span></span> <span data-ttu-id="d5cda-261">После этого самые последние значения можно будет извлекать при каждом запросе.</span><span class="sxs-lookup"><span data-stu-id="d5cda-261">You can then retrieve the latest values every time that you query.</span></span>  
  
## <a name="cannot-call-submitchanges-in-read-only-mode"></a><span data-ttu-id="d5cda-262">Не удается вызвать метод SubmitChanges в режиме "только чтение"</span><span class="sxs-lookup"><span data-stu-id="d5cda-262">Cannot Call SubmitChanges in Read-only Mode</span></span>  
 <span data-ttu-id="d5cda-263">В.</span><span class="sxs-lookup"><span data-stu-id="d5cda-263">Q.</span></span> <span data-ttu-id="d5cda-264">При попытке вызова метода <xref:System.Data.Linq.DataContext.SubmitChanges%2A> в режиме только для чтения возникает ошибка.</span><span class="sxs-lookup"><span data-stu-id="d5cda-264">When I try to call <xref:System.Data.Linq.DataContext.SubmitChanges%2A> in read-only mode, I get an error.</span></span>  
  
 <span data-ttu-id="d5cda-265">О.</span><span class="sxs-lookup"><span data-stu-id="d5cda-265">A.</span></span> <span data-ttu-id="d5cda-266">Режим только для чтения отключает для контекста возможность отслеживания изменений.</span><span class="sxs-lookup"><span data-stu-id="d5cda-266">Read-only mode turns off the ability of the context to track changes.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d5cda-267">См. также</span><span class="sxs-lookup"><span data-stu-id="d5cda-267">See Also</span></span>  
 [<span data-ttu-id="d5cda-268">Ссылки</span><span class="sxs-lookup"><span data-stu-id="d5cda-268">Reference</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/reference.md)  
 [<span data-ttu-id="d5cda-269">Устранение неполадок</span><span class="sxs-lookup"><span data-stu-id="d5cda-269">Troubleshooting</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/troubleshooting.md)  
 [<span data-ttu-id="d5cda-270">Безопасность в LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="d5cda-270">Security in LINQ to SQL</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/security-in-linq-to-sql.md)
