---
title: Общие сведения о LINQ to DataSet
ms.date: 03/30/2017
ms.assetid: dc20a8fb-03f6-4b68-9c2b-7f7299e3070b
ms.openlocfilehash: 20d9be052ba2567c16718b4b1c1019427c9b5df1
ms.sourcegitcommit: 7bc6887ab658550baa78f1520ea735838249345e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/03/2020
ms.locfileid: "75634824"
---
# <a name="linq-to-dataset-overview"></a><span data-ttu-id="fe41a-102">Общие сведения о LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="fe41a-102">LINQ to DataSet Overview</span></span>
<span data-ttu-id="fe41a-103"><xref:System.Data.DataSet> является одним из более широко используемых компонентов ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="fe41a-103">The <xref:System.Data.DataSet> is one of the more widely used components of ADO.NET.</span></span> <span data-ttu-id="fe41a-104">Это ключевой элемент модели автономного программирования, на основе которой ADO.NET, и он позволяет явно кэшировать данные из разных источников данных.</span><span class="sxs-lookup"><span data-stu-id="fe41a-104">It is a key element of the disconnected programming model that ADO.NET is based on, and it enables you to explicitly cache data from different data sources.</span></span> <span data-ttu-id="fe41a-105">Для уровня представления <xref:System.Data.DataSet> тесно интегрирован с элементами управления графическим интерфейсом привязки данных.</span><span class="sxs-lookup"><span data-stu-id="fe41a-105">For the presentation tier, the <xref:System.Data.DataSet> is tightly integrated with GUI controls for data-binding.</span></span> <span data-ttu-id="fe41a-106">Для среднего уровня он предоставляет кэш, который защищает реляционную форму данных и включает в себя быстрые простые службы запросов и навигации по иерархии.</span><span class="sxs-lookup"><span data-stu-id="fe41a-106">For the middle-tier, it provides a cache that preserves the relational shape of data, and includes fast simple query and hierarchy navigation services.</span></span> <span data-ttu-id="fe41a-107">Распространенной методикой снижения количества запросов к базе данных является использование <xref:System.Data.DataSet> для кэширования на среднем уровне.</span><span class="sxs-lookup"><span data-stu-id="fe41a-107">A common technique used to lower the number of requests on a database is to use the <xref:System.Data.DataSet> for caching in the middle-tier.</span></span> <span data-ttu-id="fe41a-108">Например, рассмотрим веб-приложение ASP.NET, управляемое данными.</span><span class="sxs-lookup"><span data-stu-id="fe41a-108">For example, consider a data-driven ASP.NET Web application.</span></span> <span data-ttu-id="fe41a-109">Обычно значительная часть данных приложения изменяется нечасто и остается неизменной во время сеанса пользователя.</span><span class="sxs-lookup"><span data-stu-id="fe41a-109">Often, a significant portion of the application data does not change frequently and is common across sessions or users.</span></span> <span data-ttu-id="fe41a-110">Эти данные могут сохраняться в памяти веб-сервера, что сократит число запросов к базе данных и ускорит взаимодействие с пользователями.</span><span class="sxs-lookup"><span data-stu-id="fe41a-110">This data can be kept in memory on the Web server, which reduces the number of requests against the database and speeds up the user’s interactions.</span></span> <span data-ttu-id="fe41a-111">Другой полезный аспект <xref:System.Data.DataSet> заключается в том, что он позволяет приложению переносить подмножества данных из одного или нескольких источников данных в пространство приложения.</span><span class="sxs-lookup"><span data-stu-id="fe41a-111">Another useful aspect of the <xref:System.Data.DataSet> is that it allows an application to bring subsets of data from one or more data source into the application space.</span></span> <span data-ttu-id="fe41a-112">Затем приложение может работать с данными в памяти как с реляционными данными.</span><span class="sxs-lookup"><span data-stu-id="fe41a-112">The application can then manipulate the data in-memory, while retaining its relational shape.</span></span>  
  
 <span data-ttu-id="fe41a-113">Объект <xref:System.Data.DataSet> имеет ограниченные возможности запросов.</span><span class="sxs-lookup"><span data-stu-id="fe41a-113">Despite its prominence, the <xref:System.Data.DataSet> has limited query capabilities.</span></span> <span data-ttu-id="fe41a-114">Метод <xref:System.Data.DataTable.Select%2A> можно использовать для фильтрации и сортировки, а методы <xref:System.Data.DataRow.GetChildRows%2A> и <xref:System.Data.DataRow.GetParentRow%2A> - для навигации по иерархии.</span><span class="sxs-lookup"><span data-stu-id="fe41a-114">The <xref:System.Data.DataTable.Select%2A> method can be used for filtering and sorting, and the <xref:System.Data.DataRow.GetChildRows%2A> and <xref:System.Data.DataRow.GetParentRow%2A> methods can be used for hierarchy navigation.</span></span> <span data-ttu-id="fe41a-115">Для более сложных операций необходимо писать пользовательские запросы.</span><span class="sxs-lookup"><span data-stu-id="fe41a-115">For anything more complex, however, the developer must write a custom query.</span></span> <span data-ttu-id="fe41a-116">Это может снизить производительность приложений и создать трудности при их сопровождении.</span><span class="sxs-lookup"><span data-stu-id="fe41a-116">This can result in applications that perform poorly and are difficult to maintain.</span></span>  
  
 <span data-ttu-id="fe41a-117">LINQ to DataSet упрощает и ускоряет выполнение запросов к данным, кэшированным в объекте <xref:System.Data.DataSet>.</span><span class="sxs-lookup"><span data-stu-id="fe41a-117">LINQ to DataSet makes it easier and faster to query over data cached in a <xref:System.Data.DataSet> object.</span></span> <span data-ttu-id="fe41a-118">Эти запросы выражены на языке программирования, а не в виде строковых литералов, внедренных в код приложения.</span><span class="sxs-lookup"><span data-stu-id="fe41a-118">These queries are expressed in the programming language itself, rather than as string literals embedded in the application code.</span></span> <span data-ttu-id="fe41a-119">Это означает, что разработчикам не придется изучать отдельный язык запросов.</span><span class="sxs-lookup"><span data-stu-id="fe41a-119">This means that developers do not have to learn a separate query language.</span></span> <span data-ttu-id="fe41a-120">Кроме того, LINQ to DataSet позволяет разработчикам Visual Studio работать более продуктивно, так как интегрированная среда разработки Visual Studio обеспечивает проверку синтаксиса во время компиляции, статическую типизацию и поддержку IntelliSense для LINQ.</span><span class="sxs-lookup"><span data-stu-id="fe41a-120">Additionally, LINQ to DataSet enables Visual Studio developers to work more productively, because the Visual Studio IDE provides compile-time syntax checking, static typing, and IntelliSense support for LINQ.</span></span> <span data-ttu-id="fe41a-121">LINQ to DataSet также можно использовать для запроса данных, консолидированных из одного или нескольких источников данных.</span><span class="sxs-lookup"><span data-stu-id="fe41a-121">LINQ to DataSet can also be used to query over data that has been consolidated from one or more data sources.</span></span> <span data-ttu-id="fe41a-122">Это делает возможными много сценариев, требующих гибкости в представлении и управлении данными.</span><span class="sxs-lookup"><span data-stu-id="fe41a-122">This enables many scenarios that require flexibility in how data is represented and handled.</span></span> <span data-ttu-id="fe41a-123">В частности, этот метод обработки требуется для универсальных приложений отчетности, анализа и бизнес-аналитики.</span><span class="sxs-lookup"><span data-stu-id="fe41a-123">In particular, generic reporting, analysis, and business intelligence applications require this method of manipulation.</span></span>  
  
## <a name="querying-datasets-using-linq-to-dataset"></a><span data-ttu-id="fe41a-124">Запросы к наборам данных с помощью LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="fe41a-124">Querying DataSets Using LINQ to DataSet</span></span>  
 <span data-ttu-id="fe41a-125">Прежде чем начать запрос к <xref:System.Data.DataSet> объекту с помощью LINQ to DataSet, необходимо заполнить <xref:System.Data.DataSet>.</span><span class="sxs-lookup"><span data-stu-id="fe41a-125">Before you can begin querying a <xref:System.Data.DataSet> object using LINQ to DataSet, you must populate the <xref:System.Data.DataSet>.</span></span> <span data-ttu-id="fe41a-126">Существует несколько способов загрузить данные в <xref:System.Data.DataSet>, например с помощью класса <xref:System.Data.Common.DataAdapter> или [LINQ to SQL](./sql/linq/index.md).</span><span class="sxs-lookup"><span data-stu-id="fe41a-126">There are several ways to load data into a <xref:System.Data.DataSet>, such as using the <xref:System.Data.Common.DataAdapter> class or [LINQ to SQL](./sql/linq/index.md).</span></span> <span data-ttu-id="fe41a-127">После загрузки данных в объект <xref:System.Data.DataSet> можно начать с него запрос.</span><span class="sxs-lookup"><span data-stu-id="fe41a-127">After the data has been loaded into a <xref:System.Data.DataSet> object, you can begin to query it.</span></span> <span data-ttu-id="fe41a-128">Запросы составления, использующие LINQ to DataSet, аналогичны использованию запросов LINQ к другим источникам данных, поддерживающим LINQ.</span><span class="sxs-lookup"><span data-stu-id="fe41a-128">Formulating queries using LINQ to DataSet is similar to using Language-Integrated Query (LINQ) against other LINQ-enabled data sources.</span></span> <span data-ttu-id="fe41a-129">Запросы LINQ можно выполнять с отдельными таблицами в <xref:System.Data.DataSet> или в нескольких таблицах с помощью <xref:System.Linq.Enumerable.Join%2A> и <xref:System.Linq.Enumerable.GroupJoin%2A> стандартных операторов запросов.</span><span class="sxs-lookup"><span data-stu-id="fe41a-129">LINQ queries can be performed against single tables in a <xref:System.Data.DataSet> or against more than one table by using the <xref:System.Linq.Enumerable.Join%2A> and <xref:System.Linq.Enumerable.GroupJoin%2A> standard query operators.</span></span>  
  
 <span data-ttu-id="fe41a-130">Запросы LINQ поддерживаются как для типизированных, так и для нетипизированных <xref:System.Data.DataSet> объектов.</span><span class="sxs-lookup"><span data-stu-id="fe41a-130">LINQ queries are supported against both typed and untyped <xref:System.Data.DataSet> objects.</span></span> <span data-ttu-id="fe41a-131">Если схема <xref:System.Data.DataSet> известна во время разработки приложения, рекомендуется использование типизированного <xref:System.Data.DataSet>.</span><span class="sxs-lookup"><span data-stu-id="fe41a-131">If the schema of the <xref:System.Data.DataSet> is known at application design time, a typed <xref:System.Data.DataSet> is recommended.</span></span> <span data-ttu-id="fe41a-132">В типизированном <xref:System.Data.DataSet> в таблицах и строках есть типизированные члены для каждого столбца, которые делают запросы проще и более читаемыми.</span><span class="sxs-lookup"><span data-stu-id="fe41a-132">In a typed <xref:System.Data.DataSet>, the tables and rows have typed members for each of the columns, which makes queries simpler and more readable.</span></span>  
  
 <span data-ttu-id="fe41a-133">В дополнение к стандартным операторам запросов, реализованным в System. Core. dll, LINQ to DataSet добавляет несколько расширений для <xref:System.Data.DataSet>, которые упрощают выполнение запросов к набору <xref:System.Data.DataRow> объектов.</span><span class="sxs-lookup"><span data-stu-id="fe41a-133">In addition to the standard query operators implemented in System.Core.dll, LINQ to DataSet adds several <xref:System.Data.DataSet>-specific extensions that make it easier to query over a set of <xref:System.Data.DataRow> objects.</span></span> <span data-ttu-id="fe41a-134">Эти специфичные для <xref:System.Data.DataSet> расширения включают в себя операторы для сравнения последовательностей строк, а также методы, обеспечивающие доступ к значениям столбцов <xref:System.Data.DataRow>.</span><span class="sxs-lookup"><span data-stu-id="fe41a-134">These <xref:System.Data.DataSet>-specific extensions include operators for comparing sequences of rows, as well as methods that provide access to the column values of a <xref:System.Data.DataRow>.</span></span>  
  
## <a name="n-tier-applications-and-linq-to-dataset"></a><span data-ttu-id="fe41a-135">Многоуровневые приложения и LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="fe41a-135">N-tier Applications and LINQ to DataSet</span></span>  
 <span data-ttu-id="fe41a-136">N-уровневые приложения для обработки данных — это нацеленные на обработку данных приложения, которые разделены на несколько логических слоев (или уровней).</span><span class="sxs-lookup"><span data-stu-id="fe41a-136">N-tier data applications are data-centric applications that are separated into multiple logical layers (or tiers).</span></span> <span data-ttu-id="fe41a-137">Типичное многоуровневое приложение включает в себя уровень представления, средний уровень и уровень данных.</span><span class="sxs-lookup"><span data-stu-id="fe41a-137">A typical N-tier application includes a presentation tier, a middle tier, and a data tier.</span></span> <span data-ttu-id="fe41a-138">Разделение компонентов приложения на уровни повышает удобство поддержки и масштабирования приложения.</span><span class="sxs-lookup"><span data-stu-id="fe41a-138">Separating application components into separate tiers increases the maintainability and scalability of the application.</span></span> <span data-ttu-id="fe41a-139">Дополнительные сведения о многоуровневых приложениях для работы с данными см. [в статье работа с наборами данных в n-уровневых приложениях](/visualstudio/data-tools/work-with-datasets-in-n-tier-applications).</span><span class="sxs-lookup"><span data-stu-id="fe41a-139">For more information about N-tier data applications, see [Work with datasets in n-tier applications](/visualstudio/data-tools/work-with-datasets-in-n-tier-applications).</span></span>  
  
 <span data-ttu-id="fe41a-140">В многоуровневых приложениях объект <xref:System.Data.DataSet> часто используется на среднем уровне, чтобы кэшировать данные для веб-приложений.</span><span class="sxs-lookup"><span data-stu-id="fe41a-140">In N-tier applications, the <xref:System.Data.DataSet> is often used in the middle-tier to cache information for a Web application.</span></span> <span data-ttu-id="fe41a-141">Функции запроса LINQ to DataSet реализуются через методы расширения и расширяют существующие <xref:System.Data.DataSet>ADO.NET 2,0.</span><span class="sxs-lookup"><span data-stu-id="fe41a-141">The LINQ to DataSet querying functionality is implemented through extension methods and extends the existing ADO.NET 2.0 <xref:System.Data.DataSet>.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="fe41a-142">См. также:</span><span class="sxs-lookup"><span data-stu-id="fe41a-142">See also</span></span>

- [<span data-ttu-id="fe41a-143">Запросы к DataSet</span><span class="sxs-lookup"><span data-stu-id="fe41a-143">Querying DataSets</span></span>](querying-datasets-linq-to-dataset.md)
- [<span data-ttu-id="fe41a-144">LINQ — C#</span><span class="sxs-lookup"><span data-stu-id="fe41a-144">Language-Integrated Query (LINQ) - C#</span></span>](../../../csharp/programming-guide/concepts/linq/index.md)
- [<span data-ttu-id="fe41a-145">LINQ — Visual Basic</span><span class="sxs-lookup"><span data-stu-id="fe41a-145">Language-Integrated Query (LINQ) - Visual Basic</span></span>](../../../visual-basic/programming-guide/concepts/linq/index.md)
- [<span data-ttu-id="fe41a-146">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="fe41a-146">LINQ to SQL</span></span>](./sql/linq/index.md)
