---
title: "Обработка событий таблиц данных"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
ms.assetid: 62f404a5-13ea-4b93-a29f-55b74a16c9d3
caps.latest.revision: "4"
author: JennieHubbard
ms.author: jhubbard
manager: jhubbard
ms.workload: dotnet
ms.openlocfilehash: f7ab9d1043fdd1d4d78ec09390f227f297e471c5
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/22/2017
---
# <a name="handling-datatable-events"></a><span data-ttu-id="8c5ad-102">Обработка событий таблиц данных</span><span class="sxs-lookup"><span data-stu-id="8c5ad-102">Handling DataTable Events</span></span>
<span data-ttu-id="8c5ad-103">Объект <xref:System.Data.DataTable> предоставляет ряд событий, которые может обрабатывать приложение.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-103">The <xref:System.Data.DataTable> object provides a series of events that can be processed by an application.</span></span> <span data-ttu-id="8c5ad-104">В следующей таблице приводится описание событий `DataTable`.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-104">The following table describes `DataTable` events.</span></span>  
  
|<span data-ttu-id="8c5ad-105">Событие</span><span class="sxs-lookup"><span data-stu-id="8c5ad-105">Event</span></span>|<span data-ttu-id="8c5ad-106">Описание</span><span class="sxs-lookup"><span data-stu-id="8c5ad-106">Description</span></span>|  
|-----------|-----------------|  
|<xref:System.Data.DataTable.Initialized>|<span data-ttu-id="8c5ad-107">Происходит после вызова метода <xref:System.Data.DataTable.EndInit%2A> объекта `DataTable`.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-107">Occurs after the <xref:System.Data.DataTable.EndInit%2A> method of a `DataTable` is called.</span></span> <span data-ttu-id="8c5ad-108">Главным образом это событие предназначено для поддержки сценариев во время разработки.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-108">This event is intended primarily to support design-time scenarios.</span></span>|  
|<xref:System.Data.DataTable.ColumnChanged>|<span data-ttu-id="8c5ad-109">Происходит после успешного изменения значения в объекте <xref:System.Data.DataColumn>.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-109">Occurs after a value has been successfully changed in a <xref:System.Data.DataColumn>.</span></span>|  
|<xref:System.Data.DataTable.ColumnChanging>|<span data-ttu-id="8c5ad-110">Происходит при подаче значения для объекта `DataColumn`.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-110">Occurs when a value has been submitted for a `DataColumn`.</span></span>|  
|<xref:System.Data.DataTable.RowChanged>|<span data-ttu-id="8c5ad-111">Происходит после успешного изменения значения `DataColumn` или состояния <xref:System.Data.DataRow.RowState%2A> объекта <xref:System.Data.DataRow> в объекте `DataTable`.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-111">Occurs after a `DataColumn` value or the <xref:System.Data.DataRow.RowState%2A> of a <xref:System.Data.DataRow> in the `DataTable` has been changed successfully.</span></span>|  
|<xref:System.Data.DataTable.RowChanging>|<span data-ttu-id="8c5ad-112">Происходит при подаче изменения для значения `DataColumn` или состояния `RowState` объекта `DataRow` в объекте `DataTable`.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-112">Occurs when a change has been submitted for a `DataColumn` value or the `RowState` of a `DataRow` in the `DataTable`.</span></span>|  
|<xref:System.Data.DataTable.RowDeleted>|<span data-ttu-id="8c5ad-113">Происходит после того, как объект `DataRow` в объекте `DataTable` был отмечен, как `Deleted`.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-113">Occurs after a `DataRow` in the `DataTable` has been marked as `Deleted`.</span></span>|  
|<xref:System.Data.DataTable.RowDeleting>|<span data-ttu-id="8c5ad-114">Происходит перед тем, как объект `DataRow` в объекте `DataTable` будет отмечен как `Deleted`.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-114">Occurs before a `DataRow` in the `DataTable` is marked as `Deleted`.</span></span>|  
|<xref:System.Data.DataTable.TableCleared>|<span data-ttu-id="8c5ad-115">Происходит после того, как вызов метода <xref:System.Data.DataTable.Clear%2A> объекта `DataTable` успешно очистил каждый объект `DataRow`.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-115">Occurs after a call to the <xref:System.Data.DataTable.Clear%2A> method of the `DataTable` has successfully cleared every `DataRow`.</span></span>|  
|<xref:System.Data.DataTable.TableClearing>|<span data-ttu-id="8c5ad-116">Происходит после вызова метода `Clear`, но до начала операции `Clear`.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-116">Occurs after the `Clear` method is called but before the `Clear` operation begins.</span></span>|  
|<xref:System.Data.DataTable.TableNewRow>|<span data-ttu-id="8c5ad-117">Происходит после создания нового объекта `DataRow` путем вызова метода `NewRow` объекта `DataTable`.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-117">Occurs after a new `DataRow` is created by a call to the `NewRow` method of the `DataTable`.</span></span>|  
|<xref:System.ComponentModel.MarshalByValueComponent.Disposed>|<span data-ttu-id="8c5ad-118">Происходит, когда объект `DataTable` удаляется `Disposed`.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-118">Occurs when the `DataTable` is `Disposed`.</span></span> <span data-ttu-id="8c5ad-119">Наследуется от <xref:System.ComponentModel.MarshalByValueComponent>.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-119">Inherited from <xref:System.ComponentModel.MarshalByValueComponent>.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="8c5ad-120">Большинство операций, которые добавляют или удаляют строки, не вызывают событий `ColumnChanged` и `ColumnChanging`.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-120">Most operations that add or delete rows do not raise the `ColumnChanged` and `ColumnChanging` events.</span></span> <span data-ttu-id="8c5ad-121">Однако метод `ReadXml` вызывает события `ColumnChanged` и `ColumnChanging`, если только свойству `XmlReadMode` не задано значение `DiffGram` или значение `Auto`, когда читаемый XML-документ является `DiffGram`.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-121">However, the `ReadXml` method does raise `ColumnChanged` and `ColumnChanging` events, unless the `XmlReadMode` is set to `DiffGram` or is set to `Auto` when the XML document being read is a `DiffGram`.</span></span>  
  
> [!WARNING]
>  <span data-ttu-id="8c5ad-122">Изменение данных в объекте `DataSet`, из которого было вызвано событие `RowChanged`, может привести к повреждению данных.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-122">Data corruption can occur if data is modified in a `DataSet` from which the `RowChanged` event is raised.</span></span> <span data-ttu-id="8c5ad-123">При подобном повреждении данных исключение вызвано не будет.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-123">No exception will be raised if such data corruption occurs.</span></span>  
  
## <a name="additional-related-events"></a><span data-ttu-id="8c5ad-124">Дополнительные связанные события</span><span class="sxs-lookup"><span data-stu-id="8c5ad-124">Additional Related Events</span></span>  
 <span data-ttu-id="8c5ad-125">Свойство <xref:System.Data.DataTable.Constraints%2A> содержит экземпляр <xref:System.Data.ConstraintCollection>.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-125">The <xref:System.Data.DataTable.Constraints%2A> property holds a <xref:System.Data.ConstraintCollection> instance.</span></span> <span data-ttu-id="8c5ad-126">Класс <xref:System.Data.ConstraintCollection> представляет событие <xref:System.Data.ConstraintCollection.CollectionChanged>.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-126">The <xref:System.Data.ConstraintCollection> class exposes a <xref:System.Data.ConstraintCollection.CollectionChanged> event.</span></span> <span data-ttu-id="8c5ad-127">Это событие возникает при добавлении, изменении или удалении ограничения из коллекции `ConstraintCollection`.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-127">This event fires when a constraint is added, modified, or removed from the `ConstraintCollection`.</span></span>  
  
 <span data-ttu-id="8c5ad-128">Свойство <xref:System.Data.DataTable.Columns%2A> содержит экземпляр <xref:System.Data.DataColumnCollection>.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-128">The <xref:System.Data.DataTable.Columns%2A> property holds a <xref:System.Data.DataColumnCollection> instance.</span></span> <span data-ttu-id="8c5ad-129">Класс `DataColumnCollection` представляет событие <xref:System.Data.DataColumnCollection.CollectionChanged>.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-129">The `DataColumnCollection` class exposes a <xref:System.Data.DataColumnCollection.CollectionChanged> event.</span></span> <span data-ttu-id="8c5ad-130">Это событие возникает при добавлении, изменении или удалении из коллекции `DataColumn` объекта `DataColumnCollection`.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-130">This event fires when a `DataColumn` is added, modified, or removed from the `DataColumnCollection`.</span></span> <span data-ttu-id="8c5ad-131">Среди изменений, которые могут вызвать возникновение этого события, - изменения имени, типа, выражения или порядкового номера столбца.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-131">Modifications that cause the event to fire include changes to the name, type, expression or ordinal position of a column.</span></span>  
  
 <span data-ttu-id="8c5ad-132">Свойство <xref:System.Data.DataSet.Tables%2A> объекта <xref:System.Data.DataSet> содержит экземпляр <xref:System.Data.DataTableCollection>.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-132">The <xref:System.Data.DataSet.Tables%2A> property of a <xref:System.Data.DataSet> holds a <xref:System.Data.DataTableCollection> instance.</span></span> <span data-ttu-id="8c5ad-133">Класс `DataTableCollection` вызывает события `CollectionChanged` и `CollectionChanging`.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-133">The `DataTableCollection` class exposes both a `CollectionChanged` and a `CollectionChanging` event.</span></span> <span data-ttu-id="8c5ad-134">Эти события возникают при добавлении или удалении из коллекции `DataTable` объекта `DataSet`.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-134">These events fire when a `DataTable` is added to or removed from the `DataSet`.</span></span>  
  
 <span data-ttu-id="8c5ad-135">Внесение изменений в объекты `DataRows` также могут вызвать события для ассоциированного объекта <xref:System.Data.DataView>.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-135">Changes to `DataRows` can also trigger events for an associated <xref:System.Data.DataView>.</span></span> <span data-ttu-id="8c5ad-136">Класс `DataView` вызывает событие <xref:System.Data.DataView.ListChanged>, которое возникает при изменении значения `DataColumn` или при изменении композиции или порядка сортировки представления.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-136">The `DataView` class exposes a <xref:System.Data.DataView.ListChanged> event that fires when a `DataColumn` value changes or when the composition or sort order of the view changes.</span></span> <span data-ttu-id="8c5ad-137">Класс <xref:System.Data.DataRowView> вызывает событие <xref:System.Data.DataRowView.PropertyChanged>, которое возникает при изменении значения ассоциированного объекта `DataColumn`.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-137">The <xref:System.Data.DataRowView> class exposes a <xref:System.Data.DataRowView.PropertyChanged> event that fires when an associated `DataColumn` value changes.</span></span>  
  
## <a name="sequence-of-operations"></a><span data-ttu-id="8c5ad-138">Последовательность операций</span><span class="sxs-lookup"><span data-stu-id="8c5ad-138">Sequence of Operations</span></span>  
 <span data-ttu-id="8c5ad-139">При добавлении, изменении или удалении объекта `DataRow` надо выполнить следующую последовательность операций.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-139">Here is the sequence of operations that occur when a `DataRow` is added, modified, or deleted:</span></span>  
  
1.  <span data-ttu-id="8c5ad-140">Создайте предложенную запись и внесите любые изменения.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-140">Create the proposed record and apply any changes.</span></span>  
  
2.  <span data-ttu-id="8c5ad-141">Проверьте ограничения для столбцов, не входящих в выражения.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-141">Check constraints for non-expression columns.</span></span>  
  
3.  <span data-ttu-id="8c5ad-142">Вызовите событие `RowChanging` или `RowDeleting`, в зависимости от ситуации.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-142">Raise the `RowChanging` or `RowDeleting` events as applicable.</span></span>  
  
4.  <span data-ttu-id="8c5ad-143">Сделайте предложенную запись текущей.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-143">Set the proposed record to be the current record.</span></span>  
  
5.  <span data-ttu-id="8c5ad-144">Обновите все ассоциированные индексы.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-144">Update any associated indexes.</span></span>  
  
6.  <span data-ttu-id="8c5ad-145">Вызовите события `ListChanged` для ассоциированных объектов `DataView`, а также события `PropertyChanged` для ассоциированных объектов `DataRowView`.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-145">Raise `ListChanged` events for associated `DataView` objects and `PropertyChanged` events for associated `DataRowView` objects.</span></span>  
  
7.  <span data-ttu-id="8c5ad-146">Оцените все столбцы выражения, но отложите проверку любых ограничений для этих столбцов.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-146">Evaluate all expression columns, but delay checking any constraints on these columns.</span></span>  
  
8.  <span data-ttu-id="8c5ad-147">Вызовите события `ListChanged` для ассоциированных объектов `DataView`, а также события `PropertyChanged` для ассоциированных объектов `DataRowView`, затронутых оценками столбцов выражения.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-147">Raise `ListChanged` events for associated `DataView` objects and `PropertyChanged` events for associated `DataRowView` objects affected by the expression column evaluations.</span></span>  
  
9. <span data-ttu-id="8c5ad-148">Вызовите событие `RowChanged` или `RowDeleted`, в зависимости от ситуации.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-148">Raise `RowChanged` or `RowDeleted` events as applicable.</span></span>  
  
10. <span data-ttu-id="8c5ad-149">Проверьте ограничения на столбцы выражения.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-149">Check constraints on expression columns.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="8c5ad-150">Внесение изменений в столбцы выражений никогда не вызывает события `DataTable`.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-150">Changes to expression columns never raise `DataTable` events.</span></span> <span data-ttu-id="8c5ad-151">Внесение изменений в столбцы выражений вызывает только события `DataView` и `DataRowView`.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-151">Changes to expression columns only raise `DataView` and `DataRowView` events.</span></span> <span data-ttu-id="8c5ad-152">Столбцы выражения могут иметь зависимости от нескольких других столбцов, их оценка во время одной операции `DataRow` может производиться несколько раз.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-152">Expression columns can have dependencies on multiple other columns, and can be evaluated multiple times during a single `DataRow` operation.</span></span> <span data-ttu-id="8c5ad-153">События вызываются при вычислении каждого выражения, а при работе со столбцами выражений одна операция `DataRow` может вызвать несколько событий `ListChanged` и `PropertyChanged`, возможно, с несколькими событиями для одного столбца выражений.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-153">Each expression evaluation raises events, and a single `DataRow` operation can raise multiple `ListChanged` and `PropertyChanged` events when expression columns are affected, possibly including multiple events for the same expression column.</span></span>  
  
> [!WARNING]
>  <span data-ttu-id="8c5ad-154">Не вызывайте исключение <xref:System.NullReferenceException> в обработчике события `RowChanged`.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-154">Do not throw a <xref:System.NullReferenceException> within the `RowChanged` event handler.</span></span> <span data-ttu-id="8c5ad-155">Если исключение <xref:System.NullReferenceException> вызывается в пределах события `RowChanged` объекта `DataTable`, объект `DataTable` будет поврежден.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-155">If a <xref:System.NullReferenceException> is thrown within the `RowChanged` event of a `DataTable`, then the `DataTable` will be corrupted.</span></span>  
  
### <a name="example"></a><span data-ttu-id="8c5ad-156">Пример</span><span class="sxs-lookup"><span data-stu-id="8c5ad-156">Example</span></span>  
 <span data-ttu-id="8c5ad-157">В следующем примере демонстрируется, как создавать обработчики событий для событий `RowChanged`, `RowChanging`, `RowDeleted`, `RowDeleting`, `ColumnChanged`, `ColumnChanging`, `TableNewRow`, `TableCleared` и `TableClearing`.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-157">The following example demonstrates how to create event handlers for the `RowChanged`, `RowChanging`, `RowDeleted`, `RowDeleting`, `ColumnChanged`, `ColumnChanging`, `TableNewRow`, `TableCleared`, and `TableClearing` events.</span></span> <span data-ttu-id="8c5ad-158">Каждый обработчик события при возникновении события отображает выводимые данные в консольном окне.</span><span class="sxs-lookup"><span data-stu-id="8c5ad-158">Each event handler displays output in the console window when it is fired.</span></span>  
  
 [!code-csharp[DataWorks DataTable.Events#1](../../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DataTable.Events/CS/source.cs#1)]
 [!code-vb[DataWorks DataTable.Events#1](../../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DataTable.Events/VB/source.vb#1)]  
  
## <a name="see-also"></a><span data-ttu-id="8c5ad-159">См. также</span><span class="sxs-lookup"><span data-stu-id="8c5ad-159">See Also</span></span>  
 [<span data-ttu-id="8c5ad-160">Управление данными в DataTable</span><span class="sxs-lookup"><span data-stu-id="8c5ad-160">Manipulating Data in a DataTable</span></span>](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/manipulating-data-in-a-datatable.md)  
 [<span data-ttu-id="8c5ad-161">Обработка событий DataAdapter</span><span class="sxs-lookup"><span data-stu-id="8c5ad-161">Handling DataAdapter Events</span></span>](../../../../../docs/framework/data/adonet/handling-dataadapter-events.md)  
 [<span data-ttu-id="8c5ad-162">Обработка событий наборов данных</span><span class="sxs-lookup"><span data-stu-id="8c5ad-162">Handling DataSet Events</span></span>](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/handling-dataset-events.md)  
 [<span data-ttu-id="8c5ad-163">Центр разработчиков наборов данных и управляемых поставщиков ADO.NET</span><span class="sxs-lookup"><span data-stu-id="8c5ad-163">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
