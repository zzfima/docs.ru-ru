---
title: Сортировка и фильтрация данных
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: fdd9c753-39df-48cd-9822-2781afe76200
ms.openlocfilehash: 0907aa2a66e1bf51fefc7bed8ea2612cc0c830fa
ms.sourcegitcommit: 2d792961ed48f235cf413d6031576373c3050918
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/31/2019
ms.locfileid: "70203228"
---
# <a name="sorting-and-filtering-data"></a>Сортировка и фильтрация данных
<xref:System.Data.DataView> предоставляет несколько способов сортировки и фильтрации данных в <xref:System.Data.DataTable>.  
  
- Можно использовать свойство <xref:System.Data.DataView.Sort%2A> для задания одного или нескольких порядков сортировки столбцов и включить параметры ASC (по возрастанию) и DESC (по убыванию).  
  
- Свойство <xref:System.Data.DataView.ApplyDefaultSort%2A> служит для автоматического создания порядка сортировки по возрастанию на основании столбца или столбцов первичного ключа таблицы. <xref:System.Data.DataView.ApplyDefaultSort%2A>применяется только в том случае, если свойство **Sort** является нулевой ссылкой или пустой строкой и если в таблице определен первичный ключ.  
  
- Свойство <xref:System.Data.DataView.RowFilter%2A> можно использовать для задания подмножеств строк на основании значений их столбцов. Дополнительные сведения о допустимых выражениях для свойства **RowFilter** см. в справочных сведениях по <xref:System.Data.DataColumn.Expression%2A> свойству <xref:System.Data.DataColumn> класса.  
  
     Если требуется возвратить результаты определенного запроса к данным, а не предоставить динамическое представление подмножества данных, используйте <xref:System.Data.DataView.Find%2A> методы или <xref:System.Data.DataView.FindRows%2A> объекта **DataView** для достижения оптимальной производительности, а не задав  **Свойство RowFilter** . При установке свойства **RowFilter** перестраивается индекс данных, добавляются дополнительные затраты на приложение и снижается производительность. Свойство **RowFilter** лучше использовать в приложении с привязкой к данным, в котором привязанный элемент управления отображает отфильтрованные результаты. Методы **Find** и **FindRows** используют текущий индекс без необходимости перестроения индекса. Дополнительные сведения о методах **Find** и **FindRows** см. в разделе [Поиск строк](finding-rows.md).  
  
- Свойство <xref:System.Data.DataView.RowStateFilter%2A> можно использовать для определения, какие версии строк следует просматривать. Объект **DataView** неявно определяет, какая версия строки должна быть предоставлена в зависимости от **RowState** базовой строки. Например, если для **RowStateFilter** задано значение **DataViewRowState. Deleted**, **DataView** отображает исходную версию строк всех **удаленных** строк, так как **Текущая** версия строки отсутствует. Вы можете определить, какая версия строки предоставляется с помощью свойства **rowversion** **DataRowView**.  
  
     В следующей таблице показаны параметры для **DataViewRowState**.  
  
    |Параметры DataViewRowState|Описание|  
    |------------------------------|-----------------|  
    |**куррентровс**|**Текущая** версия строки всех неизмененных, добавленныхи измененных строк. Это значение по умолчанию.|  
    |**Добавлен**|Версия **текущей** строки всех добавленных строк.|  
    |**Удаленной**|Версия **исходной** строки всех **удаленных** строк.|  
    |**модифиедкуррент**|Версия **текущей** строки для всех **измененных** строк.|  
    |**модифиедоригинал**|Версия **исходной** строки всех измененных строк.|  
    |**None**|Нет строк.|  
    |**оригиналровс**|Версия **исходной** строки всех неизмененных, измененныхи **удаленных** строк.|  
    |**Без изменений**|Версия **текущей** строки всех неизмененных строк.|  
  
 Дополнительные сведения о состояниях строк и версиях строк см. в разделе [состояния строк и версии](row-states-and-row-versions.md)строк.  
  
 В следующем примере кода создается представление, которое показывает все продукты, где число элементов на складе меньше или равно уровню переупорядочения, отсортированного вначале по идентификаторам поставщиков, а затем по названиям продуктов.  
  
```vb  
Dim prodView As DataView = New DataView(prodDS.Tables("Products"), _  
   "UnitsInStock <= ReorderLevel", _  
   "SupplierID, ProductName", _  
   DataViewRowState.CurrentRows)  
```  
  
```csharp  
DataView prodView = new DataView(prodDS.Tables["Products"],  
   "UnitsInStock <= ReorderLevel",  
   "SupplierID, ProductName",  
   DataViewRowState.CurrentRows);  
```  
  
## <a name="see-also"></a>См. также

- <xref:System.Data.DataViewRowState>
- <xref:System.Data.DataColumn.Expression%2A?displayProperty=nameWithType>
- <xref:System.Data.DataTable>
- <xref:System.Data.DataView>
- [Объекты DataView](dataviews.md)
- [Центр разработчиков наборов данных и управляемых поставщиков ADO.NET](https://go.microsoft.com/fwlink/?LinkId=217917)
