---
title: "Активация экземпляров"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 134c3f70-5d4e-46d0-9d49-469a6643edd8
caps.latest.revision: "6"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: d33e809a0db0b812cf7311d7b5686d9125e80976
ms.sourcegitcommit: ce279f2d7fe2220e6ea0a25a8a7a5370ddf8d9f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/02/2017
---
# <a name="instance-activation"></a><span data-ttu-id="5e3ea-102">Активация экземпляров</span><span class="sxs-lookup"><span data-stu-id="5e3ea-102">Instance Activation</span></span>
<span data-ttu-id="5e3ea-103">Хранилище экземпляров рабочих процессов SQL работает как внутренняя задача, которая периодически активируется и обнаруживает запускаемые или доступные для действий экземпляры рабочих процессов в базе данных сохраняемости.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-103">The SQL Workflow Instance Store runs an internal task that periodically wakes up and detects runnable or activatable workflow instances in the persistence database.</span></span> <span data-ttu-id="5e3ea-104">Если запускаемый экземпляр рабочего процесса найден, хранилище уведомит узел рабочих процессов, который может активировать этот экземпляр.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-104">If it finds a runnable workflow instance, it notifies the workflow host that is capable of activating the instance.</span></span> <span data-ttu-id="5e3ea-105">Если хранилище экземпляров найдет доступный экземпляр рабочего процесса, оно уведомит общий узел, который активирует узел рабочих процессов, который в свою очередь запустит экземпляр рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-105">If the instance store finds an activatable workflow instance, it notifies a generic host that activates a workflow host, which in turn runs the workflow instance.</span></span> <span data-ttu-id="5e3ea-106">В следующих подразделах этого раздела приводится подробное объяснение процесса активации экземпляра.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-106">The following sections in this topic explain the instance activation process in detail.</span></span>  
  
##  <span data-ttu-id="5e3ea-107"><a name="RunnableSection"></a>Обнаружение и активация запускаемых экземпляров рабочих процессов</span><span class="sxs-lookup"><span data-stu-id="5e3ea-107"><a name="RunnableSection"></a> Detecting and Activating Runnable Workflow Instances</span></span>  
 <span data-ttu-id="5e3ea-108">Хранилище экземпляров рабочих процессов SQL считает экземпляр рабочего процесса *запускаемых* Если экземпляр не находится в приостановленном или завершенном состоянии и удовлетворяет следующим условиям:</span><span class="sxs-lookup"><span data-stu-id="5e3ea-108">The SQL Workflow Instance Store considers a workflow instance *runnable* if the instance is not in the suspended state or the completed state and satisfies the following conditions:</span></span>  
  
-   <span data-ttu-id="5e3ea-109">Экземпляр разблокирован и имеет таймер в состоянии ожидания, время которого истекло.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-109">The instance is unlocked and has a pending timer that has expired.</span></span>  
  
-   <span data-ttu-id="5e3ea-110">Время блокировки экземпляра истекло.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-110">The instance has an expired lock on it.</span></span>  
  
-   <span data-ttu-id="5e3ea-111">Экземпляр разблокирован, и она находится в состоянии **выполнение**.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-111">The instance is unlocked and its status is **Executing**.</span></span>  
  
 <span data-ttu-id="5e3ea-112">При обнаружении запускаемого экземпляра хранилище экземпляров рабочих процессов SQL создает событие <xref:System.Activities.DurableInstancing.HasRunnableWorkflowEvent>.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-112">The SQL Workflow Instance Store raises the <xref:System.Activities.DurableInstancing.HasRunnableWorkflowEvent> when it finds a runnable instance.</span></span> <span data-ttu-id="5e3ea-113">После этого хранилище экземпляров рабочих процессов SQL останавливает наблюдение до однократного вызова <xref:System.Activities.DurableInstancing.TryLoadRunnableWorkflowCommand> на этом хранилище.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-113">After this, the SqlWorkflowInstanceStore stops monitoring until the <xref:System.Activities.DurableInstancing.TryLoadRunnableWorkflowCommand> is called once on the store.</span></span>  
  
 <span data-ttu-id="5e3ea-114">Узел рабочих процессов, который подписался на событие <xref:System.Activities.DurableInstancing.HasRunnableWorkflowEvent> и может загрузить экземпляр, выполняет команду <xref:System.Activities.DurableInstancing.TryLoadRunnableWorkflowCommand> относительно хранилища экземпляров для его загрузки в память.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-114">A workflow host that has subscribed for the <xref:System.Activities.DurableInstancing.HasRunnableWorkflowEvent> and capable of loading the instance executes the <xref:System.Activities.DurableInstancing.TryLoadRunnableWorkflowCommand> against the instance store to load the instance into memory.</span></span> <span data-ttu-id="5e3ea-115">Узел рабочего процесса считается способен загрузить экземпляр рабочего процесса, если узла и экземпляра имеет свойство метаданных **WorkflowServiceType** присвоено то же значение.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-115">A workflow host is considered capable of loading a workflow instance if the host and the instance have metadata property **WorkflowServiceType** set to the same value.</span></span>  
  
## <a name="detecting-and-activating-activatable-workflow-instances"></a><span data-ttu-id="5e3ea-116">Обнаружение и активация доступных для действий экземпляров рабочих процессов</span><span class="sxs-lookup"><span data-stu-id="5e3ea-116">Detecting and Activating Activatable Workflow Instances</span></span>  
 <span data-ttu-id="5e3ea-117">Экземпляр рабочего процесса считается *активируемый* Если является запускаемым и отсутствует узел рабочего процесса, поддерживающий загрузку экземпляра, выполняется на компьютере.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-117">A workflow instance is considered *activatable* if the instance is runnable and there is no workflow host that is capable of loading the instance is running on the computer.</span></span> <span data-ttu-id="5e3ea-118">Определение экземпляра запускаемого рабочего процесса см. выше, в разделе Обнаружение и активация запускаемых экземпляров рабочих процессов.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-118">See Detecting and Activating Runnable Workflow Instances above for the definition of a runnable workflow instance.</span></span>  
  
 <span data-ttu-id="5e3ea-119">При обнаружении доступного для действий экземпляра рабочего процесса в базе данных хранилище экземпляров рабочих процессов SQL создает событие <xref:System.Activities.DurableInstancing.HasActivatableWorkflowEvent>.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-119">The SQL Workflow Instance Store raises the <xref:System.Activities.DurableInstancing.HasActivatableWorkflowEvent> when it finds an activatable workflow instance in the database.</span></span> <span data-ttu-id="5e3ea-120">После этого хранилище экземпляров рабочих процессов SQL останавливает наблюдение до однократного вызова <xref:System.Activities.DurableInstancing.QueryActivatableWorkflowsCommand> на этом хранилище.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-120">After this, the SqlWorkflowInstanceStore stops monitoring until the <xref:System.Activities.DurableInstancing.QueryActivatableWorkflowsCommand> is called once on the store.</span></span>  
  
 <span data-ttu-id="5e3ea-121">Когда общий узел, подписанный на событие <xref:System.Activities.DurableInstancing.HasActivatableWorkflowEvent>, получает его, он выполняет команду <xref:System.Activities.DurableInstancing.QueryActivatableWorkflowsCommand> относительно хранилища экземпляров для получения параметров активации, необходимых для создания узла рабочих процессов.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-121">When a generic host that has subscribed for the <xref:System.Activities.DurableInstancing.HasActivatableWorkflowEvent> receives the event, it executes the <xref:System.Activities.DurableInstancing.QueryActivatableWorkflowsCommand> against the instance store to obtain activation parameters required to create a workflow host.</span></span> <span data-ttu-id="5e3ea-122">Универсальный узел использует эти параметры для создания приложения рабочего процесса, которое в свою очередь загружает и запускает запускаемый экземпляр службы.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-122">The generic host uses these activation parameters to create a workflow host, which in turn loads and runs the runnable service instance.</span></span>  
  
## <a name="generic-hosts"></a><span data-ttu-id="5e3ea-123">Универсальные узлы</span><span class="sxs-lookup"><span data-stu-id="5e3ea-123">Generic Hosts</span></span>  
 <span data-ttu-id="5e3ea-124">Универсальный узел — узел со значением свойства метаданных **WorkflowServiceType** для универсальных узлов задано значение **WorkflowServiceType.Any** для указания, что он может обрабатывать любой тип рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-124">A generic host is a host with the value of the metadata property **WorkflowServiceType** for generic hosts is set to **WorkflowServiceType.Any** to indicate that it can handle any workflow type.</span></span> <span data-ttu-id="5e3ea-125">Параметр XName универсального узла имеет **ActivationType**.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-125">A generic host has an XName parameter named **ActivationType**.</span></span>  
  
 <span data-ttu-id="5e3ea-126">В настоящее время хранилище экземпляров рабочих процессов SQL поддерживает универсальные узлы с параметром ActivationType значение **WAS**.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-126">Currently, the SQL Workflow Instance Store supports generic hosts with value of the ActivationType parameter set to **WAS**.</span></span> <span data-ttu-id="5e3ea-127">Если параметру ActivationType не задано значение WAS, хранилище экземпляров рабочих процессов SQL формирует исключение <xref:System.Runtime.DurableInstancing.InstancePersistenceException>.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-127">If the ActivationType is not set to WAS, the SQL Workflow Instance Store throws an <xref:System.Runtime.DurableInstancing.InstancePersistenceException>.</span></span> <span data-ttu-id="5e3ea-128">Служба управления рабочими процессами, который поставляется вместе с [!INCLUDE[dublin](../../../includes/dublin-md.md)] является универсальным узлом с типом активации **WAS**.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-128">The Workflow Management Service that ships with the [!INCLUDE[dublin](../../../includes/dublin-md.md)] is a generic host that has the activation type set to **WAS**.</span></span>  
  
 <span data-ttu-id="5e3ea-129">Для активации WAS универсальному узлу требуется набор параметров активации для выявления адреса конечной точки, по которому можно активировать новые узлы.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-129">For WAS activation, a generic host requires a set of activation parameters to derive the endpoint address at which new hosts can be activated.</span></span> <span data-ttu-id="5e3ea-130">Параметры для активации WAS ― это имя узла, путь к приложению относительно узла и путь к службе относительно приложения.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-130">The activation parameters for WAS activation are name of the site, path to the application relative to the site, and path to the service relative to the application.</span></span> <span data-ttu-id="5e3ea-131">Хранилище экземпляров рабочих процессов SQL хранит эти параметры активации во время выполнения команды <xref:System.Activities.DurableInstancing.SaveWorkflowCommand>.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-131">The SQL Workflow Instance Store stores these activation parameters during the execution of the <xref:System.Activities.DurableInstancing.SaveWorkflowCommand>.</span></span>  
  
## <a name="runnable-instances-detection-period"></a><span data-ttu-id="5e3ea-132">Период обнаружения запускаемых экземпляров</span><span class="sxs-lookup"><span data-stu-id="5e3ea-132">Runnable Instances Detection Period</span></span>  
 <span data-ttu-id="5e3ea-133">**Период обнаружения запускаемых экземпляров** свойства хранилища экземпляров рабочих процессов SQL указывает период времени, после которого хранилище экземпляров рабочих процессов SQL выполняет задачу обнаружения выполняемых или активируемых рабочих процессов экземпляры в базе данных постоянного хранения после предыдущего цикла обнаружения.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-133">The **Runnable Instances Detection Period** property of the SQL Workflow Instance Store specifies the time period after which the SQL Workflow Instance Store runs a detection task to detect any runnable or activatable workflow instances in the persistence database after the previous detection cycle.</span></span> <span data-ttu-id="5e3ea-134">В разделе [период обнаружения запускаемых экземпляров](../../../docs/framework/windows-workflow-foundation/runnable-instances-detection-period.md) Дополнительные сведения о данном свойстве.</span><span class="sxs-lookup"><span data-stu-id="5e3ea-134">See [Runnable Instances Detection Period](../../../docs/framework/windows-workflow-foundation/runnable-instances-detection-period.md) for more details on this property.</span></span>
