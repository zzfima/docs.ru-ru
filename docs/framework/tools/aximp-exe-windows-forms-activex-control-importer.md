---
title: Aximp.exe (программа импорта элементов ActiveX форм Windows)
ms.date: 03/30/2017
helpviewer_keywords:
- ActiveX controls, hosting in Windows Forms
- ActiveX Control Importer
- type definitions, converting
- Aximp.exe
- Windows Forms ActiveX Control Importer
ms.assetid: 482c0d83-7144-4497-b626-87d2351b78d0
ms.openlocfilehash: 6d58d1df81780c3033eab7c1ac3e860adeb374b1
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/15/2020
ms.locfileid: "79180431"
---
# <a name="aximpexe-windows-forms-activex-control-importer"></a>Aximp.exe (программа импорта элементов ActiveX форм Windows)
Программа для импорта элементов управления ActiveX преобразует определения типов в библиотеке типов COM для элемента управления ActiveX в элемент управления Windows Forms.  
  
 В Windows Forms могут находиться только элементы управления Windows Forms, то есть классы, производные от класса <xref:System.Windows.Forms.Control>. Программа Aximp.exe создает класс-оболочку для элемента управления ActiveX, который может быть размещен в Windows Forms. Благодаря этому во время разработки можно использовать ту же методологию программирования и поддержки, что и для других элементов управления Windows Forms.  
  
 Чтобы разместить элемент управления ActiveX, необходимо создать элемент управления-оболочку, производный от <xref:System.Windows.Forms.AxHost>. Этот элемент управления-оболочка содержит экземпляр базового элемента управления ActiveX. Оболочка может взаимодействовать с элементом управления ActiveX, но выглядит как элемент управления Windows Forms. Созданный элемент управления размещает элемент управления ActiveX и представляет его свойства, методы и события как свои собственные.  
  
 Это средство автоматически устанавливается с Visual Studio. Чтобы применить этот инструмент, воспользуйтесь командной строкой разработчика для Visual Studio (или командной строкой Visual Studio в Windows 7). Дополнительные сведения см. в разделе [Командные строки](developer-command-prompt-for-vs.md).  
  
 В командной строке введите следующее.  
  
## <a name="syntax"></a>Синтаксис  
  
```console  
aximp [options]{file.dll | file.ocx}  
```  
  
## <a name="remarks"></a>Remarks  
  
|Аргумент|Описание:|  
|--------------|-----------------|  
|*файл*|Имя исходного файла, содержащего преобразуемый элемент управления ActiveX. Аргумент файла должен иметь расширение DLL или OCX.|  
  
|Параметр|Описание:|  
|------------|-----------------|  
|`/delaysign`|Указывает программе Aximp.exe подписывать полученный элемент управления отложенной подписью. Этот параметр необходимо задавать вместе с параметром `/keycontainer:`, `/keyfile:` или `/publickey:`. Дополнительные сведения о процессе отложенной подписи см. в разделе [Отложенная подпись сборки](../../standard/assembly/delay-sign.md).|  
|`/help`|Отображает синтаксис команд и параметров программы.|  
|`/keycontainer:` *containerName*|Подписывает результирующий элемент управления строгим именем, используя пару ключей (открытый/закрытый) из контейнера ключей, заданного аргументом *containerName*.|  
|`/keyfile:` *filename*|Подписывает полученный элемент управления строгим именем, используя официальную пару ключей издателя (открытый-закрытый) из *filename*.|  
|`/nologo`|Отключает отображение эмблемы Майкрософт при запуске.|  
|`/out:` *filename*|Задает имя создаваемой сборки.|  
|`/publickey:` *filename*|Подписывает полученный элемент управления строгим именем с помощью открытого ключа из *filename*.|  
|`/rcw:` *filename*|Использует указанную вызываемую оболочку времени выполнения вместо создания новой. Можно указать несколько экземпляров. Для относительных путей используется текущий каталог. Дополнительные сведения см. в разделе [Вызываемая оболочка времени выполнения](../../standard/native-interop/runtime-callable-wrapper.md).|  
|`/silent`|Запрещает отображение сообщений об успешно выполненных операциях.|  
|`/source`|Создает исходный код оболочки Windows Forms на языке C#.|  
|`/verbose`|Включает режим отображения дополнительных сведений о ходе выполнения.|  
|`/?`|Отображает синтаксис команд и параметров программы.|  
  
 Программа Aximp.exe преобразует всю библиотеку типов элемента управления ActiveX и создает набор сборок, содержащих метаданные среды CLR, и реализацию элементов управления для типов, определенных в исходной библиотеке типов. Имена файлов создаются по следующему шаблону.  
  
 Прокси среды CLR для типов COM: *progid*.dll  
  
 Прокси Windows Forms для элементов управления ActiveX (где Ax означает ActiveX): Ax*progid*.dll  
  
> [!NOTE]
> Если имя члена элемента управления ActiveX совпадает с именем, заданным в .NET Framework, к имени члена при создании производного класса AxHost программа Aximp.exe добавит префикс "Ctl". Например, если элемент управления ActiveX содержит член с именем "Layout", в производном классе "AxHost" он будет переименован в "CtlLayout", так как в .NET Framework задано событие "Layout".  
  
 Созданные файлы можно проверить с помощью таких программ, как [Ildasm.exe (дизассемблер IL)](ildasm-exe-il-disassembler.md).  
  
 Использование программы Aximp.exe для создания сборки .NET для элемента управления ActiveX WebBrowser (shdocvw.dll) не поддерживается.  
  
 Если программа Aximp.exe выполняется для "shdocvw.dll", она всегда создает другой файл с именем "shdocvw.dll" в каталоге, из которого запускается программа. Помещение вновь созданного файла в каталог "Documents and Settings" может привести к сбоям в работе Microsoft Internet Explorer и проводника Windows. При перезагрузке компьютера операционная система Windows сначала выполняет поиск копии "shdocvw.dll" в каталоге "Documents and Settings" и только затем — в каталоге "system32". Операционная система будет использовать копию, найденную в каталоге "Documents and Settings", и попытается загрузить управляемые оболочки. Internet Explorer и Проводник Windows будут работать неправильно, поскольку они используют механизм отрисовки из версии "shdocvw.dll", расположенной в каталоге "system32". В случае возникновения этой проблемы удалите копию "shdocvw.dll" из каталога "Documents and Settings" и перезагрузите компьютер.  
  
 Кроме того, проблемы могут возникнуть при использовании программы Aximp.exe с "shdocvw.dll" для создания сборки .NET, которая будет использоваться при разработке приложения. В этом случае приложение загружает и системную версию "shdocvw.dll", и созданную версию, а также может задавать приоритет системной версии. В такой ситуации при попытке загрузить веб-страницу в элемент управления ActiveX WebBrowser пользователю может быть выведено диалоговое окно "Открыть/Сохранить". Когда пользователь щелкает **Открыть**, веб-страница открывается в браузере Internet Explorer. Это происходит только на тех компьютерах, на которых установлен Internet Explorer версии 6 или более ранней версии. Чтобы избежать этой проблемы, следует использовать управляемый элемент управления <xref:System.Windows.Forms.WebBrowser> или Visual Studio для создания управляемой библиотеки "shdocvw.dll", как описано в разделе [Практическое руководство. Добавление ссылок на библиотеки типов](../interop/how-to-add-references-to-type-libraries.md).  
  
## <a name="example"></a>Пример  
 При выполнении указанной ниже команды создаются библиотеки "MediaPlayer.dll" и "AxMediaPlayer.dll" для элемента управления Media Player `msdxm.ocx`.  
  
```console
aximp c:\systemroot\system32\msdxm.ocx  
```  
  
## <a name="see-also"></a>См. также раздел

- [Инструменты](index.md)
- [Ildasm.exe (дизассемблер IL)](ildasm-exe-il-disassembler.md)
