---
title: "Regasm.exe (средство регистрации сборок)"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- Assembly Registration tool
- assemblies [.NET Framework], registering
- Regasm.exe
- registering assemblies
ms.assetid: e190e342-36ef-4651-a0b4-0e8c2c0281cb
caps.latest.revision: "20"
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: b2762080c66c3c9451e7c7c3d4621d8cb9d4846e
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/22/2017
---
# <a name="regasmexe-assembly-registration-tool"></a><span data-ttu-id="b4473-102">Regasm.exe (средство регистрации сборок)</span><span class="sxs-lookup"><span data-stu-id="b4473-102">Regasm.exe (Assembly Registration Tool)</span></span>
<span data-ttu-id="b4473-103">Средство регистрации сборки считывает метаданные сборки и добавляет в реестр необходимые записи, что позволяет COM-клиентам прозрачно создавать классы .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="b4473-103">The Assembly Registration tool reads the metadata within an assembly and adds the necessary entries to the registry, which allows COM clients to create .NET Framework classes transparently.</span></span> <span data-ttu-id="b4473-104">Зарегистрированные классы могут использоваться любыми COM-клиентами так же, как COM-классы.</span><span class="sxs-lookup"><span data-stu-id="b4473-104">Once a class is registered, any COM client can use it as though the class were a COM class.</span></span> <span data-ttu-id="b4473-105">Класс регистрируется только один раз, при установке сборки.</span><span class="sxs-lookup"><span data-stu-id="b4473-105">The class is registered only once, when the assembly is installed.</span></span> <span data-ttu-id="b4473-106">Экземпляры классов внутри сборки не могут создаваться на основе COM-классов до их фактической регистрации.</span><span class="sxs-lookup"><span data-stu-id="b4473-106">Instances of classes within the assembly cannot be created from COM until they are actually registered.</span></span>  
  
 <span data-ttu-id="b4473-107">Чтобы применить этот инструмент, воспользуйтесь командной строкой разработчика (или командной строкой Visual Studio в Windows 7).</span><span class="sxs-lookup"><span data-stu-id="b4473-107">To run the tool, use the Developer Command Prompt (or the Visual Studio Command Prompt in Windows 7).</span></span> <span data-ttu-id="b4473-108">Дополнительные сведения см. в разделе [Командные строки](../../../docs/framework/tools/developer-command-prompt-for-vs.md).</span><span class="sxs-lookup"><span data-stu-id="b4473-108">For more information, see [Command Prompts](../../../docs/framework/tools/developer-command-prompt-for-vs.md).</span></span>  
  
 <span data-ttu-id="b4473-109">В командной строке введите следующее.</span><span class="sxs-lookup"><span data-stu-id="b4473-109">At the command prompt, type the following:</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="b4473-110">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="b4473-110">Syntax</span></span>  
  
```  
regasm assemblyFile [options]  
```  
  
#### <a name="parameters"></a><span data-ttu-id="b4473-111">Параметры</span><span class="sxs-lookup"><span data-stu-id="b4473-111">Parameters</span></span>  
  
|<span data-ttu-id="b4473-112">Параметр</span><span class="sxs-lookup"><span data-stu-id="b4473-112">Parameter</span></span>|<span data-ttu-id="b4473-113">Описание:</span><span class="sxs-lookup"><span data-stu-id="b4473-113">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="b4473-114">*assemblyFile*</span><span class="sxs-lookup"><span data-stu-id="b4473-114">*assemblyFile*</span></span>|<span data-ttu-id="b4473-115">Сборка, которая должна быть зарегистрирована в COM.</span><span class="sxs-lookup"><span data-stu-id="b4473-115">The assembly to be registered with COM.</span></span>|  
  
|<span data-ttu-id="b4473-116">Параметр</span><span class="sxs-lookup"><span data-stu-id="b4473-116">Option</span></span>|<span data-ttu-id="b4473-117">Описание:</span><span class="sxs-lookup"><span data-stu-id="b4473-117">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="b4473-118">**/codebase**</span><span class="sxs-lookup"><span data-stu-id="b4473-118">**/codebase**</span></span>|<span data-ttu-id="b4473-119">Создает в реестре запись Codebase.</span><span class="sxs-lookup"><span data-stu-id="b4473-119">Creates a Codebase entry in the registry.</span></span> <span data-ttu-id="b4473-120">Запись Codebase указывает путь к файлу сборки, которая не установлена в глобальном кэше сборок.</span><span class="sxs-lookup"><span data-stu-id="b4473-120">The Codebase entry specifies the file path for an assembly that is not installed in the global assembly cache.</span></span> <span data-ttu-id="b4473-121">Не следует указывать этот параметр, если впоследствии вы будете устанавливать регистрируемую сборку в глобальном кэше сборок.</span><span class="sxs-lookup"><span data-stu-id="b4473-121">You should not specify this option if you will subsequently install the assembly that you are registering into the global assembly cache.</span></span> <span data-ttu-id="b4473-122">Аргумент *assemblyFile*, задаваемый с помощью параметра **/codebase**, должен быть [сборкой со строгим именем](../../../docs/framework/app-domains/strong-named-assemblies.md).</span><span class="sxs-lookup"><span data-stu-id="b4473-122">The *assemblyFile* argument that you specify with the **/codebase** option must be a [strong-named assembly](../../../docs/framework/app-domains/strong-named-assemblies.md).</span></span>|  
|<span data-ttu-id="b4473-123">**/registered**</span><span class="sxs-lookup"><span data-stu-id="b4473-123">**/registered**</span></span>|<span data-ttu-id="b4473-124">Указывает, что это средство будет ссылаться только на библиотеки типов, которые уже были зарегистрированы.</span><span class="sxs-lookup"><span data-stu-id="b4473-124">Specifies that this tool will only refer to type libraries that have already been registered.</span></span>|  
|<span data-ttu-id="b4473-125">**/asmpath:directory**</span><span class="sxs-lookup"><span data-stu-id="b4473-125">**/asmpath:directory**</span></span>|<span data-ttu-id="b4473-126">Задает каталог, содержащий ссылки на сборки.</span><span class="sxs-lookup"><span data-stu-id="b4473-126">Specifies a directory containing assembly references.</span></span> <span data-ttu-id="b4473-127">Этот параметр необходимо указывать вместе с параметром **/regfile**.</span><span class="sxs-lookup"><span data-stu-id="b4473-127">Must be used with the **/regfile** option.</span></span>|  
|<span data-ttu-id="b4473-128">**/nologo**</span><span class="sxs-lookup"><span data-stu-id="b4473-128">**/nologo**</span></span>|<span data-ttu-id="b4473-129">Отключает отображение эмблемы Майкрософт при запуске.</span><span class="sxs-lookup"><span data-stu-id="b4473-129">Suppresses the Microsoft startup banner display.</span></span>|  
|<span data-ttu-id="b4473-130">**/regfile** [**:** *regFile*]</span><span class="sxs-lookup"><span data-stu-id="b4473-130">**/regfile** [**:** *regFile*]</span></span>|<span data-ttu-id="b4473-131">Создает для сборки REG-файл, содержащий необходимые записи реестра.</span><span class="sxs-lookup"><span data-stu-id="b4473-131">Generates the specified .reg file for the assembly, which contains the needed registry entries.</span></span> <span data-ttu-id="b4473-132">Указание этого параметра не приводит к внесению изменений в реестр.</span><span class="sxs-lookup"><span data-stu-id="b4473-132">Specifying this option does not change the registry.</span></span> <span data-ttu-id="b4473-133">Вы не можете использовать этот параметр с параметрами **/u** и **/tlb**.</span><span class="sxs-lookup"><span data-stu-id="b4473-133">You cannot use this option with the **/u** or **/tlb** options.</span></span>|  
|<span data-ttu-id="b4473-134">**/silent** или **/s**</span><span class="sxs-lookup"><span data-stu-id="b4473-134">**/silent** or **/s**</span></span>|<span data-ttu-id="b4473-135">Запрещает отображение сообщений об успешно выполненных операциях.</span><span class="sxs-lookup"><span data-stu-id="b4473-135">Suppresses the display of success messages.</span></span>|  
|<span data-ttu-id="b4473-136">**/tlb** [**:** *typeLibFile*]</span><span class="sxs-lookup"><span data-stu-id="b4473-136">**/tlb** [**:** *typeLibFile*]</span></span>|<span data-ttu-id="b4473-137">Создает библиотеку типов из указанной сборки, содержащую определения доступных типов, описанных в сборке.</span><span class="sxs-lookup"><span data-stu-id="b4473-137">Generates a type library from the specified assembly containing definitions of the accessible types defined within the assembly.</span></span>|  
|<span data-ttu-id="b4473-138">**/unregister** или **/u**</span><span class="sxs-lookup"><span data-stu-id="b4473-138">**/unregister** or **/u**</span></span>|<span data-ttu-id="b4473-139">Отменяет регистрацию создаваемых классов, содержащихся в *assemblyFile*.</span><span class="sxs-lookup"><span data-stu-id="b4473-139">Unregisters the creatable classes found in *assemblyFile*.</span></span> <span data-ttu-id="b4473-140">Если этот параметр не указан, средство Regasm.exe регистрирует создаваемые классы в сборке.</span><span class="sxs-lookup"><span data-stu-id="b4473-140">Omitting this option causes Regasm.exe to register the creatable classes in the assembly.</span></span>|  
|<span data-ttu-id="b4473-141">**/verbose**</span><span class="sxs-lookup"><span data-stu-id="b4473-141">**/verbose**</span></span>|<span data-ttu-id="b4473-142">Включает режим подробного протоколирования. Если указан параметр **/tlb**, на экран выводится список всех сборок, на которые ссылается эта сборка, и для которых требуется создать библиотеку типов.</span><span class="sxs-lookup"><span data-stu-id="b4473-142">Specifies verbose mode; displays a list of any referenced assemblies for which a type library needs to be generated, when specified with the **/tlb** option.</span></span>|  
|<span data-ttu-id="b4473-143">**/?**</span><span class="sxs-lookup"><span data-stu-id="b4473-143">**/?**</span></span> <span data-ttu-id="b4473-144">или **/help**</span><span class="sxs-lookup"><span data-stu-id="b4473-144">or **/help**</span></span>|<span data-ttu-id="b4473-145">Отображает синтаксис команд и параметров программы.</span><span class="sxs-lookup"><span data-stu-id="b4473-145">Displays command syntax and options for the tool.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="b4473-146">В параметрах командной строки средства Regasm.exe прописные и строчные буквы не различаются.</span><span class="sxs-lookup"><span data-stu-id="b4473-146">The Regasm.exe command-line options are case insensitive.</span></span> <span data-ttu-id="b4473-147">Достаточно указать начало параметра, позволяющее однозначно его определить.</span><span class="sxs-lookup"><span data-stu-id="b4473-147">You only need to provide enough of the option to uniquely identify it.</span></span> <span data-ttu-id="b4473-148">Например, запись **/n** эквивалентна записи **/nologo**, а **/t:** *outfile.tlb* — записи **/tlb:** *outfile.tlb*.</span><span class="sxs-lookup"><span data-stu-id="b4473-148">For example, **/n** is equivalent to **/nologo** and **/t:** *outfile.tlb* is equivalent to **/tlb:** *outfile.tlb*.</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="b4473-149">Примечания</span><span class="sxs-lookup"><span data-stu-id="b4473-149">Remarks</span></span>  
 <span data-ttu-id="b4473-150">Можно не вносить изменения непосредственно в реестр, а создать REG-файл с записями реестра при помощи параметра **/regfile**.</span><span class="sxs-lookup"><span data-stu-id="b4473-150">You can use the **/regfile** option to generate a .reg file that contains the registry entries instead of making the changes directly to the registry.</span></span> <span data-ttu-id="b4473-151">Чтобы внести изменения в реестр компьютера, импортируйте REG-файл в реестр с помощью редактора реестра (средства Regedit.exe).</span><span class="sxs-lookup"><span data-stu-id="b4473-151">You can update the registry on a computer by importing the .reg file with the Registry Editor tool (Regedit.exe).</span></span> <span data-ttu-id="b4473-152">Обратите внимание, что REG-файл не содержит обновлений реестра, которые могут выполняться пользовательскими функциями реестра.</span><span class="sxs-lookup"><span data-stu-id="b4473-152">Note that the .reg file does not contain any registry updates that can be made by user-defined register functions.</span></span>  <span data-ttu-id="b4473-153">Также заметьте, что параметр **/regfile** порождает записи реестра только для управляемых классов.</span><span class="sxs-lookup"><span data-stu-id="b4473-153">Note that the **/regfile** option only emits registry entries for managed classes.</span></span>  <span data-ttu-id="b4473-154">Он не создает записи для объектов `TypeLibID` и `InterfaceID`.</span><span class="sxs-lookup"><span data-stu-id="b4473-154">This option does not emit entries for `TypeLibID`s or `InterfaceID`s.</span></span>  
  
 <span data-ttu-id="b4473-155">Если задан параметр **/tlb**, средство Regasm.exe создает и регистрирует библиотеку типов, описывающую типы, которые содержатся в сборке.</span><span class="sxs-lookup"><span data-stu-id="b4473-155">When you specify the **/tlb** option, Regasm.exe generates and registers a type library describing the types found in the assembly.</span></span> <span data-ttu-id="b4473-156">Regasm.exe помещает созданные библиотеки типов в текущий рабочий каталог или в каталог выходных файлов.</span><span class="sxs-lookup"><span data-stu-id="b4473-156">Regasm.exe places the generated type libraries in the current working directory or the directory specified for the output file.</span></span> <span data-ttu-id="b4473-157">Если сборка ссылается на другие сборки, то при создании библиотеки ее типов, возможно, будет создано сразу несколько библиотек типов.</span><span class="sxs-lookup"><span data-stu-id="b4473-157">Generating a type library for an assembly that references other assemblies may cause several type libraries to be generated at once.</span></span> <span data-ttu-id="b4473-158">Библиотека типов позволяет предоставлять сведения о типах средствам разработки, таким как [!INCLUDE[vsprvslong](../../../includes/vsprvslong-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b4473-158">You can use the type library to provide type information to development tools like [!INCLUDE[vsprvslong](../../../includes/vsprvslong-md.md)].</span></span> <span data-ttu-id="b4473-159">Не используйте параметр **/tlb**, если регистрируемая сборка была создана программой импорта библиотек типов ([Tlbimp.exe](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)).</span><span class="sxs-lookup"><span data-stu-id="b4473-159">You should not use the **/tlb** option if the assembly you are registering was produced by the Type Library Importer ([Tlbimp.exe](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)).</span></span> <span data-ttu-id="b4473-160">Невозможно экспортировать библиотеку типов из сборки, которая была импортирована из библиотеки типов.</span><span class="sxs-lookup"><span data-stu-id="b4473-160">You cannot export a type library from an assembly that was imported from a type library.</span></span> <span data-ttu-id="b4473-161">Параметр **/tlb** дает тот же результат, что и программа экспорта библиотек типов ([Tlbexp.exe](../../../docs/framework/tools/tlbexp-exe-type-library-exporter.md)) и Regasm.exe, за исключением того, что Tlbexp.exe не регистрирует создаваемые библиотеки типов.</span><span class="sxs-lookup"><span data-stu-id="b4473-161">Using the **/tlb** option has the same effect as using the Type Library Exporter ([Tlbexp.exe](../../../docs/framework/tools/tlbexp-exe-type-library-exporter.md)) and Regasm.exe, with the exception that Tlbexp.exe does not register the type library it produces.</span></span>  <span data-ttu-id="b4473-162">Если библиотека типов зарегистрирована с помощью параметра **/tlb**, для отмены регистрации можно использовать параметр **/tlb** с параметром **/unregister**.</span><span class="sxs-lookup"><span data-stu-id="b4473-162">If you use the **/tlb** option to registered a type library, you can use **/tlb** option with the **/unregister** option to unregistered the type library.</span></span> <span data-ttu-id="b4473-163">При указании обоих параметров будет отменена регистрация библиотеки типов и записей интерфейса, что может существенно очистить реестр.</span><span class="sxs-lookup"><span data-stu-id="b4473-163">Using the two options together will unregister the type library and interface entries, which can clean the registry considerably.</span></span>  
  
 <span data-ttu-id="b4473-164">При регистрации сборки для использования в COM средство Regasm.exe добавляет записи в реестр локального компьютера.</span><span class="sxs-lookup"><span data-stu-id="b4473-164">When you register an assembly for use by COM, Regasm.exe adds entries to the registry on the local computer.</span></span> <span data-ttu-id="b4473-165">Точнее, в этом случае создаются зависящие от версии разделы реестра, которые позволяют запускать на одном компьютере несколько версий одной сборки одновременно.</span><span class="sxs-lookup"><span data-stu-id="b4473-165">More specifically, it creates version-dependent registry keys that allow multiple versions of the same assembly to run side by side on a computer.</span></span> <span data-ttu-id="b4473-166">Когда сборка регистрируется в первый раз, создается один раздел верхнего уровня для сборки и уникальный подраздел для конкретной версии.</span><span class="sxs-lookup"><span data-stu-id="b4473-166">The first time an assembly is registered, one top-level key is created for the assembly and a unique subkey is created for the specific version.</span></span> <span data-ttu-id="b4473-167">При регистрации каждой новой версии сборки Regasm.exe создает подраздел для этой новой версии.</span><span class="sxs-lookup"><span data-stu-id="b4473-167">Each time you register a new version of the assembly, Regasm.exe creates a subkey for the new version.</span></span>  
  
 <span data-ttu-id="b4473-168">Например, предположим, что вы регистрируете управляемый компонент myComp.dll версии 1.0.0.0 для использования в COM.</span><span class="sxs-lookup"><span data-stu-id="b4473-168">For example, consider a scenario where you register the managed component, myComp.dll, version 1.0.0.0 for use by COM.</span></span> <span data-ttu-id="b4473-169">Позже вы регистрируете myComp.dll версии 2.0.0.0.</span><span class="sxs-lookup"><span data-stu-id="b4473-169">Later, you register myComp.dll, version 2.0.0.0.</span></span> <span data-ttu-id="b4473-170">Вы определяете, что все клиентские приложения COM на компьютере используют myComp.dll версии 2.0.0.0 и решаете отменить регистрацию myComponent.dll версии 1.0.0.0.</span><span class="sxs-lookup"><span data-stu-id="b4473-170">You determine that all COM client applications on the computer are using myComp.dll version 2.0.0.0 and you decide to unregister myComponent.dll version 1.0.0.0.</span></span> <span data-ttu-id="b4473-171">Эта схема реестра позволяет отменить регистрацию myComp.dll версии 1.0.0.0, поскольку удаляется только подраздел версии 1.0.0.0.</span><span class="sxs-lookup"><span data-stu-id="b4473-171">This registry scheme allows you to unregister myComp.dll version 1.0.0.0 because only the version 1.0.0.0 subkey is removed.</span></span>  
  
 <span data-ttu-id="b4473-172">Зарегистрировав сборку с помощью средства Regasm.exe, можно установить ее в [глобальном кэше сборок](../../../docs/framework/app-domains/gac.md), тогда ее сможет активировать любой COM-клиент.</span><span class="sxs-lookup"><span data-stu-id="b4473-172">After registering an assembly using Regasm.exe, you can install it in the [global assembly cache](../../../docs/framework/app-domains/gac.md) so that it can be activated from any COM client.</span></span> <span data-ttu-id="b4473-173">Если сборку будет активировать только одно приложение, ее можно поместить в каталог этого приложения.</span><span class="sxs-lookup"><span data-stu-id="b4473-173">If the assembly is only going to be activated by a single application, you can place it in that application's directory.</span></span>  
  
## <a name="examples"></a><span data-ttu-id="b4473-174">Примеры</span><span class="sxs-lookup"><span data-stu-id="b4473-174">Examples</span></span>  
 <span data-ttu-id="b4473-175">Следующая команда регистрирует все открытые классы, содержащиеся в библиотеке `myTest.dll`.</span><span class="sxs-lookup"><span data-stu-id="b4473-175">The following command registers all public classes contained in `myTest.dll`.</span></span>  
  
```  
regasm myTest.dll  
```  
  
 <span data-ttu-id="b4473-176">Следующая команда создает файл `myTest.reg`, который содержит все необходимые записи реестра.</span><span class="sxs-lookup"><span data-stu-id="b4473-176">The following command generates the file `myTest.reg`, which contains all the necessary registry entries.</span></span> <span data-ttu-id="b4473-177">Эта команда не обновляет реестр.</span><span class="sxs-lookup"><span data-stu-id="b4473-177">This command does not update the registry.</span></span>  
  
```  
regasm myTest.dll /regfile:myTest.reg  
```  
  
 <span data-ttu-id="b4473-178">Следующая команда регистрирует все открытые классы, содержащиеся в `myTest.dll`, а также создает и регистрирует библиотеку типов `myTest.tlb`, в которой содержатся определения всех открытых типов, описанных в `myTest.dll`.</span><span class="sxs-lookup"><span data-stu-id="b4473-178">The following command registers all public classes contained in `myTest.dll`, and generates and registers the type library `myTest.tlb`, which contains definitions of all the public types defined in `myTest.dll`.</span></span>  
  
```  
regasm myTest.dll /tlb:myTest.tlb  
```  
  
## <a name="see-also"></a><span data-ttu-id="b4473-179">См. также</span><span class="sxs-lookup"><span data-stu-id="b4473-179">See Also</span></span>  
 [<span data-ttu-id="b4473-180">Инструменты</span><span class="sxs-lookup"><span data-stu-id="b4473-180">Tools</span></span>](../../../docs/framework/tools/index.md)  
 [<span data-ttu-id="b4473-181">Tlbexp.exe (программа экспорта библиотек типов)</span><span class="sxs-lookup"><span data-stu-id="b4473-181">Tlbexp.exe (Type Library Exporter)</span></span>](../../../docs/framework/tools/tlbexp-exe-type-library-exporter.md)  
 [<span data-ttu-id="b4473-182">Tlbimp.exe (программа экспорта библиотек типов)</span><span class="sxs-lookup"><span data-stu-id="b4473-182">Tlbimp.exe (Type Library Importer)</span></span>](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)  
 [<span data-ttu-id="b4473-183">Регистрация сборок в COM</span><span class="sxs-lookup"><span data-stu-id="b4473-183">Registering Assemblies with COM</span></span>](../../../docs/framework/interop/registering-assemblies-with-com.md)  
 [<span data-ttu-id="b4473-184">Командные строки</span><span class="sxs-lookup"><span data-stu-id="b4473-184">Command Prompts</span></span>](../../../docs/framework/tools/developer-command-prompt-for-vs.md)
