---
title: Основные понятия Windows Communication Foundation
ms.date: 03/30/2017
helpviewer_keywords:
- WCF [WCF], concepts
- concepts [WCF]
- fundamentals [WCF]
- Windows Communication Foundation [WCF], concepts
ms.assetid: 3e7e0afd-7913-499d-bafb-eac7caacbc7a
ms.openlocfilehash: 360479a2ba17c4542d61a737856d23992296e276
ms.sourcegitcommit: 32a575bf4adccc901f00e264f92b759ced633379
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/04/2019
ms.locfileid: "74802312"
---
# <a name="fundamental-windows-communication-foundation-concepts"></a>Основные понятия Windows Communication Foundation

Этот документ дает общее представление об архитектуре Windows Communication Foundation (WCF). В нем приводится объяснение ключевых понятий и их взаимосвязь. Руководство по созданию простейшей версии службы WCF и клиента см. в [руководстве по начало работы](getting-started-tutorial.md). Дополнительные сведения о программировании WCF см. в разделе [Базовая программирование WCF](basic-wcf-programming.md).

## <a name="wcf-fundamentals"></a>Основы WCF

WCF — это среда выполнения и набор интерфейсов API для создания систем, отправляющих сообщения между службами и клиентами. Те же инфраструктура и интерфейсы API используются для создания приложений, обменивающихся данными с другими приложениями на данном компьютере или на компьютере, который находится в другой компании, и доступ к которому можно получить через Интернет.

### <a name="messaging-and-endpoints"></a>Обмен сообщениями и конечные точки

WCF основана на концепции связи на основе сообщений, и все, что может быть смоделировано как сообщение (например, HTTP-запрос или сообщение MSMQ), могут быть представлены единообразно в модели программирования. Это обеспечивает универсальный интерфейс API для разных транспортных механизмов.

Модель различает _Клиенты_, которые являются приложениями, которые инициируют связь, и _службами_, которые представляют собой приложения, которые ожидают от клиентов взаимодействовать с ними и реагируют на это взаимодействие. Одно приложение может быть как клиентом, так и службой. Примеры см. в разделе [Дуплексные службы](./feature-details/duplex-services.md) и [одноранговые сети](./feature-details/peer-to-peer-networking.md).

Между конечными точками выполняется обмен сообщениями. _Конечные точки_ — это места, куда отправляются или принимаются сообщения (или и те, и другие), и определяются все сведения, необходимые для обмена сообщениями. Служба предоставляет одну или несколько конечных точек приложения (а также ноль или более конечных точек инфраструктуры), а клиент создает конечную точку, совместимую с одной из конечных точек службы.

_Конечная точка_ описывает стандартный способ отправки сообщений, способ их отправки и то, как должны выглядеть сообщения. Служба может предоставлять эти сведения в виде метаданных, которые клиенты могут обрабатывать для создания соответствующих клиентов WCF и _стеков_связи.

### <a name="communication-protocols"></a>Протоколы связи

Одним из обязательных элементов стека связи является _транспортный протокол_. Сообщения можно отправлять через интрасети или через Интернет с помощью общих транспортов, таких как HTTP и TCP. Предусмотрены другие транспорты, поддерживающие связь с приложениями очереди сообщений и узлами в сетке одноранговой сети. Дополнительные механизмы транспорта можно добавить с помощью встроенных точек расширения WCF.

Другим обязательным элементом стека связи является кодирование, определяющее способ форматирования любого заданного сообщения. WCF предоставляет следующие кодировки:

- кодировка текста - кодирование с возможностью взаимодействия;

- кодировка подсистемы оптимизации передачи сообщений MTOM - поддерживающий взаимодействие способ эффективной отправки неструктурированных двоичных данных в службу и из нее;

- двоичное кодирование для эффективной передачи.

Дополнительные механизмы кодирования (например, кодирование сжатия) можно добавить с помощью встроенных точек расширения WCF.

### <a name="message-patterns"></a>Шаблоны сообщений

WCF поддерживает несколько шаблонов обмена сообщениями, включая запрос-ответ, односторонний и дуплексную связь. Разные транспорты поддерживают разные шаблоны обмена сообщениями и таким образом влияют на типы поддерживаемых взаимодействий. Интерфейсы API и среда выполнения WCF также позволяют безопасно и надежно отсылать сообщения.

## <a name="wcf-terms"></a>Термины WCF

Другие понятия и термины, используемые в документации по WCF, включают следующее:

**Сообщение**  
 Автономная единица данных, которая может состоять из нескольких частей, включая текст и заголовки.

**Service**  
 Конструкция, предоставляющая доступ к одной или нескольким конечным точкам, каждая из которых предоставляет доступ к одой или нескольким операциям службы.

**Endpoint**  
 Конструкция, в которой производится отправка или прием сообщений. Он включает в себя расположение (адрес), которое определяет, где можно отправлять сообщения, спецификацию механизма связи (привязки), описывающего способ отправки сообщений, и определение набора сообщений, которые могут быть отправлены или получены (или и того, и другого). расположение (контракт службы), описывающее сообщение, которое может быть отправлено.

Служба WCF видима внешнему миру как коллекция конечных точек.

**Конечная точка приложения**  
 Конечная точка, предоставляемая приложением и соответствующая контракту службы, реализуемому приложением.

**Конечная точка инфраструктуры**  
 Конечная точка, предоставляемая инфраструктурой для расширения функциональных возможностей, необходимых для службы или предоставляемых службой и не имеющих отношения к контракту службы. Например, со службой может быть связана конечная точка инфраструктуры, предоставляющая информацию о метаданных.

**Адрес**  
 Задает расположение, где принимаются сообщения. Он задается в виде универсального кода ресурса (URI). Часть URI, определяющая схему, задает транспортный механизм для доставки по адресу, например HTTP и TCP. Иерархическая часть URI содержит уникальное расположение, формат которого зависит от транспортного механизма.

Адрес конечной точки позволяет создавать уникальные адреса для каждой конечной точки в службе или при определенных условиях использовать один адрес для нескольких конечных точек. В следующем примере показан адрес, использующий протокол HTTPS с портом, не установленным по умолчанию:

```http
HTTPS://cohowinery:8005/ServiceModelSamples/CalculatorService
```

**Привязка**  
 Задает способ связи конечной точки с внешним миром. Она состоит из набора компонентов, называемых элементами привязки, которые компонуются в "стек", один над другим, образуя инфраструктуру связи. Как минимум, привязка определяет используемые транспорт (например HTTP или TCP) и кодирование (например, текстовое или двоичное). Привязка может содержать элементы привязки, задающие такие сведения, как механизмы безопасности, используемые для защищенных сообщений, или шаблон сообщений, используемый конечной точкой. Дополнительные сведения см. в разделе [Настройка служб](configuring-services.md).

**Элемент Binding**  
 Представляет определенную часть привязки, такую как транспорт, кодирование, реализация протокола на уровне инфраструктуры (например, WS-ReliableMessaging) или любой другой компонент стека связи.

**Поведения**  
 Компонент, управляющий различными аспектами работы службы, конечной точки, определенной операции или клиента во время выполнения. Расширения функциональности группируются в соответствии с областью действия: общие расширения функциональности влияют глобально на все конечные точки, расширения функциональности служб влияют только на аспекты, относящиеся к службам, расширения функциональности конечных точек влияют только на свойства, относящиеся к конечным точкам, а расширения функциональности уровня операции влияют только на конкретные операции. Например, одно расширение функциональности службы регулирующее и определяет реакцию службы при избытке сообщений, превосходящем возможности обработки. С другой стороны, поведение конечной точки управляет только аспектами, относящимися к конечным точкам, например способом поиска учетных данных безопасности и расположением для поиска.

**Привязки, предоставляемые системой**  
 WCF содержит ряд привязок, предоставляемых системой. Они являются коллекциями элементов привязки, оптимизированными для конкретных сценариев. Например, <xref:System.ServiceModel.WSHttpBinding> предназначен для взаимодействия со службами, которые реализуют различные спецификации WS-\*. Эти заранее определенные привязки экономят время, предоставляя только те параметры, которые могут быть правильно применены для конкретного сценария. Если заранее определенная привязка не удовлетворяет необходимым требованиям, можно создать собственную настраиваемую привязку.

**Настройка и кодирование**  
 Управление приложением возможно с помощью кода, с помощью конфигурации или с помощью и того, и другого. Преимущество конфигурации заключается в том, что после написания кода параметры клиента или службы могут задаваться пользователями (например, системным администратором), а не только разработчиком, при этом отсутствует необходимость в повторной компиляции. Конфигурация не только позволяет задавать значения, такие как адреса конечных точек, но и обеспечивает дополнительные возможности управления, позволяя добавлять конечные точки, привязки и расширения функциональности. Кодирование позволяет разработчику сохранить полный контроль над всеми компонентами службы или клиента; все параметры, заданные при конфигурации, можно проверить и, при необходимости, изменить с помощью кода.

**Операция службы**  
 Процедура, определенная в программном коде службы и реализующая функциональные возможности операции. Эта операция видима клиентам в виде методов клиента WCF. Метод может возвращать значение и может иметь ряд необязательных аргументов либо может не иметь аргументов и не возвращать никаких значений. Например, операция, выполняющая функцию простого приветствия "Привет", может использоваться для уведомления о наличии клиента и запуска серии операций.

**Контракт службы**  
 Объединяет несколько связанных операций в один функциональный модуль. Контракт может определять параметры уровня службы, такие как пространство имен службы, соответствующий контракт обратного вызова и другие подобные параметры. В большинстве случаев контракт задается путем создания интерфейса на выбранном языке программирования и применения атрибута <xref:System.ServiceModel.ServiceContractAttribute> к этому интерфейсу. Фактический код службы создается при реализации этого интерфейса.

**Контракт операции**  
 Контракт операции определяет параметры операции и тип возвращаемых ею значений. При создании интерфейса, определяющего контракт службы, контракт операции задается применением атрибута <xref:System.ServiceModel.OperationContractAttribute> к определению каждого метода, входящего в контракт. Операции могут задаваться как получающие одно сообщение и возвращающие одно сообщение или как получающие набор типов и возвращающие тип. В последнем случае формат сообщений, обмен которыми происходит при выполнении данной операции, определяется системой.

**Контракт сообщения**  
 Описывает формат сообщения. Например, в нем описывается, должны элементы сообщения размещаться в заголовках или в теле, уровень безопасности, применяемый к определенным элементам сообщения и т. д.

**Контракт сбоя**  
 Может связываться с операцией службы для обозначения ошибок, которые могут возвращаться вызывающему объекту. С операцией могут быть связаны ноль или более сбоев. Эти ошибки представляют собой сбои протокола SOAP, которые моделируются в модели программирования как исключения.

**Контракт данных**  
 Хранящееся в метаданных описание типов данных, используемых службой. Это описание позволяет другим объектам работать со службой. Типы данных могут использоваться в любой части сообщения, например в виде типов параметров или возвращаемых значений. Если в службе используются только простые типы, явное использование контрактов данных не требуется.

**Размещение**  
 Служба должна быть размещена в некотором процессе. _Узел_ — это приложение, которое управляет временем существования службы. Службы могут быть резидентными (размещенными сами в себе) или управляемыми существующим ведущим процессом.

**Автономная служба**  
 Служба, которая выполняется в приложении-процессе, созданном разработчиком. Разработчик контролирует время существования службы, набор свойств службы, открывает службу (при этом служба переходит в режим ожидания данных) и закрывает службу.

**Ведущий процесс**  
 Приложение, предназначенное для размещения служб. В число таких приложений входят службы IIS, службы активации Windows (WAS) и службы Windows. В этих сценариях ведущее приложение контролирует время существования службы. Например, с помощью IIS можно создать виртуальный каталог, содержащий сборку службы и файл конфигурации. При получении сообщения IIS запускает службу и контролирует время ее существования.

**Создание экземпляров**  
 Со службой связана модель создания экземпляров. Существуют три модели создания экземпляров: «один экземпляр», в которой один объект CLR обслуживает всех клиентов, «по вызовам», в которой для обработки каждого вызова, поступившего от клиента, создается новый объект CLR, и «по сеансам», в которой создается набор объектов CLR, по одному на каждый отдельный сеанс. Выбор модели создания экземпляров зависит от требований к приложению и ожидаемого режима использования службы.

**Клиентское приложение**  
 Программа, обменивающаяся сообщениями с одной или несколькими конечными точками. Клиентское приложение начинает работу с создания экземпляра клиента WCF и вызывает методы этого клиента WCF. Обратите внимание, что одно и то же приложение может быть как клиентом, так и службой.

**Канал**  
 Конкретная реализация элемента привязки. Привязка представляет собой конфигурацию, а канал является реализацией, связанной с этой конфигурацией. Следовательно, с каждым элементом привязки связан канал. Каналы, собранные в стек друг на другом, образуют конкретную реализацию привязки: стек каналов.

**Клиент WCF**  
 Конструкция клиентского приложения, предоставляющая операции службы как методы (на выбранном вами языке программирования .NET Framework, например Visual Basic или Visual C#). Каждое приложение может содержать клиента WCF, включая приложение, содержащее службу. Следовательно, можно создать службу, содержащую клиентов WCF других служб.

Клиент WCF можно создать автоматически с помощью [средства служебной программы метаданных ServiceModel (Svcutil. exe)](servicemodel-metadata-utility-tool-svcutil-exe.md) и указать его в работающей службе, которая публикует метаданные.

**Метаданные**  
 Описывают характеристики службы, которые необходимо знать внешней сущности для обмена данными со службой. Метаданные можно использовать с помощью [средства служебной программы метаданных ServiceModel (Svcutil. exe)](servicemodel-metadata-utility-tool-svcutil-exe.md) для создания клиента WCF и сопутствующей конфигурации, которую клиентское приложение может использовать для взаимодействия со службой.

Метаданные, предоставляемые службой, содержат документы схемы XML, определяющие контракт данных службы, и документы WSDL, описывающие методы службы.

Если метаданные для службы включены, они автоматически создаются WCF путем проверки службы и ее конечных точек. Для публикации метаданных службы необходимо явно задать расширение функциональности метаданных.

**Security**  
 В WCF включает в себя конфиденциальность (шифрование сообщений для предотвращения перехвата), целостность (средства для обнаружения искажений сообщений), проверку подлинности (средства для проверки серверов и клиентов) и авторизацию (Управление доступом к ресурсы). Эти функции предоставляются либо с помощью существующих механизмов безопасности, таких как TLS по протоколу HTTP (также известного как HTTPS), либо путем реализации одной или нескольких спецификаций безопасности WS-\*.

**Режим безопасности транспорта**  
 Указывает, что конфиденциальность, целостность и проверка подлинности обеспечиваются механизмами транспортного уровня (такими как HTTPS). При использовании такого транспорта, как HTTPS, преимущества этого режима заключаются в его эффективной производительности и хорошей известности в связи с преобладающим применением в Интернете. Недостаток заключается в том, что безопасность этого типа применяется отдельно на каждом прыжке пути передачи, в результате чего связь становится чувствительной к атакам типа "злоумышленник в середине".

**Режим безопасности сообщений**  
 Указывает, что безопасность предоставляется путем реализации одной или нескольких спецификаций безопасности, например спецификации с именем [WS-Security: SOAP Message Security](http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf). Каждое сообщение содержит необходимые механизмы, обеспечивающие безопасность во время его передачи и позволяющие получателям обнаруживать подделки и расшифровывать сообщения. В этом отношении безопасность заложена внутри каждого сообщения, обеспечивая сквозную безопасность по всем участкам передачи. Поскольку сведения о безопасности становятся частью сообщения, можно также включить несколько типов учетных данных с сообщением (они называются _утверждениями_). Дополнительным преимуществом такого подхода является возможность безопасной передачи сообщения с помощью любого транспортного механизма, включая несколько транспортных механизмов между источником и назначением. К недостатком этого подхода относится сложность используемых криптографических механизмов, требовательных к производительности.

**Транспорт с режимом безопасности учетных данных сообщений**  
 Задает использование транспортного уровня для обеспечения конфиденциальности, проверки подлинности и целостности сообщений, но каждое сообщение может содержать несколько учетных данных (утверждений), требуемых получателями сообщения.

**WS-\***  
 Сокращение для обозначения растущего набора спецификаций веб-служб (WS), таких как WS-Security, WS-ReliableMessaging и т. д., реализованных в WCF.

## <a name="see-also"></a>См. также:

- [Что такое Windows Communication Foundation](whats-wcf.md)
- [Архитектура Windows Communication Foundation](architecture.md)
