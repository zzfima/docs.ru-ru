---
title: Настройка поддержки транзакций WS-Atomic
ms.date: 03/30/2017
helpviewer_keywords:
- WS-AT protocol [WCF], configuring WS-Atomic Transaction
ms.assetid: cb9f1c9c-1439-4172-b9bc-b01c3e09ac48
ms.openlocfilehash: 068ddcab5cfb7bfb5f37a1858820195a5a05269f
ms.sourcegitcommit: c01c18755bb7b0f82c7232314ccf7955ea7834db
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/15/2020
ms.locfileid: "75964580"
---
# <a name="configure-ws-atomic-transaction-support"></a><span data-ttu-id="fd1f1-102">Настройка поддержки WS-Atomic Transaction</span><span class="sxs-lookup"><span data-stu-id="fd1f1-102">Configure WS-Atomic Transaction support</span></span>

<span data-ttu-id="fd1f1-103">В этой теме описывается, как можно настроить поддержку WS-AtomicTransaction (WS-AT) с помощью программы конфигурации WS-AT.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-103">This topic describes how you can configure WS-AtomicTransaction (WS-AT) support by using the WS-AT Configuration Utility.</span></span>

## <a name="use-the-ws-at-configuration-utility"></a><span data-ttu-id="fd1f1-104">Использование служебной программы настройки WS-AT</span><span class="sxs-lookup"><span data-stu-id="fd1f1-104">Use the WS-AT configuration utility</span></span>

<span data-ttu-id="fd1f1-105">Программа конфигурации WS-AT (wsatConfig.exe) используется для настройки параметров WS-AT.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-105">The WS-AT Configuration Utility (wsatConfig.exe) is used to configure WS-AT settings.</span></span> <span data-ttu-id="fd1f1-106">Чтобы включить службу протокола WS-AT, с помощью программы конфигурации следует настроить порт HTTPS для WS-AT, привязать сертификат X.509 к порту HTTPS и настроить сертификаты авторизованных партнеров, указав имена субъектов сертификатов или отпечатки.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-106">In order to enable the WS-AT protocol service, you must use the configuration utility to configure the HTTPS port for WS-AT, bind an X.509 certificate to the HTTPS port, and configure authorized partner certificates by specifying certificate subject names or thumbprints.</span></span> <span data-ttu-id="fd1f1-107">Программа конфигурации также позволяет выбрать режим трассировки и задать значения времени ожидания по умолчанию для исходящих и максимальных входящих транзакций.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-107">The configuration utility also allows you to select the tracing mode and set default outgoing and maximum incoming transaction timeouts.</span></span>

<span data-ttu-id="fd1f1-108">Функциями этой программы можно воспользоваться с помощью оснастки страницы свойств консоли управления (MMC) в консоли управления службами компонентов или с помощью окна командной строки.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-108">You can access this tool's functionality by using a Microsoft Management Console (MMC) property page snap-in in the Component Services management console, or from a command-line window.</span></span> <span data-ttu-id="fd1f1-109">Настройте поддержку WS-AT на локальном компьютере с помощью окна командной строки; задайте параметры на локальных и удаленных компьютерах с помощью оснастки MMC.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-109">Configure WS-AT support on the local machine through the command-line window; configure settings on both local and remote machines by using the MMC snap-in.</span></span>

<span data-ttu-id="fd1f1-110">Окно командной строки можно открыть в папке установки Windows SDK "%WINDIR%\Microsoft.NET\Framework\v3.0\Windows Communication Foundation".</span><span class="sxs-lookup"><span data-stu-id="fd1f1-110">The command-line window can be accessed in the Windows SDK installation location "%WINDIR%\Microsoft.NET\Framework\v3.0\Windows Communication Foundation".</span></span>

<span data-ttu-id="fd1f1-111">Дополнительные сведения о программе командной строки см. в разделе [служебная программа настройки WS-AtomicTransaction (WsatConfig. exe)](../../../../docs/framework/wcf/ws-atomictransaction-configuration-utility-wsatconfig-exe.md).</span><span class="sxs-lookup"><span data-stu-id="fd1f1-111">For more information about the command-line tool, see [WS-AtomicTransaction Configuration Utility (wsatConfig.exe)](../../../../docs/framework/wcf/ws-atomictransaction-configuration-utility-wsatconfig-exe.md).</span></span>

<span data-ttu-id="fd1f1-112">Если вы используете [!INCLUDE[wxp](../../../../includes/wxp-md.md)] или Windows Server 2003, доступ к оснастке MMC можно получить, перейдя к **панели управления/Администрирование/службы компонентов**, щелкнув правой кнопкой мыши **Мой компьютер**и выбрав пункт **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-112">If you are running [!INCLUDE[wxp](../../../../includes/wxp-md.md)] or Windows Server 2003, you can access the MMC snap-in by navigating to **Control Panel/Administrative Tools/Component Services**, right-clicking **My Computer**, and selecting **Properties**.</span></span> <span data-ttu-id="fd1f1-113">Здесь же можно настроить координатор распределенных транзакций (Майкрософт).</span><span class="sxs-lookup"><span data-stu-id="fd1f1-113">This is the same location where you can configure the Microsoft Distributed Transaction Coordinator (MSDTC).</span></span> <span data-ttu-id="fd1f1-114">Параметры, доступные для конфигурации, группируются на вкладке **WS-AT** . Если вы используете Windows Vista или Windows Server 2008, оснастку MMC можно найти, нажав кнопку **Пуск** и введя `dcomcnfg.exe` в поле **поиска** .</span><span class="sxs-lookup"><span data-stu-id="fd1f1-114">Options available for configuration are grouped under the **WS-AT** tab. If you are running Windows Vista or Windows Server 2008, the MMC snap-in can be found by clicking the **Start** button, and entering `dcomcnfg.exe` in the **Search** box.</span></span> <span data-ttu-id="fd1f1-115">Когда откроется консоль MMC, перейдите к узлу **Мои Компутер\дистрибутед Transaction КУРДИНАТОР\ЛОКАЛ DTC** , щелкните правой кнопкой мыши и выберите пункт **свойства**.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-115">When the MMC is opened, navigate to the **My Computer\Distributed Transaction Coordinator\Local DTC** node, right click and select **Properties**.</span></span> <span data-ttu-id="fd1f1-116">Параметры, доступные для конфигурации, группируются на вкладке **WS-AT** .</span><span class="sxs-lookup"><span data-stu-id="fd1f1-116">Options available for configuration are grouped under the **WS-AT** tab.</span></span>

<span data-ttu-id="fd1f1-117">Дополнительные сведения об оснастке см. в разделе [оснастка MMC "Настройка WS-AtomicTransaction](../../../../docs/framework/wcf/ws-atomictransaction-configuration-mmc-snap-in.md)".</span><span class="sxs-lookup"><span data-stu-id="fd1f1-117">For more information about the snap-in, see the [WS-AtomicTransaction Configuration MMC Snap-in](../../../../docs/framework/wcf/ws-atomictransaction-configuration-mmc-snap-in.md).</span></span>

<span data-ttu-id="fd1f1-118">Для работы с пользовательским интерфейсом средства необходимо зарегистрировать файл WsatUI.dll. Путь к этому файлу:</span><span class="sxs-lookup"><span data-stu-id="fd1f1-118">To enable the tool's user interface, you must first register the WsatUI.dll file, located at the following path</span></span>

<span data-ttu-id="fd1f1-119">%PROGRAMFILES%\Microsoft SDKs\Windows\v6.0\Bin</span><span class="sxs-lookup"><span data-stu-id="fd1f1-119">%PROGRAMFILES%\Microsoft SDKs\Windows\v6.0\Bin</span></span>

<span data-ttu-id="fd1f1-120">Чтобы зарегистрировать продукт, выполните следующую команду в окне командной строки:</span><span class="sxs-lookup"><span data-stu-id="fd1f1-120">To register the product, execute the following command from a Command Prompt window:</span></span>

`regasm.exe /codebase WsatUI.dll`

## <a name="enable-ws-at"></a><span data-ttu-id="fd1f1-121">Включить WS-AT</span><span class="sxs-lookup"><span data-stu-id="fd1f1-121">Enable WS-AT</span></span>

<span data-ttu-id="fd1f1-122">Чтобы включить службу протокола WS-AT в MSDTC с использованием порта 443 и сертификата X.509 с закрытым ключом, установленным в хранилище локального компьютера, используйте средство wsatConfig.exe со следующей командой.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-122">To enable the WS-AT protocol service inside MSDTC using port 443 and an X.509 certificate with a private key that has been installed in the local machine store, use the wsatConfig.exe tool with the following command.</span></span>

`WsatConfig.exe –network:enable –port:8443 –endpointCert:<machine|"Issuer\SubjectName"> -accountsCerts:<thumbprint|"Issuer\SubjectName"> -restart`

<span data-ttu-id="fd1f1-123">Замените соответствующие параметры значениями, подходящими для вашей среды.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-123">Substitute the respective parameters with values relevant to your environment.</span></span>

<span data-ttu-id="fd1f1-124">Чтобы выключить службу протокола WS-AT в MSDTC, используйте средство wsatConfig.exe со следующей командой.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-124">To disable the WS-AT protocol service inside MSDTC, use the wsatConfig.exe tool with the following command.</span></span>

`WsatConfig.exe –network:disable -restart`

## <a name="configure-trust-between-two-machines"></a><span data-ttu-id="fd1f1-125">Настройка отношений доверия между двумя компьютерами</span><span class="sxs-lookup"><span data-stu-id="fd1f1-125">Configure trust between two machines</span></span>

<span data-ttu-id="fd1f1-126">Для службы протокола WS-AT требуется, чтобы администратор явно авторизовал отдельные учетные записи для их участия в распределенных транзакциях.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-126">The WS-AT protocol service requires the administrator to explicitly authorize individual accounts to participate in distributed transactions.</span></span> <span data-ttu-id="fd1f1-127">Администратор двух компьютеров может настроить оба из них, чтобы они установили взаимно доверенные отношения путем обмена правильным набором сертификатов между компьютерами, их установки в соответствующие хранилища сертификатов и использования средства wsatConfig.exe для добавления сертификата каждого компьютера в список сертификатов авторизованных участников другого компьютера.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-127">If you are an administrator for two machines, you can configure both machines to establish a mutual trust relationship by exchanging the right set of certificates between the machines, installing them into the appropriate certificate stores, and using the wsatConfig.exe tool to add each machine's certificate to the other's list of authorized participant certificates.</span></span> <span data-ttu-id="fd1f1-128">Эта процедура необходима для выполнения распределенных транзакций между двумя компьютерами с WS-AT.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-128">This step is necessary to perform distributed transactions between two machines using WS-AT.</span></span>

<span data-ttu-id="fd1f1-129">В следующем примере описываются этапы установления доверия между двумя компьютерами, A и B.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-129">In the following example outlines the steps to establish trust between two machines, A and B.</span></span>

### <a name="create-and-export-certificates"></a><span data-ttu-id="fd1f1-130">Создание и экспорт сертификатов</span><span class="sxs-lookup"><span data-stu-id="fd1f1-130">Create and export certificates</span></span>

<span data-ttu-id="fd1f1-131">Для этой процедуры требуется оснастка диспетчера сертификатов MMC.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-131">This procedure requires the MMC Certificates snap-in.</span></span> <span data-ttu-id="fd1f1-132">Чтобы открыть эту оснастку, выберите меню «Пуск - Выполнить», введите «mmc» в поле ввода и нажмите кнопку «ОК».</span><span class="sxs-lookup"><span data-stu-id="fd1f1-132">The snap-in can be accessed by opening the Start/Run menu, typing "mmc" in the input box and pressing OK.</span></span> <span data-ttu-id="fd1f1-133">Затем в окне **Консоль1** перейдите к оснастке **файл/добавить-удалить** , нажмите кнопку Добавить и выберите **Сертификаты** из **доступного автономного списка оснастки** .</span><span class="sxs-lookup"><span data-stu-id="fd1f1-133">Then, in the **Console1** window, navigate to **the File/Add-Remove** Snap-in, click Add, and choose **Certificates** from the **Available Standalone Snapins** list.</span></span> <span data-ttu-id="fd1f1-134">Наконец, выберите **учетную запись компьютера** для управления и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-134">Finally, select **Computer Account** to manage and click **OK**.</span></span> <span data-ttu-id="fd1f1-135">Узел **Сертификаты** отображается в консоли оснастки.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-135">The **Certificates** node appears in the snap-in console.</span></span>

<span data-ttu-id="fd1f1-136">Чтобы установить доверенные отношения, необходимо уже иметь в наличии необходимые сертификаты.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-136">You must already possess the required certificates to establish trust.</span></span> <span data-ttu-id="fd1f1-137">Сведения о создании и установке новых сертификатов перед выполнением следующих шагов см. в разделе [как создавать и устанавливать временные сертификаты клиентов в WCF во время разработки](https://docs.microsoft.com/previous-versions/msp-n-p/ff650751(v=pandp.10)).</span><span class="sxs-lookup"><span data-stu-id="fd1f1-137">To learn how to create and install new certificates prior to the following steps, see [How to: Create and Install Temporary Client Certificates in WCF During Development](https://docs.microsoft.com/previous-versions/msp-n-p/ff650751(v=pandp.10)).</span></span>

1. <span data-ttu-id="fd1f1-138">На компьютере A, использующем оснастку диспетчера сертификатов MMC, импортируйте существующий сертификат (certA) в хранилище LocalMachine\MY (Личный узел) и LocalMachine\ROOT (узел доверенного корневого центра сертификации).</span><span class="sxs-lookup"><span data-stu-id="fd1f1-138">On machine A, using the MMC Certificates snap-in, import the existing certificate (certA) into the LocalMachine\MY (Personal Node) and LocalMachine\ROOT store (trusted root certification authority node).</span></span> <span data-ttu-id="fd1f1-139">Чтобы импортировать сертификат на конкретный узел, щелкните узел правой кнопкой мыши и выберите **все задачи/импорт**.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-139">To import a certificate to a specific node, right-click the node and choose **All Tasks/Import**.</span></span>

2. <span data-ttu-id="fd1f1-140">На компьютере B, использующем оснастку диспетчера сертификатов MMC, создайте или получите сертификат (certB) с закрытым ключом и импортируйте его в хранилище LocalMachine\MY (личный узел) и LocalMachine\ROOT (узел доверенного корневого центра сертификации).</span><span class="sxs-lookup"><span data-stu-id="fd1f1-140">On machine B, using the MMC Certificates snap-in, create or obtain a certificate certB with a private key and import it into the LocalMachine\MY (Personal Node) and LocalMachine\ROOT store (trusted root certification authority node).</span></span>

3. <span data-ttu-id="fd1f1-141">Экспортируйте открытый ключ certA в файл, если это еще не сделано.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-141">Export certA's public key to a file if this has not been done already.</span></span>

4. <span data-ttu-id="fd1f1-142">Экспортируйте открытый ключ certB в файл, если это еще не сделано.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-142">Export certB's public key to a file if this has not been done already.</span></span>

### <a name="establish-mutual-trust-between-machines"></a><span data-ttu-id="fd1f1-143">Установка взаимного доверия между компьютерами</span><span class="sxs-lookup"><span data-stu-id="fd1f1-143">Establish mutual trust between machines</span></span>

1. <span data-ttu-id="fd1f1-144">На компьютере A импортируйте файловое представление certB в хранилища LocalMachine\MY и LocalMachine\ROOT.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-144">On machine A, import the file representation of certB into the LocalMachine\MY and LocalMachine\ROOT stores.</span></span> <span data-ttu-id="fd1f1-145">Это объявляет, что компьютер A доверяет certB связываться с ним.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-145">This declares that machine A trusts certB to communicate with it.</span></span>

2. <span data-ttu-id="fd1f1-146">На компьютере B импортируйте файл certA в хранилища LocalMachine\MY и LocalMachine\ROOT.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-146">On machine B, import certA’s file into the LocalMachine\MY and LocalMachine\ROOT stores.</span></span> <span data-ttu-id="fd1f1-147">Это подразумевает, что компьютер B доверяет certA связываться с ним.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-147">This implies that machine B trusts certA to communicate with it.</span></span>

<span data-ttu-id="fd1f1-148">По завершении этих этапов между двумя компьютерами устанавливаются отношения доверия, и их можно настроить таким образом, чтобы они связывались друг с другом с использованием WS-AT.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-148">After completing these steps, trust is established between the two machines, and they can be configured to communicate with each other using WS-AT.</span></span>

### <a name="configure-msdtc-to-use-certificates"></a><span data-ttu-id="fd1f1-149">Настройка MSDTC для использования сертификатов</span><span class="sxs-lookup"><span data-stu-id="fd1f1-149">Configure MSDTC to use certificates</span></span>

<span data-ttu-id="fd1f1-150">Поскольку служба протокола WS-AT работает как клиент и как сервер, она должна прослушивать входящие подключения и инициировать исходящие.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-150">Since the WS-AT protocol service acts as both a client and a server, it must both listen for incoming connections and initiate outgoing connections.</span></span> <span data-ttu-id="fd1f1-151">Поэтому координатор MSDTC необходимо настроить таким образом, чтобы он знал, какой сертификат использовать для связи с внешними сторонами, а какие авторизовывать во время приема входящего подключения.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-151">Therefore, you need to configure MSDTC so that it knows which certificate to use when communicating with external parties, and which certificates to authorize when accepting incoming communication.</span></span>

<span data-ttu-id="fd1f1-152">Это можно осуществить с помощью оснастки MMC WS-AT.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-152">You can configure this by using the MMC WS-AT snap-in.</span></span> <span data-ttu-id="fd1f1-153">Дополнительные сведения об этом средстве см. в разделе [оснастка конфигурации WS-ATOMICTRANSACTION MMC](../../../../docs/framework/wcf/ws-atomictransaction-configuration-mmc-snap-in.md) .</span><span class="sxs-lookup"><span data-stu-id="fd1f1-153">For more information about this tool, see the [WS-AtomicTransaction Configuration MMC Snap-in](../../../../docs/framework/wcf/ws-atomictransaction-configuration-mmc-snap-in.md) topic.</span></span> <span data-ttu-id="fd1f1-154">Далее описывается, как устанавливать отношения доверия между двумя компьютерами с MSDTC.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-154">The following steps describe how to establish trust between two computers running MSDTC.</span></span>

1. <span data-ttu-id="fd1f1-155">Задайте параметры компьютера A.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-155">Configure machine A's settings.</span></span> <span data-ttu-id="fd1f1-156">Для "сертификат конечной точки" выберите Cert a.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-156">For "Endpoint Certificate", select certA.</span></span> <span data-ttu-id="fd1f1-157">Для "полномочные сертификаты" выберите Цертб.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-157">For "Authorized Certificates", select the certB.</span></span>

2. <span data-ttu-id="fd1f1-158">Задайте параметры компьютера B.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-158">Configure machine B's settings.</span></span> <span data-ttu-id="fd1f1-159">В качестве "сертификата конечной точки" выберите Цертб.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-159">For "Endpoint Certificate", select certB.</span></span> <span data-ttu-id="fd1f1-160">Для "полномочные сертификаты" выберите сертификат а.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-160">For "Authorized Certificates", select the certA.</span></span>

> [!NOTE]
> <span data-ttu-id="fd1f1-161">Когда один компьютер отправляет сообщение другому, отправитель пытается проверить совпадение имени субъекта сертификата получателя и имени компьютера получателя.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-161">When one machine sends a message to the other machine, the sender attempts to verify that the subject name of the recipient’s certificate and the name of the recipient’s machine match.</span></span> <span data-ttu-id="fd1f1-162">Если они не совпадают, проверка сертификата завершается ошибкой и оба компьютера не могут связываться друг с другом.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-162">If they do not match, certificate verification fails and the two machines cannot communicate.</span></span>
>
> <span data-ttu-id="fd1f1-163">Для компьютера, входящего в состав домена, имя представляет собой полное доменное имя.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-163">For a machine joined to a domain, the name is the fully qualified domain name.</span></span> <span data-ttu-id="fd1f1-164">По умолчанию имя компьютера в рабочей группе является именем NetBIOS компьютера.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-164">By default, the name of a machine on a workgroup is the machine’s NetBIOS name.</span></span> <span data-ttu-id="fd1f1-165">Однако имя также может содержать суффикс службы доменных имен (DNS), если он используется для подключения между двумя компьютерами.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-165">However, the name can also include a Domain Name System (DNS) suffix if one is present for the connection being used between the two machines.</span></span>
>
> <span data-ttu-id="fd1f1-166">Если имя компьютера меняется, например, когда компьютер рабочей группы входит в состав домена, необходимо повторно выдать сертификаты или вручную настроить суффиксы DNS.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-166">If the name of the machine changes, for example, when a workgroup machine joins a domain, you must reissue certificates or manually configure DNS suffixes.</span></span>

## <a name="security"></a><span data-ttu-id="fd1f1-167">по безопасности</span><span class="sxs-lookup"><span data-stu-id="fd1f1-167">Security</span></span>

<span data-ttu-id="fd1f1-168">Поскольку некоторые параметры, относящиеся к MSDTC и WS-AT, хранятся в реестре в разделе HKLM\Software\Microsoft\MSDTC и HKLM\Software\Microsoft\WSAT соответственно, убедитесь, что эти ключи реестра защищены и только администраторы могут указывать в них значения.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-168">Since some of the settings related to MSDTC and WS-AT are stored in the registry at HKLM\Software\Microsoft\MSDTC and at HKLM\Software\Microsoft\WSAT, respectively, ensure that these registry keys are secured so that only administrators can write to them.</span></span> <span data-ttu-id="fd1f1-169">В редакторе реестра щелкните правой кнопкой мыши ключ, который необходимо защитить, и выберите **разрешение** на установку соответствующего элемента управления доступом.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-169">In the Registry Editor tool, right-click the key you want to secure and select **Permission** to set the appropriate access control.</span></span> <span data-ttu-id="fd1f1-170">Для обеспечения безопасности и целостности системы крайне важно, чтобы для важных ключей был задан атрибут «только для чтения» для пользователей с ограниченными правами доступа.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-170">It is crucial to the security and integrity of the system that important keys are read-only for low-privileged users.</span></span>

<span data-ttu-id="fd1f1-171">При развертывании MSDTC администратор должен обеспечить безопасность обмена любыми данными MSDTC.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-171">When deploying MSDTC, the administrator must ensure that any MSDTC data interchange is secure.</span></span> <span data-ttu-id="fd1f1-172">При развертывании рабочей группы изолируйте инфраструктуру транзакций от злоумышленников. При кластерном развертывании защитите реестр кластера.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-172">In a workgroup deployment, isolate the transactional infrastructure from malicious users; in a cluster deployment, secure the cluster registry.</span></span>

## <a name="tracing"></a><span data-ttu-id="fd1f1-173">Трассировка</span><span class="sxs-lookup"><span data-stu-id="fd1f1-173">Tracing</span></span>

<span data-ttu-id="fd1f1-174">Служба протокола WS-AT поддерживает интегрированную трассировку, зависящую от транзакций, которая может быть включена и управляться с помощью средства [оснастки MMC "Настройка конфигурации WS-AtomicTransaction](../../../../docs/framework/wcf/ws-atomictransaction-configuration-mmc-snap-in.md) ".</span><span class="sxs-lookup"><span data-stu-id="fd1f1-174">The WS-AT protocol service supports integrated, transaction-specific tracing that can be enabled and managed through the use of the [WS-AtomicTransaction Configuration MMC Snap-in](../../../../docs/framework/wcf/ws-atomictransaction-configuration-mmc-snap-in.md) tool.</span></span> <span data-ttu-id="fd1f1-175">Трассировки могут включать в себя данные, указывающие на время создания зачисления для определенной транзакции, время достижения транзакцией конечного состояния и результат, полученный зачислением каждой транзакции.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-175">Traces can include data indicating the time an enlistment is made for a specific transaction, the time a transaction reaches its terminal state, the outcome each transaction enlistment has received.</span></span> <span data-ttu-id="fd1f1-176">Просмотреть все трассировки можно с помощью средства [Service Trace Viewer (SvcTraceViewer. exe)](../../../../docs/framework/wcf/service-trace-viewer-tool-svctraceviewer-exe.md) .</span><span class="sxs-lookup"><span data-stu-id="fd1f1-176">All traces can be viewed using the [Service Trace Viewer Tool (SvcTraceViewer.exe)](../../../../docs/framework/wcf/service-trace-viewer-tool-svctraceviewer-exe.md) tool.</span></span>

<span data-ttu-id="fd1f1-177">Служба протокола WS-AT также поддерживает интегрированную трассировку ServiceModel во время сеанса трассировки ETW.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-177">The WS-AT protocol service also supports integrated ServiceModel tracing through the ETW trace session.</span></span> <span data-ttu-id="fd1f1-178">Результатом этого являются более подробные трассировки, относящиеся к связи, в дополнение к существующим трассировкам транзакций.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-178">This provides more detailed, communication-specific traces in addition to the existing transaction traces.</span></span>  <span data-ttu-id="fd1f1-179">Чтобы включить такие дополнительные трассировки, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-179">To enable these additional traces, follow these steps</span></span>

1. <span data-ttu-id="fd1f1-180">Откройте меню **Пуск/выполнить** , введите "regedit" в поле "вход" и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-180">Open the **Start/Run** menu, type "regedit" in the input box and select **OK**.</span></span>

2. <span data-ttu-id="fd1f1-181">В **редакторе реестра**перейдите к следующей папке в левой области, Hkey_Local_Machine \software\microsoft\wsat\3.0</span><span class="sxs-lookup"><span data-stu-id="fd1f1-181">In the **Registry Editor**, navigate to the following folder on the left pane, Hkey_Local_Machine\SOFTWARE\Microsoft\WSAT\3.0</span></span>\

3. <span data-ttu-id="fd1f1-182">Щелкните правой кнопкой мыши значение `ServiceModelDiagnosticTracing` на правой панели и выберите **изменить**.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-182">Right-click the `ServiceModelDiagnosticTracing` value in the right pane and select **Modify**.</span></span>

4. <span data-ttu-id="fd1f1-183">В поле Ввод **данных значения** введите одно из следующих допустимых значений, чтобы указать уровень трассировки, который требуется включить.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-183">In the **Value data** input box, enter one of the following valid values to specify the trace level you want to enable.</span></span>

- <span data-ttu-id="fd1f1-184">0: выключено</span><span class="sxs-lookup"><span data-stu-id="fd1f1-184">0: off</span></span>

- <span data-ttu-id="fd1f1-185">1: критично</span><span class="sxs-lookup"><span data-stu-id="fd1f1-185">1: critical</span></span>

- <span data-ttu-id="fd1f1-186">3: ошибка.</span><span class="sxs-lookup"><span data-stu-id="fd1f1-186">3: error.</span></span> <span data-ttu-id="fd1f1-187">Это значение по умолчанию</span><span class="sxs-lookup"><span data-stu-id="fd1f1-187">This is the default value</span></span>

- <span data-ttu-id="fd1f1-188">7: предупреждение</span><span class="sxs-lookup"><span data-stu-id="fd1f1-188">7: warning</span></span>

- <span data-ttu-id="fd1f1-189">15: информация</span><span class="sxs-lookup"><span data-stu-id="fd1f1-189">15: information</span></span>

- <span data-ttu-id="fd1f1-190">31: подробно</span><span class="sxs-lookup"><span data-stu-id="fd1f1-190">31: verbose</span></span>

## <a name="see-also"></a><span data-ttu-id="fd1f1-191">См. также:</span><span class="sxs-lookup"><span data-stu-id="fd1f1-191">See also</span></span>

- [<span data-ttu-id="fd1f1-192">Служебная программа конфигурации WS-AtomicTransaction (wsatConfig.exe)</span><span class="sxs-lookup"><span data-stu-id="fd1f1-192">WS-AtomicTransaction Configuration Utility (wsatConfig.exe)</span></span>](../../../../docs/framework/wcf/ws-atomictransaction-configuration-utility-wsatconfig-exe.md)
- [<span data-ttu-id="fd1f1-193">Оснастка консоли MMC для конфигурации WS-AtomicTransaction</span><span class="sxs-lookup"><span data-stu-id="fd1f1-193">WS-AtomicTransaction Configuration MMC Snap-in</span></span>](../../../../docs/framework/wcf/ws-atomictransaction-configuration-mmc-snap-in.md)
