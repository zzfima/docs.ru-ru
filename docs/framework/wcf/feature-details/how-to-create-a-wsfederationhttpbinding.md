---
title: Практическое руководство. Создание WSFederationHttpBinding
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- WCF, federation
- federation
ms.assetid: e54897d7-aa6c-46ec-a278-b2430c8c2e10
ms.openlocfilehash: c3ce90c74ae61dfcbfc0b05fc17b25fe0118e071
ms.sourcegitcommit: fbb8a593a511ce667992502a3ce6d8f65c594edf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/16/2019
ms.locfileid: "74141694"
---
# <a name="how-to-create-a-wsfederationhttpbinding"></a><span data-ttu-id="c7f84-102">Практическое руководство. Создание WSFederationHttpBinding</span><span class="sxs-lookup"><span data-stu-id="c7f84-102">How to: Create a WSFederationHttpBinding</span></span>

<span data-ttu-id="c7f84-103">В Windows Communication Foundation (WCF) класс <xref:System.ServiceModel.WSFederationHttpBinding> ([\<wsFederationHttpBinding >](../../../../docs/framework/configure-apps/file-schema/wcf/wsfederationhttpbinding.md) в конфигурации) предоставляет механизм для предоставления федеративной службы.</span><span class="sxs-lookup"><span data-stu-id="c7f84-103">In Windows Communication Foundation (WCF), the <xref:System.ServiceModel.WSFederationHttpBinding> class ([\<wsFederationHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/wsfederationhttpbinding.md) in configuration) provides a mechanism for exposing a federated service.</span></span> <span data-ttu-id="c7f84-104">т. е. к службе, требующей проверки подлинности клиентов с использованием маркера безопасности, выданного службой маркеров безопасности.</span><span class="sxs-lookup"><span data-stu-id="c7f84-104">That is, a service that requires clients to authenticate using a security token issued by a security token service.</span></span> <span data-ttu-id="c7f84-105">В этом разделе показано, как настраивать привязку <xref:System.ServiceModel.WSFederationHttpBinding> в коде и в конфигурации.</span><span class="sxs-lookup"><span data-stu-id="c7f84-105">This topic shows how to set up a <xref:System.ServiceModel.WSFederationHttpBinding> in both code and configuration.</span></span> <span data-ttu-id="c7f84-106">После создания привязки можно настроить конечную точку на использование этой привязки.</span><span class="sxs-lookup"><span data-stu-id="c7f84-106">Once the binding is created, you can set up an endpoint to use that binding.</span></span>

 <span data-ttu-id="c7f84-107">Ниже перечислены основные шаги.</span><span class="sxs-lookup"><span data-stu-id="c7f84-107">The basic steps are outlined as follows:</span></span>

1. <span data-ttu-id="c7f84-108">Выберите режим безопасности.</span><span class="sxs-lookup"><span data-stu-id="c7f84-108">Select a security mode.</span></span> <span data-ttu-id="c7f84-109">Привязка <xref:System.ServiceModel.WSFederationHttpBinding> поддерживает режим `Message`, обеспечивающий сквозную защиту на уровне сообщений даже при нескольких переходах, а также режим `TransportWithMessageCredential`, который повышает производительность в случаях, когда клиент и служба могут напрямую подключаться друг к другу с помощью протокола HTTPS.</span><span class="sxs-lookup"><span data-stu-id="c7f84-109">The <xref:System.ServiceModel.WSFederationHttpBinding> supports `Message`, which provides end-to-end security at the message level, even across multiple hops, and `TransportWithMessageCredential`, which provides better performance in cases where the client and the service can make a direct connection over HTTPS.</span></span>

    > [!NOTE]
    > <span data-ttu-id="c7f84-110">Кроме того, привязка <xref:System.ServiceModel.WSFederationHttpBinding> поддерживает режим безопасности `None`.</span><span class="sxs-lookup"><span data-stu-id="c7f84-110">The <xref:System.ServiceModel.WSFederationHttpBinding> also supports `None` as a security mode.</span></span> <span data-ttu-id="c7f84-111">Этот режим небезопасен и поддерживается только в целях отладки.</span><span class="sxs-lookup"><span data-stu-id="c7f84-111">This mode is not secure and is provided for debugging purposes only.</span></span> <span data-ttu-id="c7f84-112">Если конечная точка службы развертывается с <xref:System.ServiceModel.WSFederationHttpBinding>, для которой установлен режим безопасности `None`, то результирующая привязка клиента (созданная [средством служебной программы метаданных ServiceModel (Svcutil. exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)) представляет собой <xref:System.ServiceModel.WSHttpBinding> с режимом безопасности `None`.</span><span class="sxs-lookup"><span data-stu-id="c7f84-112">If a service endpoint is deployed with a <xref:System.ServiceModel.WSFederationHttpBinding> with its security mode set to `None`, the resulting client binding (generated by the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)) is a <xref:System.ServiceModel.WSHttpBinding> with a security mode of `None`.</span></span>

     <span data-ttu-id="c7f84-113">В отличие от других предоставляемых системой привязок, при использовании привязки `WSFederationHttpBinding` нет необходимости выбирать тип учетных данных клиента.</span><span class="sxs-lookup"><span data-stu-id="c7f84-113">Unlike other system-provided bindings, it is not necessary to select a client credential type when using the `WSFederationHttpBinding`.</span></span> <span data-ttu-id="c7f84-114">Это связано с тем, что типом учетных данных клиента всегда является выданный токен.</span><span class="sxs-lookup"><span data-stu-id="c7f84-114">This is because the client credential type is always an issued token.</span></span> <span data-ttu-id="c7f84-115">WCF получает маркер от указанного издателя и представляет этот токен службе для проверки подлинности клиента.</span><span class="sxs-lookup"><span data-stu-id="c7f84-115">WCF acquires a token from a specified issuer and presents that token to the service to authenticate the client.</span></span>

2. <span data-ttu-id="c7f84-116">В федеративных клиентах присвойте свойству <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerAddress%2A> URL-адрес службы маркеров безопасности.</span><span class="sxs-lookup"><span data-stu-id="c7f84-116">On federated clients, set the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerAddress%2A> property to the URL of the security token service.</span></span> <span data-ttu-id="c7f84-117">Задайте в качестве свойства <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerBinding%2A> привязку, которая должна использоваться для взаимодействия со службой маркеров безопасности.</span><span class="sxs-lookup"><span data-stu-id="c7f84-117">Set the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerBinding%2A> to the binding to use to communicate with the security token service.</span></span>

3. <span data-ttu-id="c7f84-118">Необязательный.</span><span class="sxs-lookup"><span data-stu-id="c7f84-118">Optional.</span></span> <span data-ttu-id="c7f84-119">Задайте в качестве свойства <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuedTokenType%2A> универсальный код ресурса (URI) типа маркера.</span><span class="sxs-lookup"><span data-stu-id="c7f84-119">Set the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuedTokenType%2A> property to the Uniform Resource Identifier (URI) of a token type.</span></span> <span data-ttu-id="c7f84-120">В федеративных службах укажите ожидаемый службой тип маркера.</span><span class="sxs-lookup"><span data-stu-id="c7f84-120">On federated services, specify the token type that the service expects.</span></span> <span data-ttu-id="c7f84-121">В федеративных клиентах укажите тип маркера, запрашиваемый клиентом у службы маркеров безопасности.</span><span class="sxs-lookup"><span data-stu-id="c7f84-121">On federated clients, specify the token type the client requests from the security token service.</span></span>

     <span data-ttu-id="c7f84-122">Если тип маркера не задан, клиенты создают маркеры безопасности запросов (RST) WS-Trust без универсального кода ресурса (URI) типа маркера, а служба по умолчанию ожидает проверки подлинности клиента с использованием маркера SAML 1.1.</span><span class="sxs-lookup"><span data-stu-id="c7f84-122">If no token type is specified, clients generate WS-Trust Request Security Tokens (RSTs) without a token type URI, and services expect client authentication using a Security Assertions Markup Language (SAML) 1.1 token by default.</span></span>

     <span data-ttu-id="c7f84-123">URI токена SAML 1,1 `http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1`.</span><span class="sxs-lookup"><span data-stu-id="c7f84-123">The URI for a SAML 1.1 token is `http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1`.</span></span>

4. <span data-ttu-id="c7f84-124">Необязательный.</span><span class="sxs-lookup"><span data-stu-id="c7f84-124">Optional.</span></span> <span data-ttu-id="c7f84-125">В федеративных службах присвойте свойству <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerMetadataAddress%2A> URL-адрес метаданных службы маркеров безопасности.</span><span class="sxs-lookup"><span data-stu-id="c7f84-125">On federated services, set the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerMetadataAddress%2A> property to the metadata URL of a security token service.</span></span> <span data-ttu-id="c7f84-126">Конечная точка метаданных позволяет клиентам службы выбрать соответствующую пару «привязка - конечная точка», если служба настроена на публикацию метаданных.</span><span class="sxs-lookup"><span data-stu-id="c7f84-126">The metadata endpoint enables clients of the service to select an appropriate binding/endpoint pair, if the service is configured to publish metadata.</span></span> <span data-ttu-id="c7f84-127">Дополнительные сведения о публикации метаданных см. в разделе [Публикация метаданных](publishing-metadata.md).</span><span class="sxs-lookup"><span data-stu-id="c7f84-127">For more information about publishing metadata, see [Publishing Metadata](publishing-metadata.md).</span></span>

 <span data-ttu-id="c7f84-128">Можно также задать другие свойства, в том числе тип ключа, используемого в качестве ключа проверки в выданном маркере, набор алгоритмов для взаимодействия между клиентом и службой, необходимость согласования или явного задания учетных данных службы, конкретные утверждения, которые служба ожидает получить в выданном маркере, а также любые дополнительные элементы XML, которые необходимо добавить в запрос, отправляемый клиентом службе маркеров безопасности.</span><span class="sxs-lookup"><span data-stu-id="c7f84-128">You can also set other properties, including the type of key used as a proof key in the issued token, the algorithm suite to use between the client and the service, whether to negotiate or explicitly specify the service credential, any specific claims the service expects the issued token to contain, and any additional XML elements that must be added to the request the client sends to the security token service.</span></span>

> [!NOTE]
> <span data-ttu-id="c7f84-129">Свойство `NegotiateServiceCredential` используется только в том случае, если `SecurityMode` имеет значение `Message`.</span><span class="sxs-lookup"><span data-stu-id="c7f84-129">The `NegotiateServiceCredential` property is only relevant when the `SecurityMode` is set to `Message`.</span></span> <span data-ttu-id="c7f84-130">Если `SecurityMode` имеет значение `TransportWithMessageCredential`, свойство `NegotiateServiceCredential` игнорируется.</span><span class="sxs-lookup"><span data-stu-id="c7f84-130">If `SecurityMode` is set to `TransportWithMessageCredential`, then the `NegotiateServiceCredential` property is ignored.</span></span>

## <a name="to-configure-a-wsfederationhttpbinding-in-code"></a><span data-ttu-id="c7f84-131">Настройка привязки WSFederationHttpBinding в коде</span><span class="sxs-lookup"><span data-stu-id="c7f84-131">To configure a WSFederationHttpBinding in code</span></span>

1. <span data-ttu-id="c7f84-132">Создайте экземпляр класса <xref:System.ServiceModel.WSFederationHttpBinding>.</span><span class="sxs-lookup"><span data-stu-id="c7f84-132">Create an instance of the <xref:System.ServiceModel.WSFederationHttpBinding>.</span></span>

2. <span data-ttu-id="c7f84-133">Присвойте свойству <xref:System.ServiceModel.WSFederationHttpSecurity.Mode%2A> значение <xref:System.ServiceModel.WSFederationHttpSecurityMode> или <xref:System.ServiceModel.WSFederationHttpSecurityMode.Message> в зависимости от необходимости.</span><span class="sxs-lookup"><span data-stu-id="c7f84-133">Set the <xref:System.ServiceModel.WSFederationHttpSecurity.Mode%2A> property to <xref:System.ServiceModel.WSFederationHttpSecurityMode> or <xref:System.ServiceModel.WSFederationHttpSecurityMode.Message> as required.</span></span> <span data-ttu-id="c7f84-134">Если требуется набор алгоритмов, отличный от <xref:System.ServiceModel.Security.SecurityAlgorithmSuite.Basic256%2A>, задайте для свойства <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.AlgorithmSuite%2A> значение, взятое из <xref:System.ServiceModel.Security.SecurityAlgorithmSuite>.</span><span class="sxs-lookup"><span data-stu-id="c7f84-134">If an algorithm suite other than <xref:System.ServiceModel.Security.SecurityAlgorithmSuite.Basic256%2A> is required, set the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.AlgorithmSuite%2A> property to a value taken from <xref:System.ServiceModel.Security.SecurityAlgorithmSuite>.</span></span>

3. <span data-ttu-id="c7f84-135">Задайте свойство <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.NegotiateServiceCredential%2A> в зависимости от необходимости.</span><span class="sxs-lookup"><span data-stu-id="c7f84-135">Set the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.NegotiateServiceCredential%2A> property as appropriate.</span></span>

4. <span data-ttu-id="c7f84-136">Задайте для свойства <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuedKeyType%2A> значение <xref:System.IdentityModel.Tokens.SecurityKeyType>`SymmetricKey` или.`AsymmetricKey`</span><span class="sxs-lookup"><span data-stu-id="c7f84-136">Set the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuedKeyType%2A> property to <xref:System.IdentityModel.Tokens.SecurityKeyType>`SymmetricKey` or .`AsymmetricKey`</span></span> <span data-ttu-id="c7f84-137">При необходимости.</span><span class="sxs-lookup"><span data-stu-id="c7f84-137">as required.</span></span>

5. <span data-ttu-id="c7f84-138">Присвойте свойству <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuedTokenType%2A> соответствующее значение.</span><span class="sxs-lookup"><span data-stu-id="c7f84-138">Set the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuedTokenType%2A> property to the appropriate value.</span></span> <span data-ttu-id="c7f84-139">Если значение не задано, WCF по умолчанию принимает `http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1`, что указывает токены SAML 1,1.</span><span class="sxs-lookup"><span data-stu-id="c7f84-139">If no value is set, WCF defaults to `http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1`, which indicates SAML 1.1 tokens.</span></span>

6. <span data-ttu-id="c7f84-140">Является обязательным для клиента, если не задан локальный издатель; для службы является необязательным.</span><span class="sxs-lookup"><span data-stu-id="c7f84-140">Required on the client if no local issuer is specified; optional on the service.</span></span> <span data-ttu-id="c7f84-141">Создайте объект <xref:System.ServiceModel.EndpointAddress>, содержащий адрес и сведения об удостоверении службы маркеров безопасности и присвойте экземпляр <xref:System.ServiceModel.EndpointAddress> свойству <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerAddress%2A>.</span><span class="sxs-lookup"><span data-stu-id="c7f84-141">Create an <xref:System.ServiceModel.EndpointAddress> that contains the address and identity information of the security token service and assign the <xref:System.ServiceModel.EndpointAddress> instance to the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerAddress%2A> property.</span></span>

7. <span data-ttu-id="c7f84-142">Является обязательным для клиента, если не задан локальный издатель; для службы не используется.</span><span class="sxs-lookup"><span data-stu-id="c7f84-142">Required on the client if no local issuer is specified; not used on the service.</span></span> <span data-ttu-id="c7f84-143">Создайте <xref:System.ServiceModel.Channels.Binding> для `SecurityTokenService` и назначьте экземпляр <xref:System.ServiceModel.Channels.Binding> свойству <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerBinding%2A>.</span><span class="sxs-lookup"><span data-stu-id="c7f84-143">Create a <xref:System.ServiceModel.Channels.Binding> for the `SecurityTokenService` and assign the <xref:System.ServiceModel.Channels.Binding> instance to the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerBinding%2A> property.</span></span>

8. <span data-ttu-id="c7f84-144">Не используется для клиента; является необязательным для службы.</span><span class="sxs-lookup"><span data-stu-id="c7f84-144">Not used on the client; optional on the service.</span></span> <span data-ttu-id="c7f84-145">Создайте экземпляр <xref:System.ServiceModel.EndpointAddress> для метаданных службы маркеров безопасности и присвойте его свойству `IssuerMetadataAddress`.</span><span class="sxs-lookup"><span data-stu-id="c7f84-145">Create an <xref:System.ServiceModel.EndpointAddress> instance for the metadata of the security token service and assign it to the `IssuerMetadataAddress` property.</span></span>

9. <span data-ttu-id="c7f84-146">Является необязательным как для клиента, так и для службы.</span><span class="sxs-lookup"><span data-stu-id="c7f84-146">Optional on both the client and the service.</span></span> <span data-ttu-id="c7f84-147">Создайте и добавьте один или более экземпляров <xref:System.ServiceModel.Security.Tokens.ClaimTypeRequirement> в коллекцию, возвращаемую свойством <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.ClaimTypeRequirements%2A>.</span><span class="sxs-lookup"><span data-stu-id="c7f84-147">Create and add one or more <xref:System.ServiceModel.Security.Tokens.ClaimTypeRequirement> instances to the collection returned by the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.ClaimTypeRequirements%2A> property.</span></span>

10. <span data-ttu-id="c7f84-148">Является необязательным как для клиента, так и для службы.</span><span class="sxs-lookup"><span data-stu-id="c7f84-148">Optional on both the client and the service.</span></span> <span data-ttu-id="c7f84-149">Создайте и добавьте один или более экземпляров <xref:System.Xml.XmlElement> в коллекцию, возвращаемую свойством <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.TokenRequestParameters%2A>.</span><span class="sxs-lookup"><span data-stu-id="c7f84-149">Create and add one or more <xref:System.Xml.XmlElement> instances to the collection returned by the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.TokenRequestParameters%2A> property.</span></span>

## <a name="to-create-a-federated-endpoint-in-configuration"></a><span data-ttu-id="c7f84-150">Создание федеративной конечной точки в конфигурации</span><span class="sxs-lookup"><span data-stu-id="c7f84-150">To create a federated endpoint in configuration</span></span>

1. <span data-ttu-id="c7f84-151">Создайте [\<wsFederationHttpBinding >](../../../../docs/framework/configure-apps/file-schema/wcf/wsfederationhttpbinding.md) в качестве дочернего элемента [\<привязок >](../../../../docs/framework/configure-apps/file-schema/wcf/bindings.md) в файле конфигурации приложения.</span><span class="sxs-lookup"><span data-stu-id="c7f84-151">Create a [\<wsFederationHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/wsfederationhttpbinding.md) as a child of the [\<bindings>](../../../../docs/framework/configure-apps/file-schema/wcf/bindings.md) element in the application configuration file.</span></span>

2. <span data-ttu-id="c7f84-152">Создайте [\<привязку >](../../configure-apps/file-schema/wcf/bindings.md) в качестве дочернего элемента [\<WSFederationHttpBinding >](../../../../docs/framework/configure-apps/file-schema/wcf/wsfederationhttpbinding.md) и задайте для атрибута `name` соответствующее значение.</span><span class="sxs-lookup"><span data-stu-id="c7f84-152">Create a [\<binding>](../../configure-apps/file-schema/wcf/bindings.md) element as a child of [\<wsFederationHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/wsfederationhttpbinding.md) and set the `name` attribute to an appropriate value.</span></span>

3. <span data-ttu-id="c7f84-153">Создайте элемент `<security>` в качестве дочернего элемента [> привязки\<](../../configure-apps/file-schema/wcf/bindings.md) .</span><span class="sxs-lookup"><span data-stu-id="c7f84-153">Create a `<security>` element as a child of the [\<binding>](../../configure-apps/file-schema/wcf/bindings.md) element.</span></span>

4. <span data-ttu-id="c7f84-154">Задайте для атрибута `mode` элемента `<security>` значение `Message` или `TransportWithMessageCredential` в зависимости от необходимости.</span><span class="sxs-lookup"><span data-stu-id="c7f84-154">Set the `mode` attribute on the `<security>` element to a value of `Message` or `TransportWithMessageCredential`, as required.</span></span>

5. <span data-ttu-id="c7f84-155">Создайте элемент `<message>`, являющийся дочерним для элемента `<security>`.</span><span class="sxs-lookup"><span data-stu-id="c7f84-155">Create a `<message>` element as a child of the `<security>` element.</span></span>

6. <span data-ttu-id="c7f84-156">Необязательный.</span><span class="sxs-lookup"><span data-stu-id="c7f84-156">Optional.</span></span> <span data-ttu-id="c7f84-157">Задайте соответствующее значение атрибута `algorithmSuite` элемента `<message>`.</span><span class="sxs-lookup"><span data-stu-id="c7f84-157">Set the `algorithmSuite` attribute on the `<message>` element with an appropriate value.</span></span> <span data-ttu-id="c7f84-158">Значение по умолчанию: `Basic256`.</span><span class="sxs-lookup"><span data-stu-id="c7f84-158">The default is `Basic256`.</span></span>

7. <span data-ttu-id="c7f84-159">Необязательный.</span><span class="sxs-lookup"><span data-stu-id="c7f84-159">Optional.</span></span> <span data-ttu-id="c7f84-160">Если требуется асимметричный ключ проверки, задайте для атрибута `issuedKeyType` элемента `<message>` значение `AsymmetricKey`.</span><span class="sxs-lookup"><span data-stu-id="c7f84-160">If an asymmetric proof key is required, set the `issuedKeyType` attribute of the `<message>` element to `AsymmetricKey`.</span></span> <span data-ttu-id="c7f84-161">Значение по умолчанию: `SymmetricKey`.</span><span class="sxs-lookup"><span data-stu-id="c7f84-161">The default is `SymmetricKey`.</span></span>

8. <span data-ttu-id="c7f84-162">Необязательный.</span><span class="sxs-lookup"><span data-stu-id="c7f84-162">Optional.</span></span> <span data-ttu-id="c7f84-163">Задайте значение атрибута `issuedTokenType` элемента `<message>`.</span><span class="sxs-lookup"><span data-stu-id="c7f84-163">Set the `issuedTokenType` attribute on the `<message>` element.</span></span>

9. <span data-ttu-id="c7f84-164">Является обязательным для клиента, если не задан локальный издатель; для службы является необязательным.</span><span class="sxs-lookup"><span data-stu-id="c7f84-164">Required on the client if no local issuer is specified; optional on the service.</span></span> <span data-ttu-id="c7f84-165">Создайте элемент `<issuer>`, являющийся дочерним для элемента `<message>`.</span><span class="sxs-lookup"><span data-stu-id="c7f84-165">Create an `<issuer>` element as a child of the `<message>` element.</span></span>

10. <span data-ttu-id="c7f84-166">Задайте атрибут `address` элемента `<issuer>` и укажите адрес, по которому служба маркеров безопасности принимает запросы маркеров.</span><span class="sxs-lookup"><span data-stu-id="c7f84-166">Set the `address` attribute to the `<issuer>` element and specify the address at which the security token service accepts token requests.</span></span>

11. <span data-ttu-id="c7f84-167">Необязательный.</span><span class="sxs-lookup"><span data-stu-id="c7f84-167">Optional.</span></span> <span data-ttu-id="c7f84-168">Добавьте дочерний элемент `<identity>` и задайте удостоверение службы маркеров безопасности.</span><span class="sxs-lookup"><span data-stu-id="c7f84-168">Add an `<identity>` child element and specify the identity of the security token service</span></span>

12. <span data-ttu-id="c7f84-169">Дополнительные сведения см. в статье [удостоверение службы и проверка подлинности](service-identity-and-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="c7f84-169">For more information, see [Service Identity and Authentication](service-identity-and-authentication.md).</span></span>

13. <span data-ttu-id="c7f84-170">Является обязательным для клиента, если не задан локальный издатель; для службы не используется.</span><span class="sxs-lookup"><span data-stu-id="c7f84-170">Required on the client if no local issuer is specified; not used on the service.</span></span> <span data-ttu-id="c7f84-171">Создание [\<привязки >](../../configure-apps/file-schema/wcf/bindings.md) элемента в разделе привязок, который можно использовать для взаимодействия со службой маркеров безопасности.</span><span class="sxs-lookup"><span data-stu-id="c7f84-171">Create a [\<binding>](../../configure-apps/file-schema/wcf/bindings.md) element in the bindings section that can be used to communicate with the security token service.</span></span> <span data-ttu-id="c7f84-172">Дополнительные сведения о создании привязки см. в разделе [инструкции. Указание привязки службы в конфигурации](../../../../docs/framework/wcf/how-to-specify-a-service-binding-in-configuration.md).</span><span class="sxs-lookup"><span data-stu-id="c7f84-172">For more information about creating a binding, see [How to: Specify a Service Binding in Configuration](../../../../docs/framework/wcf/how-to-specify-a-service-binding-in-configuration.md).</span></span>

14. <span data-ttu-id="c7f84-173">Укажите привязку, созданную на предыдущем этапе, задав атрибуты `binding` и `bindingConfiguration` элемента `<issuer>`.</span><span class="sxs-lookup"><span data-stu-id="c7f84-173">Specify the binding created in the previous step by setting the `binding` and `bindingConfiguration` attributes of the `<issuer>` element.</span></span>

15. <span data-ttu-id="c7f84-174">Не используется для клиента; является необязательным для службы.</span><span class="sxs-lookup"><span data-stu-id="c7f84-174">Not used on the client; optional on the service.</span></span> <span data-ttu-id="c7f84-175">Создайте элемент `<issuerMetadata>` в качестве дочернего элемента <`message`>.</span><span class="sxs-lookup"><span data-stu-id="c7f84-175">Create an `<issuerMetadata>` element as a child of the <`message`> element.</span></span> <span data-ttu-id="c7f84-176">Затем в атрибуте `address` элемента `<issuerMetadata>` укажите адрес, по которому служба маркеров безопасности должна опубликовать свои метаданные.</span><span class="sxs-lookup"><span data-stu-id="c7f84-176">Then, in an `address` attribute on the `<issuerMetadata>` element, specify the address at which the security token service is to publish its metadata.</span></span> <span data-ttu-id="c7f84-177">Добавьте дочерний элемент `<identity>` и задайте удостоверение службы маркеров безопасности (необязательно).</span><span class="sxs-lookup"><span data-stu-id="c7f84-177">Optionally, add an `<identity>` child element and specify the identity of the security token service.</span></span>

16. <span data-ttu-id="c7f84-178">Является необязательным как для клиента, так и для службы.</span><span class="sxs-lookup"><span data-stu-id="c7f84-178">Optional on both the client and the service.</span></span> <span data-ttu-id="c7f84-179">Добавьте элемент `<claimTypeRequirements>` в качестве дочернего элемента для элемента `<message>`.</span><span class="sxs-lookup"><span data-stu-id="c7f84-179">Add a `<claimTypeRequirements>` element as a child of the `<message>` element.</span></span> <span data-ttu-id="c7f84-180">Укажите обязательные и необязательные утверждения, на которые опирается служба, добавив [\<добавить >](../../../../docs/framework/configure-apps/file-schema/wcf/add-of-claimtyperequirements.md) элементы в элемент `<claimTypeRequirements>` и указав тип утверждения с помощью атрибута `claimType`.</span><span class="sxs-lookup"><span data-stu-id="c7f84-180">Specify required and optional claims that the service relies on by adding [\<add>](../../../../docs/framework/configure-apps/file-schema/wcf/add-of-claimtyperequirements.md) elements to the `<claimTypeRequirements>` element and specifying the claim type with the `claimType` attribute.</span></span> <span data-ttu-id="c7f84-181">С помощью атрибута `isOptional` укажите, является ли то или иное утверждение обязательным.</span><span class="sxs-lookup"><span data-stu-id="c7f84-181">Specify whether a given claim is required or optional by setting the `isOptional` attribute.</span></span>

## <a name="example"></a><span data-ttu-id="c7f84-182">Пример</span><span class="sxs-lookup"><span data-stu-id="c7f84-182">Example</span></span>

<span data-ttu-id="c7f84-183">Ниже приведен пример кода принудительной настройки привязки `WSFederationHttpBinding`.</span><span class="sxs-lookup"><span data-stu-id="c7f84-183">The following code sample shows code for setting up a `WSFederationHttpBinding` imperatively.</span></span>

[!code-csharp[c_FederationBinding#2](~/samples/snippets/csharp/VS_Snippets_CFX/c_federationbinding/cs/source.cs#2)]
[!code-vb[c_FederationBinding#2](~/samples/snippets/visualbasic/VS_Snippets_CFX/c_federationbinding/vb/source.vb#2)]

## <a name="see-also"></a><span data-ttu-id="c7f84-184">См. также</span><span class="sxs-lookup"><span data-stu-id="c7f84-184">See also</span></span>

- [<span data-ttu-id="c7f84-185">Федерация</span><span class="sxs-lookup"><span data-stu-id="c7f84-185">Federation</span></span>](federation.md)
- [<span data-ttu-id="c7f84-186">Пример федерации</span><span class="sxs-lookup"><span data-stu-id="c7f84-186">Federation Sample</span></span>](../../../../docs/framework/wcf/samples/federation-sample.md)
- [<span data-ttu-id="c7f84-187">Практическое руководство. Порядок отключения безопасных сеансов в WSFederationHttpBinding</span><span class="sxs-lookup"><span data-stu-id="c7f84-187">How to: Disable Secure Sessions on a WSFederationHttpBinding</span></span>](how-to-disable-secure-sessions-on-a-wsfederationhttpbinding.md)
