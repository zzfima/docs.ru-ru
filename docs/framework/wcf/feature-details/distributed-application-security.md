---
title: Безопасность распределенного приложения
ms.date: 03/30/2017
helpviewer_keywords:
- distributed application security [WCF]
- security [WCF], transfer
ms.assetid: 53928a10-e474-46d0-ab90-5f98f8d7b668
ms.openlocfilehash: cb271bcf8fb27bae4c8ef6b60df0f8d2940ecb9a
ms.sourcegitcommit: c01c18755bb7b0f82c7232314ccf7955ea7834db
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/15/2020
ms.locfileid: "75964829"
---
# <a name="distributed-application-security"></a>Безопасность распределенного приложения
Безопасность Windows Communication Foundation (WCF) разбивается на три основные функциональные области: безопасность, управление доступом и аудит. Безопасность передачи обеспечивает целостность, конфиденциальность и проверку подлинности. Безопасность передачи обеспечивается одним из следующих способов: безопасность транспорта, безопасность сообщений или `TransportWithMessageCredential`.  
  
 Общие сведения о безопасности сообщений WCF см. в разделе [Общие сведения о безопасности](../../../../docs/framework/wcf/feature-details/security-overview.md). Дополнительные сведения о двух других аспектах безопасности WCF см. в разделе [авторизация](../../../../docs/framework/wcf/feature-details/authorization-in-wcf.md) и [Аудит](../../../../docs/framework/wcf/feature-details/auditing-security-events.md).  
  
## <a name="transfer-security-scenarios"></a>Сценарии безопасности передачи  
 Распространенные сценарии, использующие безопасность при переносе WCF, включают следующее:  
  
- Безопасная передача с помощью Windows. Клиент и служба WCF развертываются в домене Windows (или в лесу Windows). Сообщения содержат личные данные, поэтому требуется взаимная проверка подлинности клиента и службы, целостность сообщений и конфиденциальность сообщений. Кроме того, требуется подтверждение проведения конкретной транзакции, например, получатель сообщения должен записать информацию о сигнатуры.  
  
- Безопасная передача с использованием `UserName` и HTTPS. Клиент и служба WCF должны быть разработаны для работы через Интернет. Подлинность учетных данных клиента проверяется по базе данных, содержащих пары "имя пользователя-пароль". Служба разворачивается по адресу HTTPS с использованием доверенного SSL-сертификата. Так как сообщения передаются по Интернету, необходима взаимная проверка подлинности клиента и службы, и во время передачи необходимо сохранение конфиденциальности и целостности сообщений.  
  
- Безопасная передача с помощью сертификатов. Клиент и служба WCF должны быть разработаны для работы через общедоступный Интернет. Как клиент, так и служба имеют сертификаты, которые можно использовать для обеспечения безопасности сообщений. Клиент и служба используют Интернет для взаимодействия друг с другом и для выполнения ценных транзакций, требующих целостности и конфиденциальности сообщений, а также взаимной проверки подлинности.  
  
## <a name="integrity-confidentiality-and-authentication"></a>Целостность, конфиденциальность и проверка подлинности  
 Эти функции (целостность, конфиденциальность и проверка подлинности) совместно называются безопасностью передачи. Безопасность передачи обеспечивает функции, позволяющие устранить угрозы для распределенных приложений. В приведенной ниже таблице кратко описаны три функции, составляющие безопасность передачи.  
  
|Функция|Описание|  
|--------------|-----------------|  
|Целостность|*Целостность* — это гарантия того, что данные заполнены и точны, особенно после того, как они проходят от одной точки к другой и, возможно, считаны множеством субъектов. Целостность, необходимая для предотвращения подделки данных, обычно обеспечивается цифровой подписью сообщения.|  
|Конфиденциальность|*Конфиденциальность* — это гарантия того, что сообщение не было прочитано кем-либо, кроме предполагаемого читателя. Например, при передаче по Интернету необходимо сохранить в секрете номер кредитной карты. Конфиденциальность часто обеспечивается путем шифрования данных с использованием схемы "открытый ключ/закрытый ключ".|  
|Проверка подлинности|*Проверка подлинности* — это проверка затребованного удостоверения. Например, при использовании банковского счета абсолютно необходимо, чтобы снятие средств могло быть выполнено только действительным владельцем счета. Проверка подлинности может обеспечиваться различными средствами. Одним из обычных способов является система пользователь/пароль. Вторым способом является использование сертификата X.509, предоставляемого третьей стороной.|  
  
## <a name="security-modes"></a>Режимы безопасности  
 В WCF предусмотрено несколько режимов обмена безопасностью, которые описаны в следующей таблице.  
  
|Режим|Описание|  
|----------|-----------------|  
|Нет|Безопасность на уровне транспорта или на уровне сообщений не обеспечивается. Ни одна из предопределенных привязок не использует этот режим по умолчанию, кроме [\<basicHttpBinding >](../../../../docs/framework/configure-apps/file-schema/wcf/basichttpbinding.md) или при использовании кода класса <xref:System.ServiceModel.BasicHttpBinding>.|  
|Transport|Для обеспечения целостности, конфиденциальности и взаимной проверки подлинности используется безопасный транспорт, такой как HTTPS.|  
|Message|Для обеспечения целостности, конфиденциальности и для взаимной проверки подлинности используется безопасность SOAP-сообщений. Защита SOAP-сообщений обеспечивается в соответствии со стандартами WS-Security.|  
|Смешанный режим|Целостность, конфиденциальность и проверка подлинности сервера обеспечиваются с помощью средств безопасности транспорта. Для проверки подлинности клиента используются средства безопасности сообщений (WS-Security и другие стандарты).<br /><br /> (В перечислении этому режиму соответствует значение `TransportWithMessageCredential`.)|  
|Оба варианта|Защита и проверка подлинности выполняется на обоих уровнях. Этот режим доступен только в элементе [\<netMsmqBinding >](../../../../docs/framework/configure-apps/file-schema/wcf/netmsmqbinding.md) .|  
  
## <a name="credentials-and-transfer-security"></a>Учетные данные и безопасность передачи  
 *Учетные* данные представляют собой сведения, которые представляют собой запрошенное удостоверение или возможности. При предоставлении учетных данных требуется предоставить как сами данные, так и доказательство обладания ими. WCF поддерживает различные типы учетных данных на уровнях безопасности транспорта и сообщений. Можно указать тип учетных данных для привязки WCF.  
  
 Во многих странах или регионах примером учетных данных могут служить водительские права. Водительские права содержат данные о личности и возможностях их обладателя. Они содержат доказательство владения в виде фотографии владельца. Водительские права выданы доверенной организацией, обычно государственным органом. Водительские права ламинированы и могут содержать голограмму, подтверждающую, что права не изменены или подделаны.  
  
 В качестве примера рассмотрим два типа учетных данных, поддерживаемых в WCF: имя пользователя и учетные данные сертификата (X. 509).  
  
 В учетных данных с именем пользователя имя пользователя представляет заявленную идентификацию, а пароль является доказательством прав обладания. Центром авторизации в данном случае является система, проверяющая имя пользователя и пароль.  
  
 В учетных данных с сертификатом имя субъекта, альтернативное имя субъекта или определенные поля сертификата могут использоваться для представления заявленной идентификации и/или возможностей. Обладание данными, приведенными в учетных данных, доказывается с помощью соответствующего закрытого ключа, использованного для создания сигнатуры.  
  
 Дополнительные сведения об обеспечении безопасности при переносе и указании учетных данных см. в разделе привязки, [поведение](../../../../docs/framework/wcf/feature-details/security-behaviors-in-wcf.md) [безопасности](../../../../docs/framework/wcf/feature-details/bindings-and-security.md) и безопасности.  
  
### <a name="transport-client-credential-types"></a>Типы учетных данных клиента с безопасностью транспорта  
 В следующей таблице приведены возможные значения, применимые при создании приложения, использующего безопасность транспорта. Эти значения можно использовать либо в коде, либо в параметрах привязки.  
  
|Параметр|Описание|  
|-------------|-----------------|  
|Нет|Указывает, что клиенту не требуется предоставлять учетные данные. Это означает, что клиент является анонимным.|  
|Basic|Задает обычную проверку подлинности. Дополнительные сведения см. в разделе RFC2617, "[http Authentication: обычная и дайджест-проверка подлинности](http://schemas.xmlsoap.org/ws/2004/10/discovery/ws-discovery.pdf)".|  
|Digest|Задает дайджест-проверку подлинности. Дополнительные сведения см. в разделе RFC2617, "[http Authentication: обычная и дайджест-проверка подлинности](http://schemas.xmlsoap.org/ws/2004/10/discovery/ws-discovery.pdf)".|  
|Ntlm|Задает проверку подлинности Windows с использованием согласования SSPI с домене Windows.<br /><br /> При согласовании SSPI выбирается либо протокол Kerberos, либо протокол NT LanMan (NTLM).|  
|Портал|Задает проверку подлинности Windows с использованием согласования SSPI с домене Windows. В качестве службы проверки подлинности SSPI выбирает либо протокол Kerberos, либо протокол NT LanMan (NTLM).<br /><br /> Сначала SSPI пытается использовать протокол Kerberos; если это не удается, используется NTLM.|  
|Сертификат|Выполняет проверку подлинности клиента с использованием сертификата, обычно X.509.|  
  
### <a name="message-client-credential-types"></a>Типы учетных данных клиента при использовании безопасности сообщений  
 В следующей таблице приведены возможные значения, применимые при создании приложения, использующего безопасность сообщений. Эти значения можно использовать либо в коде, либо в параметрах привязки.  
  
|Параметр|Описание|  
|-------------|-----------------|  
|Нет|Позволяет службе взаимодействовать с анонимными клиентами.|  
|Портал|Позволяет проводить обмен сообщениями SOAP, если выполнена проверка подлинности с помощью учетных данных Windows. Для выбора службы проверки подлинности (протокол Kerberos или протокол NTLM) используется механизм согласования SSPI.|  
|Имя пользователя|Позволяет службе запрашивать проверку подлинности клиента на основе учетных данных типа «имя пользователя». Обратите внимание, что в WCF не допускаются криптографические операции с именем пользователя, например создание подписи или шифрование данных. Таким образом, WCF обеспечивает защиту транспорта при использовании учетных данных имени пользователя.|  
|Сертификат|Позволяет службе требовать проверки подлинности клиента с помощью сертификата.|  
|CardSpace|Позволяет службе требовать проверку подлинности клиента с помощью CardSpace.|  
  
### <a name="programming-credentials"></a>Программирование учетных данных  
 Для каждого типа учетных данных клиента модель программирования WCF позволяет указать значения учетных данных и проверяющих учетных данных с помощью поведения службы и поведения канала.  
  
 Безопасность WCF имеет два типа учетных данных: поведение учетных данных службы и поведение учетных данных канала. Поведения учетных данных в WCF указывают фактические данные, а именно учетные данные, используемые для удовлетворения требований безопасности, представленных в привязках. В WCF клиентский класс — это компонент времени выполнения, который выполняет преобразование между вызовом операции и сообщениями. Все клиенты наследуют от класса <xref:System.ServiceModel.ClientBase%601>. Свойство <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A> базового класса позволяет задавать различные значения учетных данных клиента.  
  
 В WCF поведения службы — это атрибуты, применяемые к классу, реализующему контракт службы (интерфейс) для программного управления службой. Класс <xref:System.ServiceModel.Description.ServiceCredentials> позволяет указать сертификаты для учетных данных службы и параметры проверки клиента для различных типов учетных данных клиента.  
  
### <a name="negotiation-model-for-message-security"></a>Модель согласования для безопасности сообщений  
 Режим безопасности сообщений позволяет реализовать безопасность передачи таким образом, чтобы учетные данные службы задавались в клиенте по внештатному каналу. Например, если используется сертификат, хранящийся в хранилище сертификатов Windows, необходимо использовать такое средство, как оснастка консоли управления (MMC).  
  
 Режим безопасности сообщений также позволяет обеспечивать безопасность передачи таким образом, чтобы учетные данные службы передавались клиенту в процессе начального согласования. Для разрешения согласования задайте для свойства <xref:System.ServiceModel.MessageSecurityOverHttp.NegotiateServiceCredential%2A> значение `true`.  
  
## <a name="see-also"></a>См. также:

- [Общие сведения о создании конечных точек](../../../../docs/framework/wcf/endpoint-creation-overview.md)
- [Привязки, предоставляемые системой](../../../../docs/framework/wcf/system-provided-bindings.md)
- [Общие сведения о безопасности](../../../../docs/framework/wcf/feature-details/security-overview.md)
- [Модель безопасности для Windows Server App Fabric](https://docs.microsoft.com/previous-versions/appfabric/ee677202(v=azure.10))
