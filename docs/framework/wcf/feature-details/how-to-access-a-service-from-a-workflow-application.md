---
title: Как получить доступ к службе из приложения рабочего процесса
ms.date: 03/30/2017
ms.assetid: 925ef8ea-5550-4c9d-bb7b-209e20c280ad
ms.openlocfilehash: c524dc07106f039d9dc6c17ee6fb966321b6da24
ms.sourcegitcommit: c01c18755bb7b0f82c7232314ccf7955ea7834db
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/15/2020
ms.locfileid: "75964532"
---
# <a name="how-to-access-a-service-from-a-workflow-application"></a>Как получить доступ к службе из приложения рабочего процесса
В этом разделе описывается вызов службы рабочего процесса из консольного приложения рабочего процесса. Это зависит от завершения статьи [Создание службы рабочего процесса с помощью действий обмена сообщениями](../../../../docs/framework/wcf/feature-details/how-to-create-a-workflow-service-with-messaging-activities.md) . Хотя в этом разделе описывается вызов службы рабочего процесса из приложения рабочего процесса, одни и те же методы можно использовать для вызова любой службы Windows Communication Foundation (WCF) из приложения рабочего процесса.

### <a name="create-a-workflow-console-application-project"></a>Создание проекта консольного приложения рабочего процесса

1. Запустите Visual Studio 2012.

2. Загрузите проект Мивфсервице, созданный в разделе [как создать службу рабочего процесса с помощью действий обмена сообщениями](../../../../docs/framework/wcf/feature-details/how-to-create-a-workflow-service-with-messaging-activities.md) .

3. Щелкните правой кнопкой мыши решение **мивфсервице** в **Обозреватель решений** и выберите **добавить**, **Новый проект**. Выберите **Рабочий процесс** в окне **Установленные шаблоны** и **консольное приложение рабочего процесса** из списка типов проектов. Назовите проект MyWFClient и используйте расположение по умолчанию, как показано на следующем рисунке.

     ![Диалоговое окно «Добавление нового проекта»](./media/how-to-access-a-service-from-a-workflow-application/add-new-project-dialog.jpg)

     Нажмите кнопку **ОК** , чтобы закрыть **диалоговое окно Добавление нового проекта**.

4. После создания проекта в конструкторе откроется файл Workflow1.xaml. Перейдите на вкладку **область элементов** , чтобы открыть панель элементов, если она еще не открыта, и нажмите кнопку, чтобы открыть окно панели элементов.

5. Нажмите клавиши **Ctrl**+**F5** , чтобы создать и запустить службу. Как и раньше, будет запущен ASP.NET Development Server, а в обозревателе Internet Explorer откроется страница справки WCF. Запомните URI этой страницы, поскольку его будет необходимо использовать в следующем шаге.

     ![Internet Explorer, отображающий страницу справки WCF и URI](./media/how-to-access-a-service-from-a-workflow-application/ie-wcf-help-page-uri.jpg)

6. Щелкните правой кнопкой мыши проект **мивфклиент** в **Обозреватель решений** и выберите **добавить** > **ссылку на службу**. Нажмите кнопку **обнаружить** , чтобы найти в текущем решении все службы. Нажмите треугольник рядом с Service1.xamlx в списке «Службы». Нажмите треугольник рядом с Service1, чтобы открыть список контрактов, реализованных службой Service1. Разверните узел **Service1** в списке **служб** . Операция Echo отображается в списке **операций** , как показано на следующем рисунке.

     ![Диалоговое окно «Добавить ссылку на службу»](./media/how-to-access-a-service-from-a-workflow-application/add-service-reference.jpg)

     Не заключайте пространство имен по умолчанию и нажмите кнопку **ОК** , чтобы закрыть диалоговое окно **Добавление ссылки на службу** . Отобразится следующее диалоговое окно.

     ![Диалоговое окно уведомления Добавление ссылки на службу](./media/how-to-access-a-service-from-a-workflow-application/add-service-reference-dialog.jpg)

     Нажмите кнопку **ОК** , чтобы закрыть диалоговое окно. Затем, чтобы выполнить сборку решения, нажмите сочетание клавиш CTRL+SHIFT+B. Обратите внимание, что в панели элементов добавлен новый раздел с именем **мивфклиент. ServiceReference1. activitys**. Разверните этот раздел и обратите внимание на действие с именем Echo, которое было добавлено, как показано на следующем рисунке.

     ![Действие Echo на панели элементов](./media/how-to-access-a-service-from-a-workflow-application/echo-activity-toolbox.jpg)

7. Перетащите действие <xref:System.Activities.Statements.Sequence> в область конструктора. Он находится в разделе " **поток управления** " области элементов.

8. С помощью действия <xref:System.Activities.Statements.Sequence> в фокусе щелкните ссылку **переменные** и добавьте строковую переменную с именем `inString`. Присвойте переменной значение по умолчанию `"Hello, world"` а также строковую переменную с именем `outString`, как показано на следующей схеме.

     ![Добавление нестроковой переменной](./media/how-to-access-a-service-from-a-workflow-application/add-instring-variable.jpg)

9. Перетащите действие **echo** в <xref:System.Activities.Statements.Sequence>. В окне Свойства свяжите аргумент `inMsg` с переменной `inString` и аргументом `outMsg` с переменной `outString`, как показано на следующем рисунке. При этом операции будет передано значение переменной `inString`, а затем будет принято возвращаемое значение и помещено в переменную `outString`.

     ![Привязка аргументов к переменным](./media/how-to-access-a-service-from-a-workflow-application/bind-arguments-variables.jpg)

10. Перетащите действие **WriteLine** под действие **echo** , чтобы отобразить строку, возвращенную вызовом службы. Действие **WriteLine** находится в узле **примитивы** на панели элементов. Привяжите **текстовый** аргумент действия **WriteLine** к переменной `outString`, введя `outString` в текстовое поле действия **WriteLine** . После этого рабочий процесс должен выглядеть так, как показано на следующем рисунке.

     ![Полный рабочий процесс клиента](./media/how-to-access-a-service-from-a-workflow-application/complete-client-workflow.jpg)

11. Щелкните правой кнопкой мыши решение Мивфсервице и выберите пункт **задать запускаемые проекты...** . Выберите переключатель **Несколько запускаемых проектов** и нажмите кнопку **запустить** для каждого проекта в столбце **действие** , как показано на следующем рисунке.

     ![Параметры запускаемых проектов](./media/how-to-access-a-service-from-a-workflow-application/startup-project-options.jpg)

12. Используйте сочетание клавиш Ctrl+F5 для запуска службы и клиента. На ASP.NET Development Server размещается служба, Internet Explorer отображает страницу справки WCF, а приложение рабочего процесса клиента запускается в окне консоли и отображает строку, возвращенную службой ("Hello, World").

## <a name="see-also"></a>См. также:

- [Службы рабочих процессов](../../../../docs/framework/wcf/feature-details/workflow-services.md)
- [Практическое руководство. Создание службы рабочего процесса с помощью действий обмена сообщениями](../../../../docs/framework/wcf/feature-details/how-to-create-a-workflow-service-with-messaging-activities.md)
- [Использование службы WCF из рабочего процесса в веб-проекте](https://docs.microsoft.com/archive/blogs/endpoint/how-to-consume-a-wcf-service-from-a-wf4-workflow)
