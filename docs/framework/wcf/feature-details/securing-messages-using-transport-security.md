---
title: Защита сообщений с использованием средств обеспечения безопасности транспорта
ms.date: 03/30/2017
ms.assetid: 9029771a-097e-448a-a13a-55d2878330b8
ms.openlocfilehash: b0507590914e2e8cda7e5e599914a9e3d7b0acd0
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/22/2019
ms.locfileid: "69911706"
---
# <a name="securing-messages-using-transport-security"></a><span data-ttu-id="2f329-102">Защита сообщений с использованием средств обеспечения безопасности транспорта</span><span class="sxs-lookup"><span data-stu-id="2f329-102">Securing Messages Using Transport Security</span></span>
<span data-ttu-id="2f329-103">В этом разделе рассматривается механизм безопасности транспорта очереди сообщений MSMQ, который может быть использован для защиты сообщений, отправленных в очередь.</span><span class="sxs-lookup"><span data-stu-id="2f329-103">This section discusses Message Queuing (MSMQ) transport security that you can use to secure messages sent to a queue.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="2f329-104">Перед чтением этого раздела рекомендуется ознакомиться с [основными понятиями безопасности](../../../../docs/framework/wcf/feature-details/security-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="2f329-104">Before reading through this topic, it is recommended that you read [Security Concepts](../../../../docs/framework/wcf/feature-details/security-concepts.md).</span></span>  
  
 <span data-ttu-id="2f329-105">На следующем рисунке представлена концептуальная модель взаимодействия в очереди с помощью Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="2f329-105">The following illustration provides a conceptual model of queued communication using Windows Communication Foundation (WCF).</span></span> <span data-ttu-id="2f329-106">Для объяснения принципов безопасности транспорта используется следующая терминология и рисунки.</span><span class="sxs-lookup"><span data-stu-id="2f329-106">This illustration and terminology is used to explain transport security concepts.</span></span>  
  
 <span data-ttu-id="2f329-107">![Диаграмма приложений в очереди](../../../../docs/framework/wcf/feature-details/media/distributed-queue-figure.jpg "Схема распределенной очереди")</span><span class="sxs-lookup"><span data-stu-id="2f329-107">![Queued Application Diagram](../../../../docs/framework/wcf/feature-details/media/distributed-queue-figure.jpg "Distributed-Queue-Figure")</span></span>  
  
 <span data-ttu-id="2f329-108">При отправке сообщений в очереди с помощью <xref:System.ServiceModel.NetMsmqBinding>WCF и сообщение WCF прикрепляется как текст сообщения MSMQ.</span><span class="sxs-lookup"><span data-stu-id="2f329-108">When sending queued messages using WCF with <xref:System.ServiceModel.NetMsmqBinding>, the WCF message is attached as a body of the MSMQ message.</span></span> <span data-ttu-id="2f329-109">Механизм безопасности транспорта защищает целиком сообщение MSMQ (заголовок или свойства и тело сообщения MSMQ).</span><span class="sxs-lookup"><span data-stu-id="2f329-109">Transport security secures the entire MSMQ message (MSMQ message headers or properties and the message body).</span></span> <span data-ttu-id="2f329-110">Так как это текст сообщения MSMQ, использование защиты транспорта также защищает сообщение WCF.</span><span class="sxs-lookup"><span data-stu-id="2f329-110">Because it is the body of the MSMQ message, using transport security also secures the WCF message.</span></span>  
  
 <span data-ttu-id="2f329-111">Ключевое понятие в основе безопасности транспорта заключается в том, что клиент обязан удовлетворять требованиям безопасности, чтобы получить сообщение в целевую очередь.</span><span class="sxs-lookup"><span data-stu-id="2f329-111">The key concept behind transport security is that the client has to meet security requirements to get the message to the target queue.</span></span> <span data-ttu-id="2f329-112">В этом заключается отличие от безопасности сообщения, в котором сообщение защищается для приложения, которое получает сообщение.</span><span class="sxs-lookup"><span data-stu-id="2f329-112">This is unlike Message security, where the message is secured for the application that receives the message.</span></span>  
  
 <span data-ttu-id="2f329-113">Безопасность транспорта с использованием <xref:System.ServiceModel.NetMsmqBinding> и <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding>влияет на то, как защищаются сообщения MSMQ во время передачи между очередью передачи и целевой очередью, которые подразумеваются безопасными.</span><span class="sxs-lookup"><span data-stu-id="2f329-113">Transport security using <xref:System.ServiceModel.NetMsmqBinding> and <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding> impacts how MSMQ messages are secured in-transit between the transmission queue and the target queue where secured implies:</span></span>  
  
- <span data-ttu-id="2f329-114">Подписывание сообщения обеспечивает защиту от подделки.</span><span class="sxs-lookup"><span data-stu-id="2f329-114">Signing the message to ensure it is not tampered with.</span></span>  
  
- <span data-ttu-id="2f329-115">Шифрование сообщения обеспечивает защиту от просмотра или подделки.</span><span class="sxs-lookup"><span data-stu-id="2f329-115">Encrypting the message to ensure that it cannot be seen or tampered with.</span></span> <span data-ttu-id="2f329-116">Это рекомендуется, но не является обязательным.</span><span class="sxs-lookup"><span data-stu-id="2f329-116">This is recommended but optional.</span></span>  
  
- <span data-ttu-id="2f329-117">Диспетчер целевой очереди определяет отправителя сообщения для предотвращения подделки.</span><span class="sxs-lookup"><span data-stu-id="2f329-117">The target queue manager that identifies the sender of the message for non-repudiation.</span></span>  
  
 <span data-ttu-id="2f329-118">В MSMQ, независимо от проверки подлинности, целевая очередь содержит список управления доступом (ACL) для проверки, имеет ли клиент разрешение посылать сообщение в целевую очередь.</span><span class="sxs-lookup"><span data-stu-id="2f329-118">In MSMQ, independent of authentication, the target queue has an access control list (ACL) to check whether the client has permission to send the message to the target queue.</span></span> <span data-ttu-id="2f329-119">У принимающего приложения также проверяется право принимать сообщения от целевой очереди.</span><span class="sxs-lookup"><span data-stu-id="2f329-119">The receiving application is also checked for permission to receive the message from the target queue.</span></span>  
  
## <a name="wcf-msmq-transport-security-properties"></a><span data-ttu-id="2f329-120">Свойства безопасности транспорта WCF MSMQ.</span><span class="sxs-lookup"><span data-stu-id="2f329-120">WCF MSMQ Transport Security Properties</span></span>  
 <span data-ttu-id="2f329-121">MSMQ использует безопасность Windows для проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="2f329-121">MSMQ uses Windows security for authentication.</span></span> <span data-ttu-id="2f329-122">Используются идентификатор безопасности Windows (SID) для идентификации клиента и служба каталогов Active Directory в качестве центра сертификации при проверке подлинности клиента.</span><span class="sxs-lookup"><span data-stu-id="2f329-122">It uses the Windows security identifier (SID) to identify the client and uses Active Directory directory service as the certificate authority when authenticating the client.</span></span> <span data-ttu-id="2f329-123">Требуется установить MSMQ с интеграцией Active Directory.</span><span class="sxs-lookup"><span data-stu-id="2f329-123">This requires MSMQ to be installed with Active Directory integration.</span></span> <span data-ttu-id="2f329-124">Поскольку для идентификации клиента используется идентификатор безопасности домена Windows SID, этот вариант обеспечения безопасности имеет смысл, если клиент и служба являются частью одного домена Windows.</span><span class="sxs-lookup"><span data-stu-id="2f329-124">Because the Windows domain SID is used to identify the client, this security option is only meaningful when both the client and service are part of the same Windows domain.</span></span>  
  
 <span data-ttu-id="2f329-125">MSMQ также предоставляет возможность прикрепить сертификат к сообщению, даже если он не зарегистрирован в Active Directory.</span><span class="sxs-lookup"><span data-stu-id="2f329-125">MSMQ also provides the ability to attach a certificate with the message that is not registered with Active Directory.</span></span> <span data-ttu-id="2f329-126">В этом случае он обеспечивает проверку подписи сообщения с использованием прикрепленного сертификата.</span><span class="sxs-lookup"><span data-stu-id="2f329-126">In this case, it ensures that the message was signed using the attached certificate.</span></span>  
  
 <span data-ttu-id="2f329-127">WCF предоставляет как часть безопасности транспорта MSMQ, так и основные сведения для обеспечения безопасности транспорта.</span><span class="sxs-lookup"><span data-stu-id="2f329-127">WCF provides both these options as part of MSMQ transport security and they are the key pivot for transport security.</span></span>  
  
 <span data-ttu-id="2f329-128">По умолчанию безопасность транспорта включена.</span><span class="sxs-lookup"><span data-stu-id="2f329-128">By default, transport security is turned on.</span></span>  
  
 <span data-ttu-id="2f329-129">С учетом этих основ, следующие разделы дают представление о свойствах безопасности транспорта совместно с <xref:System.ServiceModel.NetMsmqBinding> и <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding>.</span><span class="sxs-lookup"><span data-stu-id="2f329-129">Given these basics, the following sections detail transport security properties bundled with <xref:System.ServiceModel.NetMsmqBinding> and <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding>.</span></span>  
  
#### <a name="msmq-authentication-mode"></a><span data-ttu-id="2f329-130">Режим проверки подлинности MSMQ</span><span class="sxs-lookup"><span data-stu-id="2f329-130">MSMQ Authentication Mode</span></span>  
 <span data-ttu-id="2f329-131">Режим <xref:System.ServiceModel.MsmqTransportSecurity.MsmqAuthenticationMode%2A> определяет, следует ли использовать безопасность домена Windows или внешнюю безопасность на основе сертификатов для защиты сообщения.</span><span class="sxs-lookup"><span data-stu-id="2f329-131">The <xref:System.ServiceModel.MsmqTransportSecurity.MsmqAuthenticationMode%2A> dictates whether to use the Windows domain security or an external certificate-based security to secure the message.</span></span> <span data-ttu-id="2f329-132">В обоих режимах проверки подлинности канал транспорта, помещенный `CertificateValidationMode` в очередь WCF, использует указанный в конфигурации службы.</span><span class="sxs-lookup"><span data-stu-id="2f329-132">In both authentication modes, the WCF queued transport channel uses the `CertificateValidationMode` specified in the service configuration.</span></span> <span data-ttu-id="2f329-133">Режим проверки сертификата задает механизм, используемый для проверки допустимости сертификата.</span><span class="sxs-lookup"><span data-stu-id="2f329-133">The certificate validation mode specifies the mechanism used to check the validity of the certificate.</span></span>  
  
 <span data-ttu-id="2f329-134">Если безопасность транспорта включена, значение по умолчанию - <xref:System.ServiceModel.MsmqAuthenticationMode.WindowsDomain>.</span><span class="sxs-lookup"><span data-stu-id="2f329-134">When transport security is turned on, the default setting is <xref:System.ServiceModel.MsmqAuthenticationMode.WindowsDomain>.</span></span>  
  
#### <a name="windows-domain-authentication-mode"></a><span data-ttu-id="2f329-135">Режим проверки подлинности домена Windows</span><span class="sxs-lookup"><span data-stu-id="2f329-135">Windows Domain Authentication Mode</span></span>  
 <span data-ttu-id="2f329-136">Вариант с использованием безопасности Windows требует интеграции с Active Directory.</span><span class="sxs-lookup"><span data-stu-id="2f329-136">The choice of using Windows security requires Active Directory integration.</span></span> <span data-ttu-id="2f329-137">Режим безопасности, используемый по умолчанию, - <xref:System.ServiceModel.MsmqAuthenticationMode.WindowsDomain>.</span><span class="sxs-lookup"><span data-stu-id="2f329-137"><xref:System.ServiceModel.MsmqAuthenticationMode.WindowsDomain> is the default transport security mode.</span></span> <span data-ttu-id="2f329-138">Если этот параметр задан, канал WCF присоединяет идентификатор безопасности Windows к сообщению MSMQ и использует его внутренний сертификат, полученный от Active Directory.</span><span class="sxs-lookup"><span data-stu-id="2f329-138">When this is set, the WCF channel attaches the Windows SID to the MSMQ message and uses its internal certificate obtained from Active Directory.</span></span> <span data-ttu-id="2f329-139">MSMQ использует этот внутренний сертификат для защиты сообщения.</span><span class="sxs-lookup"><span data-stu-id="2f329-139">MSMQ uses this internal certificate to secure the message.</span></span> <span data-ttu-id="2f329-140">Диспетчер принимающей очереди использует Active Directory для поиска и нахождения соответствующего сертификата для проверки подлинности клиента, а также проверки соответствия SID клиенту.</span><span class="sxs-lookup"><span data-stu-id="2f329-140">The receiving queue manager uses Active Directory to search and find a matching certificate to authenticate the client and checks that the SID also matches that of the client.</span></span> <span data-ttu-id="2f329-141">Если сертификат прикреплен к сообщению, выполняется этап проверки подлинности, даже если целевая очередь не отмечена как требующая проверки подлинности. В режиме проверки подлинности `WindowsDomain` происходит внутреннее создание сертификата, в режиме проверки подлинности `Certificate` происходит внешнее создание сертификата.</span><span class="sxs-lookup"><span data-stu-id="2f329-141">This authentication step is executed if a certificate, either internally generated in the case of `WindowsDomain` authentication mode or externally generated in the case of `Certificate` authentication mode, is attached to the message even if the target queue is not marked as requiring authentication.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="2f329-142">При создании очереди можно указать, что очередь является очередью с проверкой подлинности и требует проверки подлинности клиента, посылающего сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="2f329-142">When creating a queue, you can mark the queue as an authenticated queue to indicate that the queue requires authentication of the client sending messages to the queue.</span></span> <span data-ttu-id="2f329-143">Это запрещает прием очередью сообщений, не прошедших проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="2f329-143">This ensures that no unauthenticated messages are accepted in the queue.</span></span>  
  
 <span data-ttu-id="2f329-144">Прикрепленный к сообщению идентификатор SID также используется для проверки списка ACL целевой очереди, чтобы убедиться в полномочиях клиента отправлять сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="2f329-144">The SID attached with the message is also used to check against the target queue's ACL to ensure that the client has the authority to send messages to the queue.</span></span>  
  
#### <a name="certificate-authentication-mode"></a><span data-ttu-id="2f329-145">Режим проверки подлинности сертификата</span><span class="sxs-lookup"><span data-stu-id="2f329-145">Certificate Authentication Mode</span></span>  
 <span data-ttu-id="2f329-146">При выборе режима проверки подлинности сертификата не требуется интеграция с Active Directory.</span><span class="sxs-lookup"><span data-stu-id="2f329-146">The choice of using certificate authentication mode does not require Active Directory integration.</span></span> <span data-ttu-id="2f329-147">В некоторых случаях, например, когда MSMQ установлена в режиме рабочей группы (без интеграции с Active Directory) или при использовании протокола надежного обмена сообщениями SOAP (SRMP) для передачи сообщений в очередь, работает только <xref:System.ServiceModel.MsmqAuthenticationMode.Certificate>.</span><span class="sxs-lookup"><span data-stu-id="2f329-147">In fact, in some cases, such as when MSMQ is installed in workgroup mode (without Active Directory integration) or when using the SOAP Reliable Messaging Protocol (SRMP) transfer protocol to send messages to the queue, only <xref:System.ServiceModel.MsmqAuthenticationMode.Certificate> works.</span></span>  
  
 <span data-ttu-id="2f329-148">При отправке сообщения WCF с <xref:System.ServiceModel.MsmqAuthenticationMode.Certificate>помощью канал WCF не присоединяет идентификатор безопасности Windows к сообщению MSMQ.</span><span class="sxs-lookup"><span data-stu-id="2f329-148">When sending a WCF message with <xref:System.ServiceModel.MsmqAuthenticationMode.Certificate>, the WCF channel does not attach a Windows SID to the MSMQ message.</span></span> <span data-ttu-id="2f329-149">Таким образом, список ACL целевой очереди должен предоставить пользователю `Anonymous` доступ для передачи в очередь.</span><span class="sxs-lookup"><span data-stu-id="2f329-149">As such, the target queue ACL must allow for `Anonymous` user access to send to the queue.</span></span> <span data-ttu-id="2f329-150">Диспетчер принимающей очереди проверяет, было ли подписано сообщение MSMQ сертификатом, но не проверяет его подлинность.</span><span class="sxs-lookup"><span data-stu-id="2f329-150">The receiving queue manager checks whether the MSMQ message was signed with the certificate but does not perform any authentication.</span></span>  
  
 <span data-ttu-id="2f329-151">Сертификат с его утверждениями и идентификационными данными заполняется в <xref:System.ServiceModel.ServiceSecurityContext> канале транспорта, помещенном в очередь WCF.</span><span class="sxs-lookup"><span data-stu-id="2f329-151">The certificate with its claims and identity information is populated in the <xref:System.ServiceModel.ServiceSecurityContext> by the WCF queued transport channel.</span></span> <span data-ttu-id="2f329-152">Служба может использовать эту информацию для выполнения собственной проверки подлинности отправителя.</span><span class="sxs-lookup"><span data-stu-id="2f329-152">The service can use this information to perform its own authentication of the sender.</span></span>  
  
### <a name="msmq-protection-level"></a><span data-ttu-id="2f329-153">Уровень защиты MSMQ</span><span class="sxs-lookup"><span data-stu-id="2f329-153">MSMQ Protection Level</span></span>  
 <span data-ttu-id="2f329-154">Уровень защиты определяет, как защищать сообщение MSMQ для предотвращения его подделки.</span><span class="sxs-lookup"><span data-stu-id="2f329-154">The protection level dictates how to protect the MSMQ message to ensure that it is not tampered with.</span></span> <span data-ttu-id="2f329-155">Это задается в свойстве <xref:System.ServiceModel.MsmqTransportSecurity.MsmqProtectionLevel%2A>.</span><span class="sxs-lookup"><span data-stu-id="2f329-155">It is specified in the <xref:System.ServiceModel.MsmqTransportSecurity.MsmqProtectionLevel%2A> property.</span></span> <span data-ttu-id="2f329-156">Значение по умолчанию — <xref:System.Net.Security.ProtectionLevel.Sign>.</span><span class="sxs-lookup"><span data-stu-id="2f329-156">The default value is <xref:System.Net.Security.ProtectionLevel.Sign>.</span></span>  
  
#### <a name="sign-protection-level"></a><span data-ttu-id="2f329-157">Уровень защиты "Подписать"</span><span class="sxs-lookup"><span data-stu-id="2f329-157">Sign Protection Level</span></span>  
 <span data-ttu-id="2f329-158">Сообщение MSMQ подписывается с использованием созданного внутреннего сертификата, если используется режим проверки подлинности `WindowsDomain`, или с использованием внешнего созданного сертификата, если используется режим проверки подлинности `Certificate`.</span><span class="sxs-lookup"><span data-stu-id="2f329-158">The MSMQ message is signed using the internally generated certificate when using `WindowsDomain` authentication mode or an externally generated certificate when using `Certificate` authentication mode.</span></span>  
  
#### <a name="sign-and-encrypt-protection-level"></a><span data-ttu-id="2f329-159">Уровень защиты "Подписать и зашифровать"</span><span class="sxs-lookup"><span data-stu-id="2f329-159">Sign and Encrypt Protection Level</span></span>  
 <span data-ttu-id="2f329-160">Сообщение MSMQ подписывается с использованием созданного внутреннего сертификата, если используется режим проверки подлинности `WindowsDomain`, или с использованием внешнего созданного сертификата, если используется режим проверки подлинности `Certificate`.</span><span class="sxs-lookup"><span data-stu-id="2f329-160">The MSMQ message is signed using the internally generated certificate when using `WindowsDomain` authentication mode or externally generated certificate when using `Certificate` authentication mode.</span></span>  
  
 <span data-ttu-id="2f329-161">Кроме подписывания сообщения, сообщение MSMQ зашифровывается с использованием открытого ключа сертификата, получаемого из Active Directory, который принадлежит диспетчеру принимающей очереди, на котором размещена целевая очередь.</span><span class="sxs-lookup"><span data-stu-id="2f329-161">In addition to signing the message, the MSMQ message is encrypted using the public key of the certificate obtained from Active Directory that belongs to the receiving queue manager that hosts the target queue.</span></span> <span data-ttu-id="2f329-162">Диспетчер передающей очереди гарантирует, что сообщение MSMQ является зашифрованным при передаче.</span><span class="sxs-lookup"><span data-stu-id="2f329-162">The sending queue manager ensures that the MSMQ message is encrypted in transit.</span></span> <span data-ttu-id="2f329-163">Диспетчер принимающей очереди расшифровывает сообщение MSMQ с использованием закрытого ключа своего внутреннего сертификата и сохраняет сообщение в очереди открытым текстом (если прошел проверку подлинности и авторизацию).</span><span class="sxs-lookup"><span data-stu-id="2f329-163">The receiving queue manager decrypts the MSMQ message using the private key of its internal certificate and stores the message in the queue (if authenticated and authorized) in clear text.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="2f329-164">Чтобы зашифровать сообщение, требуется доступ к Active Directory (свойству `UseActiveDirectory` класса <xref:System.ServiceModel.NetMsmqBinding> должно быть присвоено логическое значение `true`), и может использоваться как с <xref:System.ServiceModel.MsmqAuthenticationMode.Certificate>, так и <xref:System.ServiceModel.MsmqAuthenticationMode.WindowsDomain>.</span><span class="sxs-lookup"><span data-stu-id="2f329-164">To encrypt the message, Active Directory access is required (`UseActiveDirectory` property of <xref:System.ServiceModel.NetMsmqBinding> must be set to `true`) and can be used with both <xref:System.ServiceModel.MsmqAuthenticationMode.Certificate> and <xref:System.ServiceModel.MsmqAuthenticationMode.WindowsDomain>.</span></span>  
  
#### <a name="none-protection-level"></a><span data-ttu-id="2f329-165">Уровень защиты "Отсутствует"</span><span class="sxs-lookup"><span data-stu-id="2f329-165">None Protection Level</span></span>  
 <span data-ttu-id="2f329-166">Это используется, когда свойству <xref:System.ServiceModel.MsmqTransportSecurity.MsmqProtectionLevel%2A> присвоено <xref:System.Net.Security.ProtectionLevel.None>.</span><span class="sxs-lookup"><span data-stu-id="2f329-166">This is implied when <xref:System.ServiceModel.MsmqTransportSecurity.MsmqProtectionLevel%2A> is set to <xref:System.Net.Security.ProtectionLevel.None>.</span></span> <span data-ttu-id="2f329-167">Это не является допустимым значением для любых других режимов проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="2f329-167">This cannot be a valid value for any other authentication modes.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="2f329-168">Если сообщение MSMQ подписано, MSMQ проверяет, подписано ли сообщение прикрепленным сертификатом (внутренним или внешним) независимо от состояния очереди (то есть, является очередь очередью с проверкой подлинности или нет).</span><span class="sxs-lookup"><span data-stu-id="2f329-168">If the MSMQ message is signed, MSMQ checks whether the message is signed with the attached certificate (internal or external) independent of the state of the queue, that is, authenticated queue or not.</span></span>  
  
### <a name="msmq-encryption-algorithm"></a><span data-ttu-id="2f329-169">Алгоритм шифрования MSMQ</span><span class="sxs-lookup"><span data-stu-id="2f329-169">MSMQ Encryption Algorithm</span></span>  
 <span data-ttu-id="2f329-170">Алгоритм шифрования задает алгоритм, используемый в сети для шифрования сообщения MSMQ.</span><span class="sxs-lookup"><span data-stu-id="2f329-170">The encryption algorithm specifies the algorithm to use to encrypt the MSMQ message on the wire.</span></span> <span data-ttu-id="2f329-171">Это свойство используется только в случае, если для свойства <xref:System.ServiceModel.MsmqTransportSecurity.MsmqProtectionLevel%2A> установлено значение <xref:System.Net.Security.ProtectionLevel.EncryptAndSign>.</span><span class="sxs-lookup"><span data-stu-id="2f329-171">This property is used only if <xref:System.ServiceModel.MsmqTransportSecurity.MsmqProtectionLevel%2A> is set to <xref:System.Net.Security.ProtectionLevel.EncryptAndSign>.</span></span>  
  
 <span data-ttu-id="2f329-172">Поддерживаемые алгоритмы: `RC4Stream` и `AES`. Значение по умолчанию - `RC4Stream`.</span><span class="sxs-lookup"><span data-stu-id="2f329-172">The supported algorithms are `RC4Stream` and `AES` and the default is `RC4Stream`.</span></span>  
  
 <span data-ttu-id="2f329-173">Алгоритм `AES` можно использовать, только если отправитель установил MSMQ 4.0.</span><span class="sxs-lookup"><span data-stu-id="2f329-173">You can use the `AES` algorithm only if the sender has MSMQ 4.0 installed.</span></span> <span data-ttu-id="2f329-174">Кроме того, целевая очередь также должна быть размещена на MSMQ 4.0.</span><span class="sxs-lookup"><span data-stu-id="2f329-174">In addition, the target queue must also be hosted on MSMQ 4.0.</span></span>  
  
### <a name="msmq-hash-algorithm"></a><span data-ttu-id="2f329-175">Алгоритм хэширования MSMQ</span><span class="sxs-lookup"><span data-stu-id="2f329-175">MSMQ Hash Algorithm</span></span>  
 <span data-ttu-id="2f329-176">Алгоритм хэширования задает алгоритм, который используется для создания цифровой подписи сообщения MSMQ.</span><span class="sxs-lookup"><span data-stu-id="2f329-176">The hash algorithm specifies the algorithm used to create a digital signature of the MSMQ message.</span></span> <span data-ttu-id="2f329-177">Диспетчер принимающей очереди использует тот же алгоритм для проверки подлинности сообщения MSMQ.</span><span class="sxs-lookup"><span data-stu-id="2f329-177">The receiving queue manager uses this same algorithm to authenticate the MSMQ message.</span></span> <span data-ttu-id="2f329-178">Это свойство используется, только если для свойства <xref:System.ServiceModel.MsmqTransportSecurity.MsmqProtectionLevel%2A> установлено значение <xref:System.Net.Security.ProtectionLevel.Sign> или <xref:System.Net.Security.ProtectionLevel.EncryptAndSign>.</span><span class="sxs-lookup"><span data-stu-id="2f329-178">This property is used only if <xref:System.ServiceModel.MsmqTransportSecurity.MsmqProtectionLevel%2A> is set to <xref:System.Net.Security.ProtectionLevel.Sign> or <xref:System.Net.Security.ProtectionLevel.EncryptAndSign>.</span></span>  
  
 <span data-ttu-id="2f329-179">Поддерживаются алгоритмы: `MD5`, `SHA1`, `SHA256` и `SHA512`.</span><span class="sxs-lookup"><span data-stu-id="2f329-179">The supported algorithms are `MD5`, `SHA1`, `SHA256`, and `SHA512`.</span></span> <span data-ttu-id="2f329-180">Значение по умолчанию — `SHA1`.</span><span class="sxs-lookup"><span data-stu-id="2f329-180">The default is `SHA1`.</span></span>

 <span data-ttu-id="2f329-181">Из-за проблем с MD5/SHA1 Корпорация Майкрософт рекомендует использовать SHA256 или более высокий уровень.</span><span class="sxs-lookup"><span data-stu-id="2f329-181">Due to collision problems with MD5/SHA1, Microsoft recommends SHA256 or better.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="2f329-182">См. также</span><span class="sxs-lookup"><span data-stu-id="2f329-182">See also</span></span>

- [<span data-ttu-id="2f329-183">Общие сведения об очередях</span><span class="sxs-lookup"><span data-stu-id="2f329-183">Queues Overview</span></span>](queues-overview.md)
- [<span data-ttu-id="2f329-184">Основные понятия безопасности</span><span class="sxs-lookup"><span data-stu-id="2f329-184">Security Concepts</span></span>](../../../../docs/framework/wcf/feature-details/security-concepts.md)
- [<span data-ttu-id="2f329-185">Защита служб и клиентов</span><span class="sxs-lookup"><span data-stu-id="2f329-185">Securing Services and Clients</span></span>](../../../../docs/framework/wcf/feature-details/securing-services-and-clients.md)
