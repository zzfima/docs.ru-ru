---
title: Расширенная политика защиты
ms.date: 03/30/2017
ms.assetid: e2616a10-317e-4c34-8023-0c015a80a82f
ms.openlocfilehash: 1cb6d44e8f6ee8f54f776453e5a1783ab0cfa4f0
ms.sourcegitcommit: 5fb5b6520b06d7f5e6131ec2ad854da302a28f2e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/03/2019
ms.locfileid: "74716425"
---
# <a name="extended-protection-policy"></a>Расширенная политика защиты
Расширенная защита - это инициатива, направленная на отражение атак типа «злоумышленник в середине» (MITM). Атака MITM - это угроза безопасности, при которой злоумышленник перехватывает учетные данные клиента и переправляет их на сервер.  
  
## <a name="demonstrates"></a>Демонстрации  
 Расширенная защита  
  
## <a name="discussion"></a>Обсуждение  
 Если приложение проходит проверку подлинности с использованием протокола Kerberos, дайджест-проверку подлинности или проверку NTLM с использованием HTTPS, то сначала устанавливается канал безопасности транспортного уровня (TLS), а проверка подлинности выполняется по этому защищенному каналу. При этом отсутствует привязка между сеансовым ключом, создаваемым протоколом SSL, и сеансовым ключом, создаваемым в ходе проверки подлинности. Любой злоумышленник может внедриться между клиентом и сервером и начать пересылать запросы от клиента, даже если сам по себе транспортный канал защищен, поскольку сервер не имеет возможности проверить, был ли установлен защищенный канал клиентом или злоумышленником. Решением в данном сценарии является привязка внешнего канала с защитой TLS ко внутреннему каналу с проверкой подлинности клиента, чтобы сервер мог обнаружить вторжение злоумышленника.  
  
> [!NOTE]
> Данный образец работает только при размещении на IIS и не поддерживает Cassini - сервер разработчиков Visual Studio, поскольку Cassini не поддерживает протокол HTTPS.  
  
> [!NOTE]
> Эта функция доступна в настоящее время только для Windows 7. Следующие шаги применимы только для Windows 7.  
  
#### <a name="to-set-up-build-and-run-the-sample"></a>Настройка, сборка и выполнение образца  
  
1. Установите службы IIS с **панели управления**, компонента **Установка и удаление программ**, **компоненты Windows**.  
  
2. Установите **проверку подлинности Windows** в **компонентах Windows**, **службы IIS**, **службах**Интернета, **безопасности**и **проверки подлинности Windows**.  
  
3. Установите **Windows Communication Foundation активацию HTTP** в **компонентах Windows**, **Microsoft .NET Framework 3.5.1**и **Windows Communication Foundation активации HTTP**.  
  
4. Для работы этого образца клиенту необходимо установить защищенный канал с сервером, для чего требуется наличие сертификата сервера, который может устанавливаться из диспетчера служб IIS.  
  
    1. Откройте диспетчер IIS. Откройте **Сертификаты сервера**, которые отображаются на вкладке **представление функций** при выборе корневого узла (имя компьютера).  
  
    2. Для тестирования этого образца создайте самозаверяющий сертификат. Чтобы не выводить в Internet Explorer запрос об отсутствии защиты сертификата, можно установить его в хранилище «Доверенные корневые центры сертификации».  
  
5. Откройте панель **действия** для веб-сайта по умолчанию. Щелкните **изменить сайт**, **привязки**. Добавьте HTTPS в качестве типа, если пока этот протокол отсутствует, с номером порта 443. Назначьте SSL-сертификат, созданный на предыдущем шаге.  
  
6. Постройте службу. При этом в службах IIS будет создан виртуальный каталог, куда будут скопированы DLL-файлы, SVC-файлы и файлы конфигурации, необходимые для размещения службы в веб.  
  
7. Откройте диспетчер IIS. Щелкните правой кнопкой мыши виртуальный каталог (**екстендедпротектион**), созданный на предыдущем шаге. Выберите **преобразовать в приложение**.  
  
8. Откройте модуль **проверки подлинности** в диспетчере IIS для этого виртуального каталога и включите **проверку подлинности Windows**.  
  
9. Откройте **Дополнительные параметры** в разделе **Проверка подлинности Windows** для этого виртуального каталога и задайте для него значение **обязательно**.  
  
10. Проверить службу можно, введя соответствующий HTTPS URL в окне браузера (полное доменное имя). Чтобы получить доступ к этому URL-адресу с удаленного компьютера, убедитесь, что в брандмауэре открыты все входящие подключения HTTP и HTTPS.  
  
11. Откройте клиентский файл конфигурации и введите полное имя домена в атрибуте адреса клиента или конечной точки вместо `<<full_machine_name>>`.  
  
12. Запустите клиент. Клиент обращается к службе, которая устанавливает безопасный канал и использует расширенную защиту.  
  
> [!IMPORTANT]
> Образцы уже могут быть установлены на компьютере. Перед продолжением проверьте следующий каталог (по умолчанию).  
>   
> `<InstallDrive>:\WF_WCF_Samples`  
>   
> Если этот каталог не существует, перейдите к [примерам Windows Communication Foundation (WCF) и Windows Workflow Foundation (WF) для .NET Framework 4](https://www.microsoft.com/download/details.aspx?id=21459) , чтобы скачать все Windows Communication Foundation (WCF) и [!INCLUDE[wf1](../../../../includes/wf1-md.md)] Samples. Этот образец расположен в следующем каталоге.  
>   
> `<InstallDrive>:\WF_WCF_Samples\WCF\Basic\Services\Security\ExtendedProtection`
