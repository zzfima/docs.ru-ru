---
title: Процедура однократной настройки образцов Windows Communication Foundation
ms.date: 03/30/2017
ms.assetid: a5848ffd-3eb5-432d-812e-bd948ccb6bca
ms.openlocfilehash: 3c3c5934cbbc7dd68f03d888aa0594f9ff61c225
ms.sourcegitcommit: a885cc8c3e444ca6471348893d5373c6e9e49a47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/07/2018
ms.locfileid: "44063859"
---
# <a name="one-time-setup-procedure-for-the-windows-communication-foundation-samples"></a>Процедура однократной настройки образцов Windows Communication Foundation
Большинство примеров Windows Communication Foundation (WCF) размещаются в Internet Information Services (IIS) и выполняются из общего виртуального каталога. Эта процедура однократной настройки создает папку на диске; Он также добавляет виртуальный каталог IIS с именем **ServiceModelSamples**.  
  
 **ServiceModelSamples** виртуальный каталог используется для построения и выполнения всех образцов, которые используют службу, размещенную в IIS. Это единственный виртуальный каталог, необходимый для выполнения примеров. При построении образца будет заменена любая служба, развернутая ранее в этом виртуальном каталоге. Развернут и доступен в данном виртуальном каталоге будет только последний построенный образец.  
  
> [!NOTE]
>  Необходимо выполнить все команды от имени учетной записи локального администратора. При использовании Windows 7, [!INCLUDE[windowsver](../../../../includes/windowsver-md.md)] или Windows Server 2008 R2 необходимо запустить командную строку с более высоким уровнем привилегий. Чтобы сделать это, щелкните правой кнопкой мыши значок командной строки и нажмите кнопку **Запуск от имени администратора**. Все команды в данном разделе должны выполняться в командной строке с соответствующим образом заданными параметрами пути.  Проще всего добиться этого, используя командную строку Visual Studio. Чтобы открыть этот запрос, нажмите кнопку **запустить**выберите **все программы**, прокрутите вниз до раздела **Visual Studio 2010**выберите **средств Visual Studio**, Щелкните правой кнопкой мыши **Командная строка Visual Studio (2010)**, а затем нажмите кнопку **Запуск от имени администратора**. Если установлен один из выпусков Visual Studio Express, эта командная строка недоступна. В этом случае добавьте в системный путь строку «C:\Windows\Microsoft.Net\Framework\v4.0».  
  
### <a name="one-time-setup-procedure-for-wcf-samples"></a>Однократно настраиваемая процедура для образцов WCF  
  
1.  Убедитесь, что [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] установлена. Дополнительные сведения о настройке [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)], см. в разделе [инструкции по размещению сведения службы IIS](../../../../docs/framework/wcf/samples/internet-information-service-hosting-instructions.md).  
  
2.  Убедитесь, что установлена платформа [!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)]. Найдите для версии 4.0 (или более поздней версии): **\Windows\Microsoft.NET\Framework**  
  
3.  Если [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] не установлен, и операционная система не Windows Server 2008 SP2 или более поздней версии, установите [пакет исправлений 251798](https://go.microsoft.com/fwlink/?LinkId=184693).  
  
4.  Выполните следующие команды. Дополнительные сведения о почему необходимо запустить следующие команды, см. в разделе [сбоя размещенной службы IIS](https://msdn.microsoft.com/library/ee5499fc-1b10-4cda-a9b1-13dba70f05f8).  
  
    > [!WARNING]
    >  Если IIS был переустановлен, необходимо вновь выполнить следующие команды.  
  
    ```  
    "%WINDIR%\Microsoft.Net\Framework\v4.0.30319\aspnet_regiis" –i –enable  
    "%WINDIR%\Microsoft.Net\Framework\v4.0.30319\ServiceModelReg.exe" -r  
    ```  
  
    > [!WARNING]
    >  Выполнив команду `aspnet_regiis –i –enable` сделает пул приложений по умолчанию выполняться с использованием [!INCLUDE[netfx40_short](../../../../includes/netfx40-short-md.md)], что может привести к проблем с совместимостью для других приложений на одном компьютере.  
  
5.  Выполните [инструкции брандмауэра](../../../../docs/framework/wcf/samples/firewall-instructions.md) включить порты, используемые в образцах.  
  
6.  Проверьте следующий каталог по умолчанию: \<Диск_установки >:**\WF_WCF_Samples**. Если образцы были предварительно установлены, этот каталог будет выбран по умолчанию.  
  
7.  Если образцы не установлены, установите их из загрузочного каталога для [Visual C#](https://go.microsoft.com/fwlink/?LinkId=190939) или [Visual Basic](https://go.microsoft.com/fwlink/?LinkID=193373).  
  
8.  После установки образцов перейдите на страницу: \<Диск_установки >:**\WF_WCF_Samples\WCF\Setup\\**  
  
9. Запустите **Setupvroot.bat** пакетный файл. Выполняются следующие действия.  
  
    -   В службах IIS создается виртуальный каталог с именем ServiceModelSamples.  
  
    -   Создаются новые каталоги диска с именами «%SystemDrive%\Inetpub\wwwroot\ServiceModelSamples» и «%SystemDrive%\Inetpub\wwwroot\ServiceModelSamples\bin».  
  
     Если вы предпочитаете установить эти каталоги вручную, см. в разделе [виртуального инструкции по настройке каталогов](../../../../docs/framework/wcf/samples/virtual-directory-setup-instructions.md). Чтобы отменить все изменения, произведенные на данном шаге, запустите файл cleanupvroot.bat по окончании использования образцов.  
  
    > [!NOTE]
    >  Если только не запущен файл cleanupvroot.bat, эта процедура выполняется только один раз для каждого компьютера.  
  
10. Предоставьте разрешение на изменение папки «%SystemDrive%\inetpub\wwwroot» для учетной записи, от имени которой выполняется построение образцов, и для пользователя сетевой службы. При построении некоторых образцов, размещенных на веб-сервере, может быть выполнена попытка копирования компилированных двоичных файлов в указанное ранее расположение, и если соответствующие разрешения не заданы, построение прервется. Можно также оставить разрешения неизменными и запускать командную строку пакета SDK или Visual Studio(2012) от имени администратора или строить образцы в [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] также от имени администратора.  
  
    > [!NOTE]
    >  Если этот шаг не выполнен, построение всех образцов, размещенных в службах IIS, завершится с ошибкой. Убедитесь, что разрешения заданы правильно, или запустите и командную строку пакета SDK, и командную строку Visual Studio (2012) от имени администратора.  
  
11. Создайте на компьютере каталог C:\logs. Некоторые образцы могут ожидать его наличия. Убедитесь, что соответствующая учетная запись имеет разрешение на запись в этот каталог. Для Windows 7 [!INCLUDE[wv](../../../../includes/wv-md.md)], и Windows Server 2008 R2, эта учетная запись является **сетевой службы**. Для [!INCLUDE[lserver](../../../../includes/lserver-md.md)] это учетная запись NT Authority\Network Service. Для [!INCLUDE[wxp](../../../../includes/wxp-md.md)] и [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] это учетная запись ASPNET.  
  
12. Запустите файл Setupcerttool.bat. Этот файл находится в \<путь установки > \WF_WCF_Samples\WCF\Setup\ папки.  Этот скрипт выполнит следующие задачи.  
  
    -   Построит средство FindPrivateKey.  
  
    -   Создаст каталог с именем %ProgramFiles%\ServiceModelSampleTools.  
  
    -   Скопирует в этот каталог новое средство FindPrivateKey.  
  
     Данное средство необходимо для образцов, в которых используются сертификаты и которые размещены в службах IIS.  
  
    > [!NOTE]
    >  В целях безопасности по завершении работы с образцами не забудьте удалить определение виртуального каталога и разрешения, предоставленные на шагах установки, запустив пакетный файл Cleanupvroot.bat.  
  
13. Резидентным образцам (не размещенным в службах IIS) требуется разрешение на регистрацию HTTP-адресов на компьютере для прослушивания. Разрешение на резервирование пространства имен HTTP поступает от учетной записи пользователя, используемой для выполнения образца. По умолчанию учетные записи администратора имеют разрешение на регистрацию любых HTTP-адресов. Неадминистративным учетным записям должно быть предоставлено разрешение на использование пространства имен HTTP, применяемых в образцах кода. Дополнительные сведения о настройке резервирования пространств имен см. в разделе [Настройка протоколов HTTP и HTTPS](../../../../docs/framework/wcf/feature-details/configuring-http-and-https.md).  
  
14. Для некоторых примеров требуется очередь сообщений. См. в разделе [Установка очереди сообщений (MSMQ)](../../../../docs/framework/wcf/samples/installing-message-queuing-msmq.md) инструкции по установке.  
  
    > [!NOTE]
    >  Перед запуском всех образцов, использующих очереди сообщений, необходимо убедиться, что запущена служба очередей сообщений.  
  
15. Для некоторых образцов требуются сертификаты. См. в разделе [инструкции по установке сертификата сервера (IIS) в службах IIS](../../../../docs/framework/wcf/samples/iis-server-certificate-installation-instructions.md).  
  
## <a name="see-also"></a>См. также
