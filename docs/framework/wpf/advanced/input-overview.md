---
title: Общие сведения о входных данных
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- commands [WPF]
- input [WPF], overview
- keyboard focus [WPF]
- keyboard input [WPF]
- touch events [WPF]
- event routing [WPF]
- touch input [WPF]
- manipulation [WPF]
- logical focus [WPF]
- stylus input [WPF]
- text input [WPF]
- input events [WPF], handling
- WPF [WPF], input overview
- manipulation events [WPF]
- mouse input [WPF]
- mouse capture [WPF]
- focus [WPF]
- mouse position [WPF]
ms.assetid: ee5258b7-6567-415a-9b1c-c0cbe46e79ef
ms.openlocfilehash: a90c74542c1a6604ed27d37f882385b67402dd92
ms.sourcegitcommit: eff6adb61852369ab690f3f047818c90580e7eb1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/07/2019
ms.locfileid: "72005025"
---
# <a name="input-overview"></a><span data-ttu-id="52e2d-102">Общие сведения о входных данных</span><span class="sxs-lookup"><span data-stu-id="52e2d-102">Input Overview</span></span>
<a name="introduction"></a><span data-ttu-id="52e2d-103">Подсистема [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] предоставляет мощный API для получения входных данных с различных устройств, включая мышь, клавиатуру, касание и перо.</span><span class="sxs-lookup"><span data-stu-id="52e2d-103">The [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] subsystem provides a powerful API for obtaining input from a variety of devices, including the mouse, keyboard, touch, and stylus.</span></span> <span data-ttu-id="52e2d-104">В этом разделе описываются службы, предоставляемые [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], и объясняется архитектура систем ввода.</span><span class="sxs-lookup"><span data-stu-id="52e2d-104">This topic describes the services provided by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and explains the architecture of the input systems.</span></span>

<a name="input_api"></a>
## <a name="input-api"></a><span data-ttu-id="52e2d-105">API ввода</span><span class="sxs-lookup"><span data-stu-id="52e2d-105">Input API</span></span>
 <span data-ttu-id="52e2d-106">Основной интерфейс ввода API находится в классах базовых элементов: <xref:System.Windows.UIElement>, <xref:System.Windows.ContentElement>, <xref:System.Windows.FrameworkElement>и <xref:System.Windows.FrameworkContentElement>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-106">The primary input API exposure is found on the base element classes: <xref:System.Windows.UIElement>, <xref:System.Windows.ContentElement>, <xref:System.Windows.FrameworkElement>, and <xref:System.Windows.FrameworkContentElement>.</span></span>  <span data-ttu-id="52e2d-107">Дополнительные сведения о базовых элементах см. в разделе [Обзор базовых элементов](base-elements-overview.md).</span><span class="sxs-lookup"><span data-stu-id="52e2d-107">For more information about the base elements, see [Base Elements Overview](base-elements-overview.md).</span></span>  <span data-ttu-id="52e2d-108">Эти классы предоставляют функциональность для входных событий, связанных, например, с нажатием клавиш, кнопками мыши, колесиком мыши, движением мыши, управлением фокусом и захватом мыши.</span><span class="sxs-lookup"><span data-stu-id="52e2d-108">These classes provide functionality for input events related to key presses, mouse buttons, mouse wheel, mouse movement, focus management, and mouse capture, to name a few.</span></span> <span data-ttu-id="52e2d-109">Поместив входной API в базовые элементы, вместо того чтобы обрабатывать все входные события как службу, архитектура ввода позволяет источнику входных событий в пользовательском интерфейсе и поддерживать схему маршрутизации событий, в которой несколько элементов имеют ОПП. ортунити для управления входным событием.</span><span class="sxs-lookup"><span data-stu-id="52e2d-109">By placing the input API on the base elements, rather than treating all input events as a service, the input architecture enables the input events to be sourced by a particular object in the UI, and to support an event routing scheme whereby more than one element has an opportunity to handle an input event.</span></span> <span data-ttu-id="52e2d-110">Многие события ввода имеют пару связанных с ними событий.</span><span class="sxs-lookup"><span data-stu-id="52e2d-110">Many input events have a pair of events associated with them.</span></span>  <span data-ttu-id="52e2d-111">Например, событие нажатия клавиши связано с событиями <xref:System.Windows.Input.Keyboard.KeyDown> и <xref:System.Windows.Input.Keyboard.PreviewKeyDown>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-111">For example, the key down event is associated with the <xref:System.Windows.Input.Keyboard.KeyDown> and <xref:System.Windows.Input.Keyboard.PreviewKeyDown> events.</span></span>  <span data-ttu-id="52e2d-112">Различие этих событий заключается в способе их маршрутизации в целевой элемент.</span><span class="sxs-lookup"><span data-stu-id="52e2d-112">The difference in these events is in how they are routed to the target element.</span></span>  <span data-ttu-id="52e2d-113">События предварительного просмотра проходят вниз по дереву элементов от корневого элемента в целевой элемент.</span><span class="sxs-lookup"><span data-stu-id="52e2d-113">Preview events tunnel down the element tree from the root element to the target element.</span></span>  <span data-ttu-id="52e2d-114">События восходящей маршрутизации поднимаются от целевого элемента в корневой элемент.</span><span class="sxs-lookup"><span data-stu-id="52e2d-114">Bubbling events bubble up from the target element to the root element.</span></span>  <span data-ttu-id="52e2d-115">Маршрутизация событий в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] рассматривается более подробно далее в этом обзоре и в разделе [Общие сведения о перенаправленных событиях](routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="52e2d-115">Event routing in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is discussed in more detail later in this overview and in the [Routed Events Overview](routed-events-overview.md).</span></span>

### <a name="keyboard-and-mouse-classes"></a><span data-ttu-id="52e2d-116">Классы Keyboard и Mouse</span><span class="sxs-lookup"><span data-stu-id="52e2d-116">Keyboard and Mouse Classes</span></span>
 <span data-ttu-id="52e2d-117">Помимо входного API для классов базовых элементов, класс <xref:System.Windows.Input.Keyboard> и классы <xref:System.Windows.Input.Mouse> предоставляют дополнительный API для работы с вводом с клавиатуры и мыши.</span><span class="sxs-lookup"><span data-stu-id="52e2d-117">In addition to the input API on the base element classes, the <xref:System.Windows.Input.Keyboard> class and <xref:System.Windows.Input.Mouse> classes provide additional API for working with keyboard and mouse input.</span></span>

 <span data-ttu-id="52e2d-118">Примерами входного API для класса <xref:System.Windows.Input.Keyboard> являются свойства <xref:System.Windows.Input.Keyboard.Modifiers%2A>, которые возвращают <xref:System.Windows.Input.ModifierKeys> нажатой в данный момент, и метод <xref:System.Windows.Input.Keyboard.IsKeyDown%2A>, который определяет, нажата ли заданная клавиша.</span><span class="sxs-lookup"><span data-stu-id="52e2d-118">Examples of input API on the <xref:System.Windows.Input.Keyboard> class are the <xref:System.Windows.Input.Keyboard.Modifiers%2A> property, which returns the <xref:System.Windows.Input.ModifierKeys> currently pressed, and the <xref:System.Windows.Input.Keyboard.IsKeyDown%2A> method, which determines whether a specified key is pressed.</span></span>

 <span data-ttu-id="52e2d-119">В следующем примере используется метод <xref:System.Windows.Input.Keyboard.GetKeyStates%2A>, чтобы определить, находится ли <xref:System.Windows.Input.Key> в некотором состоянии.</span><span class="sxs-lookup"><span data-stu-id="52e2d-119">The following example uses the <xref:System.Windows.Input.Keyboard.GetKeyStates%2A> method to determine if a <xref:System.Windows.Input.Key> is in the down state.</span></span>

 [!code-csharp[keyargssnippetsample#KeyEventArgsKeyBoardGetKeyStates](~/samples/snippets/csharp/VS_Snippets_Wpf/KeyArgsSnippetSample/CSharp/Window1.xaml.cs#keyeventargskeyboardgetkeystates)]
 [!code-vb[keyargssnippetsample#KeyEventArgsKeyBoardGetKeyStates](~/samples/snippets/visualbasic/VS_Snippets_Wpf/KeyArgsSnippetSample/visualbasic/window1.xaml.vb#keyeventargskeyboardgetkeystates)]

 <span data-ttu-id="52e2d-120">Примерами входного API для класса <xref:System.Windows.Input.Mouse> являются <xref:System.Windows.Input.Mouse.MiddleButton%2A>, который получает состояние средней кнопки мыши и <xref:System.Windows.Input.Mouse.DirectlyOver%2A>, который получает элемент, на который в данный момент наведен указатель мыши.</span><span class="sxs-lookup"><span data-stu-id="52e2d-120">Examples of input API on the <xref:System.Windows.Input.Mouse> class are <xref:System.Windows.Input.Mouse.MiddleButton%2A>, which obtains the state of the middle mouse button, and <xref:System.Windows.Input.Mouse.DirectlyOver%2A>, which gets the element the mouse pointer is currently over.</span></span>

 <span data-ttu-id="52e2d-121">В следующем примере определяется, находится ли <xref:System.Windows.Input.Mouse.LeftButton%2A> мыши в <xref:System.Windows.Input.MouseButtonState.Pressed>ном состоянии.</span><span class="sxs-lookup"><span data-stu-id="52e2d-121">The following example determines whether the <xref:System.Windows.Input.Mouse.LeftButton%2A> on the mouse is in the <xref:System.Windows.Input.MouseButtonState.Pressed> state.</span></span>

 [!code-csharp[mouserelatedsnippets#MouseRelatedSnippetsGetLeftButtonMouse](~/samples/snippets/csharp/VS_Snippets_Wpf/MouseRelatedSnippets/CSharp/Window1.xaml.cs#mouserelatedsnippetsgetleftbuttonmouse)]
 [!code-vb[mouserelatedsnippets#MouseRelatedSnippetsGetLeftButtonMouse](~/samples/snippets/visualbasic/VS_Snippets_Wpf/MouseRelatedSnippets/visualbasic/window1.xaml.vb#mouserelatedsnippetsgetleftbuttonmouse)]

 <span data-ttu-id="52e2d-122">Классы <xref:System.Windows.Input.Mouse> и <xref:System.Windows.Input.Keyboard> более подробно рассматриваются в этом обзоре.</span><span class="sxs-lookup"><span data-stu-id="52e2d-122">The <xref:System.Windows.Input.Mouse> and <xref:System.Windows.Input.Keyboard> classes are covered in more detail throughout this overview.</span></span>

### <a name="stylus-input"></a><span data-ttu-id="52e2d-123">Ввод с помощью пера</span><span class="sxs-lookup"><span data-stu-id="52e2d-123">Stylus Input</span></span>
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="52e2d-124">поддерживает интегрированную поддержку <xref:System.Windows.Input.Stylus>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-124">has integrated support for the <xref:System.Windows.Input.Stylus>.</span></span>  <span data-ttu-id="52e2d-125"><xref:System.Windows.Input.Stylus> — это ввод с помощью пера, который представляет собой популярное на планшетном ПК.</span><span class="sxs-lookup"><span data-stu-id="52e2d-125">The <xref:System.Windows.Input.Stylus> is a pen input made popular by the Tablet PC.</span></span>  [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="52e2d-126">приложения могут рассматривать перо как мышь с помощью API мыши, но [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] также предоставляет абстракцию устройства пера, использующую модель, похожую на клавиатуру и мышь.</span><span class="sxs-lookup"><span data-stu-id="52e2d-126">applications can treat the stylus as a mouse by using the mouse API, but [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] also exposes a stylus device abstraction that use a model similar to the keyboard and mouse.</span></span>  <span data-ttu-id="52e2d-127">Все API-интерфейсы, связанные с пером, содержат слово «перо».</span><span class="sxs-lookup"><span data-stu-id="52e2d-127">All stylus-related APIs contain the word "Stylus".</span></span>

 <span data-ttu-id="52e2d-128">Поскольку перо может действовать как мышь, приложения, поддерживающие только ввод с помощью мыши, по-прежнему могут автоматически получать определенный уровень поддержки пера.</span><span class="sxs-lookup"><span data-stu-id="52e2d-128">Because the stylus can act as a mouse, applications that support only mouse input can still obtain some level of stylus support automatically.</span></span> <span data-ttu-id="52e2d-129">При использовании пера таким образом приложение получает возможность обработать соответствующее событие пера, а затем обрабатывает соответствующее событие мыши.</span><span class="sxs-lookup"><span data-stu-id="52e2d-129">When the stylus is used in such a manner, the application is given the opportunity to handle the appropriate stylus event and then handles the corresponding mouse event.</span></span> <span data-ttu-id="52e2d-130">Кроме того, через абстрактное устройство «перо» доступны также службы более высокого уровня, например рукописный ввод.</span><span class="sxs-lookup"><span data-stu-id="52e2d-130">In addition, higher-level services such as ink input are also available through the stylus device abstraction.</span></span>  <span data-ttu-id="52e2d-131">Дополнительные сведения о рукописном вводе см. в разделе [Начало работы с рукописным вводом](getting-started-with-ink.md).</span><span class="sxs-lookup"><span data-stu-id="52e2d-131">For more information about ink as input, see [Getting Started with Ink](getting-started-with-ink.md).</span></span>

<a name="event_routing"></a>
## <a name="event-routing"></a><span data-ttu-id="52e2d-132">Маршрутизация событий</span><span class="sxs-lookup"><span data-stu-id="52e2d-132">Event Routing</span></span>
 <span data-ttu-id="52e2d-133"><xref:System.Windows.FrameworkElement> может содержать другие элементы в качестве дочерних элементов в своей модели содержимого, формируя дерево элементов.</span><span class="sxs-lookup"><span data-stu-id="52e2d-133">A <xref:System.Windows.FrameworkElement> can contain other elements as child elements in its content model, forming a tree of elements.</span></span>  <span data-ttu-id="52e2d-134">В [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] родительский элемент может участвовать во вводе, направленном в его дочерние элементы или другие потомки, путем обработки событий.</span><span class="sxs-lookup"><span data-stu-id="52e2d-134">In [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], the parent element can participate in input directed to its child elements or other descendants by handing events.</span></span> <span data-ttu-id="52e2d-135">Это особенно полезно для построения элементов управления из меньших элементов управления; этот процесс называется «составление элемента управления» или «компоновка».</span><span class="sxs-lookup"><span data-stu-id="52e2d-135">This is especially useful for building controls out of smaller controls, a process known as "control composition" or "compositing."</span></span> <span data-ttu-id="52e2d-136">Дополнительные сведения о деревьях элементов и их связи с маршрутами событий см. в разделе [Деревья в WPF](trees-in-wpf.md).</span><span class="sxs-lookup"><span data-stu-id="52e2d-136">For more information about element trees and how element trees relate to event routes, see [Trees in WPF](trees-in-wpf.md).</span></span>

 <span data-ttu-id="52e2d-137">Маршрутизация событий — это процесс направления событий в несколько элементов, так что конкретный объект или элемент в маршруте может выбрать предоставление значительного отклика (посредством обработки) на событие, которое могло быть получено от другого элемента.</span><span class="sxs-lookup"><span data-stu-id="52e2d-137">Event routing is the process of forwarding events to multiple elements, so that a particular object or element along the route can choose to offer a significant response (through handling) to an event that might have been sourced by a different element.</span></span>  <span data-ttu-id="52e2d-138">Перенаправленные события используют один из трех механизмов маршрутизации: прямую маршрутизацию, восходящую маршрутизацию и туннелирование.</span><span class="sxs-lookup"><span data-stu-id="52e2d-138">Routed events use one of three routing mechanisms: direct, bubbling, and tunneling.</span></span>  <span data-ttu-id="52e2d-139">При прямой маршрутизации уведомляется только исходный элемент и событие не перенаправляется ни в какие другие элементы.</span><span class="sxs-lookup"><span data-stu-id="52e2d-139">In direct routing, the source element is the only element notified, and the event is not routed to any other elements.</span></span> <span data-ttu-id="52e2d-140">Однако прямое перенаправленное событие по-прежнему предоставляет некоторые дополнительные возможности, которые имеются только для перенаправленных событий, в отличие от стандартных событий CLR.</span><span class="sxs-lookup"><span data-stu-id="52e2d-140">However, the direct routed event still offers some additional capabilities that are only present for routed events as opposed to standard CLR events.</span></span> <span data-ttu-id="52e2d-141">Восходящая маршрутизация работает вверх по дереву элементов, уведомляя элемент, который является источником события, затем его родительский элемент и т. д.</span><span class="sxs-lookup"><span data-stu-id="52e2d-141">Bubbling works up the element tree by first notifying the element that sourced the event, then the parent element, and so on.</span></span>  <span data-ttu-id="52e2d-142">Туннелирование начинается в корне дерева элементов и работает вниз, заканчивая элементом, который является источником.</span><span class="sxs-lookup"><span data-stu-id="52e2d-142">Tunneling starts at the root of the element tree and works down, ending with the original source element.</span></span>  <span data-ttu-id="52e2d-143">Дополнительные сведения о перенаправленных событиях см. в разделе [Общие сведения о перенаправленных событиях](routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="52e2d-143">For more information about routed events, see [Routed Events Overview](routed-events-overview.md).</span></span>

 <span data-ttu-id="52e2d-144">События ввода [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] обычно представлены парами, состоящими из событий нисходящей и восходящей маршрутизации.</span><span class="sxs-lookup"><span data-stu-id="52e2d-144">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] input events generally come in pairs that consists of a tunneling event and a bubbling event.</span></span>  <span data-ttu-id="52e2d-145">События нисходящей маршрутизации отличаются от событий восходящей маршрутизации префиксом Preview.</span><span class="sxs-lookup"><span data-stu-id="52e2d-145">Tunneling events are distinguished from bubbling events with the "Preview" prefix.</span></span>  <span data-ttu-id="52e2d-146">Например, <xref:System.Windows.Input.Mouse.PreviewMouseMove> является версией туннелирования события перемещения мыши, а <xref:System.Windows.Input.Mouse.MouseMove> является восходящей версией этого события.</span><span class="sxs-lookup"><span data-stu-id="52e2d-146">For instance, <xref:System.Windows.Input.Mouse.PreviewMouseMove> is the tunneling version of a mouse move event and <xref:System.Windows.Input.Mouse.MouseMove> is the bubbling version of this event.</span></span> <span data-ttu-id="52e2d-147">Такое связывание событий представляет собой соглашение, которое реализуется на уровне элемента и не является неотъемлемой характеристикой системы событий [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="52e2d-147">This event pairing is a convention that is implemented at the element level and is not an inherent capability of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] event system.</span></span> <span data-ttu-id="52e2d-148">Дополнительные сведения см. в разделе «События ввода WPF» статьи [Общие сведения о перенаправленных событиях](routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="52e2d-148">For details, see the WPF Input Events section in [Routed Events Overview](routed-events-overview.md).</span></span>

<a name="handling_input_events"></a>
## <a name="handling-input-events"></a><span data-ttu-id="52e2d-149">Обработка событий ввода</span><span class="sxs-lookup"><span data-stu-id="52e2d-149">Handling Input Events</span></span>
 <span data-ttu-id="52e2d-150">Для получения входных данных в элементе обработчик событий должен быть связан с данным конкретным событием.</span><span class="sxs-lookup"><span data-stu-id="52e2d-150">To receive input on an element, an event handler must be associated with that particular event.</span></span>  <span data-ttu-id="52e2d-151">В [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] это осуществляется напрямую: вы указываете имя события в качестве атрибута элемента, который будет перехватывать это событие.</span><span class="sxs-lookup"><span data-stu-id="52e2d-151">In [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] this is straightforward: you reference the name of the event as an attribute of the element that will be listening for this event.</span></span>  <span data-ttu-id="52e2d-152">Затем в качестве значения этого атрибута вы задаете имя обработчика событий, который можно определить на основе делегата.</span><span class="sxs-lookup"><span data-stu-id="52e2d-152">Then, you set the value of the attribute to the name of the event handler that you define, based on a delegate.</span></span>  <span data-ttu-id="52e2d-153">Обработчик событий должен быть написан в коде, например C# , и может быть помещен в файл кода программной части.</span><span class="sxs-lookup"><span data-stu-id="52e2d-153">The event handler must be written in code such as C# and can be included in a code-behind file.</span></span>

 <span data-ttu-id="52e2d-154">События клавиатуры возникают, когда операционная система сообщает о действиях клавиш, которые происходят, когда фокус клавиатуры находится в элементе.</span><span class="sxs-lookup"><span data-stu-id="52e2d-154">Keyboard events occur when the operating system reports key actions that occur while keyboard focus is on an element.</span></span> <span data-ttu-id="52e2d-155">События мыши и пера делятся на две категории: события, сообщающие об изменениях положения указателя относительно элемента, и события, сообщающие об изменениях состояния кнопок устройства.</span><span class="sxs-lookup"><span data-stu-id="52e2d-155">Mouse and stylus events each fall into two categories: events that report changes in pointer position relative to the element, and events that report changes in the state of device buttons.</span></span>

### <a name="keyboard-input-event-example"></a><span data-ttu-id="52e2d-156">Пример события ввода с клавиатуры</span><span class="sxs-lookup"><span data-stu-id="52e2d-156">Keyboard Input Event Example</span></span>
 <span data-ttu-id="52e2d-157">В следующем примере перехватывается событие нажатия клавиши со стрелкой влево.</span><span class="sxs-lookup"><span data-stu-id="52e2d-157">The following example listens for a left arrow key press.</span></span>  <span data-ttu-id="52e2d-158">Создается <xref:System.Windows.Controls.StackPanel> с <xref:System.Windows.Controls.Button>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-158">A <xref:System.Windows.Controls.StackPanel> is created that has a <xref:System.Windows.Controls.Button>.</span></span>  <span data-ttu-id="52e2d-159">Обработчик событий для прослушивания нажатия клавиши со стрелкой влево прикрепляется к экземпляру <xref:System.Windows.Controls.Button>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-159">An event handler to listen for the left arrow key press is attached to the <xref:System.Windows.Controls.Button> instance.</span></span>

 <span data-ttu-id="52e2d-160">В первом разделе примера создается <xref:System.Windows.Controls.StackPanel> и <xref:System.Windows.Controls.Button> и присоединяется обработчик событий для <xref:System.Windows.UIElement.KeyDown>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-160">The first section of the example creates the <xref:System.Windows.Controls.StackPanel> and the <xref:System.Windows.Controls.Button> and attaches the event handler for the <xref:System.Windows.UIElement.KeyDown>.</span></span>

 [!code-xaml[InputOvw#Input_OvwKeyboardExampleXAML](~/samples/snippets/csharp/VS_Snippets_Wpf/InputOvw/CSharp/Page1.xaml#input_ovwkeyboardexamplexaml)]

 [!code-csharp[InputOvw#Input_OvwKeyboardExampleUICodeBehind](~/samples/snippets/csharp/VS_Snippets_Wpf/InputOvw/CSharp/Page1.xaml.cs#input_ovwkeyboardexampleuicodebehind)]
 [!code-vb[InputOvw#Input_OvwKeyboardExampleUICodeBehind](~/samples/snippets/visualbasic/VS_Snippets_Wpf/InputOvw/VisualBasic/Page1.xaml.vb#input_ovwkeyboardexampleuicodebehind)]

 <span data-ttu-id="52e2d-161">Второй раздел прописывается в коде, и в нем определяется обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="52e2d-161">The second section is written in code and defines the event handler.</span></span>  <span data-ttu-id="52e2d-162">Если нажата клавиша со стрелкой влево и <xref:System.Windows.Controls.Button> имеет фокус клавиатуры, выполняется обработчик и изменяется цвет <xref:System.Windows.Controls.Control.Background%2A> <xref:System.Windows.Controls.Button>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-162">When the left arrow key is pressed and the <xref:System.Windows.Controls.Button> has keyboard focus, the handler runs and the <xref:System.Windows.Controls.Control.Background%2A> color of the <xref:System.Windows.Controls.Button> is changed.</span></span>  <span data-ttu-id="52e2d-163">Если клавиша нажата, но не является клавишей со стрелкой влево, <xref:System.Windows.Controls.Control.Background%2A> цвет <xref:System.Windows.Controls.Button> меняется на начальный цвет.</span><span class="sxs-lookup"><span data-stu-id="52e2d-163">If the key is pressed, but it is not the left arrow key, the <xref:System.Windows.Controls.Control.Background%2A> color of the <xref:System.Windows.Controls.Button> is changed back to its starting color.</span></span>

 [!code-csharp[InputOvw#Input_OvwKeyboardExampleHandlerCodeBehind](~/samples/snippets/csharp/VS_Snippets_Wpf/InputOvw/CSharp/Page1.xaml.cs#input_ovwkeyboardexamplehandlercodebehind)]
 [!code-vb[InputOvw#Input_OvwKeyboardExampleHandlerCodeBehind](~/samples/snippets/visualbasic/VS_Snippets_Wpf/InputOvw/VisualBasic/Page1.xaml.vb#input_ovwkeyboardexamplehandlercodebehind)]

### <a name="mouse-input-event-example"></a><span data-ttu-id="52e2d-164">Пример события ввода с помощью мыши</span><span class="sxs-lookup"><span data-stu-id="52e2d-164">Mouse Input Event Example</span></span>
 <span data-ttu-id="52e2d-165">В следующем примере цвет <xref:System.Windows.Controls.Control.Background%2A> <xref:System.Windows.Controls.Button> изменяется, когда указатель мыши попадает на <xref:System.Windows.Controls.Button>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-165">In the following example, the <xref:System.Windows.Controls.Control.Background%2A> color of a <xref:System.Windows.Controls.Button> is changed when the mouse pointer enters the <xref:System.Windows.Controls.Button>.</span></span>  <span data-ttu-id="52e2d-166">Цвет <xref:System.Windows.Controls.Control.Background%2A> восстанавливается, когда указатель мыши покидает <xref:System.Windows.Controls.Button>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-166">The <xref:System.Windows.Controls.Control.Background%2A> color is restored when the mouse leaves the <xref:System.Windows.Controls.Button>.</span></span>

 <span data-ttu-id="52e2d-167">В первом разделе примера создается <xref:System.Windows.Controls.StackPanel> и элемент управления <xref:System.Windows.Controls.Button> и присоединяются обработчики событий для <xref:System.Windows.UIElement.MouseEnter> и <xref:System.Windows.UIElement.MouseLeave> событий к <xref:System.Windows.Controls.Button>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-167">The first section of the example creates the <xref:System.Windows.Controls.StackPanel> and the <xref:System.Windows.Controls.Button> control and attaches the event handlers for the <xref:System.Windows.UIElement.MouseEnter> and <xref:System.Windows.UIElement.MouseLeave> events to the <xref:System.Windows.Controls.Button>.</span></span>

 [!code-xaml[InputOvw#Input_OvwMouseExampleXAML](~/samples/snippets/csharp/VS_Snippets_Wpf/InputOvw/CSharp/Page1.xaml#input_ovwmouseexamplexaml)]

 [!code-csharp[InputOvw#Input_OvwMouseExampleUICodeBehind](~/samples/snippets/csharp/VS_Snippets_Wpf/InputOvw/CSharp/Page1.xaml.cs#input_ovwmouseexampleuicodebehind)]
 [!code-vb[InputOvw#Input_OvwMouseExampleUICodeBehind](~/samples/snippets/visualbasic/VS_Snippets_Wpf/InputOvw/VisualBasic/Page1.xaml.vb#input_ovwmouseexampleuicodebehind)]

 <span data-ttu-id="52e2d-168">Второй раздел примера прописывается в коде, и в нем определяются обработчики событий.</span><span class="sxs-lookup"><span data-stu-id="52e2d-168">The second section of the example is written in code and defines the event handlers.</span></span>  <span data-ttu-id="52e2d-169">Когда указатель мыши попадает в <xref:System.Windows.Controls.Button>, цвет <xref:System.Windows.Controls.Control.Background%2A> <xref:System.Windows.Controls.Button> меняется на <xref:System.Windows.Media.Brushes.SlateGray%2A>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-169">When the mouse enters the <xref:System.Windows.Controls.Button>, the <xref:System.Windows.Controls.Control.Background%2A> color of the <xref:System.Windows.Controls.Button> is changed to <xref:System.Windows.Media.Brushes.SlateGray%2A>.</span></span>  <span data-ttu-id="52e2d-170">Когда указатель мыши покидает <xref:System.Windows.Controls.Button>, цвет <xref:System.Windows.Controls.Control.Background%2A> <xref:System.Windows.Controls.Button> меняется обратно на <xref:System.Windows.Media.Brushes.AliceBlue%2A>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-170">When the mouse leaves the <xref:System.Windows.Controls.Button>, the <xref:System.Windows.Controls.Control.Background%2A> color of the <xref:System.Windows.Controls.Button> is changed back to <xref:System.Windows.Media.Brushes.AliceBlue%2A>.</span></span>

 [!code-csharp[InputOvw#Input_OvwMouseExampleEneterHandler](~/samples/snippets/csharp/VS_Snippets_Wpf/InputOvw/CSharp/Page1.xaml.cs#input_ovwmouseexampleeneterhandler)]
 [!code-vb[InputOvw#Input_OvwMouseExampleEneterHandler](~/samples/snippets/visualbasic/VS_Snippets_Wpf/InputOvw/VisualBasic/Page1.xaml.vb#input_ovwmouseexampleeneterhandler)]

 [!code-csharp[InputOvw#Input_OvwMouseExampleLeaveHandler](~/samples/snippets/csharp/VS_Snippets_Wpf/InputOvw/CSharp/Page1.xaml.cs#input_ovwmouseexampleleavehandler)]
 [!code-vb[InputOvw#Input_OvwMouseExampleLeaveHandler](~/samples/snippets/visualbasic/VS_Snippets_Wpf/InputOvw/VisualBasic/Page1.xaml.vb#input_ovwmouseexampleleavehandler)]

<a name="text_input"></a>
## <a name="text-input"></a><span data-ttu-id="52e2d-171">Текстовый ввод</span><span class="sxs-lookup"><span data-stu-id="52e2d-171">Text Input</span></span>
 <span data-ttu-id="52e2d-172">Событие <xref:System.Windows.ContentElement.TextInput> позволяет ожидать ввода текста независимым от устройства образом.</span><span class="sxs-lookup"><span data-stu-id="52e2d-172">The <xref:System.Windows.ContentElement.TextInput> event enables you to listen for text input in a device-independent manner.</span></span> <span data-ttu-id="52e2d-173">Клавиатура является основным средством ввода текста, но текст также можно вводить и с помощью речи, рукописного ввода и других устройств.</span><span class="sxs-lookup"><span data-stu-id="52e2d-173">The keyboard is the primary means of text input, but speech, handwriting, and other input devices can generate text input also.</span></span>

 <span data-ttu-id="52e2d-174">Для ввода с клавиатуры [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] сначала отправляет соответствующие события <xref:System.Windows.ContentElement.KeyDown>/<xref:System.Windows.ContentElement.KeyUp>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-174">For keyboard input, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] first sends the appropriate <xref:System.Windows.ContentElement.KeyDown>/<xref:System.Windows.ContentElement.KeyUp> events.</span></span> <span data-ttu-id="52e2d-175">Если эти события не обрабатываются и ключ является текстовым (а не управляющим ключом, например стрелками направления или функциональными клавишами), то возникает событие <xref:System.Windows.ContentElement.TextInput>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-175">If those events are not handled and the key is textual (rather than a control key such as directional arrows or function keys), then a <xref:System.Windows.ContentElement.TextInput> event is raised.</span></span>  <span data-ttu-id="52e2d-176">Не всегда существует простое однозначное сопоставление между <xref:System.Windows.ContentElement.KeyDown>/<xref:System.Windows.ContentElement.KeyUp> и <xref:System.Windows.ContentElement.TextInput> событиями, так как несколько нажатий клавиш могут создавать один символ текстового ввода, а при нажатии одной клавиши можно создавать многосимвольные строки.</span><span class="sxs-lookup"><span data-stu-id="52e2d-176">There is not always a simple one-to-one mapping between <xref:System.Windows.ContentElement.KeyDown>/<xref:System.Windows.ContentElement.KeyUp> and <xref:System.Windows.ContentElement.TextInput> events because multiple keystrokes can generate a single character of text input and single keystrokes can generate multi-character strings.</span></span>  <span data-ttu-id="52e2d-177">Это особенно справедливо для таких языков, как китайский, японский и корейский, которые используют редакторы методов ввода (IME) для создания тысяч возможных символов в соответствующих алфавитах.</span><span class="sxs-lookup"><span data-stu-id="52e2d-177">This is especially true for languages such as Chinese, Japanese, and Korean which use Input Method Editors (IMEs) to generate the thousands of possible characters in their corresponding alphabets.</span></span>

 <span data-ttu-id="52e2d-178">Когда [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] отправляет событие <xref:System.Windows.ContentElement.KeyUp>/<xref:System.Windows.ContentElement.KeyDown>, <xref:System.Windows.Input.KeyEventArgs.Key%2A> устанавливается в <xref:System.Windows.Input.Key.System?displayProperty=nameWithType>, если нажатия клавиш могут стать частью события <xref:System.Windows.ContentElement.TextInput> (например, если нажата клавиша ALT + S).</span><span class="sxs-lookup"><span data-stu-id="52e2d-178">When [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sends a <xref:System.Windows.ContentElement.KeyUp>/<xref:System.Windows.ContentElement.KeyDown> event, <xref:System.Windows.Input.KeyEventArgs.Key%2A> is set to <xref:System.Windows.Input.Key.System?displayProperty=nameWithType> if the keystrokes could become part of a <xref:System.Windows.ContentElement.TextInput> event (if ALT+S is pressed, for example).</span></span> <span data-ttu-id="52e2d-179">Это позволяет коду в обработчике событий <xref:System.Windows.ContentElement.KeyDown> проверять наличие <xref:System.Windows.Input.Key.System?displayProperty=nameWithType> и, если он найден, оставить обработку обработчика последующего события <xref:System.Windows.ContentElement.TextInput>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-179">This allows code in a <xref:System.Windows.ContentElement.KeyDown> event handler to check for <xref:System.Windows.Input.Key.System?displayProperty=nameWithType> and, if found, leave processing for the handler of the subsequently raised <xref:System.Windows.ContentElement.TextInput> event.</span></span> <span data-ttu-id="52e2d-180">В таких случаях для определения исходного нажатия клавиш можно использовать различные свойства аргумента <xref:System.Windows.Input.TextCompositionEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-180">In these cases, the various properties of the <xref:System.Windows.Input.TextCompositionEventArgs> argument can be used to determine the original keystrokes.</span></span> <span data-ttu-id="52e2d-181">Аналогично, если редактор IME активен, <xref:System.Windows.Input.Key> имеет значение <xref:System.Windows.Input.Key.ImeProcessed?displayProperty=nameWithType>, а <xref:System.Windows.Input.KeyEventArgs.ImeProcessedKey%2A> возвращает исходное нажатие клавиши или нажатия клавиш.</span><span class="sxs-lookup"><span data-stu-id="52e2d-181">Similarly, if an IME is active, <xref:System.Windows.Input.Key> has the value of <xref:System.Windows.Input.Key.ImeProcessed?displayProperty=nameWithType>, and <xref:System.Windows.Input.KeyEventArgs.ImeProcessedKey%2A> gives the original keystroke or keystrokes.</span></span>

 <span data-ttu-id="52e2d-182">В следующем примере определяется обработчик для события <xref:System.Windows.Controls.Primitives.ButtonBase.Click> и обработчика события <xref:System.Windows.UIElement.KeyDown>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-182">The following example defines a handler for the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event and a handler for the <xref:System.Windows.UIElement.KeyDown> event.</span></span>

 <span data-ttu-id="52e2d-183">Первый сегмент кода или разметки создает пользовательский интерфейс.</span><span class="sxs-lookup"><span data-stu-id="52e2d-183">The first segment of code or markup creates the user interface.</span></span>

 [!code-xaml[InputOvw#Input_OvwTextInputXAML](~/samples/snippets/csharp/VS_Snippets_Wpf/InputOvw/CSharp/Page1.xaml#input_ovwtextinputxaml)]

 [!code-csharp[InputOvw#Input_OvwTextInputUICodeBehind](~/samples/snippets/csharp/VS_Snippets_Wpf/InputOvw/CSharp/Page1.xaml.cs#input_ovwtextinputuicodebehind)]
 [!code-vb[InputOvw#Input_OvwTextInputUICodeBehind](~/samples/snippets/visualbasic/VS_Snippets_Wpf/InputOvw/VisualBasic/Page1.xaml.vb#input_ovwtextinputuicodebehind)]

 <span data-ttu-id="52e2d-184">Второй сегмент кода содержит обработчики событий.</span><span class="sxs-lookup"><span data-stu-id="52e2d-184">The second segment of code contains the event handlers.</span></span>

 [!code-csharp[InputOvw#Input_OvwTextInputHandlersCodeBehind](~/samples/snippets/csharp/VS_Snippets_Wpf/InputOvw/CSharp/Page1.xaml.cs#input_ovwtextinputhandlerscodebehind)]
 [!code-vb[InputOvw#Input_OvwTextInputHandlersCodeBehind](~/samples/snippets/visualbasic/VS_Snippets_Wpf/InputOvw/VisualBasic/Page1.xaml.vb#input_ovwtextinputhandlerscodebehind)]

 <span data-ttu-id="52e2d-185">Так как события ввода поднимаются вверх по маршруту события, <xref:System.Windows.Controls.StackPanel> получает входные данные независимо от того, какой элемент имеет фокус клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="52e2d-185">Because input events bubble up the event route, the <xref:System.Windows.Controls.StackPanel> receives the input regardless of which element has keyboard focus.</span></span> <span data-ttu-id="52e2d-186">Первым уведомлен элемент управления <xref:System.Windows.Controls.TextBox>, а обработчик `OnTextInputKeyDown` вызывается только в том случае, если <xref:System.Windows.Controls.TextBox> не обрабатывает входные данные.</span><span class="sxs-lookup"><span data-stu-id="52e2d-186">The <xref:System.Windows.Controls.TextBox> control is notified first and the `OnTextInputKeyDown` handler is called only if the <xref:System.Windows.Controls.TextBox> did not handle the input.</span></span> <span data-ttu-id="52e2d-187">Если вместо события <xref:System.Windows.UIElement.KeyDown> используется <xref:System.Windows.UIElement.PreviewKeyDown> событие, сначала вызывается обработчик `OnTextInputKeyDown`.</span><span class="sxs-lookup"><span data-stu-id="52e2d-187">If the <xref:System.Windows.UIElement.PreviewKeyDown> event is used instead of the <xref:System.Windows.UIElement.KeyDown> event, the `OnTextInputKeyDown` handler is called first.</span></span>

 <span data-ttu-id="52e2d-188">В этом примере логика обработки пишется два раза — один раз для CTRL+O и еще один раз для события нажатия кнопки.</span><span class="sxs-lookup"><span data-stu-id="52e2d-188">In this example, the handling logic is written two times—one time for CTRL+O, and again for button's click event.</span></span> <span data-ttu-id="52e2d-189">Это можно упростить, если вместо прямой обработки событий ввода использовать команды.</span><span class="sxs-lookup"><span data-stu-id="52e2d-189">This can be simplified by using commands, instead of handling the input events directly.</span></span>  <span data-ttu-id="52e2d-190">Команды описываются в этом обзоре и в разделе [Общие сведения о системе команд](commanding-overview.md).</span><span class="sxs-lookup"><span data-stu-id="52e2d-190">Commands are discussed in this overview and in [Commanding Overview](commanding-overview.md).</span></span>

<a name="touch_and_manipulation"></a>
## <a name="touch-and-manipulation"></a><span data-ttu-id="52e2d-191">Касание и манипуляция</span><span class="sxs-lookup"><span data-stu-id="52e2d-191">Touch and Manipulation</span></span>
 <span data-ttu-id="52e2d-192">Новое оборудование и API в операционной системе Windows 7 дают приложениям возможность получать входные данные от нескольких касаний одновременно.</span><span class="sxs-lookup"><span data-stu-id="52e2d-192">New hardware and API in the Windows 7 operating system provide applications the ability to receive input from multiple touches simultaneously.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="52e2d-193">позволяет приложениям обнаруживать сенсорный ввод и реагировать на него так же, как на другой ввод, например с помощью мыши или клавиатуры, путем создания событий при возникновении сенсорного ввода.</span><span class="sxs-lookup"><span data-stu-id="52e2d-193">enables applications to detect and respond to touch in a manner similar to responding to other input, such as the mouse or keyboard, by raising events when touch occurs.</span></span>

 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="52e2d-194">предоставляет два типа событий для сенсорного ввода: события касания и события манипуляции.</span><span class="sxs-lookup"><span data-stu-id="52e2d-194">exposes two types of events when touch occurs: touch events and manipulation events.</span></span> <span data-ttu-id="52e2d-195">События касания предоставляют необработанные данные о каждом пальце на сенсорном экране и его перемещениях.</span><span class="sxs-lookup"><span data-stu-id="52e2d-195">Touch events provide raw data about each finger on a touchscreen and its movement.</span></span> <span data-ttu-id="52e2d-196">События манипуляции интерпретируют ввод как определенные действия.</span><span class="sxs-lookup"><span data-stu-id="52e2d-196">Manipulation events interpret the input as certain actions.</span></span> <span data-ttu-id="52e2d-197">В этом разделе рассматриваются оба типа событий.</span><span class="sxs-lookup"><span data-stu-id="52e2d-197">Both types of events are discussed in this section.</span></span>

### <a name="prerequisites"></a><span data-ttu-id="52e2d-198">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="52e2d-198">Prerequisites</span></span>
 <span data-ttu-id="52e2d-199">Для разработки приложений, реагирующих на сенсорный ввод, необходимы следующие компоненты.</span><span class="sxs-lookup"><span data-stu-id="52e2d-199">You need the following components to develop an application that responds to touch.</span></span>

- <span data-ttu-id="52e2d-200">Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="52e2d-200">Visual Studio 2010.</span></span>

- <span data-ttu-id="52e2d-201">Windows 7.</span><span class="sxs-lookup"><span data-stu-id="52e2d-201">Windows 7.</span></span>

- <span data-ttu-id="52e2d-202">Устройство, которое поддерживает Windows Touch, например сенсорный экран.</span><span class="sxs-lookup"><span data-stu-id="52e2d-202">A device, such as a touchscreen, that supports Windows Touch.</span></span>

### <a name="terminology"></a><span data-ttu-id="52e2d-203">Терминология</span><span class="sxs-lookup"><span data-stu-id="52e2d-203">Terminology</span></span>
 <span data-ttu-id="52e2d-204">При обсуждении сенсорного ввода используются следующие термины.</span><span class="sxs-lookup"><span data-stu-id="52e2d-204">The following terms are used when touch is discussed.</span></span>

- <span data-ttu-id="52e2d-205">**Касание** — это тип ввода пользователя, распознаваемый Windows 7.</span><span class="sxs-lookup"><span data-stu-id="52e2d-205">**Touch** is a type of user input that is recognized by Windows 7.</span></span> <span data-ttu-id="52e2d-206">Обычно касание инициируется, когда пользователь прикасается пальцами к сенсорному экрану.</span><span class="sxs-lookup"><span data-stu-id="52e2d-206">Usually, touch is initiated by putting fingers on a touch-sensitive screen.</span></span> <span data-ttu-id="52e2d-207">Обратите внимание, что такие устройства, как сенсорная панель, обычно используемая в ноутбуках, не поддерживают касание, если подобное устройство просто преобразует положение и движение пальца как ввод с помощью мыши.</span><span class="sxs-lookup"><span data-stu-id="52e2d-207">Note that devices such as a touchpad that is common on laptop computers do not support touch if the device merely converts the finger's position and movement as mouse input.</span></span>

- <span data-ttu-id="52e2d-208">**Мультикасание** — это касание, которое происходит одновременно в нескольких точках.</span><span class="sxs-lookup"><span data-stu-id="52e2d-208">**Multitouch** is touch that occurs from more than one point simultaneously.</span></span> <span data-ttu-id="52e2d-209">Windows 7 и [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] поддерживают мультикасание.</span><span class="sxs-lookup"><span data-stu-id="52e2d-209">Windows 7 and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] supports multitouch.</span></span> <span data-ttu-id="52e2d-210">Всякий раз, когда в документации для [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] идет речь о касании, это относится и мультикасанию.</span><span class="sxs-lookup"><span data-stu-id="52e2d-210">Whenever touch is discussed in the documentation for [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], the concepts apply to multitouch.</span></span>

- <span data-ttu-id="52e2d-211">**Манипуляция** происходит, когда касание интерпретируется как физическое действие, которое применяется к объекту.</span><span class="sxs-lookup"><span data-stu-id="52e2d-211">A **manipulation** occurs when touch is interpreted as a physical action that is applied to an object.</span></span> <span data-ttu-id="52e2d-212">В [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], события манипуляции интерпретируют ввод как сдвиг, расширение или поворот.</span><span class="sxs-lookup"><span data-stu-id="52e2d-212">In [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], manipulation events interpret input as a translation, expansion, or rotation manipulation.</span></span>

- <span data-ttu-id="52e2d-213">`touch device` — это устройство для сенсорного ввода, например одним пальцем на сенсорном экране.</span><span class="sxs-lookup"><span data-stu-id="52e2d-213">A `touch device` represents a device that produces touch input, such as a single finger on a touchscreen.</span></span>

### <a name="controls-that-respond-to-touch"></a><span data-ttu-id="52e2d-214">Элементы управления, реагирующие на касания</span><span class="sxs-lookup"><span data-stu-id="52e2d-214">Controls that Respond to Touch</span></span>
 <span data-ttu-id="52e2d-215">Следующие элементы управления можно прокручивать, проводя пальцем по элементу управления, если имеется содержимое, которое находится вне области просмотра.</span><span class="sxs-lookup"><span data-stu-id="52e2d-215">The following controls can be scrolled by dragging a finger across the control if it has content that is scrolled out of view.</span></span>

- <xref:System.Windows.Controls.ComboBox>

- <xref:System.Windows.Controls.ContextMenu>

- <xref:System.Windows.Controls.DataGrid>

- <xref:System.Windows.Controls.ListBox>

- <xref:System.Windows.Controls.ListView>

- <xref:System.Windows.Controls.MenuItem>

- <xref:System.Windows.Controls.TextBox>

- <xref:System.Windows.Controls.ToolBar>

- <xref:System.Windows.Controls.TreeView>

 <span data-ttu-id="52e2d-216"><xref:System.Windows.Controls.ScrollViewer> определяет присоединенное <xref:System.Windows.Controls.ScrollViewer.PanningMode%2A?displayProperty=nameWithType> свойство, которое позволяет указать, включено ли сенсорное панорамирование по горизонтали, вертикали, обоим или ни одному.</span><span class="sxs-lookup"><span data-stu-id="52e2d-216">The <xref:System.Windows.Controls.ScrollViewer> defines the <xref:System.Windows.Controls.ScrollViewer.PanningMode%2A?displayProperty=nameWithType> attached property that enables you to specify whether touch panning is enabled horizontally, vertically, both, or neither.</span></span> <span data-ttu-id="52e2d-217">Свойство <xref:System.Windows.Controls.ScrollViewer.PanningDeceleration%2A?displayProperty=nameWithType> указывает скорость, с которой замедляется прокрутка, когда пользователь отрывает палец от сенсорного экрана.</span><span class="sxs-lookup"><span data-stu-id="52e2d-217">The <xref:System.Windows.Controls.ScrollViewer.PanningDeceleration%2A?displayProperty=nameWithType> property specifies how quickly the scrolling slows down when the user lifts the finger from the touchscreen.</span></span> <span data-ttu-id="52e2d-218">Присоединенное свойство <xref:System.Windows.Controls.ScrollViewer.PanningRatio%2A?displayProperty=nameWithType> указывает отношение смещения прокрутки к смещению манипуляции.</span><span class="sxs-lookup"><span data-stu-id="52e2d-218">The <xref:System.Windows.Controls.ScrollViewer.PanningRatio%2A?displayProperty=nameWithType> attached property specifies the ratio of scrolling offset to translate manipulation offset.</span></span>

### <a name="touch-events"></a><span data-ttu-id="52e2d-219">События касания</span><span class="sxs-lookup"><span data-stu-id="52e2d-219">Touch Events</span></span>
 <span data-ttu-id="52e2d-220">Базовые классы, <xref:System.Windows.UIElement>, <xref:System.Windows.UIElement3D>и <xref:System.Windows.ContentElement>определяют события, на которые можно подписываться, чтобы приложение отвечало на сенсорный ввод.</span><span class="sxs-lookup"><span data-stu-id="52e2d-220">The base classes, <xref:System.Windows.UIElement>, <xref:System.Windows.UIElement3D>, and <xref:System.Windows.ContentElement>, define events that you can subscribe to so your application will respond to touch.</span></span> <span data-ttu-id="52e2d-221">События касания полезны в тех случаях, когда приложение интерпретирует касание не как действие с объектом.</span><span class="sxs-lookup"><span data-stu-id="52e2d-221">Touch events are useful when your application interprets touch as something other than manipulating an object.</span></span> <span data-ttu-id="52e2d-222">Например, приложение, в котором пользователь может рисовать одним или несколькими пальцами, будет подписываться на события касания.</span><span class="sxs-lookup"><span data-stu-id="52e2d-222">For example, an application that enables a user to draw with one or more fingers would subscribe to touch events.</span></span>

 <span data-ttu-id="52e2d-223">Все эти три класса определяют следующие события, которые ведут себя одинаково независимо от определяющего класса.</span><span class="sxs-lookup"><span data-stu-id="52e2d-223">All three classes define the following events, which behave similarly, regardless of the defining class.</span></span>

- <xref:System.Windows.UIElement.TouchDown>

- <xref:System.Windows.UIElement.TouchMove>

- <xref:System.Windows.UIElement.TouchUp>

- <xref:System.Windows.UIElement.TouchEnter>

- <xref:System.Windows.UIElement.TouchLeave>

- <xref:System.Windows.UIElement.PreviewTouchDown>

- <xref:System.Windows.UIElement.PreviewTouchMove>

- <xref:System.Windows.UIElement.PreviewTouchUp>

- <xref:System.Windows.UIElement.GotTouchCapture>

- <xref:System.Windows.UIElement.LostTouchCapture>

 <span data-ttu-id="52e2d-224">Как и события клавиатуры и мыши, события сенсорного ввода являются перенаправленными событиями.</span><span class="sxs-lookup"><span data-stu-id="52e2d-224">Like keyboard and mouse events, the touch events are routed events.</span></span> <span data-ttu-id="52e2d-225">События нисходящей маршрутизации начинаются с `Preview`, а события восходящей маршрутизации — с `Touch`.</span><span class="sxs-lookup"><span data-stu-id="52e2d-225">The events that begin with `Preview` are tunneling events and the events that begin with `Touch` are bubbling events.</span></span> <span data-ttu-id="52e2d-226">Дополнительные сведения о перенаправленных событиях см. в разделе [Общие сведения о перенаправленных событиях](routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="52e2d-226">For more information about routed events, see [Routed Events Overview](routed-events-overview.md).</span></span> <span data-ttu-id="52e2d-227">При обработке этих событий можно получить расположение входных данных относительно любого элемента, вызвав метод <xref:System.Windows.Input.TouchEventArgs.GetTouchPoint%2A> или <xref:System.Windows.Input.TouchEventArgs.GetIntermediateTouchPoints%2A>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-227">When you handle these events, you can get the position of the input, relative to any element, by calling the <xref:System.Windows.Input.TouchEventArgs.GetTouchPoint%2A> or <xref:System.Windows.Input.TouchEventArgs.GetIntermediateTouchPoints%2A> method.</span></span>

 <span data-ttu-id="52e2d-228">Чтобы лучше объяснить взаимодействие между событиями касания, рассмотрим ситуацию, когда пользователь помещает один палец в элемент, а затем убирает палец из этого элемента.</span><span class="sxs-lookup"><span data-stu-id="52e2d-228">To understand the interaction among the touch events, consider the scenario where a user puts one finger on an element, moves the finger in the element, and then lifts the finger from the element.</span></span> <span data-ttu-id="52e2d-229">На следующем рисунке показано выполнение событий восходящей маршрутизации (для простоты события нисходящей маршрутизации не указаны).</span><span class="sxs-lookup"><span data-stu-id="52e2d-229">The following illustration shows the execution of the bubbling events (the tunneling events are omitted for simplicity).</span></span>

 <span data-ttu-id="52e2d-230">![Последовательность событий касания.](./media/ndp-touchevents.png "NDP_TouchEvents") События касания</span><span class="sxs-lookup"><span data-stu-id="52e2d-230">![The sequence of touch events.](./media/ndp-touchevents.png "NDP_TouchEvents") Touch events</span></span>

 <span data-ttu-id="52e2d-231">Последовательность событий на предыдущем рисунке приведена в следующем списке.</span><span class="sxs-lookup"><span data-stu-id="52e2d-231">The following list describes the sequence of the events in the preceding illustration.</span></span>

1. <span data-ttu-id="52e2d-232">Событие <xref:System.Windows.UIElement.TouchEnter> возникает один раз, когда пользователь помещает палец на элемент.</span><span class="sxs-lookup"><span data-stu-id="52e2d-232">The <xref:System.Windows.UIElement.TouchEnter> event occurs one time when the user puts a finger on the element.</span></span>

2. <span data-ttu-id="52e2d-233">Событие <xref:System.Windows.UIElement.TouchDown> возникает один раз.</span><span class="sxs-lookup"><span data-stu-id="52e2d-233">The <xref:System.Windows.UIElement.TouchDown> event occurs one time.</span></span>

3. <span data-ttu-id="52e2d-234">Событие <xref:System.Windows.UIElement.TouchMove> возникает несколько раз, когда пользователь перемещает палец внутри элемента.</span><span class="sxs-lookup"><span data-stu-id="52e2d-234">The <xref:System.Windows.UIElement.TouchMove> event occurs multiple times as the user moves the finger within the element.</span></span>

4. <span data-ttu-id="52e2d-235">Событие <xref:System.Windows.UIElement.TouchUp> возникает один раз, когда пользователь отрывает палец от элемента.</span><span class="sxs-lookup"><span data-stu-id="52e2d-235">The <xref:System.Windows.UIElement.TouchUp> event occurs one time when the user lifts the finger from the element.</span></span>

5. <span data-ttu-id="52e2d-236">Событие <xref:System.Windows.UIElement.TouchLeave> возникает один раз.</span><span class="sxs-lookup"><span data-stu-id="52e2d-236">The <xref:System.Windows.UIElement.TouchLeave> event occurs one time.</span></span>

 <span data-ttu-id="52e2d-237">При использовании более двух пальцев, события возникают для каждого пальца.</span><span class="sxs-lookup"><span data-stu-id="52e2d-237">When more than two fingers are used, the events occur for each finger.</span></span>

### <a name="manipulation-events"></a><span data-ttu-id="52e2d-238">События манипуляции</span><span class="sxs-lookup"><span data-stu-id="52e2d-238">Manipulation Events</span></span>
 <span data-ttu-id="52e2d-239">В случаях, когда приложение позволяет пользователю манипулировать объектом, класс <xref:System.Windows.UIElement> определяет события манипуляции.</span><span class="sxs-lookup"><span data-stu-id="52e2d-239">For cases where an application enables a user to manipulate an object, the <xref:System.Windows.UIElement> class defines manipulation events.</span></span> <span data-ttu-id="52e2d-240">В отличие от событий касания, которые сообщают только положение точки касания, события манипуляции сообщают, как можно интерпретировать ввод.</span><span class="sxs-lookup"><span data-stu-id="52e2d-240">Unlike the touch events that simply report the position of touch, the manipulation events report how the input can be interpreted.</span></span> <span data-ttu-id="52e2d-241">Существует три типа манипуляции: сдвиг, расширение и поворот.</span><span class="sxs-lookup"><span data-stu-id="52e2d-241">There are three types of manipulations, translation, expansion, and rotation.</span></span> <span data-ttu-id="52e2d-242">В следующем списке показывается, как вызываются эти три типа манипуляции.</span><span class="sxs-lookup"><span data-stu-id="52e2d-242">The following list describes how to invoke the three types of manipulations.</span></span>

- <span data-ttu-id="52e2d-243">Поместите палец на объект и переместите палец по сенсорному экрану, чтобы выполнить сдвиг.</span><span class="sxs-lookup"><span data-stu-id="52e2d-243">Put a finger on an object and move the finger across the touchscreen to invoke a translation manipulation.</span></span> <span data-ttu-id="52e2d-244">Обычно такое действие перемещает объект.</span><span class="sxs-lookup"><span data-stu-id="52e2d-244">This usually moves the object.</span></span>

- <span data-ttu-id="52e2d-245">Поместите два пальца на объект и сведите или разведите их, чтобы выполнить расширение.</span><span class="sxs-lookup"><span data-stu-id="52e2d-245">Put two fingers on an object and move the fingers closer together or farther apart from one another to invoke an expansion manipulation.</span></span> <span data-ttu-id="52e2d-246">Обычно такое действие изменяет размеры объекта.</span><span class="sxs-lookup"><span data-stu-id="52e2d-246">This usually resizes the object.</span></span>

- <span data-ttu-id="52e2d-247">Поместите два пальца на объект и поворачивайте их вокруг друг друга, чтобы выполнить действие поворота.</span><span class="sxs-lookup"><span data-stu-id="52e2d-247">Put two fingers on an object and rotate the fingers around each other to invoke a rotation manipulation.</span></span> <span data-ttu-id="52e2d-248">Обычно такое действие выполняет циклический сдвиг объекта.</span><span class="sxs-lookup"><span data-stu-id="52e2d-248">This usually rotates the object.</span></span>

 <span data-ttu-id="52e2d-249">Можно одновременно выполнять несколько типов манипуляций.</span><span class="sxs-lookup"><span data-stu-id="52e2d-249">More than one type of manipulation can occur simultaneously.</span></span>

 <span data-ttu-id="52e2d-250">Реализуя реагирование объектов на манипуляции, можно создать видимость инерции объекта.</span><span class="sxs-lookup"><span data-stu-id="52e2d-250">When you cause objects to respond to manipulations, you can have the object appear to have inertia.</span></span> <span data-ttu-id="52e2d-251">Тогда объекты смогут имитировать физический мир.</span><span class="sxs-lookup"><span data-stu-id="52e2d-251">This can make your objects simulate the physical world.</span></span> <span data-ttu-id="52e2d-252">Например, если вы достаточно сильно толкнете книгу по столу, то после того как вы ее отпустите, она продолжит движение.</span><span class="sxs-lookup"><span data-stu-id="52e2d-252">For example, when you push a book across a table, if you push hard enough the book will continue to move after you release it.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="52e2d-253">позволяет имитировать это поведение путем вызова событий манипуляции после того, как пальцы пользователя отпускают объект.</span><span class="sxs-lookup"><span data-stu-id="52e2d-253">enables you to simulate this behavior by raising manipulation events after the user's fingers releases the object.</span></span>

 <span data-ttu-id="52e2d-254">Сведения о том, как создать приложение, которое дает пользователю возможность перемещать, масштабировать и поворачивать объект, см. в статье [Пошаговое руководство. Создание первого приложения для обработки касаний](walkthrough-creating-your-first-touch-application.md).</span><span class="sxs-lookup"><span data-stu-id="52e2d-254">For information about how to create an application that enables the user to move, resize, and rotate an object, see [Walkthrough: Creating Your First Touch Application](walkthrough-creating-your-first-touch-application.md).</span></span>

 <span data-ttu-id="52e2d-255"><xref:System.Windows.UIElement> определяет следующие события манипуляции.</span><span class="sxs-lookup"><span data-stu-id="52e2d-255">The <xref:System.Windows.UIElement> defines the following manipulation events.</span></span>

- <xref:System.Windows.UIElement.ManipulationStarting>

- <xref:System.Windows.UIElement.ManipulationStarted>

- <xref:System.Windows.UIElement.ManipulationDelta>

- <xref:System.Windows.UIElement.ManipulationInertiaStarting>

- <xref:System.Windows.UIElement.ManipulationCompleted>

- <xref:System.Windows.UIElement.ManipulationBoundaryFeedback>

 <span data-ttu-id="52e2d-256">По умолчанию <xref:System.Windows.UIElement> не получает эти события манипуляции.</span><span class="sxs-lookup"><span data-stu-id="52e2d-256">By default, a <xref:System.Windows.UIElement> does not receive these manipulation events.</span></span> <span data-ttu-id="52e2d-257">Чтобы получить события манипуляции в <xref:System.Windows.UIElement>, задайте для <xref:System.Windows.UIElement.IsManipulationEnabled%2A?displayProperty=nameWithType> значение `true`.</span><span class="sxs-lookup"><span data-stu-id="52e2d-257">To receive manipulation events on a <xref:System.Windows.UIElement>, set <xref:System.Windows.UIElement.IsManipulationEnabled%2A?displayProperty=nameWithType> to `true`.</span></span>

#### <a name="the-execution-path-of-manipulation-events"></a><span data-ttu-id="52e2d-258">Путь выполнения событий манипуляции</span><span class="sxs-lookup"><span data-stu-id="52e2d-258">The Execution Path of Manipulation Events</span></span>
 <span data-ttu-id="52e2d-259">Рассмотрим сценарий, когда пользователь «бросает» объект.</span><span class="sxs-lookup"><span data-stu-id="52e2d-259">Consider a scenario where a user "throws" an object.</span></span> <span data-ttu-id="52e2d-260">Пользователь ставит палец на объект, перемещает палец по сенсорному экрану на короткое расстояние, а затем поднимает палец, когда тот еще движется.</span><span class="sxs-lookup"><span data-stu-id="52e2d-260">The user puts a finger on the object, moves the finger across the touchscreen for a short distance, and then lifts the finger while it is moving.</span></span> <span data-ttu-id="52e2d-261">В результате объект будет перемещаться под пальцем пользователя и продолжит движение после того, как пользователь поднимет палец.</span><span class="sxs-lookup"><span data-stu-id="52e2d-261">The result of this is that the object will move under the user's finger and continue to move after the user lifts the finger.</span></span>

 <span data-ttu-id="52e2d-262">На следующем рисунке показан путь выполнения событий манипуляции и важные сведения о каждом событии.</span><span class="sxs-lookup"><span data-stu-id="52e2d-262">The following illustration shows the execution path of manipulation events and important information about each event.</span></span>

 <span data-ttu-id="52e2d-263">![Последовательность событий манипуляции.](./media/ndp-manipulationevents.png "NDP_ManipulationEvents") События манипуляции</span><span class="sxs-lookup"><span data-stu-id="52e2d-263">![The sequence of manipulation events.](./media/ndp-manipulationevents.png "NDP_ManipulationEvents") Manipulation events</span></span>

 <span data-ttu-id="52e2d-264">Последовательность событий на предыдущем рисунке приведена в следующем списке.</span><span class="sxs-lookup"><span data-stu-id="52e2d-264">The following list describes the sequence of the events in the preceding illustration.</span></span>

1. <span data-ttu-id="52e2d-265">Событие <xref:System.Windows.UIElement.ManipulationStarting> возникает, когда пользователь помещает палец на объект.</span><span class="sxs-lookup"><span data-stu-id="52e2d-265">The <xref:System.Windows.UIElement.ManipulationStarting> event occurs when the user places a finger on the object.</span></span> <span data-ttu-id="52e2d-266">Помимо прочего, это событие позволяет задать свойство <xref:System.Windows.Input.ManipulationStartingEventArgs.ManipulationContainer%2A>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-266">Among other things, this event allows you to set the <xref:System.Windows.Input.ManipulationStartingEventArgs.ManipulationContainer%2A> property.</span></span> <span data-ttu-id="52e2d-267">В последующих событиях расположение манипуляции будет относиться к <xref:System.Windows.Input.ManipulationStartingEventArgs.ManipulationContainer%2A>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-267">In the subsequent events, the position of the manipulation will be relative to the <xref:System.Windows.Input.ManipulationStartingEventArgs.ManipulationContainer%2A>.</span></span> <span data-ttu-id="52e2d-268">В событиях, отличных от <xref:System.Windows.UIElement.ManipulationStarting>, это свойство доступно только для чтения, поэтому событием <xref:System.Windows.UIElement.ManipulationStarting> является единственный момент, когда можно задать это свойство.</span><span class="sxs-lookup"><span data-stu-id="52e2d-268">In events other than <xref:System.Windows.UIElement.ManipulationStarting>, this property is read-only, so the <xref:System.Windows.UIElement.ManipulationStarting> event is the only time that you can set this property.</span></span>

2. <span data-ttu-id="52e2d-269">Событие <xref:System.Windows.UIElement.ManipulationStarted> возникает далее.</span><span class="sxs-lookup"><span data-stu-id="52e2d-269">The <xref:System.Windows.UIElement.ManipulationStarted> event occurs next.</span></span> <span data-ttu-id="52e2d-270">Это событие сообщает исходную точку манипуляции.</span><span class="sxs-lookup"><span data-stu-id="52e2d-270">This event reports the origin of the manipulation.</span></span>

3. <span data-ttu-id="52e2d-271">Событие <xref:System.Windows.UIElement.ManipulationDelta> возникает несколько раз, когда пальцы пользователя перемещаются на сенсорный экран.</span><span class="sxs-lookup"><span data-stu-id="52e2d-271">The <xref:System.Windows.UIElement.ManipulationDelta> event occurs multiple times as a user's fingers move on a touchscreen.</span></span> <span data-ttu-id="52e2d-272">Свойство <xref:System.Windows.Input.ManipulationDeltaEventArgs.DeltaManipulation%2A> класса <xref:System.Windows.Input.ManipulationDeltaEventArgs> сообщает, интерпретируется ли манипуляция как перемещение, расширение или перевод.</span><span class="sxs-lookup"><span data-stu-id="52e2d-272">The <xref:System.Windows.Input.ManipulationDeltaEventArgs.DeltaManipulation%2A> property of the <xref:System.Windows.Input.ManipulationDeltaEventArgs> class reports whether the manipulation is interpreted as movement, expansion, or translation.</span></span> <span data-ttu-id="52e2d-273">Здесь вы выполняете большую часть манипуляций с объектом.</span><span class="sxs-lookup"><span data-stu-id="52e2d-273">This is where you perform most of the work of manipulating an object.</span></span>

4. <span data-ttu-id="52e2d-274">Событие <xref:System.Windows.UIElement.ManipulationInertiaStarting> возникает, когда пальцы пользователя теряют контакт с объектом.</span><span class="sxs-lookup"><span data-stu-id="52e2d-274">The <xref:System.Windows.UIElement.ManipulationInertiaStarting> event occurs when the user's fingers lose contact with the object.</span></span> <span data-ttu-id="52e2d-275">Это событие позволяет указать замедление манипуляции во время инерции.</span><span class="sxs-lookup"><span data-stu-id="52e2d-275">This event enables you to specify the deceleration of the manipulations during inertia.</span></span> <span data-ttu-id="52e2d-276">Так объект может имитировать разные физические расстояния или атрибуты при вашем желании.</span><span class="sxs-lookup"><span data-stu-id="52e2d-276">This is so your object can emulate different physical spaces or attributes if you choose.</span></span> <span data-ttu-id="52e2d-277">Например, предположим, что в приложении имеются два объекта, представляющие элементы в физическом мире, один из которых тяжелее другого.</span><span class="sxs-lookup"><span data-stu-id="52e2d-277">For example, suppose your application has two objects that represent items in the physical world, and one is heavier than the other.</span></span> <span data-ttu-id="52e2d-278">Можно сделать так, чтобы более тяжелый объект замедлялся быстрее, чем более легкий.</span><span class="sxs-lookup"><span data-stu-id="52e2d-278">You can make the heavier object decelerate faster than the lighter object.</span></span>

5. <span data-ttu-id="52e2d-279">Событие <xref:System.Windows.UIElement.ManipulationDelta> возникает несколько раз, когда происходит инерция.</span><span class="sxs-lookup"><span data-stu-id="52e2d-279">The <xref:System.Windows.UIElement.ManipulationDelta> event occurs multiple times as inertia occurs.</span></span> <span data-ttu-id="52e2d-280">Обратите внимание, что это событие возникает, и когда пальцы пользователя двигаются по сенсорному экрану, и когда [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] имитирует инерцию.</span><span class="sxs-lookup"><span data-stu-id="52e2d-280">Note that this event occurs when the user's fingers move across the touchscreen and when [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] simulates inertia.</span></span> <span data-ttu-id="52e2d-281">Иными словами, <xref:System.Windows.UIElement.ManipulationDelta> происходит до и после события <xref:System.Windows.UIElement.ManipulationInertiaStarting>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-281">In other words, <xref:System.Windows.UIElement.ManipulationDelta> occurs before and after the <xref:System.Windows.UIElement.ManipulationInertiaStarting> event.</span></span> <span data-ttu-id="52e2d-282">Свойство <xref:System.Windows.Input.ManipulationDeltaEventArgs.IsInertial%2A?displayProperty=nameWithType> сообщает, возникает ли событие <xref:System.Windows.UIElement.ManipulationDelta> во время инерции, поэтому можно проверить это свойство и выполнить различные действия в зависимости от его значения.</span><span class="sxs-lookup"><span data-stu-id="52e2d-282">The <xref:System.Windows.Input.ManipulationDeltaEventArgs.IsInertial%2A?displayProperty=nameWithType> property reports whether the <xref:System.Windows.UIElement.ManipulationDelta> event occurs during inertia, so you can check that property and perform different actions, depending on its value.</span></span>

6. <span data-ttu-id="52e2d-283">Событие <xref:System.Windows.UIElement.ManipulationCompleted> возникает при каждом завершении манипуляции и инерции.</span><span class="sxs-lookup"><span data-stu-id="52e2d-283">The <xref:System.Windows.UIElement.ManipulationCompleted> event occurs when the manipulation and any inertia ends.</span></span> <span data-ttu-id="52e2d-284">То есть после возникновения всех событий <xref:System.Windows.UIElement.ManipulationDelta> возникает событие <xref:System.Windows.UIElement.ManipulationCompleted>, сообщающее о завершении манипуляции.</span><span class="sxs-lookup"><span data-stu-id="52e2d-284">That is, after all the <xref:System.Windows.UIElement.ManipulationDelta> events occur, the <xref:System.Windows.UIElement.ManipulationCompleted> event occurs to signal that the manipulation is complete.</span></span>

 <span data-ttu-id="52e2d-285"><xref:System.Windows.UIElement> также определяет событие <xref:System.Windows.UIElement.ManipulationBoundaryFeedback>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-285">The <xref:System.Windows.UIElement> also defines the <xref:System.Windows.UIElement.ManipulationBoundaryFeedback> event.</span></span> <span data-ttu-id="52e2d-286">Это событие возникает при вызове метода <xref:System.Windows.Input.ManipulationDeltaEventArgs.ReportBoundaryFeedback%2A> в событии <xref:System.Windows.UIElement.ManipulationDelta>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-286">This event occurs when the <xref:System.Windows.Input.ManipulationDeltaEventArgs.ReportBoundaryFeedback%2A> method is called in the <xref:System.Windows.UIElement.ManipulationDelta> event.</span></span> <span data-ttu-id="52e2d-287">Событие <xref:System.Windows.UIElement.ManipulationBoundaryFeedback> позволяет приложениям или компонентам предоставлять визуальную обратную связь, когда объект достигает границы.</span><span class="sxs-lookup"><span data-stu-id="52e2d-287">The <xref:System.Windows.UIElement.ManipulationBoundaryFeedback> event enables applications or components to provide visual feedback when an object hits a boundary.</span></span> <span data-ttu-id="52e2d-288">Например, класс <xref:System.Windows.Window> обрабатывает событие <xref:System.Windows.UIElement.ManipulationBoundaryFeedback>, чтобы окно было слегка перемещено при обнаружении его границы.</span><span class="sxs-lookup"><span data-stu-id="52e2d-288">For example, the <xref:System.Windows.Window> class handles the <xref:System.Windows.UIElement.ManipulationBoundaryFeedback> event to cause the window to slightly move when its edge is encountered.</span></span>

 <span data-ttu-id="52e2d-289">Вы можете отменить манипуляцию, вызвав метод <xref:System.Windows.Input.ManipulationStartingEventArgs.Cancel%2A> для аргументов события в любом событии манипуляции, кроме события <xref:System.Windows.UIElement.ManipulationBoundaryFeedback>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-289">You can cancel the manipulation by calling the <xref:System.Windows.Input.ManipulationStartingEventArgs.Cancel%2A> method on the event arguments in any manipulation event except <xref:System.Windows.UIElement.ManipulationBoundaryFeedback> event.</span></span> <span data-ttu-id="52e2d-290">При вызове <xref:System.Windows.Input.ManipulationStartingEventArgs.Cancel%2A>события манипуляции больше не вызываются, а для сенсорного ввода возникают события мыши.</span><span class="sxs-lookup"><span data-stu-id="52e2d-290">When you call <xref:System.Windows.Input.ManipulationStartingEventArgs.Cancel%2A>, the manipulation events are no longer raised and mouse events occur for touch.</span></span> <span data-ttu-id="52e2d-291">В следующей таблице описывается связь между моментом отмены манипуляции и событиями мыши, которые происходят.</span><span class="sxs-lookup"><span data-stu-id="52e2d-291">The following table describes the relationship between the time the manipulation is canceled and the mouse events that occur.</span></span>

|<span data-ttu-id="52e2d-292">Событие, вызываемое отменой</span><span class="sxs-lookup"><span data-stu-id="52e2d-292">The event that Cancel is called in</span></span>|<span data-ttu-id="52e2d-293">События мыши, возникающие для ввода, который уже произошел</span><span class="sxs-lookup"><span data-stu-id="52e2d-293">The mouse events that occur for input that already occurred</span></span>|
|----------------------------------------|-----------------------------------------------------------------|
|<span data-ttu-id="52e2d-294"><xref:System.Windows.UIElement.ManipulationStarting> и <xref:System.Windows.UIElement.ManipulationStarted></span><span class="sxs-lookup"><span data-stu-id="52e2d-294"><xref:System.Windows.UIElement.ManipulationStarting> and <xref:System.Windows.UIElement.ManipulationStarted></span></span>|<span data-ttu-id="52e2d-295">События нажатия кнопки мыши.</span><span class="sxs-lookup"><span data-stu-id="52e2d-295">Mouse down events.</span></span>|
|<xref:System.Windows.UIElement.ManipulationDelta>|<span data-ttu-id="52e2d-296">События нажатия кнопки мыши и перемещения мыши.</span><span class="sxs-lookup"><span data-stu-id="52e2d-296">Mouse down and mouse move events.</span></span>|
|<span data-ttu-id="52e2d-297"><xref:System.Windows.UIElement.ManipulationInertiaStarting> и <xref:System.Windows.UIElement.ManipulationCompleted></span><span class="sxs-lookup"><span data-stu-id="52e2d-297"><xref:System.Windows.UIElement.ManipulationInertiaStarting> and <xref:System.Windows.UIElement.ManipulationCompleted></span></span>|<span data-ttu-id="52e2d-298">События нажатия кнопки мыши, перемещения мыши и отпускания кнопки мыши.</span><span class="sxs-lookup"><span data-stu-id="52e2d-298">Mouse down, mouse move, and mouse up events.</span></span>|

 <span data-ttu-id="52e2d-299">Обратите внимание, что при вызове <xref:System.Windows.Input.ManipulationStartingEventArgs.Cancel%2A>, когда манипуляция находится в инерции, метод возвращает `false` и входные данные не вызывают события мыши.</span><span class="sxs-lookup"><span data-stu-id="52e2d-299">Note that if you call <xref:System.Windows.Input.ManipulationStartingEventArgs.Cancel%2A> when the manipulation is in inertia, the method returns `false` and the input does not raise mouse events.</span></span>

### <a name="the-relationship-between-touch-and-manipulation-events"></a><span data-ttu-id="52e2d-300">Связь между событиями касания и событиями манипуляции</span><span class="sxs-lookup"><span data-stu-id="52e2d-300">The Relationship Between Touch and Manipulation Events</span></span>
 <span data-ttu-id="52e2d-301"><xref:System.Windows.UIElement> всегда может получить события касания.</span><span class="sxs-lookup"><span data-stu-id="52e2d-301">A <xref:System.Windows.UIElement> can always receive touch events.</span></span> <span data-ttu-id="52e2d-302">Если свойство <xref:System.Windows.UIElement.IsManipulationEnabled%2A> имеет значение `true`, <xref:System.Windows.UIElement> может принимать как события касания, так и манипуляции.</span><span class="sxs-lookup"><span data-stu-id="52e2d-302">When the <xref:System.Windows.UIElement.IsManipulationEnabled%2A> property is set to `true`, a <xref:System.Windows.UIElement> can receive both touch and manipulation events.</span></span>  <span data-ttu-id="52e2d-303">Если событие <xref:System.Windows.UIElement.TouchDown> не обрабатывается (т. е. свойство <xref:System.Windows.RoutedEventArgs.Handled%2A> имеет значение `false`), логика манипуляции захватывает касание элемента и создает события манипуляции.</span><span class="sxs-lookup"><span data-stu-id="52e2d-303">If the <xref:System.Windows.UIElement.TouchDown> event is not handled (that is, the <xref:System.Windows.RoutedEventArgs.Handled%2A> property is `false`), the manipulation logic captures the touch to the element and generates the manipulation events.</span></span> <span data-ttu-id="52e2d-304">Если свойство <xref:System.Windows.RoutedEventArgs.Handled%2A> имеет значение `true` в событии <xref:System.Windows.UIElement.TouchDown>, логика манипуляции не создает события манипуляции.</span><span class="sxs-lookup"><span data-stu-id="52e2d-304">If the <xref:System.Windows.RoutedEventArgs.Handled%2A> property is set to `true` in the <xref:System.Windows.UIElement.TouchDown> event, the manipulation logic does not generate manipulation events.</span></span> <span data-ttu-id="52e2d-305">На следующем рисунке показана связь между событиями касания и событиями манипуляции.</span><span class="sxs-lookup"><span data-stu-id="52e2d-305">The following illustration shows the relationship between touch events and manipulation events.</span></span>

 <span data-ttu-id="52e2d-306">![Отношение между событиями сенсорного ввода и манипуляции](./media/ndp-touchmanipulateevents.png "NDP_TouchManipulateEvents") событиями касания и манипуляции</span><span class="sxs-lookup"><span data-stu-id="52e2d-306">![Relationship between touch and manipulation events](./media/ndp-touchmanipulateevents.png "NDP_TouchManipulateEvents") Touch and manipulation events</span></span>

 <span data-ttu-id="52e2d-307">Следующий список описывает связь между событиями касания и манипуляции, показанными на предыдущем рисунке.</span><span class="sxs-lookup"><span data-stu-id="52e2d-307">The following list describes the relationship between the touch and manipulation events that is shown in the preceding illustration.</span></span>

- <span data-ttu-id="52e2d-308">Когда первое устройство сенсорного ввода создает событие <xref:System.Windows.UIElement.TouchDown> в <xref:System.Windows.UIElement>, логика манипуляции вызывает метод <xref:System.Windows.UIElement.CaptureTouch%2A>, который создает событие <xref:System.Windows.UIElement.GotTouchCapture>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-308">When the first touch device generates a <xref:System.Windows.UIElement.TouchDown> event on a <xref:System.Windows.UIElement>, the manipulation logic calls the <xref:System.Windows.UIElement.CaptureTouch%2A> method, which generates the <xref:System.Windows.UIElement.GotTouchCapture> event.</span></span>

- <span data-ttu-id="52e2d-309">Когда происходит <xref:System.Windows.UIElement.GotTouchCapture>, логика манипуляции вызывает метод <xref:System.Windows.Input.Manipulation.AddManipulator%2A?displayProperty=nameWithType>, который создает событие <xref:System.Windows.UIElement.ManipulationStarting>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-309">When the <xref:System.Windows.UIElement.GotTouchCapture> occurs, the manipulation logic calls the <xref:System.Windows.Input.Manipulation.AddManipulator%2A?displayProperty=nameWithType> method, which generates the <xref:System.Windows.UIElement.ManipulationStarting> event.</span></span>

- <span data-ttu-id="52e2d-310">При возникновении событий <xref:System.Windows.UIElement.TouchMove> логика операций создает события <xref:System.Windows.UIElement.ManipulationDelta>, происходящие перед событием <xref:System.Windows.UIElement.ManipulationInertiaStarting>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-310">When the <xref:System.Windows.UIElement.TouchMove> events occur, the manipulation logic generates the <xref:System.Windows.UIElement.ManipulationDelta> events that occur before the <xref:System.Windows.UIElement.ManipulationInertiaStarting> event.</span></span>

- <span data-ttu-id="52e2d-311">Когда Последнее устройство сенсорного ввода в элементе вызывает событие <xref:System.Windows.UIElement.TouchUp>, логика манипуляции создает событие <xref:System.Windows.UIElement.ManipulationInertiaStarting>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-311">When the last touch device on the element raises the <xref:System.Windows.UIElement.TouchUp> event, the manipulation logic generates the <xref:System.Windows.UIElement.ManipulationInertiaStarting> event.</span></span>

<a name="focus"></a>
## <a name="focus"></a><span data-ttu-id="52e2d-312">Фокус</span><span class="sxs-lookup"><span data-stu-id="52e2d-312">Focus</span></span>
 <span data-ttu-id="52e2d-313">Существует два основных понятия, относящихся к фокусу в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]: фокус клавиатуры и логический фокус.</span><span class="sxs-lookup"><span data-stu-id="52e2d-313">There are two main concepts that pertain to focus in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]: keyboard focus and logical focus.</span></span>

### <a name="keyboard-focus"></a><span data-ttu-id="52e2d-314">Фокус клавиатуры</span><span class="sxs-lookup"><span data-stu-id="52e2d-314">Keyboard Focus</span></span>
 <span data-ttu-id="52e2d-315">Фокус клавиатуры относится к элементу, получающему ввод с клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="52e2d-315">Keyboard focus refers to the element that is receiving keyboard input.</span></span>  <span data-ttu-id="52e2d-316">На всем рабочем столе может быть только один элемент, в котором находится фокус клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="52e2d-316">There can be only one element on the whole desktop that has keyboard focus.</span></span>  <span data-ttu-id="52e2d-317">В [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]элемент с фокусом клавиатуры будет иметь <xref:System.Windows.IInputElement.IsKeyboardFocused%2A> установлен в значение `true`.</span><span class="sxs-lookup"><span data-stu-id="52e2d-317">In [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], the element that has keyboard focus will have <xref:System.Windows.IInputElement.IsKeyboardFocused%2A> set to `true`.</span></span>  <span data-ttu-id="52e2d-318">Статический метод <xref:System.Windows.Input.Keyboard> <xref:System.Windows.Input.Keyboard.FocusedElement%2A> Возвращает элемент, который в данный момент имеет фокус клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="52e2d-318">The static <xref:System.Windows.Input.Keyboard> method <xref:System.Windows.Input.Keyboard.FocusedElement%2A> returns the element that currently has keyboard focus.</span></span>

 <span data-ttu-id="52e2d-319">Фокус клавиатуры можно получить, перейдя к элементу или щелкнув мышью определенные элементы, например <xref:System.Windows.Controls.TextBox>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-319">Keyboard focus can be obtained by tabbing to an element or by clicking the mouse on certain elements, such as a <xref:System.Windows.Controls.TextBox>.</span></span>  <span data-ttu-id="52e2d-320">Фокус клавиатуры можно также получить программно с помощью метода <xref:System.Windows.Input.Keyboard.Focus%2A> в классе <xref:System.Windows.Input.Keyboard>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-320">Keyboard focus can also be obtained programmatically by using the <xref:System.Windows.Input.Keyboard.Focus%2A> method on the <xref:System.Windows.Input.Keyboard> class.</span></span>  <span data-ttu-id="52e2d-321"><xref:System.Windows.Input.Keyboard.Focus%2A> пытается присвоить заданному элементу фокус клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="52e2d-321"><xref:System.Windows.Input.Keyboard.Focus%2A> attempts to give the specified element keyboard focus.</span></span>  <span data-ttu-id="52e2d-322">Элемент, возвращаемый <xref:System.Windows.Input.Keyboard.Focus%2A>, является элементом, который в данный момент имеет фокус клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="52e2d-322">The element returned by <xref:System.Windows.Input.Keyboard.Focus%2A> is the element that currently has keyboard focus.</span></span>

 <span data-ttu-id="52e2d-323">Чтобы элемент мог получить фокус клавиатуры, свойство <xref:System.Windows.UIElement.Focusable%2A> и свойства <xref:System.Windows.UIElement.IsVisible%2A> должны иметь значение **true**.</span><span class="sxs-lookup"><span data-stu-id="52e2d-323">In order for an element to obtain keyboard focus the <xref:System.Windows.UIElement.Focusable%2A> property and the <xref:System.Windows.UIElement.IsVisible%2A> properties must be set to **true**.</span></span>  <span data-ttu-id="52e2d-324">В некоторых классах, например <xref:System.Windows.Controls.Panel>, по умолчанию <xref:System.Windows.UIElement.Focusable%2A> задано значение `false`; Поэтому может потребоваться задать для этого свойства значение `true`, если требуется, чтобы элемент мог получить фокус.</span><span class="sxs-lookup"><span data-stu-id="52e2d-324">Some classes, such as <xref:System.Windows.Controls.Panel>, have <xref:System.Windows.UIElement.Focusable%2A> set to `false` by default; therefore, you may have to set this property to `true` if you want that element to be able to obtain focus.</span></span>

 <span data-ttu-id="52e2d-325">В следующем примере для установки фокуса клавиатуры на <xref:System.Windows.Controls.Button>используется <xref:System.Windows.Input.Keyboard.Focus%2A>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-325">The following example uses <xref:System.Windows.Input.Keyboard.Focus%2A> to set keyboard focus on a <xref:System.Windows.Controls.Button>.</span></span>  <span data-ttu-id="52e2d-326">Рекомендуемое место для установки начального фокуса в приложении находится в обработчике событий <xref:System.Windows.FrameworkElement.Loaded>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-326">The recommended place to set initial focus in an application is in the <xref:System.Windows.FrameworkElement.Loaded> event handler.</span></span>

 [!code-csharp[focussample#FocusSampleSetFocus](~/samples/snippets/csharp/VS_Snippets_Wpf/FocusSample/CSharp/Window1.xaml.cs#focussamplesetfocus)]
 [!code-vb[focussample#FocusSampleSetFocus](~/samples/snippets/visualbasic/VS_Snippets_Wpf/FocusSample/visualbasic/window1.xaml.vb#focussamplesetfocus)]

 <span data-ttu-id="52e2d-327">Дополнительные сведения о фокусе клавиатуры см. в разделе [Общие сведения о фокусе](focus-overview.md).</span><span class="sxs-lookup"><span data-stu-id="52e2d-327">For more information about keyboard focus, see [Focus Overview](focus-overview.md).</span></span>

### <a name="logical-focus"></a><span data-ttu-id="52e2d-328">Логический фокус</span><span class="sxs-lookup"><span data-stu-id="52e2d-328">Logical Focus</span></span>
 <span data-ttu-id="52e2d-329">Логический фокус относится к <xref:System.Windows.Input.FocusManager.FocusedElement%2A?displayProperty=nameWithType> в области фокуса.</span><span class="sxs-lookup"><span data-stu-id="52e2d-329">Logical focus refers to the <xref:System.Windows.Input.FocusManager.FocusedElement%2A?displayProperty=nameWithType> in a focus scope.</span></span>  <span data-ttu-id="52e2d-330">В приложении может быть несколько элементов, имеющих логический фокус, но в отдельной области фокуса может быть только один элемент, имеющий логический фокус.</span><span class="sxs-lookup"><span data-stu-id="52e2d-330">There can be multiple elements that have logical focus in an application, but there may only be one element that has logical focus in a particular focus scope.</span></span>

 <span data-ttu-id="52e2d-331">Область фокуса — это элемент-контейнер, который отслеживает <xref:System.Windows.Input.FocusManager.FocusedElement%2A> в его области.</span><span class="sxs-lookup"><span data-stu-id="52e2d-331">A focus scope is a container element that keeps track of the <xref:System.Windows.Input.FocusManager.FocusedElement%2A> within its scope.</span></span>  <span data-ttu-id="52e2d-332">Когда фокус покидает область фокуса, элемент с фокусом теряет фокус клавиатуры, но сохраняет логический фокус.</span><span class="sxs-lookup"><span data-stu-id="52e2d-332">When focus leaves a focus scope, the focused element will lose keyboard focus but will retain logical focus.</span></span>  <span data-ttu-id="52e2d-333">При возвращении фокуса в область фокуса элемент с логическим фокусом получит фокус клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="52e2d-333">When focus returns to the focus scope, the focused element will obtain keyboard focus.</span></span>  <span data-ttu-id="52e2d-334">Это позволяет переносить фокус клавиатуры между несколькими областями фокуса, но гарантирует, что элемент с фокусом в области фокуса останется элементом с фокусом, когда фокус вернется в эту область.</span><span class="sxs-lookup"><span data-stu-id="52e2d-334">This allows for keyboard focus to be changed between multiple focus scopes but insures that the focused element within the focus scope remains the focused element when focus returns.</span></span>

 <span data-ttu-id="52e2d-335">Элемент можно превратить в область фокуса в [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)], установив <xref:System.Windows.Input.FocusManager> присоединенного свойства <xref:System.Windows.Input.FocusManager.IsFocusScope%2A> `true`или в коде путем установки присоединенного свойства с помощью метода <xref:System.Windows.Input.FocusManager.SetIsFocusScope%2A>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-335">An element can be turned into a focus scope in [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] by setting the <xref:System.Windows.Input.FocusManager> attached property <xref:System.Windows.Input.FocusManager.IsFocusScope%2A> to `true`, or in code by setting the attached property by using the <xref:System.Windows.Input.FocusManager.SetIsFocusScope%2A> method.</span></span>

 <span data-ttu-id="52e2d-336">В следующем примере <xref:System.Windows.Controls.StackPanel>ся в область фокуса путем задания присоединенного свойства <xref:System.Windows.Input.FocusManager.IsFocusScope%2A>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-336">The following example makes a <xref:System.Windows.Controls.StackPanel> into a focus scope by setting the <xref:System.Windows.Input.FocusManager.IsFocusScope%2A> attached property.</span></span>

 [!code-xaml[MarkupSnippets#MarkupIsFocusScopeXAML](~/samples/snippets/csharp/VS_Snippets_Wpf/MarkupSnippets/CSharp/Window1.xaml#markupisfocusscopexaml)]

 [!code-csharp[FocusSnippets#FocusSetIsFocusScope](~/samples/snippets/csharp/VS_Snippets_Wpf/FocusSnippets/CSharp/Window1.xaml.cs#focussetisfocusscope)]
 [!code-vb[FocusSnippets#FocusSetIsFocusScope](~/samples/snippets/visualbasic/VS_Snippets_Wpf/FocusSnippets/visualbasic/window1.xaml.vb#focussetisfocusscope)]

 <span data-ttu-id="52e2d-337">К классам в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], которые являются областями фокуса по умолчанию, относятся <xref:System.Windows.Window>, <xref:System.Windows.Controls.Menu>, <xref:System.Windows.Controls.ToolBar>и <xref:System.Windows.Controls.ContextMenu>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-337">Classes in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] which are focus scopes by default are <xref:System.Windows.Window>, <xref:System.Windows.Controls.Menu>, <xref:System.Windows.Controls.ToolBar>, and <xref:System.Windows.Controls.ContextMenu>.</span></span>

 <span data-ttu-id="52e2d-338">Элемент, имеющий фокус клавиатуры, также будет иметь логический фокус для области фокуса, к которой он принадлежит. Поэтому установка фокуса на элемент с помощью метода <xref:System.Windows.Input.Keyboard.Focus%2A> в классе <xref:System.Windows.Input.Keyboard> или классах базового элемента попытается предоставить фокус клавиатуры элемента и логический фокус.</span><span class="sxs-lookup"><span data-stu-id="52e2d-338">An element that has keyboard focus will also have logical focus for the focus scope it belongs to; therefore, setting focus on an element with the <xref:System.Windows.Input.Keyboard.Focus%2A> method on the <xref:System.Windows.Input.Keyboard> class or the base element classes will attempt to give the element keyboard focus and logical focus.</span></span>

 <span data-ttu-id="52e2d-339">Чтобы определить элемент с фокусом в области фокуса, используйте <xref:System.Windows.Input.FocusManager.GetFocusedElement%2A>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-339">To determine the focused element in a focus scope, use <xref:System.Windows.Input.FocusManager.GetFocusedElement%2A>.</span></span> <span data-ttu-id="52e2d-340">Чтобы изменить элемент с фокусом для области фокусировки, используйте <xref:System.Windows.Input.FocusManager.SetFocusedElement%2A>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-340">To change the focused element for a focus scope, use <xref:System.Windows.Input.FocusManager.SetFocusedElement%2A>.</span></span>

 <span data-ttu-id="52e2d-341">Дополнительные сведения о логическом фокусе см. в разделе [Общие сведения о фокусе](focus-overview.md).</span><span class="sxs-lookup"><span data-stu-id="52e2d-341">For more information about logical focus, see [Focus Overview](focus-overview.md).</span></span>

<a name="mouse_position"></a>
## <a name="mouse-position"></a><span data-ttu-id="52e2d-342">Положение мыши</span><span class="sxs-lookup"><span data-stu-id="52e2d-342">Mouse Position</span></span>
 <span data-ttu-id="52e2d-343">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] входной API предоставляет полезную информацию относительно координатных пространств.</span><span class="sxs-lookup"><span data-stu-id="52e2d-343">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] input API provides helpful information with regard to coordinate spaces.</span></span>  <span data-ttu-id="52e2d-344">Например, координата `(0,0)` является верхней левой координатой, но какого элемента в дереве?</span><span class="sxs-lookup"><span data-stu-id="52e2d-344">For example, coordinate `(0,0)` is the upper-left coordinate, but the upper-left of which element in the tree?</span></span> <span data-ttu-id="52e2d-345">Элемента, который является целевым объектом ввода?</span><span class="sxs-lookup"><span data-stu-id="52e2d-345">The element that is the input target?</span></span> <span data-ttu-id="52e2d-346">Элемента, к которому присоединен обработчик событий?</span><span class="sxs-lookup"><span data-stu-id="52e2d-346">The element you attached your event handler to?</span></span> <span data-ttu-id="52e2d-347">Или какого-нибудь другого элемента?</span><span class="sxs-lookup"><span data-stu-id="52e2d-347">Or something else?</span></span> <span data-ttu-id="52e2d-348">Чтобы избежать путаницы, при работе с координатами, полученными с помощью мыши, необходимо указать рамку ссылки в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] API ввода.</span><span class="sxs-lookup"><span data-stu-id="52e2d-348">To avoid confusion, the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] input API requires that you specify your frame of reference when you work with coordinates obtained through the mouse.</span></span> <span data-ttu-id="52e2d-349">Метод <xref:System.Windows.Input.Mouse.GetPosition%2A> Возвращает координату указателя мыши относительно указанного элемента.</span><span class="sxs-lookup"><span data-stu-id="52e2d-349">The <xref:System.Windows.Input.Mouse.GetPosition%2A> method returns the coordinate of the mouse pointer relative to the specified element.</span></span>

<a name="mouse_capture"></a>
## <a name="mouse-capture"></a><span data-ttu-id="52e2d-350">Захват мыши</span><span class="sxs-lookup"><span data-stu-id="52e2d-350">Mouse Capture</span></span>
 <span data-ttu-id="52e2d-351">Устройства мыши специально поддерживают модальную характеристику, которая называется захватом мыши.</span><span class="sxs-lookup"><span data-stu-id="52e2d-351">Mouse devices specifically hold a modal characteristic known as mouse capture.</span></span> <span data-ttu-id="52e2d-352">Захват мыши используется для поддержания промежуточного состояния ввода при запуске операции перетаскивания, так что другие операции, связанные с номинальным положением указателя мыши на экране указателя мыши, не всегда происходят.</span><span class="sxs-lookup"><span data-stu-id="52e2d-352">Mouse capture is used to maintain a transitional input state when a drag-and-drop operation is started, so that other operations involving the nominal on-screen position of the mouse pointer do not necessarily occur.</span></span> <span data-ttu-id="52e2d-353">Во время перетаскивания пользователь не может щелкнуть мышью без прерывания операции перетаскивания, что делает большинство указаний мыши нецелесообразными, пока захват мыши удерживается источником перетаскивания.</span><span class="sxs-lookup"><span data-stu-id="52e2d-353">During the drag, the user cannot click without aborting the drag-and-drop, which makes most mouseover cues inappropriate while the mouse capture is held by the drag origin.</span></span> <span data-ttu-id="52e2d-354">Входная система предоставляет интерфейсы API, которые могут определять состояние захвата мыши, а также интерфейсы API, которые могут принудительно захватывать мышь для определенного элемента или очищать состояние захвата мыши.</span><span class="sxs-lookup"><span data-stu-id="52e2d-354">The input system exposes APIs that can determine mouse capture state, as well as APIs that can force mouse capture to a specific element, or clear mouse capture state.</span></span> <span data-ttu-id="52e2d-355">Дополнительные сведения об операциях перетаскивания см. в разделе [Общие сведения о перетаскивании](drag-and-drop-overview.md).</span><span class="sxs-lookup"><span data-stu-id="52e2d-355">For more information on drag-and-drop operations, see [Drag and Drop Overview](drag-and-drop-overview.md).</span></span>

<a name="commands"></a>
## <a name="commands"></a><span data-ttu-id="52e2d-356">Команды</span><span class="sxs-lookup"><span data-stu-id="52e2d-356">Commands</span></span>
 <span data-ttu-id="52e2d-357">Команды позволяют обрабатывать входные данные на более семантическом уровне по сравнению с устройствами ввода.</span><span class="sxs-lookup"><span data-stu-id="52e2d-357">Commands enable input handling at a more semantic level than device input.</span></span>  <span data-ttu-id="52e2d-358">Команды — это простые директивы, такие как `Cut`, `Copy`, `Paste` или `Open`.</span><span class="sxs-lookup"><span data-stu-id="52e2d-358">Commands are simple directives, such as `Cut`, `Copy`, `Paste`, or `Open`.</span></span>  <span data-ttu-id="52e2d-359">Команды удобно использовать для централизации командной логики.</span><span class="sxs-lookup"><span data-stu-id="52e2d-359">Commands are useful for centralizing your command logic.</span></span>  <span data-ttu-id="52e2d-360">Эту же команду можно получить из <xref:System.Windows.Controls.Menu>, на <xref:System.Windows.Controls.ToolBar>или с помощью сочетания клавиш.</span><span class="sxs-lookup"><span data-stu-id="52e2d-360">The same command might be accessed from a <xref:System.Windows.Controls.Menu>, on a <xref:System.Windows.Controls.ToolBar>, or through a keyboard shortcut.</span></span> <span data-ttu-id="52e2d-361">Команды также предоставляют механизм для отключения элементов управления, когда команда становится недоступной.</span><span class="sxs-lookup"><span data-stu-id="52e2d-361">Commands also provide a mechanism for disabling controls when the command becomes unavailable.</span></span>

 <span data-ttu-id="52e2d-362"><xref:System.Windows.Input.RoutedCommand> — это [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] реализация <xref:System.Windows.Input.ICommand>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-362"><xref:System.Windows.Input.RoutedCommand> is the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] implementation of <xref:System.Windows.Input.ICommand>.</span></span>  <span data-ttu-id="52e2d-363">При выполнении <xref:System.Windows.Input.RoutedCommand> на целевом объекте команды вызывается <xref:System.Windows.Input.CommandManager.PreviewExecuted> и событие <xref:System.Windows.Input.CommandManager.Executed>, которые проходят и пузырьковые по дереву элементов, как и другие входные данные.</span><span class="sxs-lookup"><span data-stu-id="52e2d-363">When a <xref:System.Windows.Input.RoutedCommand> is executed, a <xref:System.Windows.Input.CommandManager.PreviewExecuted> and an <xref:System.Windows.Input.CommandManager.Executed> event are raised on the command target, which tunnel and bubble through the element tree like other input.</span></span>  <span data-ttu-id="52e2d-364">Если целевой объект команды не задан, в качестве целевого объекта будет использоваться элемент с фокусом клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="52e2d-364">If a command target is not set, the element with keyboard focus will be the command target.</span></span>  <span data-ttu-id="52e2d-365">Логика, которая выполняет команду, присоединяется к <xref:System.Windows.Input.CommandBinding>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-365">The logic that performs the command is attached to a <xref:System.Windows.Input.CommandBinding>.</span></span>  <span data-ttu-id="52e2d-366">Когда <xref:System.Windows.Input.CommandManager.Executed> событие достигает <xref:System.Windows.Input.CommandBinding> для данной команды, вызывается <xref:System.Windows.Input.ExecutedRoutedEventHandler> <xref:System.Windows.Input.CommandBinding>.</span><span class="sxs-lookup"><span data-stu-id="52e2d-366">When an <xref:System.Windows.Input.CommandManager.Executed> event reaches a <xref:System.Windows.Input.CommandBinding> for that specific command, the <xref:System.Windows.Input.ExecutedRoutedEventHandler> on the <xref:System.Windows.Input.CommandBinding> is called.</span></span>  <span data-ttu-id="52e2d-367">Этот обработчик выполняет действие команды.</span><span class="sxs-lookup"><span data-stu-id="52e2d-367">This handler performs the action of the command.</span></span>

 <span data-ttu-id="52e2d-368">Дополнительные сведения о системе команд см. в разделе [Общие сведения о системе команд](commanding-overview.md).</span><span class="sxs-lookup"><span data-stu-id="52e2d-368">For more information on commanding, see [Commanding Overview](commanding-overview.md).</span></span>

 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="52e2d-369">предоставляет библиотеку общих команд, которая состоит из <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Input.ComponentCommands>, <xref:System.Windows.Input.NavigationCommands>и <xref:System.Windows.Documents.EditingCommands>или можно определить самостоятельно.</span><span class="sxs-lookup"><span data-stu-id="52e2d-369">provides a library of common commands which consists of <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Input.ComponentCommands>, <xref:System.Windows.Input.NavigationCommands>, and <xref:System.Windows.Documents.EditingCommands>, or you can define your own.</span></span>

 <span data-ttu-id="52e2d-370">В следующем примере показано, как настроить <xref:System.Windows.Controls.MenuItem> таким образом, что при нажатии он вызовет команду <xref:System.Windows.Input.ApplicationCommands.Paste%2A> на <xref:System.Windows.Controls.TextBox>, предполагая, что <xref:System.Windows.Controls.TextBox> имеет фокус клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="52e2d-370">The following example shows how to set up a <xref:System.Windows.Controls.MenuItem> so that when it is clicked it will invoke the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command on the <xref:System.Windows.Controls.TextBox>, assuming the <xref:System.Windows.Controls.TextBox> has keyboard focus.</span></span>

 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewSimpleCommand](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewsimplecommand)]

 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](~/samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcommandtargetcodebehind)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcommandtargetcodebehind)]

 <span data-ttu-id="52e2d-371">Дополнительные сведения о командах в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] см. в разделе [Общие сведения о системе команд](commanding-overview.md).</span><span class="sxs-lookup"><span data-stu-id="52e2d-371">For more information about commands in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Commanding Overview](commanding-overview.md).</span></span>

<a name="the_input_system_and_base_elements"></a>
## <a name="the-input-system-and-base-elements"></a><span data-ttu-id="52e2d-372">Система ввода и базовые элементы</span><span class="sxs-lookup"><span data-stu-id="52e2d-372">The Input System and Base Elements</span></span>
 <span data-ttu-id="52e2d-373">Входные события, такие как вложенные события, определенные классами <xref:System.Windows.Input.Mouse>, <xref:System.Windows.Input.Keyboard>и <xref:System.Windows.Input.Stylus>, вызываются входной системой и вставляются в определенную точку объектной модели на основе проверки попадания визуального дерева во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="52e2d-373">Input events such as the attached events defined by the <xref:System.Windows.Input.Mouse>, <xref:System.Windows.Input.Keyboard>, and <xref:System.Windows.Input.Stylus> classes are raised by the input system and injected into a particular position in the object model based on hit testing the visual tree at run time.</span></span>

 <span data-ttu-id="52e2d-374">Каждое из событий, которые <xref:System.Windows.Input.Mouse>, <xref:System.Windows.Input.Keyboard>и <xref:System.Windows.Input.Stylus> определяются как вложенные события, также повторно предоставляются классами базовых элементов <xref:System.Windows.UIElement> и <xref:System.Windows.ContentElement> в качестве нового перенаправленного события.</span><span class="sxs-lookup"><span data-stu-id="52e2d-374">Each of the events that <xref:System.Windows.Input.Mouse>, <xref:System.Windows.Input.Keyboard>, and <xref:System.Windows.Input.Stylus> define as an attached event is also re-exposed by the base element classes <xref:System.Windows.UIElement> and <xref:System.Windows.ContentElement> as a new routed event.</span></span> <span data-ttu-id="52e2d-375">Перенаправленные события базовых элементов создаются классами, обрабатывающими исходное присоединенное событие и повторно использующими данные события.</span><span class="sxs-lookup"><span data-stu-id="52e2d-375">The base element routed events are generated by classes handling the original attached event and reusing the event data.</span></span>

 <span data-ttu-id="52e2d-376">Когда событие ввода становится связанным с определенным исходным элементом через реализацию события ввода его базового элемента, оно может перенаправляться через оставшуюся часть маршрута события, основанного на комбинации объектов логического и визуального дерева, и обрабатываться кодом приложения.</span><span class="sxs-lookup"><span data-stu-id="52e2d-376">When the input event becomes associated with a particular source element through its base element input event implementation, it can be routed through the remainder of an event route that is based on a combination of logical and visual tree objects, and be handled by application code.</span></span>  <span data-ttu-id="52e2d-377">Как правило, удобнее обрабатывайте эти события ввода, связанные с устройствами, с помощью перенаправленных событий <xref:System.Windows.UIElement> и <xref:System.Windows.ContentElement>, так как в [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] и в коде можно использовать более интуитивно понятный синтаксис обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="52e2d-377">Generally, it is more convenient to handle these device-related input events using the routed events on <xref:System.Windows.UIElement> and <xref:System.Windows.ContentElement>, because you can use more intuitive event handler syntax both in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] and in code.</span></span> <span data-ttu-id="52e2d-378">Вместо этого можно обрабатывать присоединенное событие, инициированное процессом, но это сопряжено с некоторыми проблемами: присоединенное событие может быть отмечено как обработанное обработчиком класса базовых элементов класса и придется использовать методы доступа вместо действительного синтаксиса событий, чтобы подключить обработчики для присоединенных событий.</span><span class="sxs-lookup"><span data-stu-id="52e2d-378">You could choose to handle the attached event that initiated the process instead, but you would face several issues: the attached event may be marked handled by the base element class handling, and you need to use accessor methods rather than true event syntax in order to attach handlers for attached events.</span></span>

<a name="whats_next"></a>
## <a name="whats-next"></a><span data-ttu-id="52e2d-379">Дальнейшая работа</span><span class="sxs-lookup"><span data-stu-id="52e2d-379">What's Next</span></span>
 <span data-ttu-id="52e2d-380">Теперь вам известно несколько методов обработки ввода в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="52e2d-380">You now have several techniques to handle input in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span>  <span data-ttu-id="52e2d-381">Вы также должны лучше понимать разные типы событий ввода и механизмы перенаправленных событий, используемые в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="52e2d-381">You should also have an improved understanding of the various types of input events and the routed event mechanisms used by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span>

 <span data-ttu-id="52e2d-382">Доступны дополнительные ресурсы, в которых более подробно разъясняются элементы инфраструктуры [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] и маршрутизация событий.</span><span class="sxs-lookup"><span data-stu-id="52e2d-382">Additional resources are available that explain [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] framework elements and event routing in more detail.</span></span> <span data-ttu-id="52e2d-383">Дополнительные сведения см. в следующих обзорах: [Общие сведения о командах](commanding-overview.md), [Общие сведения о фокусе](focus-overview.md), [Общие сведения о базовых элементах](base-elements-overview.md), [Деревья в WPF](trees-in-wpf.md) и [Общие сведения о перенаправленных событиях](routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="52e2d-383">See the following overviews for more information, [Commanding Overview](commanding-overview.md), [Focus Overview](focus-overview.md), [Base Elements Overview](base-elements-overview.md), [Trees in WPF](trees-in-wpf.md), and [Routed Events Overview](routed-events-overview.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="52e2d-384">См. также:</span><span class="sxs-lookup"><span data-stu-id="52e2d-384">See also</span></span>

- [<span data-ttu-id="52e2d-385">Общие сведения о фокусе</span><span class="sxs-lookup"><span data-stu-id="52e2d-385">Focus Overview</span></span>](focus-overview.md)
- [<span data-ttu-id="52e2d-386">Общие сведения о системе команд</span><span class="sxs-lookup"><span data-stu-id="52e2d-386">Commanding Overview</span></span>](commanding-overview.md)
- [<span data-ttu-id="52e2d-387">Общие сведения о перенаправленных событиях</span><span class="sxs-lookup"><span data-stu-id="52e2d-387">Routed Events Overview</span></span>](routed-events-overview.md)
- [<span data-ttu-id="52e2d-388">Общие сведения о базовых элементах</span><span class="sxs-lookup"><span data-stu-id="52e2d-388">Base Elements Overview</span></span>](base-elements-overview.md)
- [<span data-ttu-id="52e2d-389">Свойства</span><span class="sxs-lookup"><span data-stu-id="52e2d-389">Properties</span></span>](properties-wpf.md)
