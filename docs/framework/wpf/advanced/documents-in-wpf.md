---
title: Документы в WPF
ms.date: 03/30/2017
helpviewer_keywords:
- documents [WPF], packaging
- documents [WPF], text layout
- documents [WPF], XPS
- 'XPS documents [WPF], , '
- documents [WPF], controls
- documents [WPF], types of
- documents [WPF], browser-viewable
ms.assetid: 6e8db7bc-050a-4070-aa72-bb8c46e87ff8
ms.openlocfilehash: fbd4df8820073a3cdf2a8d5aad9c56bd7ca751df
ms.sourcegitcommit: 944ddc52b7f2632f30c668815f92b378efd38eea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/03/2019
ms.locfileid: "73460528"
---
# <a name="documents-in-wpf"></a>Документы в WPF
[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] предлагает широкий спектр возможностей документов, позволяющих создавать высокоточные материалы, которые упрощают доступ и чтение, чем в предыдущих поколениях Windows. В дополнение к расширенным возможностям и повышенному качеству [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] предоставляет интегрированные службы для отображения, упаковки и обеспечения безопасности документов. В этом разделе содержатся вводные сведения о типах и упаковке документов [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].  

<a name="types_of_documents"></a>   
## <a name="types-of-documents"></a>Типы документов  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] разделяет документы на две основные категории на основе их предполагаемого использования; эти категории документов называются "документы фиксированного формата" и "документы нефиксированного формата".  
  
 Фиксированные документы предназначены для приложений, для которых требуется точное представление о том, что вы получаете (WYSIWYG), независимо от используемого дисплея или принтера. Документы фиксированного формата используются в компьютерной верстке, текстовой обработке и макетах форм, где строгое соответствие дизайну исходной страницы имеет критическое значение. При использовании такого макета документ фиксированного формата сохраняет точное расположение элементов содержимого независимо от используемого устройства изображения или печати. Так, страница документа фиксированного формата, отображаемая на дисплее 96 точек на дюйм, будет совершенно одинаково отображаться на лазерном принтере 600 точек на дюйм и фотонаборной машине 4800 точек на дюйм. Макет страницы остается неизменным во всех случаях, хотя качество документа повышается с учетом возможностей устройства.  
  
 Для сравнения: документы нефиксированного формата предназначены для повышения удобства просмотра и чтения; их лучше всего использовать, когда в работе с документом важнее всего удобство чтения. Вместо того чтобы использовать какой-либо определенный макет, документы нефиксированного формата динамически корректируют и перемещают содержимое с учетом переменных времени выполнения, таких как размер окна, разрешение устройства и дополнительные пользовательские настройки. Веб-страница — это простой пример документа нефиксированного формата, содержимое на которой динамически форматируется, чтобы уместиться в окне. Документы нефиксированного формата оптимизируют просмотр и чтение для пользователя в зависимости от среды выполнения. Например, один и тот же документ нефиксированного формата будет динамически переформатирован, чтобы обеспечить оптимальную читаемость на дисплее высокого разрешения 19 дюймов или небольшом экране PDA размером 2 x 3 дюйма. Кроме того, документы нефиксированного формата имеют несколько встроенных возможностей, включая поиск, режимы просмотра, оптимизирующие читаемость, и возможность менять размер и внешний вид шрифта.  См. иллюстрации, примеры и подробное описание документов нефиксированного формата в разделе [Общие сведения о документах нефиксированного формата](flow-document-overview.md).  
  
<a name="document_viewer"></a>   
## <a name="document-controls-and-text-layout"></a>Элементы управления документами и макеты текста  
 .NET Framework предоставляет набор предварительно созданных элементов управления, упрощающих использование фиксированных документов, документов нефиксированного формата и общего текста в приложении.  Отображение фиксированного содержимого документа поддерживается с помощью элемента управления <xref:System.Windows.Controls.DocumentViewer>.  Отображение содержимого документа нефиксированного формата поддерживается тремя различными элементами управления: <xref:System.Windows.Controls.FlowDocumentReader>, <xref:System.Windows.Controls.FlowDocumentPageViewer>и <xref:System.Windows.Controls.FlowDocumentScrollViewer>, которые сопоставляются с различными пользовательскими сценариями (см. разделы ниже).  Другие элементы управления [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] предоставляют упрощенную разметку для стандартных способов использования текста (см. раздел [Текст в пользовательском интерфейсе](#text_in_the_user_interface) ниже).  
  
### <a name="fixed-document-control---documentviewer"></a>Элемент управления документом фиксированного формата DocumentViewer  
 Элемент управления <xref:System.Windows.Controls.DocumentViewer> предназначен для вывода <xref:System.Windows.Documents.FixedDocument> содержимого. Элемент управления <xref:System.Windows.Controls.DocumentViewer> предоставляет интуитивно понятный пользовательский интерфейс, который предоставляет встроенную поддержку для стандартных операций, включая вывод вывода на печать, копирование в буфер обмена, масштаб и функции поиска текста. Элемент управления предоставляет доступ к страницам содержимого через знакомый механизм прокрутки. Как и все элементы управления [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], <xref:System.Windows.Controls.DocumentViewer> поддерживает полную или частичную переопределение стиля, что позволяет визуально интегрировать элемент управления в практически любое приложение или среду.  
  
 <xref:System.Windows.Controls.DocumentViewer> предназначен для вывода содержимого в режиме только для чтения; изменение или изменение содержимого недоступно и не поддерживается.  
  
<a name="flow_document"></a>   
### <a name="flow-document-controls"></a>Элементы управления документа нефиксированного формата  

> [!NOTE]
> Более подробные сведения о возможностях документов нефиксированного формата и способах их создания см. в разделе [Общие сведения о потоковых документах](flow-document-overview.md).  
  
 Отображение содержимого документа нефиксированного формата поддерживается тремя элементами управления: <xref:System.Windows.Controls.FlowDocumentReader>, <xref:System.Windows.Controls.FlowDocumentPageViewer>и <xref:System.Windows.Controls.FlowDocumentScrollViewer>.  
  
#### <a name="flowdocumentreader"></a>FlowDocumentReader  
 <xref:System.Windows.Controls.FlowDocumentReader> включает функции, позволяющие пользователю динамически выбирать между различными режимами просмотра, в том числе одностраничным (страничным) режимом просмотра, двумя страницами (формат чтения книги) и непрерывной прокруткой (без нижних колонтитулов). режим просмотра.  Дополнительные сведения об этих режимах просмотра см. в разделе <xref:System.Windows.Controls.FlowDocumentReaderViewingMode>.  Если не требуется возможность динамического переключения между разными режимами просмотра, <xref:System.Windows.Controls.FlowDocumentPageViewer> и <xref:System.Windows.Controls.FlowDocumentScrollViewer> предоставляют более легкие средства просмотра содержимого потока, которые исправлены в определенном режиме просмотра.  
  
#### <a name="flowdocumentpageviewer-and-flowdocumentscrollviewer"></a>FlowDocumentPageViewer и FlowDocumentScrollViewer  
 <xref:System.Windows.Controls.FlowDocumentPageViewer> отображает содержимое в режиме просмотра на странице, в то время как <xref:System.Windows.Controls.FlowDocumentScrollViewer> отображает содержимое в режиме непрерывной прокрутки.  <xref:System.Windows.Controls.FlowDocumentPageViewer> и <xref:System.Windows.Controls.FlowDocumentScrollViewer> фиксированы в определенном режиме просмотра. Сравните с <xref:System.Windows.Controls.FlowDocumentReader>, который включает в себя функции, позволяющие пользователю динамически выбирать между различными режимами просмотра (в соответствии с перечислением <xref:System.Windows.Controls.FlowDocumentReaderViewingMode>) за счет более ресурсоемких ресурсов, чем <xref:System.Windows.Controls.FlowDocumentPageViewer> или <xref:System.Windows.Controls.FlowDocumentScrollViewer>.  
  
 По умолчанию вертикальная полоса прокрутки отображается всегда, а горизонтальная полоса прокрутки становится видимой при необходимости. [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] по умолчанию для <xref:System.Windows.Controls.FlowDocumentScrollViewer> не содержит панель инструментов. Однако свойство <xref:System.Windows.Controls.FlowDocumentScrollViewer.IsToolBarVisible%2A> можно использовать для включения встроенной панели инструментов.  
  
<a name="text_in_the_user_interface"></a>   
### <a name="text-in-the-user-interface"></a>Текст в пользовательском интерфейсе  
 Текст можно добавлять не только в документы, но и использовать в интерфейсе приложений, например в формах. В [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] имеется множество элементов управления для рисования текста на экране. Каждый элемент управления предназначен для различных сценариев и имеет свой собственный список функций и ограничений. Как правило, элемент <xref:System.Windows.Controls.TextBlock> следует использовать, если требуется ограниченная поддержка текста, например краткое предложение в [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]. <xref:System.Windows.Controls.Label> можно использовать, если требуется минимальная поддержка текста. Дополнительные сведения см. в разделе [Общие сведения о классе TextBlock](../controls/textblock-overview.md).  
  
<a name="packaging"></a>   
## <a name="document-packaging"></a>Упаковка документов  
 <xref:System.IO.Packaging> интерфейсы API предоставляют эффективные средства для организации данных приложений, содержимого документов и связанных ресурсов в одном контейнере, который прост в доступе, переносимости и простоте распространения. ZIP-файл — это пример типа <xref:System.IO.Packaging.Package>, способного удерживать несколько объектов как единое целое. API упаковки предоставляют реализацию <xref:System.IO.Packaging.ZipPackage> по умолчанию, разработанную с использованием стандарта Open Packaging Conventions с архитектурой XML и ZIP-файла. Интерфейсы API упаковки [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] позволяют легко создавать пакеты, а также хранить и получать доступ к объектам в них. Объект, хранящийся в <xref:System.IO.Packaging.Package>, называется <xref:System.IO.Packaging.PackagePart> ("часть"). Пакеты также могут включать подписанные цифровые сертификаты, с помощью которых можно идентифицировать создателя части и убедиться, что содержимое пакета не было изменено.  Пакеты также содержат функцию <xref:System.IO.Packaging.PackageRelationship>, которая позволяет добавлять дополнительные сведения в пакет или связывать их с конкретными частями без фактического изменения содержимого существующих частей.  Службы пакетов также поддерживают Microsoft Windows Rights Management (RM).  
  
 Архитектура пакета [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] лежит в основе ряда ключевых технологий:  
  
- Документы XPS, которые соответствует спецификации формата XML (XPS).  
  
- Документы открытого XML-формата Microsoft Office "12" (.docx).  
  
- Пользовательские форматы хранения для собственного приложения.  
  
 На основе API-интерфейсов упаковки <xref:System.Windows.Xps.Packaging.XpsDocument> специально предназначен для хранения [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] фиксированных документов с содержимым. <xref:System.Windows.Xps.Packaging.XpsDocument> — это автономный документ, который может быть открыт в средстве просмотра, отображен в элементе управления <xref:System.Windows.Controls.DocumentViewer>, направляется в очередь печати или выводится непосредственно на принтер, совместимый с XPS.  
  
 Следующие разделы содержат дополнительные сведения о <xref:System.IO.Packaging.Package> и <xref:System.Windows.Xps.Packaging.XpsDocument> API-интерфейсах, предоставляемых [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].  
  
<a name="packages"></a>   
### <a name="package-components"></a>Компоненты пакета  
 Интерфейсы API упаковки [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] позволяют упорядочить данные и документы приложения в единый портативный блок. ZIP-файл является одним из наиболее распространенных типов пакетов и типом пакета по умолчанию, предоставляемым [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].  <xref:System.IO.Packaging.Package> сам по себе является абстрактным классом, из которого <xref:System.IO.Packaging.ZipPackage> реализуется с помощью архитектуры Open Standard XML и ZIP-файла.  Метод <xref:System.IO.Packaging.Package.Open%2A> использует <xref:System.IO.Packaging.ZipPackage> для создания и использования ZIP-файлов по умолчанию. Пакет может содержать три основных типа элементов:  
  
|||  
|-|-|  
|<xref:System.IO.Packaging.PackagePart>|Содержимое приложения, данные, документы и файлы ресурсов.|  
|<xref:System.IO.Packaging.PackageDigitalSignature>|[Сертификат X.509] для идентификации, аутентификации и проверки.|  
|<xref:System.IO.Packaging.PackageRelationship>|Добавленные сведения о пакете или определенной части.|  
  
<a name="PackageParts"></a>   
#### <a name="packageparts"></a>PackageParts  
 <xref:System.IO.Packaging.PackagePart> ("часть") — это абстрактный класс, который ссылается на объект, хранящийся в <xref:System.IO.Packaging.Package>. В ZIP-файле части пакета соответствуют отдельным файлам, хранящимся в ZIP-файле.  <xref:System.IO.Packaging.ZipPackagePart> предоставляет реализацию по умолчанию для сериализуемых объектов, хранящихся в <xref:System.IO.Packaging.ZipPackage>.  Как и в файловой системе, части, которые содержатся в пакете, хранятся в иерархическом каталоге или организованы по папкам.  С помощью API упаковки [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] приложения могут записывать, хранить и считывать несколько <xref:System.IO.Packaging.PackagePart> объектов с помощью одного контейнера ZIP-файлов.  
  
<a name="PackageDigitalSignatures"></a>   
#### <a name="packagedigitalsignatures"></a>PackageDigitalSignatures  
 В целях безопасности <xref:System.IO.Packaging.PackageDigitalSignature> ("Цифровая подпись") может быть связан с частями внутри пакета. <xref:System.IO.Packaging.PackageDigitalSignature> включает [509], который предоставляет два компонента:  
  
1. Идентификация и проверка подлинности создателя части.  
  
2. Проверка, не была ли часть изменена.  
  
 Цифровая подпись не защищает часть от изменения, но проверка цифровой подписи завершится ошибкой, если часть изменяется каким-либо образом. В таком случае приложение может предпринять соответствующие действия, например не допустить открытия части или уведомить пользователя об изменении (и, следовательно, ненадежности) части.  
  
<a name="PackageRelationships"></a>   
#### <a name="packagerelationships"></a>PackageRelationships  
 <xref:System.IO.Packaging.PackageRelationship> ("связь") предоставляет механизм для связывания дополнительных сведений с пакетом или частью в пакете. Отношение — это возможность на уровне пакета, позволяющая связывать дополнительную информацию с частью, не меняя фактического содержимого части. Вставлять новые данные непосредственно в содержимое части, как правило, нецелесообразно:  
  
- Фактический тип части и схема содержимого неизвестны.  
  
- Даже если эти параметры известны, схема содержимого может не обеспечивать средства для добавления новых данных.  
  
- Часть может быть защищена от изменений цифровой подписью или шифрованием.  
  
 Отношения пакета предоставляют видимые средства добавления дополнительной информации в отдельные части или весь пакет и создания соответствующих связей между этой информацией и объектами. Отношения пакетов используются для решения двух основных задач:  
  
1. Определение отношений зависимости между частями.  
  
2. Определение информационных отношений, добавляющих примечания или другие данные, связанные с частью.  
  
 <xref:System.IO.Packaging.PackageRelationship> предоставляет быстрые, обнаруживаемые средства для определения зависимостей и добавления других сведений, связанных с частью пакета или пакета в целом.  
  
<a name="Dependency_Relationships"></a>   
##### <a name="dependency-relationships"></a>Отношения зависимости  
 Отношения зависимости используются для описания зависимостей между частями. Например, пакет может содержать HTML-часть, которая включает один или несколько тегов изображений \<img>. Теги изображений относятся к изображениям, которые хранятся как части внутри пакета или вне его (например, части, доступные через Интернет). Создание <xref:System.IO.Packaging.PackageRelationship>, связанного с файлом HTML, позволяет быстро и легко обнаружить зависимые ресурсы и получить к ним доступ. Браузер или приложение средства просмотра может осуществлять прямой доступ к отношениям частей и сразу приступать к сборке зависимых ресурсов, даже не зная схемы и не выполняя синтаксического анализа документа.  
  
<a name="Information_Relationships"></a>   
##### <a name="information-relationships"></a>Информационные отношения  
 Аналогично заметке или заметке можно также использовать <xref:System.IO.Packaging.PackageRelationship> для хранения других типов данных, которые должны быть связаны с частью, не требуя фактического изменения самого содержимого части.  
  
<a name="XPS_Documents"></a>   
## <a name="xps-documents"></a>XPS-документы  
 Документ в формате XPS — это пакет, содержащий один или несколько фиксированных документов вместе со всеми ресурсами и сведениями, необходимыми для подготовки к просмотру.  XPS также представляет собой собственный [!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)] формат файла очереди печати.  <xref:System.Windows.Xps.Packaging.XpsDocument> хранится в стандартном наборе данных ZIP и может включать в себя сочетание XML-и двоичных компонентов, таких как файлы изображений и шрифтов. [PackageRelationships](#PackageRelationships) используются для определения зависимостей между содержимым и ресурсами, необходимыми для полного отображения документа.  <xref:System.Windows.Xps.Packaging.XpsDocument>ная структура предоставляет единое высококачественное решение для документов, которое поддерживает несколько целей:  
  
- Чтение, запись и хранение содержимого и ресурсов документов фиксированного формата в одном портативном документе с возможностью удобного распространения.  
  
- Отображение документов с помощью приложения средства просмотра XPS.  
  
- Вывод документов в собственном формате вывода в очередь на печать [!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)].  
  
- Маршрутизация документов непосредственно на совместимый с XPS принтер.  
  
## <a name="see-also"></a>См. также

- <xref:System.Windows.Documents.FixedDocument>
- <xref:System.Windows.Documents.FlowDocument>
- <xref:System.Windows.Xps.Packaging.XpsDocument>
- <xref:System.IO.Packaging.ZipPackage>
- <xref:System.IO.Packaging.ZipPackagePart>
- <xref:System.IO.Packaging.PackageRelationship>
- <xref:System.Windows.Controls.DocumentViewer>
- [Текст](optimizing-performance-text.md)
- [Общие сведения о документах нефиксированного формата](flow-document-overview.md)
- [Общие сведения о печати](printing-overview.md)
- [Сериализация и хранение документов](document-serialization-and-storage.md)
