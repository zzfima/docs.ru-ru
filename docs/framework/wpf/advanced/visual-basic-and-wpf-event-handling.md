---
title: Обработка событий в Visual Basic и WPF
ms.date: 03/30/2017
helpviewer_keywords:
- Visual Basic [WPF], event handlers
- event handlers [WPF], Visual Basic
ms.assetid: ad4eb9aa-3afc-4a71-8cf6-add3fbea54a1
ms.openlocfilehash: 321b4547bffbbae3c16ef8dd046bdff65ebe0bf1
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
ms.locfileid: "33547827"
---
# <a name="visual-basic-and-wpf-event-handling"></a>Обработка событий в Visual Basic и WPF
Для языка Microsoft Visual Basic .NET в частности, можно использовать конкретного языка `Handles` ключевое слово для связи с экземплярами, вместо присоединения обработчиков событий с атрибутами или с помощью обработчиков событий <xref:System.Windows.UIElement.AddHandler%2A> метод. Однако метод присоединения обработчиков к экземплярам `Handles` имеет некоторые ограничения, так как синтаксис `Handles` не поддерживает некоторые возможности перенаправленных событий системы событий [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].  
  
## <a name="using-handles-in-a-wpf-application"></a>Использование ключевого слова Handles в приложениях WPF  
 Все обработчики событий, которые подключены к экземплярам и событиям с помощью `Handles`, должны быть определены внутри объявления частичного класса экземпляра, который также является требованием для обработчиков событий, назначенных с помощью значений атрибутов в элементах. Можно указать только `Handles` для элемента на страницу, с которой <xref:System.Windows.FrameworkContentElement.Name%2A> значение свойства (или [директива x: Name](../../../../docs/framework/xaml-services/x-name-directive.md) объявлен). Это вызвано <xref:System.Windows.FrameworkContentElement.Name%2A> в [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] создает ссылку на экземпляр, который необходим для поддержки *Instance.Event* формат ссылки на необходимые `Handles` синтаксиса. Единственный элемент, который может использоваться для `Handles` без <xref:System.Windows.FrameworkContentElement.Name%2A> ссылка является экземпляр корневого элемента, который определяет разделяемый класс.  
  
 Можно назначить один и тот же обработчик для нескольких элементов, разделяя запятыми ссылки *Instance.Event* после `Handles`.  
  
 Можно использовать `Handles` для назначения более одного обработчика для той же ссылки *Instance.Event*. Не следует придавать значения порядку, в котором приведены обработчики в ссылке `Handles`; предполагается, что обработчики, обрабатывающие одно и тоже событие, могут вызываться в любом порядке.  
  
 Чтобы удалить обработчик, который был добавлен с `Handles` в объявлении, можно вызвать <xref:System.Windows.UIElement.RemoveHandler%2A>.  
  
 Можно использовать `Handles` для присоединения обработчиков для перенаправленных событий до тех пор, пока обработчики присоединяются к экземплярам, которые определяют обрабатываемое в таблицах элементов событие. Для перенаправленных событий, обработчиками с `Handles` выполните те же правила маршрутизации, что и обработчики, присоединенные как [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] атрибуты, или с общей сигнатурой <xref:System.Windows.UIElement.AddHandler%2A>. Это означает, что если событие уже помечено как обработанное ( <xref:System.Windows.RoutedEventArgs.Handled%2A> свойство в данных события является `True`), то обработчики, присоединенные `Handles` не вызывается в ответ на этот экземпляр события. Событие не может быть помечено как обрабатываемое обработчиками экземпляров из другого элемента маршрута или обработкой класса либо из текущего элемента, либо из более ранних элементов маршрута. Для событий ввода, которые поддерживают события восходящей и нисходящей маршрутизации, нисходящая маршрутизация может пометить пару событий как обрабатываемую. Дополнительные сведения о перенаправленных событиях см. в разделе [Общие сведения о перенаправленных событиях](../../../../docs/framework/wpf/advanced/routed-events-overview.md).  
  
## <a name="limitations-of-handles-for-adding-handlers"></a>Ограничения ключевого слова Handles при добавлении обработчиков  
 Ключевое слово `Handles` не может ссылаться на обработчики для присоединенных событий. Необходимо использовать метод доступа `add` для присоединенных событий или атрибуты события *typename.eventname* в [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]. Дополнительные сведения см. в разделе [Общие сведения о перенаправленных событиях](../../../../docs/framework/wpf/advanced/routed-events-overview.md).  
  
 Для перенаправленных событий можно использовать `Handles` только для назначения обработчиков экземплярам, в которых это событие существует в таблице элементов экземпляра. Однако в общем случае маршрутизации событий, родительский элемент может быть слушателем события от дочерних элементов, даже если этого события нет в таблице элементов родительского элемента. В синтаксисе атрибута это можно указать через форму атрибута *typename.membername*, которая определяет, какой тип фактически определяет обрабатываемое событие. Например, родительский `Page` (без использования `Click` событие, определенное) может прослушивать события нажатия кнопки путем назначения атрибута обработчика в виде `Button.Click`. Но `Handles` не поддерживает форму *typename.membername*, так как он должен поддерживать конфликтующую форму *Instance.Event*. Дополнительные сведения см. в разделе [Общие сведения о перенаправленных событиях](../../../../docs/framework/wpf/advanced/routed-events-overview.md).  
  
 `Handles` не может присоединить обработчики, вызывающиеся для событий, которые уже отмечены как обрабатываемые. Вместо этого необходимо использовать код и вызвать `handledEventsToo` перегруженная версия <xref:System.Windows.UIElement.AddHandler%28System.Windows.RoutedEvent%2CSystem.Delegate%2CSystem.Boolean%29>.  
  
> [!NOTE]
>  Не используйте `Handles` синтаксиса в коде Visual Basic, если задать обработчик событий для того же события в XAML. В таком случае обработчик событий вызывается дважды.  
  
## <a name="how-wpf-implements-handles-functionality"></a>Как в WPF реализуются функциональные возможности ключевого слова Handles  
 При [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] компиляции страницы промежуточный файл объявляет `Friend` `WithEvents` ссылки на каждый элемент на страницу, с которой <xref:System.Windows.FrameworkContentElement.Name%2A> набор свойств (или [директива x: Name](../../../../docs/framework/xaml-services/x-name-directive.md) объявлен). Каждый именованный экземпляр является потенциальным элементом, который можно присвоить обработчику с помощью `Handles`.  
  
> [!NOTE]
>  В [!INCLUDE[TLA#tla_visualstu](../../../../includes/tlasharptla-visualstu-md.md)] [!INCLUDE[TLA2#tla_intellisense](../../../../includes/tla2sharptla-intellisense-md.md)] может показать варианты завершения элементами, доступными для ссылки `Handles` на странице. Но для того чтобы промежуточный файл смог заполнить все ссылки `Friends`, может потребоваться один проход компиляции.  
  
## <a name="see-also"></a>См. также  
 <xref:System.Windows.UIElement.AddHandler%2A>  
 [Маркировка перенаправленных событий как обработанных и обработка классов](../../../../docs/framework/wpf/advanced/marking-routed-events-as-handled-and-class-handling.md)  
 [Общие сведения о перенаправленных событиях](../../../../docs/framework/wpf/advanced/routed-events-overview.md)  
 [Общие сведения о языке XAML (WPF)](../../../../docs/framework/wpf/advanced/xaml-overview-wpf.md)
