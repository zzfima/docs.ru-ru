---
title: Общие сведения о пользовательской анимации
ms.date: 03/30/2017
helpviewer_keywords:
- custom classes [WPF], animation
- key frames [WPF], custom
- custom key frames [WPF]
- animation [WPF], custom classes
- custom animation classes [WPF]
ms.assetid: 9be69d50-3384-4938-886f-08ce00e4a7a6
ms.openlocfilehash: c5f315992e8ae37bc79602e6986d90e7af591fb2
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/12/2020
ms.locfileid: "79186548"
---
# <a name="custom-animations-overview"></a><span data-ttu-id="500b9-102">Общие сведения о пользовательской анимации</span><span class="sxs-lookup"><span data-stu-id="500b9-102">Custom Animations Overview</span></span>
<span data-ttu-id="500b9-103">В этом разделе описывается, как и когда расширять систему анимации [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] путем создания пользовательских ключевых кадров и классов анимации или путем использования покадрового обратного вызова, чтобы пропустить ее.</span><span class="sxs-lookup"><span data-stu-id="500b9-103">This topic describes how and when to extend the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation system by creating custom key frames, animation classes, or by using per-frame callback to bypass it.</span></span>  
  
<a name="prerequisites"></a>
## <a name="prerequisites"></a><span data-ttu-id="500b9-104">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="500b9-104">Prerequisites</span></span>  
 <span data-ttu-id="500b9-105">Чтобы понять материал этого раздела, необходимо ознакомиться с различными типами анимации, предоставляемыми [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="500b9-105">To understand this topic, you should be familiar with the different types of animations provided by the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span> <span data-ttu-id="500b9-106">Дополнительные сведения см. в разделах "Общие сведения об анимациях From/To/By", [Общие сведения об анимации по ключевым кадрам](key-frame-animations-overview.md) и [Общие сведения об анимация с использованием пути](path-animations-overview.md).</span><span class="sxs-lookup"><span data-stu-id="500b9-106">For more information, see the From/To/By Animations Overview, the [Key-Frame Animations Overview](key-frame-animations-overview.md), and the [Path Animations Overview](path-animations-overview.md).</span></span>  
  
 <span data-ttu-id="500b9-107">Поскольку классы анимации наследуются <xref:System.Windows.Freezable> из <xref:System.Windows.Freezable> класса, вы <xref:System.Windows.Freezable>должны быть знакомы с объектами и как наследовать от .</span><span class="sxs-lookup"><span data-stu-id="500b9-107">Because the animation classes inherit from the <xref:System.Windows.Freezable> class, you should be familiar with <xref:System.Windows.Freezable> objects and how to inherit from <xref:System.Windows.Freezable>.</span></span> <span data-ttu-id="500b9-108">Дополнительные сведения см. в разделе [Общие сведения об объектах класса Freezable](../advanced/freezable-objects-overview.md).</span><span class="sxs-lookup"><span data-stu-id="500b9-108">For more information, see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md).</span></span>  
  
<a name="extendingtheanimationsystem"></a>
## <a name="extending-the-animation-system"></a><span data-ttu-id="500b9-109">Расширение системы анимации</span><span class="sxs-lookup"><span data-stu-id="500b9-109">Extending the Animation System</span></span>  
 <span data-ttu-id="500b9-110">Существует несколько способов расширения системы анимации [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], которые зависят от уровня встроенного функционала, который будет использоваться.</span><span class="sxs-lookup"><span data-stu-id="500b9-110">There are a number of ways to extend the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation system, depending on the level of built-in functionality you want to use.</span></span>  <span data-ttu-id="500b9-111">В механизме анимации [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] имеются три основных точки расширяемости.</span><span class="sxs-lookup"><span data-stu-id="500b9-111">There are three primary extensibility points in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation engine:</span></span>  
  
- <span data-ttu-id="500b9-112">Создайте пользовательский объект кадра ключа, наследовав от <xref:System.Windows.Media.Animation.DoubleKeyFrame>одного из классов \* \<Type>\* KeyFrame, таких как.</span><span class="sxs-lookup"><span data-stu-id="500b9-112">Create a custom key frame object by inheriting from one of the *\<Type>* KeyFrame classes, such as <xref:System.Windows.Media.Animation.DoubleKeyFrame>.</span></span> <span data-ttu-id="500b9-113">Этот подход использует большую часть встроенных функциональных возможностей механизма анимации [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="500b9-113">This approach uses most of the built-in functionality of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation engine.</span></span>  
  
- <span data-ttu-id="500b9-114">Создайте свой собственный класс <xref:System.Windows.Media.Animation.AnimationTimeline> анимации, наследовав от или один из \* \<классов Type>\* AnimationBase.</span><span class="sxs-lookup"><span data-stu-id="500b9-114">Create your own animation class by inheriting from <xref:System.Windows.Media.Animation.AnimationTimeline> or one of the *\<Type>* AnimationBase classes.</span></span>  
  
- <span data-ttu-id="500b9-115">Использование покадрового обратного вызова для создания анимаций на основе отдельных кадров.</span><span class="sxs-lookup"><span data-stu-id="500b9-115">Use per-frame callback to generate animations on a per-frame basis.</span></span> <span data-ttu-id="500b9-116">Такой подход предусматривает полный обход анимации и систему времени.</span><span class="sxs-lookup"><span data-stu-id="500b9-116">This approach completely bypasses the animation and timing system.</span></span>  
  
 <span data-ttu-id="500b9-117">В следующей таблице описаны некоторые сценарии для расширения системы анимации.</span><span class="sxs-lookup"><span data-stu-id="500b9-117">The following table describes some the scenarios for extending the animation system.</span></span>  
  
|<span data-ttu-id="500b9-118">Требуемое действие</span><span class="sxs-lookup"><span data-stu-id="500b9-118">When you want to...</span></span>|<span data-ttu-id="500b9-119">Используемый подход</span><span class="sxs-lookup"><span data-stu-id="500b9-119">Use this approach</span></span>|  
|-------------------------|-----------------------|  
|<span data-ttu-id="500b9-120">Настройка интерполяции между значениями типа, \* \< \*который имеет соответствующий тип>АнимацияUsingKeyFrames</span><span class="sxs-lookup"><span data-stu-id="500b9-120">Customize the interpolation between values of a type that has a corresponding *\<Type>* AnimationUsingKeyFrames</span></span>|<span data-ttu-id="500b9-121">Создайте пользовательский ключевой кадр.</span><span class="sxs-lookup"><span data-stu-id="500b9-121">Create a custom key frame.</span></span> <span data-ttu-id="500b9-122">Дополнительные сведения см. в разделе [Создание пользовательского ключевого кадра](#createacustomkeyframe).</span><span class="sxs-lookup"><span data-stu-id="500b9-122">For more information, see the [Create a Custom Key Frame](#createacustomkeyframe) section.</span></span>|  
|<span data-ttu-id="500b9-123">Настройте больше, чем просто интерполяцию между \* \< \*значениями типа, который имеет соответствующий тип>анимации.</span><span class="sxs-lookup"><span data-stu-id="500b9-123">Customize more than just the interpolation between values of a type that has a corresponding *\<Type>* Animation.</span></span>|<span data-ttu-id="500b9-124">Создайте пользовательский класс анимации, который наследует от класса \* \<Type>\* AnimationBase, который соответствует типу, который вы хотите оживить.</span><span class="sxs-lookup"><span data-stu-id="500b9-124">Create a custom animation class that inherits from the *\<Type>* AnimationBase class that corresponds to the type you want to animate.</span></span> <span data-ttu-id="500b9-125">Дополнительные сведения см. в разделе [Создание пользовательского класса анимации](#createacustomanimationtype).</span><span class="sxs-lookup"><span data-stu-id="500b9-125">For more information, see the [Create a Custom Animation Class](#createacustomanimationtype) section.</span></span>|  
|<span data-ttu-id="500b9-126">Анимация типа, не имеющего соответствующей анимации [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</span><span class="sxs-lookup"><span data-stu-id="500b9-126">Animate a type that has no corresponding [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation</span></span>|<span data-ttu-id="500b9-127">Используйте <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> или создайте класс, <xref:System.Windows.Media.Animation.AnimationTimeline>который наследует от .</span><span class="sxs-lookup"><span data-stu-id="500b9-127">Use an <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> or create a class that inherits from <xref:System.Windows.Media.Animation.AnimationTimeline>.</span></span> <span data-ttu-id="500b9-128">Дополнительные сведения см. в разделе [Создание пользовательского класса анимации](#createacustomanimationtype).</span><span class="sxs-lookup"><span data-stu-id="500b9-128">For more information, see the [Create a Custom Animation Class](#createacustomanimationtype) section.</span></span>|  
|<span data-ttu-id="500b9-129">Анимация нескольких объектов со значениями, которые вычисляются для каждого кадра и основаны на последнем наборе взаимодействий объектов</span><span class="sxs-lookup"><span data-stu-id="500b9-129">Animate multiple objects with values that are computed each frame and are based on the last set of object interactions</span></span>|<span data-ttu-id="500b9-130">Используйте покадровый обратный вызов.</span><span class="sxs-lookup"><span data-stu-id="500b9-130">Use per-frame callback.</span></span> <span data-ttu-id="500b9-131">Дополнительные сведения см. в разделе [Использование покадрового обратного вызова](#useperframecallback).</span><span class="sxs-lookup"><span data-stu-id="500b9-131">For more information, see the [Create a Use Per-Frame Callback](#useperframecallback) section.</span></span>|  
  
<a name="createacustomkeyframe"></a>
## <a name="create-a-custom-key-frame"></a><span data-ttu-id="500b9-132">Создание пользовательского ключевого кадра</span><span class="sxs-lookup"><span data-stu-id="500b9-132">Create a Custom Key Frame</span></span>  
 <span data-ttu-id="500b9-133">Создание пользовательского ключевого кадра является простейшим способом расширения системы анимации.</span><span class="sxs-lookup"><span data-stu-id="500b9-133">Creating a custom key frame class is the simplest way to extend the animation system.</span></span> <span data-ttu-id="500b9-134">Этот подход следует использовать в случае, если требуется другой метод интерполяции для анимации по ключевым кадрам.</span><span class="sxs-lookup"><span data-stu-id="500b9-134">Use this approach when you want to a different interpolation method for a key-frame animation.</span></span>  <span data-ttu-id="500b9-135">Как описано в разделе [Общие сведения об анимации по ключевым кадрам](key-frame-animations-overview.md), в анимации по ключевым кадрам используются объекты ключевых кадров для создания выходных значений.</span><span class="sxs-lookup"><span data-stu-id="500b9-135">As described in the [Key-Frame Animations Overview](key-frame-animations-overview.md), a key-frame animation uses key frame objects to generate its output values.</span></span> <span data-ttu-id="500b9-136">Каждый объект ключевого кадра выполняет три функции:</span><span class="sxs-lookup"><span data-stu-id="500b9-136">Each key frame object performs three functions:</span></span>  
  
- <span data-ttu-id="500b9-137">Определяет целевое значение с <xref:System.Windows.Media.Animation.IKeyFrame.Value%2A> использованием его свойства.</span><span class="sxs-lookup"><span data-stu-id="500b9-137">Specifies a target value using its <xref:System.Windows.Media.Animation.IKeyFrame.Value%2A> property.</span></span>  
  
- <span data-ttu-id="500b9-138">Определяет время, в которое это значение должно <xref:System.Windows.Media.Animation.IKeyFrame.KeyTime%2A> быть достигнуто с использованием его свойства.</span><span class="sxs-lookup"><span data-stu-id="500b9-138">Specifies the time at which that value should be reached using its <xref:System.Windows.Media.Animation.IKeyFrame.KeyTime%2A> property.</span></span>  
  
- <span data-ttu-id="500b9-139">выполняет интерполяцию между значением предыдущего ключевого кадра и собственным значением с помощью метода InterpolateValueCore.</span><span class="sxs-lookup"><span data-stu-id="500b9-139">Interpolates between the value of the previous key frame and its own value by implementing the InterpolateValueCore method.</span></span>  
  
 <span data-ttu-id="500b9-140">**Инструкции по реализации**</span><span class="sxs-lookup"><span data-stu-id="500b9-140">**Implementation Instructions**</span></span>  
  
 <span data-ttu-id="500b9-141">Происходит от \* \<типа>\* абстрактного класса KeyFrame и реализуем метод InterpolateValueCore.</span><span class="sxs-lookup"><span data-stu-id="500b9-141">Derive from the *\<Type>* KeyFrame abstract class and implement the InterpolateValueCore method.</span></span> <span data-ttu-id="500b9-142">Метод InterpolateValueCore возвращает текущее значение ключевого кадра.</span><span class="sxs-lookup"><span data-stu-id="500b9-142">The InterpolateValueCore method returns the current value of the key frame.</span></span> <span data-ttu-id="500b9-143">Он принимает два параметра: значение предыдущего ключевого кадра и значение хода выполнения в диапазоне от 0 до 1.</span><span class="sxs-lookup"><span data-stu-id="500b9-143">It takes two parameters: the value of the previous key frame and a progress value that ranges from 0 to 1.</span></span> <span data-ttu-id="500b9-144">Прогресс 0 указывает на то, что ключевой кадр только что начался, а значение 1 указывает <xref:System.Windows.Media.Animation.IKeyFrame.Value%2A> на то, что ключевой кадр только что завершен и должен вернуть значение, указанное его свойством.</span><span class="sxs-lookup"><span data-stu-id="500b9-144">A progress of 0 indicates the key frame has just started, and a value of 1 indicates that the key frame has just completed and should return the value specified by its <xref:System.Windows.Media.Animation.IKeyFrame.Value%2A> property.</span></span>  
  
 <span data-ttu-id="500b9-145">Поскольку \* \< \*классы Type><xref:System.Windows.Freezable> KeyFrame наследуют сяокласс, необходимо также переопределить <xref:System.Windows.Freezable.CreateInstanceCore%2A> ядро, чтобы вернуть новый экземпляр вашего класса.</span><span class="sxs-lookup"><span data-stu-id="500b9-145">Because the *\<Type>* KeyFrame classes inherit from the <xref:System.Windows.Freezable> class, you must also override <xref:System.Windows.Freezable.CreateInstanceCore%2A> core to return a new instance of your class.</span></span> <span data-ttu-id="500b9-146">Если класс не использует свойства зависимостей для хранения своих данных или требует дополнительной инициализации после создания, может потребоваться переопределить дополнительные методы. Дополнительные сведения см. в разделе [Общие сведения об объектах класса Freezable](../advanced/freezable-objects-overview.md).</span><span class="sxs-lookup"><span data-stu-id="500b9-146">If the class does not use dependency properties to store its data or it requires extra initialization after creation, you might need to override additional methods; see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md) for more information.</span></span>  
  
 <span data-ttu-id="500b9-147">После создания пользовательского \* \<типа>\* анимации KeyFrame, вы можете использовать его с \* \<помощью>AnimationUsingKeyFrames \*для этого типа.</span><span class="sxs-lookup"><span data-stu-id="500b9-147">After you've created your custom *\<Type>* KeyFrame animation, you can use it with the *\<Type>* AnimationUsingKeyFrames for that type.</span></span>  
  
<a name="createacustomanimationtype"></a>
## <a name="create-a-custom-animation-class"></a><span data-ttu-id="500b9-148">Создание пользовательского класса анимации</span><span class="sxs-lookup"><span data-stu-id="500b9-148">Create a Custom Animation Class</span></span>  
 <span data-ttu-id="500b9-149">Создание собственного типа анимации обеспечивает больший уровень контроля над способом анимации объекта.</span><span class="sxs-lookup"><span data-stu-id="500b9-149">Creating your own animation type gives you more control over how an object in animated.</span></span> <span data-ttu-id="500b9-150">Существует два рекомендуемых способа создания собственного типа анимации: вы можете извлечь из <xref:System.Windows.Media.Animation.AnimationTimeline> класса или \* \<тип>\* класса AnimationBase.</span><span class="sxs-lookup"><span data-stu-id="500b9-150">There are two recommended ways to create your own animation type: you can derive from the <xref:System.Windows.Media.Animation.AnimationTimeline> class or the *\<Type>* AnimationBase class.</span></span> <span data-ttu-id="500b9-151">Не рекомендуется проводить занятия по>\* \<>\* \* \<в>\* вusingKeyFrames.</span><span class="sxs-lookup"><span data-stu-id="500b9-151">Deriving from the *\<Type>* Animation or *\<Type>* AnimationUsingKeyFrames classes is not recommended.</span></span>  
  
### <a name="derive-from-typeanimationbase"></a><span data-ttu-id="500b9-152">Наследование от класса \<Type>AnimationBase</span><span class="sxs-lookup"><span data-stu-id="500b9-152">Derive from \<Type>AnimationBase</span></span>  
 <span data-ttu-id="500b9-153">Выход из \* \<класса Type>\* AnimationBase является самым простым способом создания нового типа анимации.</span><span class="sxs-lookup"><span data-stu-id="500b9-153">Deriving from a *\<Type>* AnimationBase class is the simplest way to create a new animation type.</span></span> <span data-ttu-id="500b9-154">Используйте этот подход, когда требуется создать новую \* \< \*анимацию для типа, который уже имеет соответствующий тип>класса AnimationBase.</span><span class="sxs-lookup"><span data-stu-id="500b9-154">Use this approach when you want to create a new animation for type that already has a corresponding *\<Type>* AnimationBase class.</span></span>  
  
 <span data-ttu-id="500b9-155">**Инструкции по реализации**</span><span class="sxs-lookup"><span data-stu-id="500b9-155">**Implementation Instructions**</span></span>  
  
 <span data-ttu-id="500b9-156">Происходит от \* \<класса «>анимация» \*и реализуйте метод GetCurrentValueCore.</span><span class="sxs-lookup"><span data-stu-id="500b9-156">Derive from a *\<Type>* Animation class and implement the GetCurrentValueCore method.</span></span> <span data-ttu-id="500b9-157">Метод GetCurrentValueCore возвращает текущее значение анимации.</span><span class="sxs-lookup"><span data-stu-id="500b9-157">The GetCurrentValueCore method returns the current value of the animation.</span></span> <span data-ttu-id="500b9-158">Он принимает три параметра: предлагаемое начальное значение, <xref:System.Windows.Media.Animation.AnimationClock>предлагаемое конечное значение и , которое вы используете для определения хода анимации.</span><span class="sxs-lookup"><span data-stu-id="500b9-158">It takes three parameters: a suggested starting value, a suggested ending value, and an <xref:System.Windows.Media.Animation.AnimationClock>, which you use to determine the progress of the animation.</span></span>  
  
 <span data-ttu-id="500b9-159">Поскольку \* \< \*классы Type><xref:System.Windows.Freezable> AnimationBase наследуют сяокласс, необходимо также переопределить <xref:System.Windows.Freezable.CreateInstanceCore%2A> ядро, чтобы вернуть новый экземпляр вашего класса.</span><span class="sxs-lookup"><span data-stu-id="500b9-159">Because the *\<Type>* AnimationBase classes inherit from the <xref:System.Windows.Freezable> class, you must also override <xref:System.Windows.Freezable.CreateInstanceCore%2A> core to return a new instance of your class.</span></span> <span data-ttu-id="500b9-160">Если класс не использует свойства зависимостей для хранения своих данных или требует дополнительной инициализации после создания, может потребоваться переопределить дополнительные методы. Дополнительные сведения см. в разделе [Общие сведения об объектах класса Freezable](../advanced/freezable-objects-overview.md).</span><span class="sxs-lookup"><span data-stu-id="500b9-160">If the class does not use dependency properties to store its data or it requires extra initialization after creation, you might need to override additional methods; see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md) for more information.</span></span>  
  
 <span data-ttu-id="500b9-161">Для получения дополнительной информации ознакомьтесь с документацией метода GetCurrentValueCore для класса \* \<Type>\* AnimationBase для типа, который вы хотите обезображивать.</span><span class="sxs-lookup"><span data-stu-id="500b9-161">For more information, see the GetCurrentValueCore method documentation for the *\<Type>* AnimationBase class for the type that you want to animate.</span></span> <span data-ttu-id="500b9-162">Например, см. раздел [Пример пользовательской анимации](https://github.com/Microsoft/WPF-Samples/tree/master/Animation/CustomAnimation).</span><span class="sxs-lookup"><span data-stu-id="500b9-162">For an example, see the [Custom Animation Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Animation/CustomAnimation)</span></span>  
  
 <span data-ttu-id="500b9-163">**Альтернативные подходы**</span><span class="sxs-lookup"><span data-stu-id="500b9-163">**Alternative Approaches**</span></span>  
  
 <span data-ttu-id="500b9-164">Если вы просто хотите изменить интерполирование значений анимации, учитывая вытекающие из одного из классов \* \<Type>\* KeyFrame.</span><span class="sxs-lookup"><span data-stu-id="500b9-164">If you simply want to change how animation values are interpolated, considering deriving from one of the *\<Type>* KeyFrame classes.</span></span> <span data-ttu-id="500b9-165">Создаваемый ключевой кадр можно использовать с соответствующим [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] \* \<типом>\* AnimationUsingKeyFrames, предоставленным .</span><span class="sxs-lookup"><span data-stu-id="500b9-165">The key frame you create can be used with the corresponding *\<Type>* AnimationUsingKeyFrames provided by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span>  
  
### <a name="derive-from-animationtimeline"></a><span data-ttu-id="500b9-166">Наследование от AnimationTimeline</span><span class="sxs-lookup"><span data-stu-id="500b9-166">Derive from AnimationTimeline</span></span>  
 <span data-ttu-id="500b9-167">Происходит ездите из <xref:System.Windows.Media.Animation.AnimationTimeline> класса, когда требуется создать анимацию для [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] типа, который еще не имеет соответствующей анимации, или вы хотите создать анимацию, которая не сильно набрана.</span><span class="sxs-lookup"><span data-stu-id="500b9-167">Derive from the <xref:System.Windows.Media.Animation.AnimationTimeline> class when you want to create an animation for a type that doesn't already have a matching [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation, or you want to create an animation that is not strongly typed.</span></span>  
  
 <span data-ttu-id="500b9-168">**Инструкции по реализации**</span><span class="sxs-lookup"><span data-stu-id="500b9-168">**Implementation Instructions**</span></span>  
  
 <span data-ttu-id="500b9-169">Выизвуем из <xref:System.Windows.Media.Animation.AnimationTimeline> класса и переопределить следующие участники:</span><span class="sxs-lookup"><span data-stu-id="500b9-169">Derive from the <xref:System.Windows.Media.Animation.AnimationTimeline> class and override the following members:</span></span>  
  
- <span data-ttu-id="500b9-170"><xref:System.Windows.Freezable.CreateInstanceCore%2A>– Если ваш новый класс является <xref:System.Windows.Freezable.CreateInstanceCore%2A> конкретным, вы должны переопределить, чтобы вернуть новый экземпляр вашего класса.</span><span class="sxs-lookup"><span data-stu-id="500b9-170"><xref:System.Windows.Freezable.CreateInstanceCore%2A> – If your new class is concrete, you must override <xref:System.Windows.Freezable.CreateInstanceCore%2A> to return a new instance of your class.</span></span>  
  
- <span data-ttu-id="500b9-171"><xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A>- Переопределить этот метод, чтобы вернуть текущее значение вашей анимации.</span><span class="sxs-lookup"><span data-stu-id="500b9-171"><xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> – Override this method to return the current value of your animation.</span></span> <span data-ttu-id="500b9-172">Он принимает три параметра: значение происхождения по умолчанию, значение назначения по умолчанию и значение <xref:System.Windows.Media.Animation.AnimationClock>.</span><span class="sxs-lookup"><span data-stu-id="500b9-172">It takes three parameters: a default origin value, a default destination value, and an <xref:System.Windows.Media.Animation.AnimationClock>.</span></span> <span data-ttu-id="500b9-173">Используйте <xref:System.Windows.Media.Animation.AnimationClock> для получения текущего времени или прогресса для анимации.</span><span class="sxs-lookup"><span data-stu-id="500b9-173">Use the <xref:System.Windows.Media.Animation.AnimationClock> to obtain the current time or progress for the animation.</span></span> <span data-ttu-id="500b9-174">Можно выбрать, какие значения будут использоваться: начальное значение по умолчанию или конечное значение по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="500b9-174">You can choose whether to use the default origin and destination values.</span></span>  
  
- <span data-ttu-id="500b9-175"><xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A>- Переопределить это свойство, чтобы указать, использует <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> ли анимация значение назначения по умолчанию, указанное методом.</span><span class="sxs-lookup"><span data-stu-id="500b9-175"><xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A> – Override this property to indicate whether your animation uses the default destination value specified by the <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> method.</span></span>  
  
- <span data-ttu-id="500b9-176"><xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A>- Переизведокните это свойство, чтобы указать <xref:System.Type> выход, который производит анимация.</span><span class="sxs-lookup"><span data-stu-id="500b9-176"><xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A> – Override this property to indicate the <xref:System.Type> of output your animation produces.</span></span>  
  
 <span data-ttu-id="500b9-177">Если класс не использует свойства зависимостей для хранения своих данных или требует дополнительной инициализации после создания, может потребоваться переопределить дополнительные методы. Дополнительные сведения см. в разделе [Общие сведения об объектах класса Freezable](../advanced/freezable-objects-overview.md).</span><span class="sxs-lookup"><span data-stu-id="500b9-177">If the class does not use dependency properties to store its data or it requires extra initialization after creation, you might need to override additional methods; see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md) for more information.</span></span>  
  
 <span data-ttu-id="500b9-178">Рекомендуемой концепцией (используемой анимациями [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]) является использование двух уровней наследования.</span><span class="sxs-lookup"><span data-stu-id="500b9-178">The recommended paradigm (used by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animations) is to use two inheritance levels:</span></span>  
  
1. <span data-ttu-id="500b9-179">Создайте \* \< \*абстрактный тип><xref:System.Windows.Media.Animation.AnimationTimeline>класс AnimationBase, который происходит от .</span><span class="sxs-lookup"><span data-stu-id="500b9-179">Create an abstract *\<Type>* AnimationBase class that derives from <xref:System.Windows.Media.Animation.AnimationTimeline>.</span></span> <span data-ttu-id="500b9-180">Этот класс должен <xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A> переопределить метод.</span><span class="sxs-lookup"><span data-stu-id="500b9-180">This class should override the <xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A> method.</span></span> <span data-ttu-id="500b9-181">Он также должен ввести новый абстрактный <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> метод, GetCurrentValueCore, и переопределить так, чтобы он проверяет типы значения происхождения по умолчанию и параметры значения назначения по умолчанию, а затем вызывает GetCurrentValueCore.</span><span class="sxs-lookup"><span data-stu-id="500b9-181">It should also introduce a new abstract method, GetCurrentValueCore, and override <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> so that it validates the types of the default origin value and default destination value parameters, then calls GetCurrentValueCore.</span></span>  
  
2. <span data-ttu-id="500b9-182">Создайте другой класс, который \* \< \*наследует от нового класса <xref:System.Windows.Freezable.CreateInstanceCore%2A> Type>AnimationBase и переопределяет метод, метод GetCurrentValueCore, который вы представили, и <xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="500b9-182">Create another class that inherits from your new *\<Type>* AnimationBase class and overrides the <xref:System.Windows.Freezable.CreateInstanceCore%2A> method, the GetCurrentValueCore method that you introduced, and the <xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A> property.</span></span>  
  
 <span data-ttu-id="500b9-183">**Альтернативные подходы**</span><span class="sxs-lookup"><span data-stu-id="500b9-183">**Alternative Approaches**</span></span>  
  
 <span data-ttu-id="500b9-184">Если вы хотите анимировать тип, который не имеет соответствующего от/до/по анимации или анимации с ключевым иобразом кадра, рассмотрите <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames>возможность использования .</span><span class="sxs-lookup"><span data-stu-id="500b9-184">If you want to animate a type that has no corresponding From/To/By animation or key-frame animation, consider using an <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames>.</span></span> <span data-ttu-id="500b9-185">Потому что это слабо <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> набраны, может оживить любой тип значения.</span><span class="sxs-lookup"><span data-stu-id="500b9-185">Because it is weakly typed, an <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> can animate any type of value.</span></span> <span data-ttu-id="500b9-186">Недостатком этого подхода является <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> то, что только дискретная интерполяция.</span><span class="sxs-lookup"><span data-stu-id="500b9-186">The drawback to this approach is that <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> only supports discrete interpolation.</span></span>  
  
<a name="useperframecallback"></a>
## <a name="use-per-frame-callback"></a><span data-ttu-id="500b9-187">Использование покадрового обратного вызова</span><span class="sxs-lookup"><span data-stu-id="500b9-187">Use Per-Frame Callback</span></span>  
 <span data-ttu-id="500b9-188">Этот подход следует использовать, если требуется полностью обойти систему анимации WPF [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="500b9-188">Use this approach when you need to completely bypass the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation system.</span></span> <span data-ttu-id="500b9-189">Один из сценариев для такого подхода — анимация физики, при которой на каждом шаге анимации требуется пересчитывать новое направление или положение анимированных объектов на основе последнего набора взаимодействий объектов.</span><span class="sxs-lookup"><span data-stu-id="500b9-189">One scenario for this approach is physics animations, where at each animation step a new direction or position of animated objects needs to be recomputed based on the  last set of object interactions.</span></span>  
  
 <span data-ttu-id="500b9-190">**Инструкции по реализации**</span><span class="sxs-lookup"><span data-stu-id="500b9-190">**Implementation Instructions**</span></span>  
  
 <span data-ttu-id="500b9-191">В отличие от других подходов, описанных в этом обзоре, здесь для использования покадрового обратного вызова не требуется создавать пользовательскую анимацию или класс ключевого кадра.</span><span class="sxs-lookup"><span data-stu-id="500b9-191">Unlike the other approaches described in this overview, to use per-frame callback you don't need to create a custom animation or key frame class.</span></span>  
  
 <span data-ttu-id="500b9-192">Вместо этого вы <xref:System.Windows.Media.CompositionTarget.Rendering> регистрируетесь для события объекта, содержащего объекты, которые вы хотите анимировать.</span><span class="sxs-lookup"><span data-stu-id="500b9-192">Instead, you register for the <xref:System.Windows.Media.CompositionTarget.Rendering> event of the object that contains the objects you want to animate.</span></span> <span data-ttu-id="500b9-193">Метод обработчика событий вызывается один раз для каждого кадра.</span><span class="sxs-lookup"><span data-stu-id="500b9-193">This event handler method gets called once per frame.</span></span> <span data-ttu-id="500b9-194">Каждый раз, когда [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] выполняет маршалинг сохраненных данных отрисовки в визуальном дереве через дерево композиции, вызывается метод обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="500b9-194">Each time that [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] marshals the persisted rendering data in the visual tree across to the composition tree, your event handler method is called.</span></span>  
  
 <span data-ttu-id="500b9-195">В обработчике событий выполняются все вычисления, необходимые для эффекта анимации, и задаются свойства объектов, которые требуется анимировать с этими значениями.</span><span class="sxs-lookup"><span data-stu-id="500b9-195">In your event handler, perform your whatever calculations necessary for your animation effect and set the properties of the objects you want to animate with these values.</span></span>  
  
 <span data-ttu-id="500b9-196">Чтобы получить время представления текущего <xref:System.EventArgs> кадра, связанные с <xref:System.Windows.Media.RenderingEventArgs>этим событием могут быть отлиты как , которые обеспечивают <xref:System.Windows.Media.RenderingEventArgs.RenderingTime%2A> свойство, которое можно использовать для получения времени рендеринга текущего кадра.</span><span class="sxs-lookup"><span data-stu-id="500b9-196">To obtain the presentation time of the current frame, the <xref:System.EventArgs> associated with this event can be cast as <xref:System.Windows.Media.RenderingEventArgs>, which provide a <xref:System.Windows.Media.RenderingEventArgs.RenderingTime%2A> property that you can use to obtain the current frame's rendering time.</span></span>  
  
 <span data-ttu-id="500b9-197">Дополнительные сведения см. на странице <xref:System.Windows.Media.CompositionTarget.Rendering>.</span><span class="sxs-lookup"><span data-stu-id="500b9-197">For more information, see the <xref:System.Windows.Media.CompositionTarget.Rendering> page.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="500b9-198">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="500b9-198">See also</span></span>

- <xref:System.Windows.Media.Animation.AnimationTimeline>
- <xref:System.Windows.Media.Animation.IKeyFrame>
- [<span data-ttu-id="500b9-199">Общие сведения о методах анимации свойств</span><span class="sxs-lookup"><span data-stu-id="500b9-199">Property Animation Techniques Overview</span></span>](property-animation-techniques-overview.md)
- [<span data-ttu-id="500b9-200">Общие сведения об объектах класса Freezable</span><span class="sxs-lookup"><span data-stu-id="500b9-200">Freezable Objects Overview</span></span>](../advanced/freezable-objects-overview.md)
- [<span data-ttu-id="500b9-201">Общие сведения об анимации по ключевым кадрам</span><span class="sxs-lookup"><span data-stu-id="500b9-201">Key-Frame Animations Overview</span></span>](key-frame-animations-overview.md)
- [<span data-ttu-id="500b9-202">Общие сведения об анимации с использованием пути</span><span class="sxs-lookup"><span data-stu-id="500b9-202">Path Animations Overview</span></span>](path-animations-overview.md)
- [<span data-ttu-id="500b9-203">Общие сведения об эффектах анимации</span><span class="sxs-lookup"><span data-stu-id="500b9-203">Animation Overview</span></span>](animation-overview.md)
- [<span data-ttu-id="500b9-204">Общие сведения об анимации и системе управления временем</span><span class="sxs-lookup"><span data-stu-id="500b9-204">Animation and Timing System Overview</span></span>](animation-and-timing-system-overview.md)
- [<span data-ttu-id="500b9-205">Пример пользовательской анимации</span><span class="sxs-lookup"><span data-stu-id="500b9-205">Custom Animation Sample</span></span>](https://github.com/Microsoft/WPF-Samples/tree/master/Animation/CustomAnimation)
