---
title: "Профилирование среды выполнения | Microsoft Docs"
ms.custom: ""
ms.date: "03/30/2017"
ms.prod: ".net-framework"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "dotnet-clr"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "C++"
  - "jsharp"
helpviewer_keywords: 
  - "счетчики производительности"
  - "среда CLR, профилирование"
  - "Perfmon.exe"
  - "системный монитор"
  - "профилирование"
  - "среда выполнения, профилирование"
  - "профилирование приложений"
  - "консоль "Производительность""
ms.assetid: ccd68284-f3a8-47b8-bc3f-92e5fe3a1640
caps.latest.revision: 22
author: "rpetrusha"
ms.author: "ronpet"
manager: "wpickett"
caps.handback.revision: 22
---
# Профилирование среды выполнения
Профилирование представляет собой метод сбора данных по производительности в любом сценарии разработки или развертывания. Это раздел представляет интерес для разработчиков и системных администраторов, которые хотят получить сведения о производительности приложения.  
  
## Отслеживание производительности с использованием системного монитора \(Perfmon.exe\)  
 Системный монитор — самое удобное средство для профилирования приложений [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)]. Системный монитор содержит графическое представление данных счетчиков производительности платформы .NET Framework, установленных вместе со средой CLR и [!INCLUDE[winsdklong](../../../includes/winsdklong-md.md)]. Эти счетчики можно использовать для контроля всех параметров, начиная с управления памятью и заканчивая производительностью JIT\-компилятора. Они сообщают об используемых приложением ресурсах, которые являются косвенным показателем производительности. Используйте эти счетчики, чтобы понять, как приложение работает внутри.  
  
#### Запуск Perfmon.exe в Windows Vista и более поздних версиях  
  
1.  В командной строке введите **perfmon**. Появится консоль **системного монитора**.  
  
2.  В папке **Средства наблюдения** нажмите **Системный монитор**.  
  
3.  На панели инструментов "Системный монитор" щелкните значок **Добавить** \(знак "плюс"\), если он присутствует. Если этот значок не отображается, щелкните правой кнопкой мыши в окне монитора и выберите команду **Добавить счетчики**.  
  
     Откроется диалоговое окно **Добавить счетчики**. В списке **Имеющиеся счетчики** приводятся доступные объекты производительности. Для приложений .NET Framework имеется ряд предварительно определенных объектов, в том числе объекты для управления памятью \(**Память CLR .NET**\), взаимодействия \(**Взаимодействие CLR .NET**\), обработки исключений \(**Исключения CLR .NET**\) и многопоточности \(**Блокировки и потоки CLR .NET**\). Каждый объект производительности включает ряд отдельных счетчиков производительности. Список счетчиков производительности, доступных в системном мониторе, см. в разделе [Performance Counters](../../../docs/framework/debug-trace-profile/performance-counters.md).  
  
4.  Установите флажок рядом с именем объекта производительности, чтобы просмотреть список счетчиков, которые он поддерживает.  
  
5.  Щелкните нужный счетчик производительности.  
  
6.  В списке **Экземпляры выбранного объекта** выберите пункт **\<Все экземпляры\>**, чтобы указать, что необходимо выполнять глобальное наблюдение за счетчиком производительности для среды CLR \(то есть на уровне системы\).  
  
     \-или\-  
  
     В списке **Экземпляры выбранного объекта** щелкните имя приложения, чтобы отслеживать счетчик производительности для него.  
  
     Для различения нескольких версий среды выполнения или устранения неоднозначности между несколькими приложениями с одним и тем же именем необходимо также изменить раздел реестра. Для получения дополнительной информации см. [Performance Counters and In\-Process Side\-By\-Side Applications](../../../docs/framework/debug-trace-profile/performance-counters-and-in-process-side-by-side-applications.md).  
  
> [!NOTE]
>  Если новые счетчики производительности были установлены при работающем системном мониторе, остановите системный монитор и перезапустите его, чтобы новые счетчики стали видны.  
  
 Если нужно профилировать сборку, существующую в зоне или в удаленном общем ресурсе, убедитесь в том, что удаленная сборка является полностью доверенной на компьютере с работающими счетчиками производительности. Если сборка не обладает достаточным уровнем доверия, счетчики производительности работать не будут. Сведения о предоставлении доверия различным зонам см. в разделе [Caspol.exe \(Code Access Security Policy Tool\)](../../../docs/framework/tools/caspol-exe-code-access-security-policy-tool.md).  
  
> [!NOTE]
>  В системах, в которых установлена платформа [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)], в системном мониторе могут не отображаться данные счетчиков производительности в некоторых категориях, таких как **Данные CLR .NET** и **Организация сети CLR .NET**, для приложений, которые были разработаны с помощью [!INCLUDE[net_v11_short](../../../includes/net-v11-short-md.md)]. Если это так, можно настроить монитор производительности для отображения этих данных, добавив элемент [\<forcePerformanceCounterUniqueSharedMemoryReads\>](../../../docs/framework/configure-apps/file-schema/runtime/forceperformancecounteruniquesharedmemoryreads-element.md) в файле конфигурации приложения.  
  
## Считывание данных и создание счетчиков производительности программным способом  
 Платформа [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] предоставляет классы, которые можно использовать для программного доступа к тем же сведениям о производительности, которые доступны в системном мониторе. Эти классы можно также использовать для создания пользовательских счетчиков производительности. В таблице ниже описаны некоторые из классов мониторинга производительности, предоставляемых [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)].  
  
|Класс|Описание|  
|-----------|--------------|  
|<xref:System.Diagnostics.PerformanceCounter?displayProperty=fullName>|Представляет компонент счетчика производительности Windows NT. Этот класс используется для чтения существующих предварительно определенных или пользовательских счетчиков и публикации \(записи\) данных производительности в пользовательские счетчики.|  
|<xref:System.Diagnostics.PerformanceCounterCategory?displayProperty=fullName>|Предоставляет ряд методов для взаимодействия со счетчиками и категориями счетчиков на компьютере.|  
|<xref:System.Diagnostics.PerformanceCounterInstaller?displayProperty=fullName>|Задает установщик для компонента `PerformanceCounter`.|  
|<xref:System.Diagnostics.PerformanceCounterType?displayProperty=fullName>|Задает формулу для вычисления метода `NextValue` для `PerformanceCounter`.|  
  
## См. также  
 [Performance Counters](../../../docs/framework/debug-trace-profile/performance-counters.md)