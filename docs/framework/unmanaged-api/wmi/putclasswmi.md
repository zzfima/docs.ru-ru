---
title: Функция PutClassWmi (Справочник по неуправляемым API)
description: Функция PutClassWmi создает новый класс или обновляет существующий.
ms.date: 11/06/2017
api_name:
- PutClassWmi
api_location:
- WMINet_Utils.dll
api_type:
- DLLExport
f1_keywords:
- PutClassWmi
helpviewer_keywords:
- PutClassWmi function [.NET WMI and performance counters]
topic_type:
- Reference
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: de08662a825a84f19a40863cf73481d89364ebd0
ms.sourcegitcommit: fe02afbc39e78afd78cc6050e4a9c12a75f579f8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/30/2018
ms.locfileid: "43258549"
---
# <a name="putclasswmi-function"></a>Функция PutClassWmi
Создает новый класс или обновляет существующий.  

[!INCLUDE[internalonly-unmanaged](../../../../includes/internalonly-unmanaged.md)]
  
## <a name="syntax"></a>Синтаксис  
  
```  
HRESULT PutClassWmi (
   [in] IWbemClassObject*    pObject,
   [in] long                 lFlags,
   [in] IWbemContext*        pCtx,
   [out] IWbemCallResult**   ppCallResult
); 
```  

## <a name="parameters"></a>Параметры

`pObject`    
[in] Указатель является допустимым определением класса. Его необходимо правильно инициализировать со всеми значениями обязательное свойство.

`lFlags`   
[in] Сочетание флагов, влияющих на поведение этой функции. Следующие значения определяются в *WbemCli.h* файл заголовка, или их можно определить как константы в коде: 

|Константа  |Значение  |Описание:  |
|---------|---------|---------|
| `WBEM_FLAG_USE_AMENDED_QUALIFIERS` | 0x20000 | Если набор, WMI не сохраняет любые квалификаторы с измененная версия. </br> В противном случае набор, предполагается, что этот объект не локализовано, а все квалификаторы — storedwith данного экземпляра. |
| `WBEM_FLAG_CREATE_OR_UPDATE` | 0 | Создайте класс, если он не существует, или заменяет его, если он уже существует. |
| `WBEM_FLAG_UPDATE_ONLY` | 1 | Обновите класс. Класс должен существовать для успешного вызова. |
| `WBEM_FLAG_CREATE_ONLY` | 2 | Создайте класс. Вызов завершается неудачей, если класс уже существует. |
| `WBEM_FLAG_RETURN_IMMEDIATELY` | 0x10 | Этот флаг приводит к Полусинхронный вызов. |
| `WBEM_FLAG_OWNER_UPDATE` | 0x10000 | Поставщики Push-уведомлений необходимо указать этот флаг, при вызове `PutClassWmi` для указания, что этот класс был изменен. |
| `WBEM_FLAG_UPDATE_COMPATIBLE` | 0 | Позволяет классу обновляться, если нет производных классов и экземпляры этого класса не существует. Он также позволяет обновления во всех случаях при изменении просто незначительной квалификаторы, например квалификатор описания. Если класс имеет экземпляры или изменяются важные квалификаторы, обновление завершается ошибкой. |
| `WBEM_FLAG_UPDATE_SAFE_MODE` | 0x20 | Обеспечивает обновление классов, даже при наличии дочерних классов, до тех пор, пока изменения не вызывает конфликтов с дочерними классами. Например этот флаг позволяет новое свойство для добавления базового класса, который не упоминался ранее в любом из дочерних классов. Если класс имеет экземпляры, обновление завершится ошибкой. |
| `WBEM_FLAG_UPDATE_FORCE_MODE` | 0x40 | Принудительное обновление классов, при наличии конфликтующих дочерних классов. Например этот флаг вызывает принудительное обновление, если квалификатор определен в дочернем классе, и пытается добавить же квалификатор, который конфликтует с thte существующие один базовый класс. В принудительном режиме еще привлекательнее конфликт разрешается удалением квалификатора в дочернем классе. |

`pCtx`  
[in] Как правило, это значение равно `null`. В противном случае он является указателем на [IWbemContext](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemcontext) экземпляр, который может использоваться поставщиком, предоставляющего запрошенного классы. 

`ppCallResult`  
[out] Если `null`, этот параметр не используется. Если `lFlags` содержит `WBEM_FLAG_RETURN_IMMEDIATELY`, функция немедленно возвращает `WBEM_S_NO_ERROR`. `ppCallResult` Параметр получает указатель на новый [IWbemCallResult](/windows/desktop/api/wbemcli/nn-wbemcli-iwbemcallresult) объекта.

## <a name="return-value"></a>Возвращаемое значение

Следующие значения, возвращаемые этой функцией, определяются в *WbemCli.h* файл заголовка, или их можно определить как константы в коде:

|Константа  |Значение  |Описание:  |
|---------|---------|---------|
| `WBEM_E_ACCESS_DENIED` | 0x80041003 | Пользователь не имеет разрешения на создание или изменение классов. |
| `WBEM_E_FAILED` | 0x80041001 | Произошла неизвестная ошибка. |
| `WBEM_E_INVALID_CLASS` | 0x80041010 | Указанный класс не является допустимым. Как правило, это означает, что `pObject` указывает объект экземпляра. |
| `WBEM_E_INVALID_PARAMETER` | 0x80041008 | Параметр не является допустимым. |
| `WBEM_E_INVALID OPERATION` | 0x80041016 | Недопустимое имя указанного класса. |
| `WBEM_E_CLASS_HAS_CHILDREN` | 0x80041025 | Выполнена попытка сделать изменение, которое аннулирует подкласс. |
| `WBEM_E_ALREADY_EXISTS` | 0x80041019 | `WBEM_FLAG_CREATE_ONLY` Указан флаг, но класс уже существует. |
| `WBEM_E_NOT_FOUND` | 0x80041002 | `WBEM_FLAG_UPDATE_ONLY` был указан в `lFlags`, и этот класс не найден. |
| `WBEM_E_INCOMPLETE_CLASS` | 0x80041020 | Обязательные свойства для классов не все установлены. |
| `WBEM_E_OUT_OF_MEMORY` | 0x80041006 | Недостаточно памяти для завершения операции. |
| `WBEM_E_SHUTTING_DOWN` | 0x80041033 | WMI был, вероятно, остановлена или перезапустить. Вызовите [ConnectServerWmi](connectserverwmi.md) еще раз. |
| `WBEM_E_TRANSPORT_FAILURE` | 0x80041015 | Сбой удаленной процедуры вызова (RPC) связь между текущим процессом и WMI. |
| `WBEM_S_NO_ERROR` | 0 | Вызов функции был успешным.  |
  
## <a name="remarks"></a>Примечания

Эта функция создает оболочку для вызова [IWbemServices::PutClass](/windows/desktop/api/wbemcli/nf-wbemcli-iwbemservices-putclass) метод.

Пользователь не может создать классы с именами, начинаться или заканчиваться символом подчеркивания chacater

Если происходит сбой вызова функции, можно получить дополнительные сведения об ошибке, вызвав [GetErrorInfo](geterrorinfo.md) функции.

## <a name="requirements"></a>Требования  
 **Платформы:** см. раздел [требования к системе](../../../../docs/framework/get-started/system-requirements.md).  
  
 **Заголовок:** WMINet_Utils.idl  
  
 **Версии платформы .NET Framework:** [!INCLUDE[net_current_v472plus](../../../../includes/net-current-v472plus.md)]  
  
## <a name="see-also"></a>См. также  
[WMI и счетчики производительности (Справочник по неуправляемым API)](index.md)
