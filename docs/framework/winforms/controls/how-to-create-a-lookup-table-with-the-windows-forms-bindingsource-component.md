---
title: Создание таблицы подстановок с помощью компонента BindingSource
ms.date: 03/30/2017
helpviewer_keywords:
- lookup tables
- tables [Windows Forms], creating lookup tables
- BindingSource component [Windows Forms], creating a lookup table
- BindingSource component [Windows Forms], examples
ms.assetid: 622fce80-879d-44be-abbf-8350ec22ca2b
ms.openlocfilehash: ccf2bfa6cf3f56a38b55f8c87004c42a46172891
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/24/2020
ms.locfileid: "76736811"
---
# <a name="how-to-create-a-lookup-table-with-the-windows-forms-bindingsource-component"></a>Практическое руководство. Создание таблицы подстановок с помощью компонента BindingSource в формах Windows Forms
Таблица подстановки — это таблица данных, в одном из столбцов которой отображаются данные из записей в связанной таблице. В следующих процедурах для отображения поля с отношением по внешнему ключу от родительской к дочерней таблице используется элемент управления <xref:System.Windows.Forms.ComboBox>.  
  
 Чтобы вы могли представить это отношение, приведем пример родительской и дочерней таблицы.  
  
 CustomersTable (родительская таблица)  
  
|CustomerID|CustomerName|  
|----------------|------------------|  
|712|Павел Кох|  
|713|Тамара Иванова|  
  
 OrdersTable (дочерняя таблица)  
  
|OrderID|OrderDate|CustomerID|  
|-------------|---------------|----------------|  
|903|12 февраля 2004 г.|712|  
|904|13 февраля 2004 г.|713|  
  
 В данном случае одна таблица, CustomersTable, содержит актуальную информацию, которую необходимо отобразить и сохранить. Для экономии места в таблице опущены пояснения. Другая таблица, OrdersTable, содержит только внешнюю информацию о том, какой номер идентификатора клиента соответствует тем или иным данным и идентификатору заказа. При этом имена клиентов не указываются.  
  
 Чтобы создать таблицу подстановки, в элементе управления [ComboBox](combobox-control-windows-forms.md) устанавливаются четыре важных свойства.  
  
- Свойство <xref:System.Windows.Forms.ComboBox.DataSource%2A> содержит имя таблицы.  
  
- Свойство <xref:System.Windows.Forms.ListControl.DisplayMember%2A> содержит столбец данных таблицы, из которого нужно взять текст для элемента управления (имя клиента).  
  
- Свойство <xref:System.Windows.Forms.ListControl.ValueMember%2A> содержит столбец данных таблицы, в которой хранится информация (номер идентификатора в родительской таблице).  
  
- Свойство <xref:System.Windows.Forms.ListControl.SelectedValue%2A> предоставляет значение подстановки для дочерней таблицы на основании свойства <xref:System.Windows.Forms.ListControl.ValueMember%2A>.  
  
 Представленные ниже процедуры показывают, как разместить форму в виде таблицы подстановки и привязать данные к ее элементам управления. Для успешного завершения процедур необходим источник данных с родительской и дочерней таблицами, связанными по внешнему ключу, как это уже говорилось выше.  
  
### <a name="to-create-the-user-interface"></a>Создание пользовательского интерфейса  
  
1. Из **панели элементов**перетащите элемент управления <xref:System.Windows.Forms.ComboBox> на форму.  
  
     Этот элемент управления будет отображать столбец из родительской таблицы.  
  
2. Перетащите другие элементы управления для отображения сведений из дочерней таблицы. Формат данных в таблице следует определить, исходя из выбранных элементов управления. Дополнительные сведения см. в разделе [Функциональная классификация элементов управления Windows Forms](windows-forms-controls-by-function.md).  
  
3. Перетащите в форму элемент управления <xref:System.Windows.Forms.BindingNavigator>. Это позволит перемещаться по данным в дочерней таблице.  
  
### <a name="to-connect-to-the-data-and-bind-it-to-controls"></a>Подключение к данным и их привязка к элементам управления  
  
1. Выберите элемент управления <xref:System.Windows.Forms.ComboBox> и нажмите на глиф "Быстрые действия", чтобы открыть одноименное диалоговое окно.  
  
2. Выберите элемент **Использовать элементы, привязанные к данным**.  
  
3. Щелкните стрелку рядом с раскрывающимся списком **Источник данных**. Если источник данных ранее был настроен для проекта или формы, он отобразится. В противном случае выполните следующие действия (в этом примере используются таблицы Customers и Orders учебной базы данных Борей, а ссылки на них приводятся в круглых скобках).  
  
    1. Щелкните элемент **Добавить источник данных проекта**, чтобы подключиться к данным и создать источник данных.  
  
    2. На странице приветствия **Мастер настройки источника данных** нажмите кнопку **Далее**.  
  
    3. На странице **Выбор типа источника данных** выберите элемент **База данных**.  
  
    4. На странице **Выбор подключения к базе данных** выберите тип подключения данных из списка доступных подключений. Если необходимое подключение данных недоступно, выберите элемент **Создать подключение**, чтобы создать новое подключение данных.  
  
    5. Нажмите кнопку **Да, сохранить подключение**, чтобы сохранить строку подключения в файле конфигурации приложения.  
  
    6. Выберите объекты базы данных, чтобы перенести их в приложение. В данном случае выберите родительскую и дочернюю таблицы (например, таблицы Customers и Orders) с отношением по внешнему ключу.  
  
    7. Если необходимо, замените имя набора данных по умолчанию.  
  
    8. Нажмите кнопку **Готово**.  
  
4. В раскрывающемся списке **Отобразить участника** выберите имя столбца (например, ContactName) для его отображения в поле со списком.  
  
5. В раскрывающемся списке **Значение участника** выберите столбец (например, CustomerID), чтобы выполнить операции подстановки в дочерней таблице.  
  
6. В раскрывающемся списке **Выбранное значение** перейдите к элементу **Источники данных проекта** и только что созданному набору данных, который содержит родительскую и дочернюю таблицы. Выберите такое же свойство дочерней таблицы, которое является значением участника родительской таблицы (например, Orders.CustomerID). Будут созданы и добавлены в форму соответствующие <xref:System.Windows.Forms.BindingSource>, набор данных и компоненты адаптера таблицы.  
  
7. Свяжите элемент управления <xref:System.Windows.Forms.BindingNavigator> с элементом <xref:System.Windows.Forms.BindingSource> дочерней таблицы (например, `OrdersBindingSource`).  
  
8. Свяжите элементы управления, кроме <xref:System.Windows.Forms.ComboBox> и <xref:System.Windows.Forms.BindingNavigator>, с полями сведений из элемента <xref:System.Windows.Forms.BindingSource> дочерней таблицы (например, `OrdersBindingSource`), которые необходимо отобразить.  
  
## <a name="see-also"></a>См. также раздел

- <xref:System.Windows.Forms.BindingSource>
- [Компонент BindingSource](bindingsource-component.md)
- [Элемент управления ComboBox](combobox-control-windows-forms.md)
- [Привязка элементов управления к данным в Visual Studio](/visualstudio/data-tools/bind-controls-to-data-in-visual-studio)
