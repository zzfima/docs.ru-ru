---
title: "Масштабирование элемента управления DataGridView в Windows Forms"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-winforms
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- DataGridView control [Windows Forms], row sharing
- data grids [Windows Forms], best practices
- DataGridView control [Windows Forms], shared rows
- DataGridView control [Windows Forms], best practices
- best practices [Windows Forms], dataGridView control
- DataGridView control [Windows Forms], scaling
ms.assetid: 8321a8a6-6340-4fd1-b475-fa090b905aaf
caps.latest.revision: "31"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: bfefd41a4773c81757f73e725095057f988cef2c
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/21/2017
---
# <a name="best-practices-for-scaling-the-windows-forms-datagridview-control"></a><span data-ttu-id="a1291-102">Масштабирование элемента управления DataGridView в Windows Forms</span><span class="sxs-lookup"><span data-stu-id="a1291-102">Best Practices for Scaling the Windows Forms DataGridView Control</span></span>
<span data-ttu-id="a1291-103"><xref:System.Windows.Forms.DataGridView> Управления предназначен для обеспечения максимальной масштабируемости.</span><span class="sxs-lookup"><span data-stu-id="a1291-103">The <xref:System.Windows.Forms.DataGridView> control is designed to provide maximum scalability.</span></span> <span data-ttu-id="a1291-104">Если требуется для отображения больших объемов данных, необходимо следовать инструкциям, описанным в этом разделе, чтобы избежать использования больших объемов памяти и снижения скорости реагирования пользовательского интерфейса (UI).</span><span class="sxs-lookup"><span data-stu-id="a1291-104">If you need to display large amounts of data, you should follow the guidelines described in this topic to avoid consuming large amounts of memory or degrading the responsiveness of the user interface (UI).</span></span> <span data-ttu-id="a1291-105">В этом разделе обсуждаются следующие вопросы:</span><span class="sxs-lookup"><span data-stu-id="a1291-105">This topic discusses the following issues:</span></span>  
  
-   <span data-ttu-id="a1291-106">Эффективное использование стили ячеек</span><span class="sxs-lookup"><span data-stu-id="a1291-106">Using cell styles efficiently</span></span>  
  
-   <span data-ttu-id="a1291-107">Эффективное использование контекстных меню</span><span class="sxs-lookup"><span data-stu-id="a1291-107">Using shortcut menus efficiently</span></span>  
  
-   <span data-ttu-id="a1291-108">Использование автоматического изменения размеров эффективно</span><span class="sxs-lookup"><span data-stu-id="a1291-108">Using automatic resizing efficiently</span></span>  
  
-   <span data-ttu-id="a1291-109">Эффективное использование выбранными коллекциями ячеек, строк и столбцов</span><span class="sxs-lookup"><span data-stu-id="a1291-109">Using the selected cells, rows, and columns collections efficiently</span></span>  
  
-   <span data-ttu-id="a1291-110">Использование общих строк</span><span class="sxs-lookup"><span data-stu-id="a1291-110">Using shared rows</span></span>  
  
-   <span data-ttu-id="a1291-111">Предотвращение строкам</span><span class="sxs-lookup"><span data-stu-id="a1291-111">Preventing rows from becoming unshared</span></span>  
  
 <span data-ttu-id="a1291-112">Если у вас есть особые требования к производительности, можно реализовать виртуальный режим и предоставьте собственные операции управления данными.</span><span class="sxs-lookup"><span data-stu-id="a1291-112">If you have special performance needs, you can implement virtual mode and provide your own data management operations.</span></span> <span data-ttu-id="a1291-113">Дополнительные сведения см. в разделе [режимы отображения данных в элементе управления DataGridView Windows Forms](../../../../docs/framework/winforms/controls/data-display-modes-in-the-windows-forms-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="a1291-113">For more information, see [Data Display Modes in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/data-display-modes-in-the-windows-forms-datagridview-control.md).</span></span>  
  
## <a name="using-cell-styles-efficiently"></a><span data-ttu-id="a1291-114">Эффективное использование стили ячеек</span><span class="sxs-lookup"><span data-stu-id="a1291-114">Using Cell Styles Efficiently</span></span>  
 <span data-ttu-id="a1291-115">Каждый ячеек, строк и столбцов могут иметь свои собственные сведения о стиле.</span><span class="sxs-lookup"><span data-stu-id="a1291-115">Each cell, row, and column can have its own style information.</span></span> <span data-ttu-id="a1291-116">Сведения о стиле хранятся в <xref:System.Windows.Forms.DataGridViewCellStyle> объектов.</span><span class="sxs-lookup"><span data-stu-id="a1291-116">Style information is stored in <xref:System.Windows.Forms.DataGridViewCellStyle> objects.</span></span> <span data-ttu-id="a1291-117">Создание объектов стиля ячеек для большого числа <xref:System.Windows.Forms.DataGridView> элементы могут быть неэффективным, особенно при работе с большими объемами данных.</span><span class="sxs-lookup"><span data-stu-id="a1291-117">Creating cell style objects for many individual <xref:System.Windows.Forms.DataGridView> elements can be inefficient, especially when working with large amounts of data.</span></span> <span data-ttu-id="a1291-118">Чтобы избежать снижения производительности, следуйте приведенным ниже рекомендациям:</span><span class="sxs-lookup"><span data-stu-id="a1291-118">To avoid a performance impact, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="a1291-119">Не задавайте свойства стиля ячейки для отдельных <xref:System.Windows.Forms.DataGridViewCell> или <xref:System.Windows.Forms.DataGridViewRow> объектов.</span><span class="sxs-lookup"><span data-stu-id="a1291-119">Avoid setting cell style properties for individual <xref:System.Windows.Forms.DataGridViewCell> or <xref:System.Windows.Forms.DataGridViewRow> objects.</span></span> <span data-ttu-id="a1291-120">Сюда входят строки объекта, заданного параметром <xref:System.Windows.Forms.DataGridView.RowTemplate%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="a1291-120">This includes the row object specified by the <xref:System.Windows.Forms.DataGridView.RowTemplate%2A> property.</span></span> <span data-ttu-id="a1291-121">Каждая новая строка, является клоном шаблона строки получит свою собственную копию шаблона объекта стиля ячейки.</span><span class="sxs-lookup"><span data-stu-id="a1291-121">Each new row that is cloned from the row template will receive its own copy of the template's cell style object.</span></span> <span data-ttu-id="a1291-122">Для максимальной масштабируемости, задайте свойства стиля ячейки на <xref:System.Windows.Forms.DataGridView> уровне.</span><span class="sxs-lookup"><span data-stu-id="a1291-122">For maximum scalability, set cell style properties at the <xref:System.Windows.Forms.DataGridView> level.</span></span> <span data-ttu-id="a1291-123">Например, задать <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType> свойства, а не <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType> свойство.</span><span class="sxs-lookup"><span data-stu-id="a1291-123">For example, set the <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType> property rather than the <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType> property.</span></span>  
  
-   <span data-ttu-id="a1291-124">Если некоторые ячейки требуется форматирования, отличные от форматирования по умолчанию, используйте тот же идентификатор <xref:System.Windows.Forms.DataGridViewCellStyle> экземпляр групп ячеек, строк или столбцов.</span><span class="sxs-lookup"><span data-stu-id="a1291-124">If some cells require formatting other than default formatting, use the same <xref:System.Windows.Forms.DataGridViewCellStyle> instance across groups of cells, rows, or columns.</span></span> <span data-ttu-id="a1291-125">Избегайте прямого задания свойств типа <xref:System.Windows.Forms.DataGridViewCellStyle> на отдельных ячеек, строк и столбцов.</span><span class="sxs-lookup"><span data-stu-id="a1291-125">Avoid directly setting properties of type <xref:System.Windows.Forms.DataGridViewCellStyle> on individual cells, rows, and columns.</span></span> <span data-ttu-id="a1291-126">Пример совместного использования стиля ячеек см. в разделе [как: набор стилей ячейки по умолчанию для элемента управления DataGridView в Windows Forms](../../../../docs/framework/winforms/controls/how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="a1291-126">For an example of cell style sharing, see [How to: Set Default Cell Styles for the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md).</span></span> <span data-ttu-id="a1291-127">Можно также избежать снижения производительности при задании стили ячеек по отдельности, обрабатывая <xref:System.Windows.Forms.DataGridView.CellFormatting> обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="a1291-127">You can also avoid a performance penalty when setting cell styles individually by handling the <xref:System.Windows.Forms.DataGridView.CellFormatting> event handler.</span></span> <span data-ttu-id="a1291-128">Пример см. в разделе [как: Настройка форматирования данных в элементе управления DataGridView Windows Forms](../../../../docs/framework/winforms/controls/how-to-customize-data-formatting-in-the-windows-forms-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="a1291-128">For an example, see [How to: Customize Data Formatting in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/how-to-customize-data-formatting-in-the-windows-forms-datagridview-control.md).</span></span>  
  
-   <span data-ttu-id="a1291-129">При определении стиля ячейки, используйте <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A?displayProperty=nameWithType> свойства, а не <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType> свойство.</span><span class="sxs-lookup"><span data-stu-id="a1291-129">When determining a cell's style, use the <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A?displayProperty=nameWithType> property rather than the <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="a1291-130">Доступ к <xref:System.Windows.Forms.DataGridViewCell.Style%2A> свойство создает новый экземпляр <xref:System.Windows.Forms.DataGridViewCellStyle> класса, если свойство еще не использовался.</span><span class="sxs-lookup"><span data-stu-id="a1291-130">Accessing the <xref:System.Windows.Forms.DataGridViewCell.Style%2A> property creates a new instance of the <xref:System.Windows.Forms.DataGridViewCellStyle> class if the property has not already been used.</span></span> <span data-ttu-id="a1291-131">Кроме того этот объект может не содержать полные сведения о стиле для ячейки, если некоторые стили наследуются от строк, столбцов или элемента управления.</span><span class="sxs-lookup"><span data-stu-id="a1291-131">Additionally, this object might not contain the complete style information for the cell if some styles are inherited from the row, column, or control.</span></span> <span data-ttu-id="a1291-132">Дополнительные сведения о наследовании стилей ячеек см. в разделе [стили ячеек в элементе управления DataGridView Windows Forms](../../../../docs/framework/winforms/controls/cell-styles-in-the-windows-forms-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="a1291-132">For more information about cell style inheritance, see [Cell Styles in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/cell-styles-in-the-windows-forms-datagridview-control.md).</span></span>  
  
## <a name="using-shortcut-menus-efficiently"></a><span data-ttu-id="a1291-133">Эффективное использование контекстных меню</span><span class="sxs-lookup"><span data-stu-id="a1291-133">Using Shortcut Menus Efficiently</span></span>  
 <span data-ttu-id="a1291-134">Каждой ячейки, строки и столбца может иметь собственное контекстное меню.</span><span class="sxs-lookup"><span data-stu-id="a1291-134">Each cell, row, and column can have its own shortcut menu.</span></span> <span data-ttu-id="a1291-135">Контекстные меню в <xref:System.Windows.Forms.DataGridView> управления представляются <xref:System.Windows.Forms.ContextMenuStrip> элементов управления.</span><span class="sxs-lookup"><span data-stu-id="a1291-135">Shortcut menus in the <xref:System.Windows.Forms.DataGridView> control are represented by <xref:System.Windows.Forms.ContextMenuStrip> controls.</span></span> <span data-ttu-id="a1291-136">Как и в случае с объектами стиля ячеек, создание контекстных меню для множества отдельных <xref:System.Windows.Forms.DataGridView> элементов может отрицательно сказаться на производительности.</span><span class="sxs-lookup"><span data-stu-id="a1291-136">Just as with cell style objects, creating shortcut menus for many individual <xref:System.Windows.Forms.DataGridView> elements will negatively impact performance.</span></span> <span data-ttu-id="a1291-137">Чтобы избежать потерь производительности, следуйте приведенным ниже рекомендациям:</span><span class="sxs-lookup"><span data-stu-id="a1291-137">To avoid this penalty, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="a1291-138">Избегайте создания контекстных меню для отдельных ячеек и строк.</span><span class="sxs-lookup"><span data-stu-id="a1291-138">Avoid creating shortcut menus for individual cells and rows.</span></span> <span data-ttu-id="a1291-139">Это включает шаблон строки, который копируется вместе с его контекстное меню, когда новые строки добавляются к элементу управления.</span><span class="sxs-lookup"><span data-stu-id="a1291-139">This includes the row template, which is cloned along with its shortcut menu when new rows are added to the control.</span></span> <span data-ttu-id="a1291-140">Для обеспечения максимальной масштабируемости используйте только элемента управления <xref:System.Windows.Forms.Control.ContextMenuStrip%2A> свойство, чтобы указать одно контекстное меню для всего элемента управления.</span><span class="sxs-lookup"><span data-stu-id="a1291-140">For maximum scalability, use only the control's <xref:System.Windows.Forms.Control.ContextMenuStrip%2A> property to specify a single shortcut menu for the entire control.</span></span>  
  
-   <span data-ttu-id="a1291-141">Если требуется несколько контекстных меню для нескольких строк или ячеек, обрабатывать <xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded> или <xref:System.Windows.Forms.DataGridView.RowContextMenuStripNeeded> события.</span><span class="sxs-lookup"><span data-stu-id="a1291-141">If you require multiple shortcut menus for multiple rows or cells, handle the <xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded> or <xref:System.Windows.Forms.DataGridView.RowContextMenuStripNeeded> events.</span></span> <span data-ttu-id="a1291-142">Эти события позволяют управлять объектами контекстного меню самостоятельно, производя для настройки производительности.</span><span class="sxs-lookup"><span data-stu-id="a1291-142">These events let you manage the shortcut menu objects yourself, allowing you to tune performance.</span></span>  
  
## <a name="using-automatic-resizing-efficiently"></a><span data-ttu-id="a1291-143">Использование автоматического изменения размеров эффективно</span><span class="sxs-lookup"><span data-stu-id="a1291-143">Using Automatic Resizing Efficiently</span></span>  
 <span data-ttu-id="a1291-144">Строк, столбцов и заголовков может автоматически изменяться при изменении содержимого ячеек так, чтобы отображались все содержимое ячейки без усечения.</span><span class="sxs-lookup"><span data-stu-id="a1291-144">Rows, columns, and headers can be automatically resized as cell content changes so that the entire contents of cells are displayed without clipping.</span></span> <span data-ttu-id="a1291-145">Изменение режима изменения размеров можно также изменить размеры строк, столбцов и заголовков.</span><span class="sxs-lookup"><span data-stu-id="a1291-145">Changing sizing modes can also resize rows, columns, and headers.</span></span> <span data-ttu-id="a1291-146">Для определения верного размера <xref:System.Windows.Forms.DataGridView> элемент управления должен проверить значение каждой ячейки, в нем.</span><span class="sxs-lookup"><span data-stu-id="a1291-146">To determine the correct size, the <xref:System.Windows.Forms.DataGridView> control must examine the value of each cell that it must accommodate.</span></span> <span data-ttu-id="a1291-147">При работе с большими наборами данных, этот анализ может отрицательно повлиять на производительность элемента управления, при выполнении автоматического изменения размеров.</span><span class="sxs-lookup"><span data-stu-id="a1291-147">When working with large data sets, this analysis can negatively impact the performance of the control when automatic resizing occurs.</span></span> <span data-ttu-id="a1291-148">Чтобы избежать потерь производительности, следуйте приведенным ниже рекомендациям:</span><span class="sxs-lookup"><span data-stu-id="a1291-148">To avoid performance penalties, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="a1291-149">Старайтесь не использовать автоматическое изменение размеров на <xref:System.Windows.Forms.DataGridView> элемента управления с помощью большого набора строк.</span><span class="sxs-lookup"><span data-stu-id="a1291-149">Avoid using automatic sizing on a <xref:System.Windows.Forms.DataGridView> control with a large set of rows.</span></span> <span data-ttu-id="a1291-150">Если используется автоматическое изменение размеров только изменения размера на основе отображаемых строк.</span><span class="sxs-lookup"><span data-stu-id="a1291-150">If you do use automatic sizing, only resize based on the displayed rows.</span></span> <span data-ttu-id="a1291-151">Используйте только те строки, отображаемой в виртуальном режиме, а также.</span><span class="sxs-lookup"><span data-stu-id="a1291-151">Use only the displayed rows in virtual mode as well.</span></span>  
  
    -   <span data-ttu-id="a1291-152">Для строк и столбцов, используйте `DisplayedCells` или `DisplayedCellsExceptHeaders` поле <xref:System.Windows.Forms.DataGridViewAutoSizeRowsMode>, <xref:System.Windows.Forms.DataGridViewAutoSizeColumnsMode>, и <xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode> перечисления.</span><span class="sxs-lookup"><span data-stu-id="a1291-152">For rows and columns, use the `DisplayedCells` or `DisplayedCellsExceptHeaders` field of the <xref:System.Windows.Forms.DataGridViewAutoSizeRowsMode>, <xref:System.Windows.Forms.DataGridViewAutoSizeColumnsMode>, and <xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode> enumerations.</span></span>  
  
    -   <span data-ttu-id="a1291-153">Заголовки строк, используйте <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToDisplayedHeaders> или <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToFirstHeader> поле <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode> перечисления.</span><span class="sxs-lookup"><span data-stu-id="a1291-153">For row headers, use the <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToDisplayedHeaders> or <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToFirstHeader> field of the <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode> enumeration.</span></span>  
  
-   <span data-ttu-id="a1291-154">Для обеспечения максимальной масштабируемости отключите автоматическое изменение размеров и использовать программного изменения размеров.</span><span class="sxs-lookup"><span data-stu-id="a1291-154">For maximum scalability, turn off automatic sizing and use programmatic resizing.</span></span>  
  
 <span data-ttu-id="a1291-155">Дополнительные сведения см. в разделе [параметры изменения размера в элементе управления DataGridView Windows Forms](../../../../docs/framework/winforms/controls/sizing-options-in-the-windows-forms-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="a1291-155">For more information, see [Sizing Options in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/sizing-options-in-the-windows-forms-datagridview-control.md).</span></span>  
  
## <a name="using-the-selected-cells-rows-and-columns-collections-efficiently"></a><span data-ttu-id="a1291-156">Эффективное использование выделенных ячеек, строк и столбцов коллекций</span><span class="sxs-lookup"><span data-stu-id="a1291-156">Using the Selected Cells, Rows, and Columns Collections Efficiently</span></span>  
 <span data-ttu-id="a1291-157"><xref:System.Windows.Forms.DataGridView.SelectedCells%2A> Коллекции, неэффективно с большой выбор.</span><span class="sxs-lookup"><span data-stu-id="a1291-157">The <xref:System.Windows.Forms.DataGridView.SelectedCells%2A> collection does not perform efficiently with large selections.</span></span> <span data-ttu-id="a1291-158"><xref:System.Windows.Forms.DataGridView.SelectedRows%2A> И <xref:System.Windows.Forms.DataGridView.SelectedColumns%2A> также могут оказаться неэффективными, хотя и в меньшей степени, так как существует много меньше строк, чем ячеек в типичном <xref:System.Windows.Forms.DataGridView> управления и гораздо меньше столбцов, чем строк.</span><span class="sxs-lookup"><span data-stu-id="a1291-158">The <xref:System.Windows.Forms.DataGridView.SelectedRows%2A> and <xref:System.Windows.Forms.DataGridView.SelectedColumns%2A> collections can also be inefficient, although to a lesser degree because there are many fewer rows than cells in a typical <xref:System.Windows.Forms.DataGridView> control, and many fewer columns than rows.</span></span> <span data-ttu-id="a1291-159">Чтобы избежать снижения производительности при работе с этими коллекциями, следуйте приведенным ниже рекомендациям:</span><span class="sxs-lookup"><span data-stu-id="a1291-159">To avoid performance penalties when working with these collections, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="a1291-160">Для определения ли все ячейки в <xref:System.Windows.Forms.DataGridView> были выбраны для доступа к содержимое <xref:System.Windows.Forms.DataGridView.SelectedCells%2A> коллекции, проверьте значение, возвращаемое <xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="a1291-160">To determine whether all the cells in the <xref:System.Windows.Forms.DataGridView> have been selected before you access the contents of the <xref:System.Windows.Forms.DataGridView.SelectedCells%2A> collection, check the return value of the <xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A> method.</span></span> <span data-ttu-id="a1291-161">Обратите внимание, что этого метода может привести к строкам.</span><span class="sxs-lookup"><span data-stu-id="a1291-161">Note, however, that this method can cause rows to become unshared.</span></span> <span data-ttu-id="a1291-162">Дополнительные сведения см. в следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="a1291-162">For more information, see the next section.</span></span>  
  
-   <span data-ttu-id="a1291-163">Избегайте использования <xref:System.Collections.ICollection.Count%2A> свойство <xref:System.Windows.Forms.DataGridViewSelectedCellCollection?displayProperty=nameWithType> для определения числа выделенных ячеек.</span><span class="sxs-lookup"><span data-stu-id="a1291-163">Avoid using the <xref:System.Collections.ICollection.Count%2A> property of the <xref:System.Windows.Forms.DataGridViewSelectedCellCollection?displayProperty=nameWithType> to determine the number of selected cells.</span></span> <span data-ttu-id="a1291-164">Вместо этого используйте <xref:System.Windows.Forms.DataGridView.GetCellCount%2A?displayProperty=nameWithType> метод и передайте его в <xref:System.Windows.Forms.DataGridViewElementStates.Selected?displayProperty=nameWithType> значение.</span><span class="sxs-lookup"><span data-stu-id="a1291-164">Instead, use the <xref:System.Windows.Forms.DataGridView.GetCellCount%2A?displayProperty=nameWithType> method and pass in the <xref:System.Windows.Forms.DataGridViewElementStates.Selected?displayProperty=nameWithType> value.</span></span> <span data-ttu-id="a1291-165">Аналогичным образом, использовать <xref:System.Windows.Forms.DataGridViewRowCollection.GetRowCount%2A?displayProperty=nameWithType> и <xref:System.Windows.Forms.DataGridViewColumnCollection.GetColumnCount%2A?displayProperty=nameWithType> методов, чтобы определить количество выбранных элементов, а не доступ к коллекциям выбранных строк и столбцов.</span><span class="sxs-lookup"><span data-stu-id="a1291-165">Similarly, use the <xref:System.Windows.Forms.DataGridViewRowCollection.GetRowCount%2A?displayProperty=nameWithType> and <xref:System.Windows.Forms.DataGridViewColumnCollection.GetColumnCount%2A?displayProperty=nameWithType> methods to determine the number of selected elements, rather than accessing the selected row and column collections.</span></span>  
  
-   <span data-ttu-id="a1291-166">Избегайте режимы выбора на основе ячеек.</span><span class="sxs-lookup"><span data-stu-id="a1291-166">Avoid cell-based selection modes.</span></span> <span data-ttu-id="a1291-167">Вместо этого задайте <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> свойства <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType> или <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="a1291-167">Instead, set the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property to <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>.</span></span>  
  
## <a name="using-shared-rows"></a><span data-ttu-id="a1291-168">Использование общих строк</span><span class="sxs-lookup"><span data-stu-id="a1291-168">Using Shared Rows</span></span>  
 <span data-ttu-id="a1291-169">Эффективного использования памяти производится в <xref:System.Windows.Forms.DataGridView> управление с помощью общих строк.</span><span class="sxs-lookup"><span data-stu-id="a1291-169">Efficient memory use is achieved in the <xref:System.Windows.Forms.DataGridView> control through shared rows.</span></span> <span data-ttu-id="a1291-170">Строки будут совместно использовать столько информации об их внешний вид и поведение можно путем совместного использования экземпляров <xref:System.Windows.Forms.DataGridViewRow> класса.</span><span class="sxs-lookup"><span data-stu-id="a1291-170">Rows will share as much information about their appearance and behavior as possible by sharing instances of the <xref:System.Windows.Forms.DataGridViewRow> class.</span></span>  
  
 <span data-ttu-id="a1291-171">Пока совместное использование экземпляров строк сохраняет в памяти, строк можно легко строкам.</span><span class="sxs-lookup"><span data-stu-id="a1291-171">While sharing row instances saves memory, rows can easily become unshared.</span></span> <span data-ttu-id="a1291-172">Например каждый раз, когда пользователь взаимодействует непосредственно с ячейкой, соответствующей строке блокируется.</span><span class="sxs-lookup"><span data-stu-id="a1291-172">For example, whenever a user interacts directly with a cell, its row becomes unshared.</span></span> <span data-ttu-id="a1291-173">Так как не удается избежать, приведенными в этом разделе полезны только при работе с очень большими объемами данных и только в том случае, если пользователи взаимодействуют с относительно небольшим часть данных при каждом запуске программы.</span><span class="sxs-lookup"><span data-stu-id="a1291-173">Because this cannot be avoided, the guidelines in this topic are useful only when working with very large amounts of data and only when users will interact with a relatively small part of the data each time your program is run.</span></span>  
  
 <span data-ttu-id="a1291-174">Строки не могут быть доступны несвязанного <xref:System.Windows.Forms.DataGridView> управления, если какие-либо ячейки, содержащие значение.</span><span class="sxs-lookup"><span data-stu-id="a1291-174">A row cannot be shared in an unbound <xref:System.Windows.Forms.DataGridView> control if any of its cells contain values.</span></span> <span data-ttu-id="a1291-175">Когда <xref:System.Windows.Forms.DataGridView> элемент управления привязан к внешнему источнику данных или при реализации виртуального режима и укажите источник данных, значения ячеек хранятся вне элемента управления, а не в объектах ячеек, что строк для совместного использования.</span><span class="sxs-lookup"><span data-stu-id="a1291-175">When the <xref:System.Windows.Forms.DataGridView> control is bound to an external data source or when you implement virtual mode and provide your own data source, the cell values are stored outside the control rather than in cell objects, allowing the rows to be shared.</span></span>  
  
 <span data-ttu-id="a1291-176">Объект строки можно использовать совместно только в том случае, если можно определить состояние всех его ячеек из состояния строки и состояний столбцов, содержащие ячейки.</span><span class="sxs-lookup"><span data-stu-id="a1291-176">A row object can only be shared if the state of all its cells can be determined from the state of the row and the states of the columns containing the cells.</span></span> <span data-ttu-id="a1291-177">При изменении состояния ячейки, чтобы он больше не могут быть выведены от состояния ее строки и столбца, строки нельзя сделать общим.</span><span class="sxs-lookup"><span data-stu-id="a1291-177">If you change the state of a cell so that it can no longer be deduced from the state of its row and column, the row cannot be shared.</span></span>  
  
 <span data-ttu-id="a1291-178">Например строка не может использоваться в любом из следующих ситуаций:</span><span class="sxs-lookup"><span data-stu-id="a1291-178">For example, a row cannot be shared in any of the following situations:</span></span>  
  
-   <span data-ttu-id="a1291-179">Строка содержит единственную выделенную ячейку, не находится в выбранном столбце.</span><span class="sxs-lookup"><span data-stu-id="a1291-179">The row contains a single selected cell that is not in a selected column.</span></span>  
  
-   <span data-ttu-id="a1291-180">Строка содержит ячейку с его <xref:System.Windows.Forms.DataGridViewCell.ToolTipText%2A> или <xref:System.Windows.Forms.DataGridViewCell.ContextMenuStrip%2A> набором свойств.</span><span class="sxs-lookup"><span data-stu-id="a1291-180">The row contains a cell with its <xref:System.Windows.Forms.DataGridViewCell.ToolTipText%2A> or <xref:System.Windows.Forms.DataGridViewCell.ContextMenuStrip%2A> properties set.</span></span>  
  
-   <span data-ttu-id="a1291-181">Строка содержит <xref:System.Windows.Forms.DataGridViewComboBoxCell> с его <xref:System.Windows.Forms.DataGridViewComboBoxCell.Items%2A> набор свойств.</span><span class="sxs-lookup"><span data-stu-id="a1291-181">The row contains a <xref:System.Windows.Forms.DataGridViewComboBoxCell> with its <xref:System.Windows.Forms.DataGridViewComboBoxCell.Items%2A> property set.</span></span>  
  
 <span data-ttu-id="a1291-182">В связанном или виртуальном режиме, вы можете предоставить подсказки и контекстные меню для отдельных ячеек, обрабатывая <xref:System.Windows.Forms.DataGridView.CellToolTipTextNeeded> и <xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded> события.</span><span class="sxs-lookup"><span data-stu-id="a1291-182">In bound mode or virtual mode, you can provide ToolTips and shortcut menus for individual cells by handling the <xref:System.Windows.Forms.DataGridView.CellToolTipTextNeeded> and <xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded> events.</span></span>  
  
 <span data-ttu-id="a1291-183"><xref:System.Windows.Forms.DataGridView> Управления автоматически будет пытаться использовать общие строки при добавлении строк в <xref:System.Windows.Forms.DataGridViewRowCollection>.</span><span class="sxs-lookup"><span data-stu-id="a1291-183">The <xref:System.Windows.Forms.DataGridView> control will automatically attempt to use shared rows whenever rows are added to the <xref:System.Windows.Forms.DataGridViewRowCollection>.</span></span> <span data-ttu-id="a1291-184">Чтобы убедиться, что строки являются общими, следуйте приведенным ниже рекомендациям:</span><span class="sxs-lookup"><span data-stu-id="a1291-184">Use the following guidelines to ensure that rows are shared:</span></span>  
  
-   <span data-ttu-id="a1291-185">Старайтесь не вызывать `Add(Object[])` перегруженная версия <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> метод и `Insert(Object[])` перегруженная версия <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> метод <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> коллекции.</span><span class="sxs-lookup"><span data-stu-id="a1291-185">Avoid calling the `Add(Object[])` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> method and the `Insert(Object[])` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> method of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span> <span data-ttu-id="a1291-186">Эти перегрузки автоматически создают строки с монопольным доступом.</span><span class="sxs-lookup"><span data-stu-id="a1291-186">These overloads automatically create unshared rows.</span></span>  
  
-   <span data-ttu-id="a1291-187">Убедитесь, что строки, заданной в <xref:System.Windows.Forms.DataGridView.RowTemplate%2A?displayProperty=nameWithType> свойства, которые могут использоваться в следующих случаях:</span><span class="sxs-lookup"><span data-stu-id="a1291-187">Be sure that the row specified in the <xref:System.Windows.Forms.DataGridView.RowTemplate%2A?displayProperty=nameWithType> property can be shared in the following cases:</span></span>  
  
    -   <span data-ttu-id="a1291-188">При вызове `Add()` или `Add(Int32)` перегрузок <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> метода или `Insert(Int32,Int32)` перегруженная версия <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> метод <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> коллекции.</span><span class="sxs-lookup"><span data-stu-id="a1291-188">When calling the `Add()` or `Add(Int32)` overloads of the <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> method or the `Insert(Int32,Int32)` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> method of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span>  
  
    -   <span data-ttu-id="a1291-189">Если увеличить значение <xref:System.Windows.Forms.DataGridView.RowCount%2A?displayProperty=nameWithType> свойства.</span><span class="sxs-lookup"><span data-stu-id="a1291-189">When increasing the value of the <xref:System.Windows.Forms.DataGridView.RowCount%2A?displayProperty=nameWithType> property.</span></span>  
  
    -   <span data-ttu-id="a1291-190">При задании <xref:System.Windows.Forms.DataGridView.DataSource%2A?displayProperty=nameWithType> свойство.</span><span class="sxs-lookup"><span data-stu-id="a1291-190">When setting the <xref:System.Windows.Forms.DataGridView.DataSource%2A?displayProperty=nameWithType> property.</span></span>  
  
-   <span data-ttu-id="a1291-191">Убедитесь, что к строке, указанной `indexSource` параметр можно использовать совместно, при вызове <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopy%2A>, <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopies%2A>, <xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopy%2A>, и <xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopies%2A> методы <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> коллекции.</span><span class="sxs-lookup"><span data-stu-id="a1291-191">Be sure that the row indicated by the `indexSource` parameter can be shared when calling the <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopy%2A>, <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopies%2A>, <xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopy%2A>, and <xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopies%2A> methods of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span>  
  
-   <span data-ttu-id="a1291-192">Убедитесь, что при вызове может быть совместно указанной строки или строк `Add(DataGridViewRow)` перегруженная версия <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> метод, <xref:System.Windows.Forms.DataGridViewRowCollection.AddRange%2A> метода `Insert(Int32,DataGridViewRow)` перегруженная версия <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> метода и <xref:System.Windows.Forms.DataGridViewRowCollection.InsertRange%2A> метод <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType>коллекции.</span><span class="sxs-lookup"><span data-stu-id="a1291-192">Be sure that the specified row or rows can be shared when calling the `Add(DataGridViewRow)` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> method, the <xref:System.Windows.Forms.DataGridViewRowCollection.AddRange%2A> method, the `Insert(Int32,DataGridViewRow)` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> method, and the <xref:System.Windows.Forms.DataGridViewRowCollection.InsertRange%2A> method of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span>  
  
 <span data-ttu-id="a1291-193">Чтобы определить, является ли строка общей, используйте <xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType> метод для извлечения объекта строки и возврата объекта <xref:System.Windows.Forms.DataGridViewBand.Index%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="a1291-193">To determine whether a row is shared, use the <xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType> method to retrieve the row object, and then check the object's <xref:System.Windows.Forms.DataGridViewBand.Index%2A> property.</span></span> <span data-ttu-id="a1291-194">Общие строки всегда имеют <xref:System.Windows.Forms.DataGridViewBand.Index%2A> значение свойства равно – 1.</span><span class="sxs-lookup"><span data-stu-id="a1291-194">Shared rows always have an <xref:System.Windows.Forms.DataGridViewBand.Index%2A> property value of –1.</span></span>  
  
## <a name="preventing-rows-from-becoming-unshared"></a><span data-ttu-id="a1291-195">Предотвращение строкам</span><span class="sxs-lookup"><span data-stu-id="a1291-195">Preventing Rows from Becoming Unshared</span></span>  
 <span data-ttu-id="a1291-196">Общие строки может привести к блокированию кода или действия пользователя.</span><span class="sxs-lookup"><span data-stu-id="a1291-196">Shared rows can become unshared as a result of code or user action.</span></span> <span data-ttu-id="a1291-197">Чтобы избежать снижения производительности, следует избегать, что приводит к строкам.</span><span class="sxs-lookup"><span data-stu-id="a1291-197">To avoid a performance impact, you should avoid causing rows to become unshared.</span></span> <span data-ttu-id="a1291-198">Во время разработки приложения можно обрабатывать <xref:System.Windows.Forms.DataGridView.RowUnshared> событие, чтобы определить, когда строки становятся общими.</span><span class="sxs-lookup"><span data-stu-id="a1291-198">During application development, you can handle the <xref:System.Windows.Forms.DataGridView.RowUnshared> event to determine when rows become unshared.</span></span> <span data-ttu-id="a1291-199">Это полезно при отладке проблем общий доступ к строкам.</span><span class="sxs-lookup"><span data-stu-id="a1291-199">This is useful when debugging row-sharing problems.</span></span>  
  
 <span data-ttu-id="a1291-200">Чтобы предотвратить строк строкам, следуйте приведенным ниже рекомендациям:</span><span class="sxs-lookup"><span data-stu-id="a1291-200">To prevent rows from becoming unshared, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="a1291-201">Следует избегать индексирования <xref:System.Windows.Forms.DataGridView.Rows%2A> коллекции или ее перебора с `foreach` цикла.</span><span class="sxs-lookup"><span data-stu-id="a1291-201">Avoid indexing the <xref:System.Windows.Forms.DataGridView.Rows%2A> collection or iterating through it with a `foreach` loop.</span></span> <span data-ttu-id="a1291-202">Не потребуется обычно прямой доступ к строкам.</span><span class="sxs-lookup"><span data-stu-id="a1291-202">You will not typically need to access rows directly.</span></span> <span data-ttu-id="a1291-203"><xref:System.Windows.Forms.DataGridView>методы, которые работают в строках принимают аргументы строки индекса, а не экземпляру строки.</span><span class="sxs-lookup"><span data-stu-id="a1291-203"><xref:System.Windows.Forms.DataGridView> methods that operate on rows take row index arguments rather than row instances.</span></span> <span data-ttu-id="a1291-204">Кроме того обработчики событий, связанных со строками принимают аргумент объекты со свойствами строк, которые можно использовать для операций со строками, избегая их к строкам.</span><span class="sxs-lookup"><span data-stu-id="a1291-204">Additionally, handlers for row-related events receive event argument objects with row properties that you can use to manipulate rows without causing them to become unshared.</span></span>  
  
-   <span data-ttu-id="a1291-205">Если необходимо получить доступ к объекту строки, используйте <xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType> метод и передайте ему фактический индекс строки.</span><span class="sxs-lookup"><span data-stu-id="a1291-205">If you need to access a row object, use the <xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType> method and pass in the row's actual index.</span></span> <span data-ttu-id="a1291-206">Обратите внимание, что для изменения объекта совместно используемой строки, полученные таким способом изменить все строки, которые совместно используют этот объект.</span><span class="sxs-lookup"><span data-stu-id="a1291-206">Note, however, that modifying a shared row object retrieved through this method will modify all the rows that share this object.</span></span> <span data-ttu-id="a1291-207">Строку для новых записей не используется совместно с другими строками, тем не менее, так он не будут затронуты при изменении любых других строк.</span><span class="sxs-lookup"><span data-stu-id="a1291-207">The row for new records is not shared with other rows, however, so it will not be affected when you modify any other row.</span></span> <span data-ttu-id="a1291-208">Обратите внимание, что различные строки, представленные совместно используемой строки могут иметь разные контекстные меню.</span><span class="sxs-lookup"><span data-stu-id="a1291-208">Note also that different rows represented by a shared row may have different shortcut menus.</span></span> <span data-ttu-id="a1291-209">Чтобы получить правильный контекстное меню из экземпляра общей строки, используйте <xref:System.Windows.Forms.DataGridViewRow.GetContextMenuStrip%2A> метод и передайте ему фактический индекс строки.</span><span class="sxs-lookup"><span data-stu-id="a1291-209">To retrieve the correct shortcut menu from a shared row instance, use the <xref:System.Windows.Forms.DataGridViewRow.GetContextMenuStrip%2A> method and pass in the row's actual index.</span></span> <span data-ttu-id="a1291-210">Если доступ к совместно используемой строки <xref:System.Windows.Forms.DataGridViewRow.ContextMenuStrip%2A> свойство вместо этого он будет использовать индекс совместно используемой строки-1 и не получает правильные контекстное меню.</span><span class="sxs-lookup"><span data-stu-id="a1291-210">If you access the shared row's <xref:System.Windows.Forms.DataGridViewRow.ContextMenuStrip%2A> property instead, it will use the shared row index of -1 and will not retrieve the correct shortcut menu.</span></span>  
  
-   <span data-ttu-id="a1291-211">Следует избегать индексирования <xref:System.Windows.Forms.DataGridViewRow.Cells%2A?displayProperty=nameWithType> коллекции.</span><span class="sxs-lookup"><span data-stu-id="a1291-211">Avoid indexing the <xref:System.Windows.Forms.DataGridViewRow.Cells%2A?displayProperty=nameWithType> collection.</span></span> <span data-ttu-id="a1291-212">Для прямого доступа к ячейке приведет к ее родительской строки к строкам, создания нового <xref:System.Windows.Forms.DataGridViewRow>.</span><span class="sxs-lookup"><span data-stu-id="a1291-212">Accessing a cell directly will cause its parent row to become unshared, instantiating a new <xref:System.Windows.Forms.DataGridViewRow>.</span></span> <span data-ttu-id="a1291-213">Обработчики событий, связанных с ячейками принимают аргумент объекты со свойствами ячеек, которые можно использовать для операций с ячейками, не приводящее к строкам.</span><span class="sxs-lookup"><span data-stu-id="a1291-213">Handlers for cell-related events receive event argument objects with cell properties that you can use to manipulate cells without causing rows to become unshared.</span></span> <span data-ttu-id="a1291-214">Можно также использовать <xref:System.Windows.Forms.DataGridView.CurrentCellAddress%2A> свойства, чтобы получить индексы строки и столбца текущей ячейки без прямого доступа к ячейке.</span><span class="sxs-lookup"><span data-stu-id="a1291-214">You can also use the <xref:System.Windows.Forms.DataGridView.CurrentCellAddress%2A> property to retrieve the row and column indexes of the current cell without accessing the cell directly.</span></span>  
  
-   <span data-ttu-id="a1291-215">Избегайте режимы выбора на основе ячеек.</span><span class="sxs-lookup"><span data-stu-id="a1291-215">Avoid cell-based selection modes.</span></span> <span data-ttu-id="a1291-216">Эти режимы привести к строкам.</span><span class="sxs-lookup"><span data-stu-id="a1291-216">These modes cause rows to become unshared.</span></span> <span data-ttu-id="a1291-217">Вместо этого задайте <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> свойства <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType> или <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="a1291-217">Instead, set the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property to <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>.</span></span>  
  
-   <span data-ttu-id="a1291-218">Не следует обрабатывать <xref:System.Windows.Forms.DataGridViewRowCollection.CollectionChanged?displayProperty=nameWithType> или <xref:System.Windows.Forms.DataGridView.RowStateChanged?displayProperty=nameWithType> события.</span><span class="sxs-lookup"><span data-stu-id="a1291-218">Do not handle the <xref:System.Windows.Forms.DataGridViewRowCollection.CollectionChanged?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridView.RowStateChanged?displayProperty=nameWithType> events.</span></span> <span data-ttu-id="a1291-219">Эти события привести к строкам.</span><span class="sxs-lookup"><span data-stu-id="a1291-219">These events cause rows to become unshared.</span></span> <span data-ttu-id="a1291-220">Кроме того, не следует вызывать <xref:System.Windows.Forms.DataGridViewRowCollection.OnCollectionChanged%2A?displayProperty=nameWithType> или <xref:System.Windows.Forms.DataGridView.OnRowStateChanged%2A?displayProperty=nameWithType> методы, которые инициируют эти события.</span><span class="sxs-lookup"><span data-stu-id="a1291-220">Also, do not call the <xref:System.Windows.Forms.DataGridViewRowCollection.OnCollectionChanged%2A?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridView.OnRowStateChanged%2A?displayProperty=nameWithType> methods, which raise these events.</span></span>  
  
-   <span data-ttu-id="a1291-221">Нет доступа к <xref:System.Windows.Forms.DataGridView.SelectedCells%2A?displayProperty=nameWithType> коллекции при <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> значение свойства <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect>, <xref:System.Windows.Forms.DataGridViewSelectionMode.ColumnHeaderSelect>, <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect>, или <xref:System.Windows.Forms.DataGridViewSelectionMode.RowHeaderSelect>.</span><span class="sxs-lookup"><span data-stu-id="a1291-221">Do not access the <xref:System.Windows.Forms.DataGridView.SelectedCells%2A?displayProperty=nameWithType> collection when the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property value is <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect>, <xref:System.Windows.Forms.DataGridViewSelectionMode.ColumnHeaderSelect>, <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect>, or <xref:System.Windows.Forms.DataGridViewSelectionMode.RowHeaderSelect>.</span></span> <span data-ttu-id="a1291-222">В этом случае все выделенные строки к строкам.</span><span class="sxs-lookup"><span data-stu-id="a1291-222">This causes all selected rows to become unshared.</span></span>  
  
-   <span data-ttu-id="a1291-223">Не вызывайте <xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A?displayProperty=nameWithType> метод.</span><span class="sxs-lookup"><span data-stu-id="a1291-223">Do not call the <xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="a1291-224">Использование этого метода может привести к строкам.</span><span class="sxs-lookup"><span data-stu-id="a1291-224">This method can cause rows to become unshared.</span></span>  
  
-   <span data-ttu-id="a1291-225">Не вызывайте <xref:System.Windows.Forms.DataGridView.SelectAll%2A?displayProperty=nameWithType> метод при <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> значение свойства <xref:System.Windows.Forms.DataGridViewSelectionMode.CellSelect>.</span><span class="sxs-lookup"><span data-stu-id="a1291-225">Do not call the <xref:System.Windows.Forms.DataGridView.SelectAll%2A?displayProperty=nameWithType> method when the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property value is <xref:System.Windows.Forms.DataGridViewSelectionMode.CellSelect>.</span></span> <span data-ttu-id="a1291-226">В этом случае все строки к строкам.</span><span class="sxs-lookup"><span data-stu-id="a1291-226">This causes all rows to become unshared.</span></span>  
  
-   <span data-ttu-id="a1291-227">Не устанавливайте <xref:System.Windows.Forms.DataGridViewCell.ReadOnly%2A> или <xref:System.Windows.Forms.DataGridViewCell.Selected%2A> свойство ячейки для `false` Если значение соответствующего свойства в столбце `true`.</span><span class="sxs-lookup"><span data-stu-id="a1291-227">Do not set the <xref:System.Windows.Forms.DataGridViewCell.ReadOnly%2A> or <xref:System.Windows.Forms.DataGridViewCell.Selected%2A> property of a cell to `false` when the corresponding property in its column is set to `true`.</span></span> <span data-ttu-id="a1291-228">В этом случае все строки к строкам.</span><span class="sxs-lookup"><span data-stu-id="a1291-228">This causes all rows to become unshared.</span></span>  
  
-   <span data-ttu-id="a1291-229">Нет доступа к <xref:System.Windows.Forms.DataGridViewRowCollection.List%2A?displayProperty=nameWithType> свойство.</span><span class="sxs-lookup"><span data-stu-id="a1291-229">Do not access the <xref:System.Windows.Forms.DataGridViewRowCollection.List%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="a1291-230">В этом случае все строки к строкам.</span><span class="sxs-lookup"><span data-stu-id="a1291-230">This causes all rows to become unshared.</span></span>  
  
-   <span data-ttu-id="a1291-231">Не вызывайте `Sort(IComparer)` перегрузки <xref:System.Windows.Forms.DataGridView.Sort%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="a1291-231">Do not call the `Sort(IComparer)` overload of the <xref:System.Windows.Forms.DataGridView.Sort%2A> method.</span></span> <span data-ttu-id="a1291-232">Сортировка с помощью пользовательского модуля сравнения, все строки к строкам.</span><span class="sxs-lookup"><span data-stu-id="a1291-232">Sorting with a custom comparer causes all rows to become unshared.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a1291-233">См. также</span><span class="sxs-lookup"><span data-stu-id="a1291-233">See Also</span></span>  
 <xref:System.Windows.Forms.DataGridView>  
 [<span data-ttu-id="a1291-234">Оптимизация производительности элемента управления DataGridView в Windows Forms</span><span class="sxs-lookup"><span data-stu-id="a1291-234">Performance Tuning in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/performance-tuning-in-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="a1291-235">Виртуальный режим элемента управления DataGridView в Windows Forms</span><span class="sxs-lookup"><span data-stu-id="a1291-235">Virtual Mode in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/virtual-mode-in-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="a1291-236">Режимы отображения данных в элементе управления DataGridView в Windows Forms</span><span class="sxs-lookup"><span data-stu-id="a1291-236">Data Display Modes in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/data-display-modes-in-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="a1291-237">Стили ячеек элемента управления DataGridView в Windows Forms</span><span class="sxs-lookup"><span data-stu-id="a1291-237">Cell Styles in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/cell-styles-in-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="a1291-238">Практическое руководство. Установка стилей ячейки по умолчанию для элемента управления DataGridView в Windows Forms</span><span class="sxs-lookup"><span data-stu-id="a1291-238">How to: Set Default Cell Styles for the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="a1291-239">Изменение размеров управления DataGridView в Windows Forms</span><span class="sxs-lookup"><span data-stu-id="a1291-239">Sizing Options in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/sizing-options-in-the-windows-forms-datagridview-control.md)
