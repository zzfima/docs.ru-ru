---
title: "Автоматическое масштабирование в Windows Forms"
ms.date: 06/15/2017
ms.prod: .net-framework
ms.technology: dotnet-winforms
ms.topic: article
helpviewer_keywords:
- scalability [Windows Forms], automatic in Windows Forms
- Windows Forms, automatic scaling
ms.assetid: 68fad25b-afbc-44bd-8e1b-966fc43507a4
caps.latest.revision: "9"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 4eefab1dccc295557d95485d6f38add41e634fa4
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/21/2017
---
# <a name="automatic-scaling-in-windows-forms"></a><span data-ttu-id="9ebfe-102">Автоматическое масштабирование в Windows Forms</span><span class="sxs-lookup"><span data-stu-id="9ebfe-102">Automatic scaling in Windows Forms</span></span>
<span data-ttu-id="9ebfe-103">Автоматическое масштабирование позволяет форме и ее элементам управления, разработанным на одном компьютере с использованием определенного разрешения или системных шрифтов, правильно отображаться на другом компьютере с другим разрешением или системным шрифтом.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-103">Automatic scaling enables a form and its controls, designed on one machine with a certain display resolution or system font, to be displayed appropriately on another machine with a different display resolution or system font.</span></span> <span data-ttu-id="9ebfe-104">Оно гарантирует, что размеры формы и ее элементов управления будут изменяться автоматически в соответствии с приложениями Windows и другими приложениями на компьютерах пользователя и разработчика.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-104">It assures that the form and its controls will intelligently resize to be consistent with native windows and other applications on both the users' and other developers' machines.</span></span> <span data-ttu-id="9ebfe-105">Поддержка автоматического масштабирования и стилей оформления в [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] позволяет приложениям [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] сохранять согласованный внешний вид и поведение на различных компьютерах пользователей, так же как в случае с обычными приложениями Windows.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-105">The support of the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] for automatic scaling and visual styles enables [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] applications to maintain a consistent look and feel when compared to native Windows applications on each user's machine.</span></span>
  
<span data-ttu-id="9ebfe-106">В большинстве случаев автоматическое масштабирование работает должным образом в [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 2.0 и более поздних версий.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-106">For the most part, automatic scaling works as expected in [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] version 2.0 and later.</span></span> <span data-ttu-id="9ebfe-107">Однако внесение изменений в схему шрифтов может быть проблематичным.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-107">However, font scheme changes can be problematic.</span></span> <span data-ttu-id="9ebfe-108">Пример решения этой проблемы см. в разделе [как: ответ на изменения схемы шрифтов в приложении Windows Forms](how-to-respond-to-font-scheme-changes-in-a-windows-forms-application.md).</span><span class="sxs-lookup"><span data-stu-id="9ebfe-108">To see an example of how to resolve this, see [How to: Respond to Font Scheme Changes in a Windows Forms Application](how-to-respond-to-font-scheme-changes-in-a-windows-forms-application.md).</span></span>
  
## <a name="need-for-automatic-scaling"></a><span data-ttu-id="9ebfe-109">Потребность в автоматическом масштабировании</span><span class="sxs-lookup"><span data-stu-id="9ebfe-109">Need for automatic scaling</span></span>  
<span data-ttu-id="9ebfe-110">Без автоматического масштабирования приложения, разработанные для определенного разрешения экрана или шрифта, будут выглядеть либо слишком маленькими, либо слишком большими при изменении разрешения или шрифта.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-110">Without automatic scaling, an application designed for one display resolution or font will either appear too small or too large when that resolution or font is changed.</span></span> <span data-ttu-id="9ebfe-111">Например, если приложение разработано с использованием базового шрифта Tahoma размером 9 пунктов, то без коррекции оно будет выглядеть слишком маленьким при запуске на компьютере, на котором в качестве системного шрифта используется Tahoma размером 12 пунктов.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-111">For example, if the application is designed using Tahoma 9 point as a baseline, without adjustment it will appear too small if run on a machine where the system font is Tahoma 12 point.</span></span> <span data-ttu-id="9ebfe-112">Текстовые элементы, такие как заголовки, меню, содержимое текстовых полей и т. д., будут меньше, чем в других приложениях.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-112">Text elements, such as titles, menus, text box contents, and so on will render smaller than other applications.</span></span> <span data-ttu-id="9ebfe-113">Более того, размер содержащих текст элементов пользовательского интерфейса, таких как строки заголовков, меню и т. д., зависит от используемого шрифта.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-113">Furthermore, the size of user interface (UI) elements that contain text, such as the title bar, menus, and many controls are dependent on the font used.</span></span> <span data-ttu-id="9ebfe-114">В рассматриваемом примере эти элементы также будут выглядеть относительно меньше.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-114">In this example, these elements will also appear relatively smaller.</span></span>

<span data-ttu-id="9ebfe-115">Аналогичная ситуация возникает, когда приложение разработано для определенного разрешения экрана.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-115">An analogous situation occurs when an application is designed for a certain display resolution.</span></span> <span data-ttu-id="9ebfe-116">Наиболее частое разрешение экрана — 96 точек на дюйм (DPI), равно 100% масштаб отображения, но выше отображает разрешение поддержкой 125%, 150%, 200% (какие соответственно равен 120, 144 и 192 точек на ДЮЙМ) и более поздних версий, становятся все более распространенными.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-116">The most common display resolution is 96 dots per inch (DPI), which equals 100% display scaling, but higher resolution displays supporting 125%, 150%, 200% (which respectively equal 120, 144 and 192 DPI) and above are becoming more common.</span></span> <span data-ttu-id="9ebfe-117">Без коррекции приложение, особенно графическое, разработанное для одного разрешения, будет отображаться либо слишком большим, либо слишком маленьким при запуске с другим разрешением.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-117">Without adjustment, an application, especially a graphics-based one, designed for one resolution will appear either too large or too small when run at another resolution.</span></span>

<span data-ttu-id="9ebfe-118">Автоматическое масштабирование предназначено для решения таких проблем путем автоматического изменения размеров формы и ее дочерних элементов управления согласно относительному размеру шрифтов и разрешению экрана.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-118">Automatic scaling seeks to ameliorate these problems by automatically resizing the form and its child controls according to the relative font size or display resolution.</span></span> <span data-ttu-id="9ebfe-119">Операционная система Windows поддерживает автоматическое масштабирование диалоговых окон с помощью относительной единицы измерения, называемой единицей размера диалогового окна.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-119">The Windows operating system supports automatic scaling of dialog boxes using a relative unit of measurement called dialog units.</span></span> <span data-ttu-id="9ebfe-120">Единица размера диалогового окна основана на системном шрифте, а ее связь с пикселями можно определить с помощью функции `GetDialogBaseUnits` пакета Win32 SDK.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-120">A dialog unit is based on the system font and its relationship to pixels can be determined though the Win32 SDK function `GetDialogBaseUnits`.</span></span> <span data-ttu-id="9ebfe-121">При изменении темы, используемой Windows, все диалоговые окна автоматически настраиваются соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-121">When a user changes the theme used by Windows, all dialog boxes are automatically adjusted accordingly.</span></span> <span data-ttu-id="9ebfe-122">Кроме того [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] поддерживается автоматическое масштабирование в соответствии со стандартным системным шрифтом или разрешением экрана.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-122">In addition, the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] supports automatic scaling either according to the default system font or the display resolution.</span></span> <span data-ttu-id="9ebfe-123">При необходимости автоматическое масштабирование можно отключить в приложении.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-123">Optionally, automatic scaling can be disabled in an application.</span></span>

## <a name="original-support-for-automatic-scaling"></a><span data-ttu-id="9ebfe-124">Исходная поддержка автоматического масштабирования</span><span class="sxs-lookup"><span data-stu-id="9ebfe-124">Original support for automatic scaling</span></span>
<span data-ttu-id="9ebfe-125">в [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 1.0 и 1.1 автоматическое масштабирование поддерживалось простым способом и зависело от шрифта Windows, используемого по умолчанию для пользовательского интерфейса. Этот шрифт представлен в пакете Win32 SDK значением **DEFAULT_GUI_FONT**.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-125">Versions 1.0 and 1.1 of the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] supported automatic scaling in a straightforward manner that was dependent on the Windows default font used for the UI, represented by the Win32 SDK value **DEFAULT_GUI_FONT**.</span></span> <span data-ttu-id="9ebfe-126">Обычно этот шрифт изменяется только при изменении разрешения экрана.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-126">This font is typically only changed when the display resolution changes.</span></span> <span data-ttu-id="9ebfe-127">Для реализации автоматического масштабирования применялся описанный ниже механизм.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-127">The following mechanism was used to implement automatic scaling:</span></span>

1. <span data-ttu-id="9ebfe-128">Во время разработки свойству <xref:System.Windows.Forms.Form.AutoScaleBaseSize%2A> (которое теперь устарело) присваивалась высота и ширина системного шрифта по умолчанию на компьютере разработчика.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-128">At design time, the <xref:System.Windows.Forms.Form.AutoScaleBaseSize%2A> property (which is now deprecated) was set to the height and width of the default system font on the developer's machine.</span></span>

2. <span data-ttu-id="9ebfe-129">Во время выполнения для инициализации свойства <xref:System.Windows.Forms.Control.Font%2A> класса <xref:System.Windows.Forms.Form> использовался стандартный системный шрифт компьютера пользователя.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-129">At runtime, the default system font of the user's machine was used to initialize the <xref:System.Windows.Forms.Control.Font%2A> property of the <xref:System.Windows.Forms.Form> class.</span></span>

3. <span data-ttu-id="9ebfe-130">Перед отображением формы вызывался метод <xref:System.Windows.Forms.Form.ApplyAutoScaling%2A> для ее масштабирования.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-130">Before displaying the form, the <xref:System.Windows.Forms.Form.ApplyAutoScaling%2A> method was called to scale the form.</span></span> <span data-ttu-id="9ebfe-131">Этот метод вычислял относительный масштаб с помощью свойств <xref:System.Windows.Forms.Form.AutoScaleBaseSize%2A> и <xref:System.Windows.Forms.Control.Font%2A>, а затем вызывал метод <xref:System.Windows.Forms.Control.Scale%2A> для масштабирования формы и ее дочерних элементов.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-131">This method calculated the relative scale sizes from <xref:System.Windows.Forms.Form.AutoScaleBaseSize%2A> and <xref:System.Windows.Forms.Control.Font%2A> then called the <xref:System.Windows.Forms.Control.Scale%2A> method to actually scale the form and its children.</span></span>

4. <span data-ttu-id="9ebfe-132">Значение свойства <xref:System.Windows.Forms.Form.AutoScaleBaseSize%2A> обновлялось таким образом, чтобы последующие вызовы <xref:System.Windows.Forms.Form.ApplyAutoScaling%2A> не продолжали изменять размер формы.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-132">The value of <xref:System.Windows.Forms.Form.AutoScaleBaseSize%2A> was updated so that subsequent calls to <xref:System.Windows.Forms.Form.ApplyAutoScaling%2A> did not progressively resize the form.</span></span>

<span data-ttu-id="9ebfe-133">Этого механизма было достаточно для большинства целей, но он имел ряд ограничений.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-133">While this mechanism was sufficient for most purposes, it suffered from the following limitations:</span></span>

- <span data-ttu-id="9ebfe-134">Поскольку <xref:System.Windows.Forms.Form.AutoScaleBaseSize%2A> свойство представляет базовый размер шрифта как целые значения, погрешности округления становились заметны, когда форма проходила через ряд разрешений.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-134">Since the <xref:System.Windows.Forms.Form.AutoScaleBaseSize%2A> property represents the baseline font size as integer values, rounding errors occur that become evident when a form is cycled through multiple resolutions.</span></span>

- <span data-ttu-id="9ebfe-135">Автоматическое масштабирование было реализовано только в классе <xref:System.Windows.Forms.Form>, но не в классе <xref:System.Windows.Forms.ContainerControl>.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-135">Automatic scaling was implemented in only the <xref:System.Windows.Forms.Form> class, not in the <xref:System.Windows.Forms.ContainerControl> class.</span></span> <span data-ttu-id="9ebfe-136">В результате пользовательский элемент управления масштабировался корректно, только если он был разработан с тем же разрешением, что и форма, и был помещен в форму во время разработки.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-136">As a result, user controls would scale correctly only when the user control was designed at the same resolution as the form, and it was placed in the form at design time.</span></span>

- <span data-ttu-id="9ebfe-137">Несколько разработчиков могли параллельно разрабатывать формы и их дочерние элементы управления, только если разрешение экрана на их компьютерах совпадало.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-137">Forms and their child controls could only be concurrently designed by multiple developers if their machine resolutions were the same.</span></span> <span data-ttu-id="9ebfe-138">Аналогичным образом наследование форм зависело от разрешения родительской формы.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-138">Likewise it also made inheritance of a form dependent on the resolution associated with the parent form.</span></span>

> [!NOTE]
> <span data-ttu-id="9ebfe-139">Extreme различий в отображении DPI, особенно в современных устройств 2-в-1 по-прежнему возможно, с текущими версиями Visual Studio и .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-139">With the extreme differences in display DPIs, especially in modern 2-in-1 devices, this can still happen with the most current versions of the .NET Framework and Visual Studio.</span></span> <span data-ttu-id="9ebfe-140">Для решения этой команды, с помощью разных дисплеях, убедитесь, что Visual Studio всегда начинается в режиме, не поддерживающими DPI, поэтому конструктор Windows Forms всегда оснований расчет макета на 96 точек на ДЮЙМ.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-140">To address this in a team using different DPI displays, make sure Visual Studio always starts in a non-DPI-aware mode, so the Windows Forms designer always bases the layout calculation on 96 DPI.</span></span> <span data-ttu-id="9ebfe-141">Для этого нужно просто установите следующий раздел реестра для отключения учета HighDPI Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="9ebfe-141">To this end, simply set the following registry key to disable Visual Studio's HighDPI awareness:</span></span>
>
> ```
> [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\devenv.exe]
> "dpiAwareness"=dword:00000000
> ```

- <span data-ttu-id="9ebfe-142">Механизм несовместим с новыми диспетчерами макетов, добавленными в [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] версии 2.0, такими как <xref:System.Windows.Forms.FlowLayoutPanel> и <xref:System.Windows.Forms.TableLayoutPanel>.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-142">It is not compatible with the newer layout managers introduced with the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] version 2.0, such as <xref:System.Windows.Forms.FlowLayoutPanel> and <xref:System.Windows.Forms.TableLayoutPanel>.</span></span>

- <span data-ttu-id="9ebfe-143">Механизм не поддерживает масштабирование непосредственно на основе разрешения экрана, необходимое для совместимости с [!INCLUDE[compact](../../../includes/compact-md.md)].</span><span class="sxs-lookup"><span data-stu-id="9ebfe-143">It did not support scaling based directly on the display resolution that is required for compatibility to the [!INCLUDE[compact](../../../includes/compact-md.md)].</span></span>

<span data-ttu-id="9ebfe-144">Хотя этот механизм сохранился в [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] версии 2.0 для обеспечения обратной совместимости, на смену ему пришел более надежный механизм масштабирования, описанный ниже.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-144">Although this mechanism is preserved in the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] version 2.0 to maintain backward compatibility, it has been superseded by the more robust scaling mechanism described next.</span></span> <span data-ttu-id="9ebfe-145">Как следствие, методы <xref:System.Windows.Forms.Form.AutoScale%2A>, <xref:System.Windows.Forms.Form.ApplyAutoScaling%2A>, <xref:System.Windows.Forms.Form.AutoScaleBaseSize%2A> и некоторые перегрузки <xref:System.Windows.Forms.Control.Scale%2A> помечены как устаревшие.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-145">As a consequence, the <xref:System.Windows.Forms.Form.AutoScale%2A>, <xref:System.Windows.Forms.Form.ApplyAutoScaling%2A>, <xref:System.Windows.Forms.Form.AutoScaleBaseSize%2A>, and certain <xref:System.Windows.Forms.Control.Scale%2A> overloads are marked as obsolete.</span></span>

> [!NOTE]
> <span data-ttu-id="9ebfe-146">Вы можете спокойно удалить ссылки на эти члены при обновлении старого кода до [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] версии 2.0.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-146">You can safely delete references to these members when you upgrade your legacy code to the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] version 2.0.</span></span>

## <a name="current-support-for-automatic-scaling"></a><span data-ttu-id="9ebfe-147">Текущая поддержка автоматического масштабирования</span><span class="sxs-lookup"><span data-stu-id="9ebfe-147">Current support for automatic scaling</span></span>
<span data-ttu-id="9ebfe-148">В [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] версии 2.0 ограничения предыдущих версий снимаются благодаря описанным ниже изменениям, внесенным в механизм автоматического масштабирования форм Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-148">The [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] version 2.0 surmounts previous limitations by introducing the following changes to the automatic scaling of Windows Forms:</span></span>

- <span data-ttu-id="9ebfe-149">Базовая поддержка масштабирования была перемещена в класс <xref:System.Windows.Forms.ContainerControl>, чтобы формы, собственные составные элементы управления и пользовательские элементы управления получали единообразную поддержку масштабирования.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-149">Base support for scaling has been moved to the <xref:System.Windows.Forms.ContainerControl> class so that forms, native composite controls and user controls all receive uniform scaling support.</span></span> <span data-ttu-id="9ebfe-150">Были добавлены новые члены <xref:System.Windows.Forms.ContainerControl.AutoScaleFactor%2A>, <xref:System.Windows.Forms.ContainerControl.AutoScaleDimensions%2A>, <xref:System.Windows.Forms.ContainerControl.AutoScaleMode%2A> и <xref:System.Windows.Forms.ContainerControl.PerformAutoScale%2A>.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-150">The new members <xref:System.Windows.Forms.ContainerControl.AutoScaleFactor%2A>, <xref:System.Windows.Forms.ContainerControl.AutoScaleDimensions%2A>, <xref:System.Windows.Forms.ContainerControl.AutoScaleMode%2A> and <xref:System.Windows.Forms.ContainerControl.PerformAutoScale%2A> have been added.</span></span>

- <span data-ttu-id="9ebfe-151">Класс <xref:System.Windows.Forms.Control> также имеет несколько новых членов, которые позволяют ему участвовать в масштабировании и поддерживать смешанное масштабирование в одной и той же форме.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-151">The <xref:System.Windows.Forms.Control> class also has several new members that allow it to participate in scaling and to support mixed scaling on the same form.</span></span> <span data-ttu-id="9ebfe-152">В частности, члены <xref:System.Windows.Forms.Control.Scale%2A>, <xref:System.Windows.Forms.Control.ScaleChildren%2A> и <xref:System.Windows.Forms.Control.GetScaledBounds%2A> поддерживают масштабирование.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-152">Specifically the <xref:System.Windows.Forms.Control.Scale%2A>, <xref:System.Windows.Forms.Control.ScaleChildren%2A>, and <xref:System.Windows.Forms.Control.GetScaledBounds%2A> members support scaling.</span></span>

- <span data-ttu-id="9ebfe-153">В дополнение к поддержке системного шрифта была добавлена поддержка масштабирования на основе разрешения экрана в соответствии со значениями перечисления <xref:System.Windows.Forms.AutoScaleMode>.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-153">Support for scaling based upon the screen resolution has been added to complement system font support, as defined by the <xref:System.Windows.Forms.AutoScaleMode> enumeration.</span></span> <span data-ttu-id="9ebfe-154">Этот режим обеспечивает совместимость с автоматическим масштабированием, поддерживаемым [!INCLUDE[compact](../../../includes/compact-md.md)], что упрощает миграцию приложений.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-154">This mode is compatible with automatic scaling supported by the [!INCLUDE[compact](../../../includes/compact-md.md)] enabling easier application migration.</span></span>

- <span data-ttu-id="9ebfe-155">В реализацию автоматического масштабирования была добавлена совместимость с диспетчерами макетов, такими как <xref:System.Windows.Forms.FlowLayoutPanel> и <xref:System.Windows.Forms.TableLayoutPanel>.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-155">Compatibility with layout managers such as <xref:System.Windows.Forms.FlowLayoutPanel> and <xref:System.Windows.Forms.TableLayoutPanel> has been added to the implementation of automatic scaling.</span></span>

- <span data-ttu-id="9ebfe-156">Коэффициенты масштабирования теперь представляются в виде чисел с плавающей запятой, обычно с помощью структуры <xref:System.Drawing.SizeF>, что позволило практически устранить ошибки округления.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-156">Scaling factors are now represented as floating point values, typically using the <xref:System.Drawing.SizeF> structure, so that rounding errors have been practically eliminated.</span></span>

> [!CAUTION]
> <span data-ttu-id="9ebfe-157">Произвольные сочетания режимов масштабирования на основе разрешения экрана и размера шрифта не поддерживаются.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-157">Arbitrary mixtures of DPI and font scaling modes are not supported.</span></span> <span data-ttu-id="9ebfe-158">Вы без всяких проблем можете масштабировать пользовательский элемент управления в одном режиме (например, на основе разрешения экрана) и поместить его в форму с помощью другого режима (на основе размера шрифта), но использование базовой формы в одном режиме и производной формы в другом может привести к непредвиденным результатам.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-158">Although you may scale a user control using one mode (for example, DPI) and place it on a form using another mode (Font) with no issues, but mixing a base form in one mode and a derived form in another can lead to unexpected results.</span></span>

### <a name="automatic-scaling-in-action"></a><span data-ttu-id="9ebfe-159">Автоматическое масштабирование в действии</span><span class="sxs-lookup"><span data-stu-id="9ebfe-159">Automatic scaling in action</span></span>
<span data-ttu-id="9ebfe-160">В Windows Forms для автоматического масштабирования формы и ее содержимого теперь используется описанная ниже логика.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-160">Windows Forms now uses the following logic to automatically scale forms and their contents:</span></span>

1. <span data-ttu-id="9ebfe-161">Во время разработки каждый объект <xref:System.Windows.Forms.ContainerControl> регистрирует режим масштабирования и его текущее разрешение в свойствах <xref:System.Windows.Forms.ContainerControl.AutoScaleMode%2A> и <xref:System.Windows.Forms.ContainerControl.AutoScaleDimensions%2A> соответственно.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-161">At design time, each <xref:System.Windows.Forms.ContainerControl> records the scaling mode and it current resolution in the <xref:System.Windows.Forms.ContainerControl.AutoScaleMode%2A> and <xref:System.Windows.Forms.ContainerControl.AutoScaleDimensions%2A>, respectively.</span></span>

2. <span data-ttu-id="9ebfe-162">Во время выполнения фактическое разрешение хранится в свойстве <xref:System.Windows.Forms.ContainerControl.CurrentAutoScaleDimensions%2A>.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-162">At run time, the actual resolution is stored in the <xref:System.Windows.Forms.ContainerControl.CurrentAutoScaleDimensions%2A> property.</span></span> <span data-ttu-id="9ebfe-163">Свойство <xref:System.Windows.Forms.ContainerControl.AutoScaleFactor%2A> динамически вычисляет отношение между разрешением во время выполнения и разрешением во время разработки.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-163">The <xref:System.Windows.Forms.ContainerControl.AutoScaleFactor%2A> property dynamically calculates the ratio between the run-time and design-time scaling resolution.</span></span>

3. <span data-ttu-id="9ebfe-164">Если при загрузке формы значения <xref:System.Windows.Forms.ContainerControl.CurrentAutoScaleDimensions%2A> и <xref:System.Windows.Forms.ContainerControl.AutoScaleDimensions%2A> различны, то для масштабирования элемента управления и его дочерних элементов вызывается метод <xref:System.Windows.Forms.ContainerControl.PerformAutoScale%2A>.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-164">When the form loads, if the values of <xref:System.Windows.Forms.ContainerControl.CurrentAutoScaleDimensions%2A> and <xref:System.Windows.Forms.ContainerControl.AutoScaleDimensions%2A> are different, then the <xref:System.Windows.Forms.ContainerControl.PerformAutoScale%2A> method is called to scale the control and its children.</span></span> <span data-ttu-id="9ebfe-165">Этот метод приостанавливает размещение и вызывает метод <xref:System.Windows.Forms.Control.Scale%2A> для выполнения фактического масштабирования.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-165">This method suspends layout and calls the <xref:System.Windows.Forms.Control.Scale%2A> method to perform the actual scaling.</span></span> <span data-ttu-id="9ebfe-166">Впоследствии значение <xref:System.Windows.Forms.ContainerControl.AutoScaleDimensions%2A> обновляется во избежание прогрессивного масштабирования.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-166">Afterwards, the value of <xref:System.Windows.Forms.ContainerControl.AutoScaleDimensions%2A> is updated to avoid progressive scaling.</span></span>

4. <span data-ttu-id="9ebfe-167">Метод <xref:System.Windows.Forms.ContainerControl.PerformAutoScale%2A> также вызывается автоматически в перечисленных ниже ситуациях.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-167"><xref:System.Windows.Forms.ContainerControl.PerformAutoScale%2A> is also automatically invoked in the following situations:</span></span>

    - <span data-ttu-id="9ebfe-168">В ответ на событие <xref:System.Windows.Forms.Control.OnFontChanged%2A>, если используется режим масштабирования <xref:System.Windows.Forms.AutoScaleMode.Font>.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-168">In response to the <xref:System.Windows.Forms.Control.OnFontChanged%2A> event if the scaling mode is <xref:System.Windows.Forms.AutoScaleMode.Font>.</span></span>
  
    - <span data-ttu-id="9ebfe-169">Если при возобновлении размещения элементов управления внутри контейнера обнаруживается изменение свойства <xref:System.Windows.Forms.ContainerControl.AutoScaleDimensions%2A> или <xref:System.Windows.Forms.ContainerControl.AutoScaleMode%2A>.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-169">When the layout of the container control resumes and a change is detected in the <xref:System.Windows.Forms.ContainerControl.AutoScaleDimensions%2A> or <xref:System.Windows.Forms.ContainerControl.AutoScaleMode%2A> properties.</span></span>
  
    - <span data-ttu-id="9ebfe-170">При масштабировании родительского объекта <xref:System.Windows.Forms.ContainerControl>, как указанно выше.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-170">As implied above, when a parent <xref:System.Windows.Forms.ContainerControl> is being scaled.</span></span> <span data-ttu-id="9ebfe-171">Каждый контейнерный элемент управления отвечает за масштабирование своих дочерних элементов с помощью своих собственных коэффициентов масштабирования, а не коэффициентов его родительского контейнера.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-171">Each container control is responsible for scaling its children using its own scaling factors and not the one from its parent container.</span></span>

5. <span data-ttu-id="9ebfe-172">Поведение дочерних элементов управления при масштабировании может изменяться несколькими способами.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-172">Child controls can modify their scaling behavior through several means:</span></span>

    - <span data-ttu-id="9ebfe-173">Можно переопределить свойство <xref:System.Windows.Forms.Control.ScaleChildren%2A>, чтобы указать, следует ли масштабировать дочерние элементы управления.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-173">The <xref:System.Windows.Forms.Control.ScaleChildren%2A> property can be overridden to determine if their child controls should be scaled or not.</span></span>

    - <span data-ttu-id="9ebfe-174">Можно переопределить метод <xref:System.Windows.Forms.Control.GetScaledBounds%2A> для корректировки границ, до которых масштабируется элемент управления, но не логики масштабирования.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-174">The <xref:System.Windows.Forms.Control.GetScaledBounds%2A> method can be overridden to adjust the bounds that the control is scaled to, but not the scaling logic.</span></span>

    - <span data-ttu-id="9ebfe-175">Можно переопределить метод <xref:System.Windows.Forms.Control.ScaleControl%2A> для изменения логики масштабирования текущего элемента управления.</span><span class="sxs-lookup"><span data-stu-id="9ebfe-175">The <xref:System.Windows.Forms.Control.ScaleControl%2A> method can be overridden to change the scaling logic for the current control.</span></span>

## <a name="see-also"></a><span data-ttu-id="9ebfe-176">См. также</span><span class="sxs-lookup"><span data-stu-id="9ebfe-176">See also</span></span>
 <xref:System.Windows.Forms.ContainerControl.AutoScaleMode%2A>  
 <xref:System.Windows.Forms.Control.Scale%2A>  
 <xref:System.Windows.Forms.ContainerControl.PerformAutoScale%2A>  
 <xref:System.Windows.Forms.ContainerControl.AutoScaleDimensions%2A>  
 [<span data-ttu-id="9ebfe-177">Отрисовка элементов управления с применением визуальных стилей</span><span class="sxs-lookup"><span data-stu-id="9ebfe-177">Rendering Controls with Visual Styles</span></span>](./controls/rendering-controls-with-visual-styles.md)  
 [<span data-ttu-id="9ebfe-178">Практическое руководство. Повышение производительности за счет отключения автоматического масштабирования</span><span class="sxs-lookup"><span data-stu-id="9ebfe-178">How to: Improve Performance by Avoiding Automatic Scaling</span></span>](./advanced/how-to-improve-performance-by-avoiding-automatic-scaling.md)
