---
title: Уточнение типов .NET для взаимодействия
ms.date: 03/30/2017
helpviewer_keywords:
- exposing .NET Framework components to COM
- COM interop, qualifying .NET types
- qualifying .NET types for interoperation
- interoperation with unmanaged code, qualifying .NET types
- interoperation with unmanaged code, exposing .NET Framework components
- COM interop, exposing COM components
ms.assetid: 4b8afb52-fb8d-4e65-b47c-fd82956a3cdd
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: baa5b9f250fe7117838f936b09b050ba500b7209
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
---
# <a name="qualifying-net-types-for-interoperation"></a>Уточнение типов .NET для взаимодействия
Если вы планируете предоставлять типы в сборке COM-приложениям, во время разработки необходимо учитывать требования COM-взаимодействия. Управляемые типы (класс, интерфейс, структура и перечисление) легко интегрируются с COM-типами, если следовать приведенным ниже рекомендациям:  
  
-   Классы должны явным образом реализовывать интерфейсы.  
  
     Несмотря на то, что COM-взаимодействие предоставляет механизм для автоматического создания интерфейса, содержащего все члены класса и члены его базового класса, гораздо эффективнее предоставлять явные интерфейсы. Автоматически создаваемый интерфейс называется интерфейсом класса. Рекомендации см. в разделе [введение в интерфейс класса](com-callable-wrapper.md#introducing-the-class-interface).  
  
     Visual Basic, C# и C++ можно использовать для включения определений интерфейса в коде, вместо того чтобы использовать языка определения интерфейса (IDL) или его эквивалент. Дополнительные сведения о синтаксисе см. в документации по соответствующему языку.  
  
-   Управляемые типы должны быть открытыми.  
  
     Регистрация и экспорт в библиотеку типов поддерживаются только для открытых типов. В результате видимыми для модели COM являются только открытые типы.  
  
     Управляемые типы предоставляют функциональные возможности другому управляемому коду, который может быть недоступен для модели COM. Например, COM-клиентам не предоставляются параметризованные конструкторы, статические методы и поля констант. Кроме того, поскольку среда выполнения выполняет маршалинг данных из типа и обратно, данные могут копироваться и преобразовываться.  
  
-   Методы, свойства, поля и события должны быть открытыми.  
  
     Члены открытых типов, которые должны быть видимыми для модели COM, также должны быть открытыми. Видимость сборки, открытого типа или открытых членов открытого типа можно ограничить с помощью атрибута <xref:System.Runtime.InteropServices.ComVisibleAttribute>. По умолчанию все открытые типы и члены являются видимыми.  
  
-   Для активации из модели COM типы должны иметь открытый конструктор по умолчанию.  
  
     Таким образом, видимыми для модели COM являются только управляемые открытые типы. Тем не менее без открытого конструктора по умолчанию (конструктор без аргументов) COM-клиенты не смогут создавать этот тип. COM-клиенты могут использовать такой тип, если он активирован другими способами.  
  
-   Типы не могут быть абстрактными.  
  
     Ни COM-клиенты, ни клиенты .NET не могут создавать абстрактные типы.  
  
 При экспорте в модель COM иерархия наследования управляемого типа преобразуется в плоскую структуру. Кроме того, в управляемой и неуправляемой средах существуют различия в управлении версиями. Типы, предоставляемые модели COM, имеют характеристики управления версиями, отличные от других управляемых типов.  
  
## <a name="see-also"></a>См. также  
 <xref:System.Runtime.InteropServices.ComVisibleAttribute>  
 [Предоставление компонентов .NET Framework клиентам COM](../../../docs/framework/interop/exposing-dotnet-components-to-com.md)  
 [Введение в интерфейс класса](com-callable-wrapper.md#introducing-the-class-interface)  
 [Применение атрибутов взаимодействия](../../../docs/framework/interop/applying-interop-attributes.md)  
 [Упаковка сборки для модели COM](../../../docs/framework/interop/packaging-an-assembly-for-com.md)
