---
title: Развертывание приложения взаимодействия
ms.date: 03/30/2017
ms.prod: .net-framework
ms.technology:
- dotnet-clr
ms.topic: article
helpviewer_keywords:
- deploying applications [.NET Framework], interop
- strong-named assemblies, interop applications
- unsigned assemblies
- private assemblies
- exposing COM components to .NET Framework
- interoperation with unmanaged code, deploying applications
- shared assemblies
- COM interop, deploying applications
- interoperation with unmanaged code, exposing COM components
- signed assemblies
- COM interop, exposing COM components
ms.assetid: ea8a403e-ae03-4faa-9d9b-02179ec72992
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.workload:
- dotnet
ms.openlocfilehash: 8271a30d2258214defd5a15816813875cf594c8b
ms.sourcegitcommit: 9a4fe1a1c37b26532654b4bbe22d702237950009
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2018
---
# <a name="deploying-an-interop-application"></a>Развертывание приложения взаимодействия
Приложения взаимодействия обычно включают клиентскую сборку .NET, одну или несколько сборок взаимодействия (представляющих различные библиотеки типов COM) и один или несколько зарегистрированных COM-компонентов. В Visual Studio и [!INCLUDE[winsdklong](../../../includes/winsdklong-md.md)] представлены средства для импорта и преобразования библиотеки типов в сборку взаимодействия, которые описываются в разделе [Импорт библиотеки типов в виде сборки](importing-a-type-library-as-an-assembly.md). Приложение взаимодействия можно развернуть двумя способами:  
  
-   С помощью встроенных типов взаимодействия. Начиная с версии [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)], можно указать компилятору внедрять сведения о типах из сборки взаимодействия в исполняемый файл. Компилятор внедряет только сведения о типе, используемые приложением. Не требуется развертывать сборку взаимодействия с приложением. Это рекомендуемая методика.  
  
-   Развертывание сборок взаимодействия. Можно создать стандартную ссылку на сборку взаимодействия. В этом случае сборки взаимодействия должны быть развернуты вместе с приложением. Если вы применяете эту методику и не используете частный COM-компонент, всегда ссылайтесь на основную сборку взаимодействия (PIA), опубликованную автором COM-компонента, который планируется включить в управляемый код. Дополнительные сведения о создании и использовании основных сборок взаимодействия см. в разделе [Основные сборки взаимодействия](https://msdn.microsoft.com/library/b977a8be-59a0-40a0-a806-b11ffba5c080(v=vs.100)).  
  
 Если вы используете встроенные типы взаимодействия, развертывание осуществляется очень просто. В этом случае никаких особых действий с вашей стороны не требуется. Далее в этой статье описываются сценарии развертывания сборок взаимодействия с приложением.  
  
## <a name="deploying-interop-assemblies"></a>Развертывание сборок взаимодействия  
 Сборки могут иметь строгие имена. Сборка со строгим именем содержит открытый ключ издателя, предоставляющий уникальный идентификатор. Сборки, созданные с помощью [средства импорта библиотек (Tlbimp.exe)](../tools/tlbimp-exe-type-library-importer.md), могут подписываться издателем с использованием параметра **/keyfile**. Подписанные сборки можно устанавливать в глобальный кэш сборок. Неподписанные сборки необходимо устанавливать на компьютер пользователя в виде частных сборок.  
  
### <a name="private-assemblies"></a>Частные сборки  
 Чтобы установить сборку, предназначенную для частного использования, необходимо установить в одну структуру каталогов исполняемый файл приложения и сборку взаимодействия, содержащую импортированные COM-типы. На следующем рисунке показана неподписанная сборка взаимодействия, которая предназначена для частного использования приложениями Client1.exe и Client2.exe, располагающимися в разных каталогах приложения. Сборка взаимодействия (в этом примере LOANLib.dll) устанавливается дважды.  
  
 ![Структура каталогов и реестр Windows](media/comdeployprivate.gif "comdeployprivate")  
Структура каталогов и записи реестра для частного развертывания  
  
 Все COM-компоненты, связанные с приложением, должны устанавливаться в реестр Windows. Если приложения Client1.exe и Client2.exe, показанные на рисунке, установлены на разных компьютерах, необходимо зарегистрировать COM-компоненты на обоих компьютерах.  
  
### <a name="shared-assemblies"></a>Общие сборки  
 Сборки, которые являются общими для нескольких приложений, необходимо устанавливать в централизованный репозиторий, который называется глобальным кэшем сборок. Клиенты .NET могут обращаться к одной копии сборки взаимодействия, которая подписана и установлена в глобальный кэш сборок. Дополнительные сведения о создании и использовании основных сборок взаимодействия см. в разделе [Основные сборки взаимодействия](https://msdn.microsoft.com/library/b977a8be-59a0-40a0-a806-b11ffba5c080(v=vs.100)).  
  
## <a name="see-also"></a>См. также  
 [Предоставление COM-компонентов платформе .NET Framework](exposing-com-components.md)  
 [Импорт библиотеки типов в виде сборки](importing-a-type-library-as-an-assembly.md)  
 [Использование типов COM в управляемом коде](https://msdn.microsoft.com/library/1a95a8ca-c8b8-4464-90b0-5ee1a1135b66(v=vs.100))  
 [Компиляция проекта, использующего взаимодействие](compiling-an-interop-project.md)
