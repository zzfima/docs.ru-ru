---
title: "Импорт библиотеки типов в виде сборки"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology:
- dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- importing type library
- type metadata
- custom wrappers
- metadata
- exposing COM components to .NET Framework
- Type Library Importer
- interoperation with unmanaged code, importing type library
- interoperation with unmanaged code, exposing COM components
- type libraries
- TypeLibConverter class, importing type library as assembly
- COM interop, importing type library
- COM interop, exposing COM components
ms.assetid: d1898229-cd40-426e-a275-f3eb65fbc79f
caps.latest.revision: 
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.workload:
- dotnet
ms.openlocfilehash: 625bbce6dca8d57d7870dbe13e086c9a34954c9b
ms.sourcegitcommit: d95a91d685565f4d95c8773b558752864a6a3d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/12/2018
---
# <a name="importing-a-type-library-as-an-assembly"></a><span data-ttu-id="90c77-102">Импорт библиотеки типов в виде сборки</span><span class="sxs-lookup"><span data-stu-id="90c77-102">Importing a Type Library as an Assembly</span></span>
<span data-ttu-id="90c77-103">Определения COM-типов обычно хранятся в библиотеке типов.</span><span class="sxs-lookup"><span data-stu-id="90c77-103">COM type definitions usually reside in a type library.</span></span> <span data-ttu-id="90c77-104">С другой стороны, CLS-совместимые компиляторы создают в сборке метаданные типов.</span><span class="sxs-lookup"><span data-stu-id="90c77-104">In contrast, CLS-compliant compilers produce type metadata in an assembly.</span></span> <span data-ttu-id="90c77-105">Эти два источника сведений о типах заметно отличаются.</span><span class="sxs-lookup"><span data-stu-id="90c77-105">The two sources of type information are quite different.</span></span> <span data-ttu-id="90c77-106">В этом разделе описываются способы создания метаданных из библиотеки типов.</span><span class="sxs-lookup"><span data-stu-id="90c77-106">This topic describes techniques for generating metadata from a type library.</span></span> <span data-ttu-id="90c77-107">Результирующая сборка и называется сборкой взаимодействия, а содержащиеся в ней сведения о типах позволяют приложениям .NET Framework использовать COM-типы.</span><span class="sxs-lookup"><span data-stu-id="90c77-107">The resulting assembly is called an interop assembly, and the type information it contains enables .NET Framework applications to use COM types.</span></span>  
  
 <span data-ttu-id="90c77-108">Существует два способа, чтобы сделать эти сведения о типах доступными для приложения.</span><span class="sxs-lookup"><span data-stu-id="90c77-108">There are two ways to make this type information available to your application:</span></span>  
  
-   <span data-ttu-id="90c77-109">Использование сборок взаимодействия только во время разработки. Начиная с [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)], можно указать компилятору внедрять сведения о типах из сборки взаимодействия в исполняемый файл.</span><span class="sxs-lookup"><span data-stu-id="90c77-109">Using design-time-only interop assemblies: Beginning with the [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)], you can instruct the compiler to embed type information from the interop assembly into your executable.</span></span> <span data-ttu-id="90c77-110">Компилятор внедряет только сведения о типе, используемые приложением.</span><span class="sxs-lookup"><span data-stu-id="90c77-110">The compiler embeds only the type information that your application uses.</span></span> <span data-ttu-id="90c77-111">Не требуется развертывать сборку взаимодействия с приложением.</span><span class="sxs-lookup"><span data-stu-id="90c77-111">You do not have to deploy the interop assembly with your application.</span></span> <span data-ttu-id="90c77-112">Это рекомендуемая методика.</span><span class="sxs-lookup"><span data-stu-id="90c77-112">This is the recommended technique.</span></span>  
  
-   <span data-ttu-id="90c77-113">Развертывание сборок взаимодействия. Можно создать стандартную ссылку на сборку взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="90c77-113">Deploying interop assemblies: You can create a standard reference to the interop assembly.</span></span> <span data-ttu-id="90c77-114">В этом случае сборки взаимодействия должны быть развернуты вместе с приложением.</span><span class="sxs-lookup"><span data-stu-id="90c77-114">In this case, the interop assembly must be deployed with your application.</span></span> <span data-ttu-id="90c77-115">Если вы применяете эту методику и не используете частный COM-компонент, всегда ссылайтесь на основную сборку взаимодействия (PIA), опубликованную автором COM-компонента, который планируется включить в управляемый код.</span><span class="sxs-lookup"><span data-stu-id="90c77-115">If you employ this technique, and you are not using a private COM component, always reference the primary interop assembly (PIA) published by the author of the COM component you intend to incorporate in your managed code.</span></span> <span data-ttu-id="90c77-116">Дополнительные сведения о создании и использовании основных сборок взаимодействия см. в разделе [Основные сборки взаимодействия](https://msdn.microsoft.com/library/b977a8be-59a0-40a0-a806-b11ffba5c080(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="90c77-116">For more information about producing and using primary interop assemblies, see [Primary Interop Assemblies](https://msdn.microsoft.com/library/b977a8be-59a0-40a0-a806-b11ffba5c080(v=vs.100)).</span></span>  
  
 <span data-ttu-id="90c77-117">При использовании сборок взаимодействия только во время разработки можно внедрить сведения о типе из основной сборки взаимодействия, опубликованной автором COM-компонента.</span><span class="sxs-lookup"><span data-stu-id="90c77-117">When you use design-time-only interop assemblies, you can embed type information from the primary interop assembly published by the author of the COM component.</span></span> <span data-ttu-id="90c77-118">Однако не требуется развертывать основную сборку взаимодействия с приложением.</span><span class="sxs-lookup"><span data-stu-id="90c77-118">However, you do not have to deploy the primary interop assembly with your application.</span></span>  
  
 <span data-ttu-id="90c77-119">Использование сборок взаимодействия только во время разработки приводит к уменьшению размера приложения, так как большинство приложений используют не все функции COM-компонента.</span><span class="sxs-lookup"><span data-stu-id="90c77-119">Using design-time-only interop assemblies reduces the size of your application, because most applications do not use all the features of a COM component.</span></span> <span data-ttu-id="90c77-120">Компилятор очень эффективен при внедрении сведений о типе. Если приложение использует только некоторые методы в COM-интерфейсе, компилятор не внедряет неиспользуемые методы.</span><span class="sxs-lookup"><span data-stu-id="90c77-120">The compiler is very efficient when it embeds type information; if your application uses only some of the methods on a COM interface, the compiler does not embed the unused methods.</span></span> <span data-ttu-id="90c77-121">Когда приложение, содержащее внедренные сведения о типах, взаимодействует с другим таким приложением или с приложением, использующим основную сборку взаимодействия, среда CLR применяет правила эквивалентности типов, чтобы определить, представляют ли два типа с одинаковым именем один и тот же COM-тип.</span><span class="sxs-lookup"><span data-stu-id="90c77-121">When an application that has embedded type information interacts with another such application, or interacts with an application that uses a primary interop assembly, the common language runtime uses type equivalence rules to determine whether two types with the same name represent the same COM type.</span></span> <span data-ttu-id="90c77-122">Чтобы использовать COM-объекты, знать эти правила не требуется.</span><span class="sxs-lookup"><span data-stu-id="90c77-122">You do not have to know these rules to use COM objects.</span></span> <span data-ttu-id="90c77-123">Однако если вас интересуют правила, см. раздел [Эквивалентность типов и внедренные типы взаимодействия](../../../docs/framework/interop/type-equivalence-and-embedded-interop-types.md).</span><span class="sxs-lookup"><span data-stu-id="90c77-123">However, if you are interested in the rules, see [Type Equivalence and Embedded Interop Types](../../../docs/framework/interop/type-equivalence-and-embedded-interop-types.md).</span></span>  
  
## <a name="generating-metadata"></a><span data-ttu-id="90c77-124">Создание метаданных</span><span class="sxs-lookup"><span data-stu-id="90c77-124">Generating Metadata</span></span>  
 <span data-ttu-id="90c77-125">Библиотеки COM-типов могут быть автономными файлами TLB, например Loanlib.tlb.</span><span class="sxs-lookup"><span data-stu-id="90c77-125">COM type libraries can be stand-alone files that have a .tlb extension, such as Loanlib.tlb.</span></span> <span data-ttu-id="90c77-126">Некоторые библиотеки типов встроены в раздел ресурсов файла DLL или EXE.</span><span class="sxs-lookup"><span data-stu-id="90c77-126">Some type libraries are embedded in the resource section of a .dll or .exe file.</span></span> <span data-ttu-id="90c77-127">Другими источниками данных библиотек типов являются файлы OLB и OCX.</span><span class="sxs-lookup"><span data-stu-id="90c77-127">Other sources of type library information are .olb and .ocx files.</span></span>  
  
 <span data-ttu-id="90c77-128">После нахождения библиотеки типов, содержащей реализацию искомого COM-типа, для создания сборки взаимодействия, содержащей метаданные типа, разработчик может выбрать нужный из нескольких вариантов.</span><span class="sxs-lookup"><span data-stu-id="90c77-128">After you locate the type library that contains the implementation of your target COM type, you have the following options for generating an interop assembly containing type metadata:</span></span>  
  
-   <span data-ttu-id="90c77-129">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="90c77-129">Visual Studio</span></span>  
  
     <span data-ttu-id="90c77-130">Visual Studio 2005 автоматически преобразует COM-типы библиотеки типов в метаданные сборки.</span><span class="sxs-lookup"><span data-stu-id="90c77-130">Visual Studio automatically converts COM types in a type library to metadata in an assembly.</span></span> <span data-ttu-id="90c77-131">Инструкции см. в разделах [Практическое руководство. Добавление ссылок на библиотеки типов](../../../docs/framework/interop/how-to-add-references-to-type-libraries.md) и [Пошаговое руководство. Внедрение данных о типе из сборок для приложений Microsoft Office](http://msdn.microsoft.com/library/85b55e05-bc5e-4665-b6ae-e1ada9299fd3).</span><span class="sxs-lookup"><span data-stu-id="90c77-131">For instructions, see [How to: Add References to Type Libraries](../../../docs/framework/interop/how-to-add-references-to-type-libraries.md) and [Walkthrough: Embedding Type Information from Microsoft Office Assemblies](http://msdn.microsoft.com/library/85b55e05-bc5e-4665-b6ae-e1ada9299fd3).</span></span>  
  
-   [<span data-ttu-id="90c77-132">Программа импорта библиотек типов (Tlbimp.exe)</span><span class="sxs-lookup"><span data-stu-id="90c77-132">Type Library Importer (Tlbimp.exe)</span></span>](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)  
  
     <span data-ttu-id="90c77-133">Программа экспорта библиотек типов предоставляет параметры командной строки для настройки метаданных в результирующем файле взаимодействия, импортирует типы из существующей библиотеки типов и создает сборку взаимодействия и пространство имен.</span><span class="sxs-lookup"><span data-stu-id="90c77-133">The Type Library Importer provides command-line options to adjust metadata in the resulting interop file, imports types from an existing type library, and generates an interop assembly and a namespace.</span></span> <span data-ttu-id="90c77-134">Инструкции см. в разделе [Практическое руководство. Создание сборок взаимодействия из библиотек типов](../../../docs/framework/interop/how-to-generate-interop-assemblies-from-type-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="90c77-134">For instructions, see [How to: Generate Interop Assemblies from Type Libraries](../../../docs/framework/interop/how-to-generate-interop-assemblies-from-type-libraries.md).</span></span>  
  
-   <span data-ttu-id="90c77-135">Класс <xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="90c77-135"><xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType> class</span></span>  
  
     <span data-ttu-id="90c77-136">Этот класс предоставляет методы преобразования компонентных классов и интерфейсов в библиотеке типов в метаданные сборки.</span><span class="sxs-lookup"><span data-stu-id="90c77-136">This class provides methods to convert coclasses and interfaces in a type library to metadata within an assembly.</span></span> <span data-ttu-id="90c77-137">Он создает такие же выходные метаданные, что и программа Tlbimp.exe.</span><span class="sxs-lookup"><span data-stu-id="90c77-137">It produces the same metadata output as Tlbimp.exe.</span></span> <span data-ttu-id="90c77-138">Однако, в отличие от программы Tlbimp.exe, класс <xref:System.Runtime.InteropServices.TypeLibConverter> может преобразовать в метаданные библиотеку типов, находящуюся в памяти.</span><span class="sxs-lookup"><span data-stu-id="90c77-138">However, unlike Tlbimp.exe, the <xref:System.Runtime.InteropServices.TypeLibConverter> class can convert an in-memory type library to metadata.</span></span>  
  
-   <span data-ttu-id="90c77-139">Настраиваемые оболочки</span><span class="sxs-lookup"><span data-stu-id="90c77-139">Custom wrappers</span></span>  
  
     <span data-ttu-id="90c77-140">Если библиотека типов недоступна или является неверной, единственный выход — создать в управляемом исходном коде дубликат определения класса или интерфейса.</span><span class="sxs-lookup"><span data-stu-id="90c77-140">When a type library is unavailable or incorrect, one option is to create a duplicate definition of the class or interface in managed source code.</span></span> <span data-ttu-id="90c77-141">После этого нужно скомпилировать исходный код с помощью компилятора, который обращается к среде выполнения, чтобы создать метаданные в сборке.</span><span class="sxs-lookup"><span data-stu-id="90c77-141">You then compile the source code with a compiler that targets the runtime to produce metadata in an assembly.</span></span>  
  
     <span data-ttu-id="90c77-142">Чтобы определить COM-типы вручную, необходим доступ к следующим элементам:</span><span class="sxs-lookup"><span data-stu-id="90c77-142">To define COM types manually, you must have access to the following items:</span></span>  
  
    -   <span data-ttu-id="90c77-143">точные описания определяемых компонентных классов и интерфейсов;</span><span class="sxs-lookup"><span data-stu-id="90c77-143">Precise descriptions of the coclasses and interfaces being defined.</span></span>  
  
    -   <span data-ttu-id="90c77-144">компилятор, например компилятор C#, который может создавать соответствующие определения классов .NET Framework;</span><span class="sxs-lookup"><span data-stu-id="90c77-144">A compiler, such as the C# compiler, that can generate the appropriate .NET Framework class definitions.</span></span>  
  
    -   <span data-ttu-id="90c77-145">ведения о правилах преобразования библиотек типов в сборки.</span><span class="sxs-lookup"><span data-stu-id="90c77-145">Knowledge of the type library-to-assembly conversion rules.</span></span>  
  
     <span data-ttu-id="90c77-146">Написание настраиваемой оболочки — это сложная процедура.</span><span class="sxs-lookup"><span data-stu-id="90c77-146">Writing a custom wrapper is an advanced technique.</span></span> <span data-ttu-id="90c77-147">Дополнительные сведения о создании настраиваемой оболочки см. в разделе [Настройка стандартных оболочек](https://msdn.microsoft.com/library/c40d089b-6a3c-41b5-a20d-d760c215e49d(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="90c77-147">For additional information about how to generate a custom wrapper, see [Customizing Standard Wrappers](https://msdn.microsoft.com/library/c40d089b-6a3c-41b5-a20d-d760c215e49d(v=vs.100)).</span></span>  
  
 <span data-ttu-id="90c77-148">Дополнительные сведения процессе импорта COM-взаимодействия см. в разделе [Обзор преобразования библиотек типов в сборки](https://msdn.microsoft.com/library/bf3f90c5-4770-4ab8-895c-3ba1055cc958(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="90c77-148">For more information about the COM interop import process, see [Type Library to Assembly Conversion Summary](https://msdn.microsoft.com/library/bf3f90c5-4770-4ab8-895c-3ba1055cc958(v=vs.100)).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="90c77-149">См. также</span><span class="sxs-lookup"><span data-stu-id="90c77-149">See Also</span></span>  
 <xref:System.Runtime.InteropServices.TypeLibConverter>  
 [<span data-ttu-id="90c77-150">Предоставление COM-компонентов платформе .NET Framework</span><span class="sxs-lookup"><span data-stu-id="90c77-150">Exposing COM Components to the .NET Framework</span></span>](../../../docs/framework/interop/exposing-com-components.md)  
 <span data-ttu-id="90c77-151">[Общие сведения о преобразовании библиотеки типов в сборку](https://msdn.microsoft.com/library/bf3f90c5-4770-4ab8-895c-3ba1055cc958(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="90c77-151">[Type Library to Assembly Conversion Summary](https://msdn.microsoft.com/library/bf3f90c5-4770-4ab8-895c-3ba1055cc958(v=vs.100))</span></span>  
 [<span data-ttu-id="90c77-152">Tlbimp.exe (программа экспорта библиотек типов)</span><span class="sxs-lookup"><span data-stu-id="90c77-152">Tlbimp.exe (Type Library Importer)</span></span>](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)  
 <span data-ttu-id="90c77-153">[Настройка стандартных оболочек](https://msdn.microsoft.com/library/c40d089b-6a3c-41b5-a20d-d760c215e49d(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="90c77-153">[Customizing Standard Wrappers](https://msdn.microsoft.com/library/c40d089b-6a3c-41b5-a20d-d760c215e49d(v=vs.100))</span></span>  
 <span data-ttu-id="90c77-154">[Использование типов COM в управляемом коде](https://msdn.microsoft.com/library/1a95a8ca-c8b8-4464-90b0-5ee1a1135b66(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="90c77-154">[Using COM Types in Managed Code](https://msdn.microsoft.com/library/1a95a8ca-c8b8-4464-90b0-5ee1a1135b66(v=vs.100))</span></span>  
 [<span data-ttu-id="90c77-155">Компиляция проекта, использующего взаимодействие</span><span class="sxs-lookup"><span data-stu-id="90c77-155">Compiling an Interop Project</span></span>](../../../docs/framework/interop/compiling-an-interop-project.md)  
 [<span data-ttu-id="90c77-156">Развертывание приложения взаимодействия</span><span class="sxs-lookup"><span data-stu-id="90c77-156">Deploying an Interop Application</span></span>](../../../docs/framework/interop/deploying-an-interop-application.md)  
 [<span data-ttu-id="90c77-157">Практическое руководство. Добавление ссылок на библиотеки типов</span><span class="sxs-lookup"><span data-stu-id="90c77-157">How to: Add References to Type Libraries</span></span>](../../../docs/framework/interop/how-to-add-references-to-type-libraries.md)  
 [<span data-ttu-id="90c77-158">Практическое руководство. Создание сборок взаимодействия их библиотек типов</span><span class="sxs-lookup"><span data-stu-id="90c77-158">How to: Generate Interop Assemblies from Type Libraries</span></span>](../../../docs/framework/interop/how-to-generate-interop-assemblies-from-type-libraries.md)  
 [<span data-ttu-id="90c77-159">Пошаговое руководство. Внедрение данных о типе из сборок для приложений Microsoft Office</span><span class="sxs-lookup"><span data-stu-id="90c77-159">Walkthrough: Embedding Type Information from Microsoft Office Assemblies</span></span>](http://msdn.microsoft.com/library/85b55e05-bc5e-4665-b6ae-e1ada9299fd3)
