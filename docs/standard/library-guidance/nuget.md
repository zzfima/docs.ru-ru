---
title: NuGet и библиотеки .NET
description: Практические рекомендации по упаковке библиотек .NET с помощью NuGet.
author: jamesnk
ms.author: mairaw
ms.date: 01/15/2019
ms.openlocfilehash: 9288bf440692302c3a0b1954236540af6363f367
ms.sourcegitcommit: 559259da2738a7b33a46c0130e51d336091c2097
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/22/2019
ms.locfileid: "72775315"
---
# <a name="nuget"></a>NuGet

NuGet — это диспетчер пакетов для экосистемы .NET, который используется разработчиками как основное средство для поиска и получения библиотек .NET с открытым кодом. Бесплатная служба [NuGet.org](https://www.nuget.org/), предоставляемая корпорацией Майкрософт для размещения пакетов NuGet, является основным узлом для общедоступных пакетов NuGet. Также поддерживается публикация в пользовательских службах NuGet типа [MyGet](https://www.myget.org/) и [Azure Artifacts](https://azure.microsoft.com/services/devops/artifacts/).

![NuGet](./media/nuget/nuget-logo.png "NuGet")

## <a name="create-a-nuget-package"></a>Создание пакета NuGet

Пакет NuGet (`*.nupkg`) — это ZIP-файл со сборками .NET и связанными метаданными.

Пакет NuGet можно создать двумя способами. Мы рекомендуем использовать более новый подход — создавать пакет из проекта в стиле SDK (это файл проекта, содержимое которого начинается с `<Project Sdk="Microsoft.NET.Sdk">`). Сборки и целевые объекты автоматически добавляются в пакет, а метаданные, например имя пакета и номер версии, — в файл MSBuild. Компиляция с помощью команды [`dotnet pack`](../../core/tools/dotnet-pack.md) создает файл `*.nupkg`, а не сборки.

```xml
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFramework>netstandard2.0</TargetFramework>
    <AssemblyName>Contoso.Api</AssemblyName>
    <PackageVersion>1.1.0</PackageVersion>
    <Authors>John Doe</Authors>
  </PropertyGroup>
</Project>
```

Более старый способ создания пакета NuGet — это файл `*.nuspec` и средство командной строки `nuget.exe`. Файл с расширением .nuspec предоставляет функции управления, но указывать сборки и целевые объекты для включения в пакет NuGet нужно внимательно. Здесь очень легко допустить ошибку или забыть обновить файл .nuspec после внесения изменений. Важное преимущество файла .nuspec заключается в том, что он позволяет создать пакет NuGet для платформы, которая еще не поддерживает файлы проектов в стиле SDK.

**✔️ ДОПУСТИМО.** Вы можете использовать файл проекта в стиле SDK для создания пакета NuGet.

## <a name="package-dependencies"></a>Зависимости пакета

См. сведения о [зависимостях пакета NuGet](./dependencies.md).

## <a name="important-nuget-package-metadata"></a>Важные метаданные пакета NuGet

Пакет NuGet поддерживает многие [свойства метаданных](/nuget/reference/nuspec). В следующей таблице собраны основные метаданные, которые должен предоставлять каждый пакет на NuGet.org.

| Имя свойства MSBuild              | Имя Nuspec              | ОПИСАНИЕ  |
| ---------------------------------- | ------------------------ | ------------ |
| `PackageId`                        | `id`                       | Идентификатор пакета. Можно зарезервировать префикс из идентификатора, если он удовлетворяет [критериям](/nuget/reference/id-prefix-reservation). |
| `PackageVersion`                   | `version`                  | Версия пакета NuGet. См. сведения о [версии пакета NuGet](./versioning.md#nuget-package-version).             |
| `Title`                            | `title`                    | Понятный заголовок пакета. По умолчанию используется значение `PackageId`.             |
| `Description`                      | `description`              | Подробное описание пакета для отображения в пользовательском интерфейсе.             |
| `Authors`                          | `authors`                  | Разделенный запятыми список авторов пакета, обозначенных именами профилей на сайте nuget.org.             |
| `PackageTags`                      | `tags`                     | Разделенный пробелами список тегов и ключевых слов для описания пакета. Теги используются при поиске пакетов.             |
| `PackageIconUrl`                   | `iconUrl`                  | URL-адрес изображения, которое будет использоваться как значок для пакета. Это должен быть URL-адрес (HTTPS), указывающий на изображение размером 64×64 с прозрачным фоном.             |
| `PackageProjectUrl`                | `projectUrl`               | URL-адрес домашней страницы или репозитория проекта.             |
| `PackageLicenseExpression`         | `license`                  | [Идентификатор SPDX](https://spdx.org/licenses/) лицензии проекта. Идентификатор могут использовать только лицензии, утвержденные OSI и FSF. Другие лицензии должны использовать `PackageLicenseFile`. Подробнее о [метаданных `license`](/nuget/reference/nuspec#license). |

> [!IMPORTANT]
> Проект без лицензии по умолчанию получает статус [монопольного авторского права](https://choosealicense.com/no-permission/), то есть не может законно использоваться другими пользователями.

**✔️ ДОПУСТИМО.** Вы можете выбрать имя пакета NuGet с префиксом, который соответствует [критериям](/nuget/reference/id-prefix-reservation) для резервирования префикса NuGet.

**✔️ РЕКОМЕНДУЕТСЯ.**  Используйте атрибут href для определения HTTPS-ссылки, указывающей на значок пакета.

> NuGet.org и другие аналогичные сайты работают с поддержкой HTTPS, поэтому при отображении изображения с другим протоколом появится предупреждение о смешанном типе содержимого.

**✔️ РЕКОМЕНДУЕТСЯ.** Используйте для значка пакета изображение размером 64×64 с прозрачным фоном, чтобы обеспечить оптимальную видимость.

**✔️ ДОПУСТИМО.** Вы можете настроить [Source Link](./sourcelink.md), чтобы добавить метаданные системы управления версиями в сборки и пакет NuGet.

> Source Link автоматически добавляет метаданные `RepositoryUrl` и `RepositoryType` в пакет NuGet. Source Link также добавляет сведения о точном исходном коде, из которого создан пакет. Например, к пакету, созданному из репозитория Git, будет добавлен хэш фиксации в качестве метаданных.

## <a name="pre-release-packages"></a>Пакеты предварительного выпуска

Пакеты NuGet с суффиксом версии получают статус [предварительной версии](/nuget/create-packages/prerelease-packages). По умолчанию в пользовательском интерфейсе диспетчера пакетов NuGet отображаются только стабильные выпуски, если пользователь не согласился использовать пакеты предварительной версии. Благодаря такой политике пакеты предварительной версии предоставляются для тестирования ограниченному числу пользователей.

```xml
<PackageVersion>1.0.1-beta1</PackageVersion>
```

> [!NOTE]
> В пакетах стабильных выпусков нельзя указывать зависимости от пакетов предварительной версии. В таком случае переведите используемый пакет в режим предварительной версии или укажите зависимость от более ранней стабильной версии.

![Зависимость пакета предварительной версии NuGet](./media/nuget/nuget-prerelease-package.png "Зависимость пакета предварительной версии NuGet")

**✔️ РЕКОМЕНДУЕТСЯ.** Публикуйте пакет в режиме предварительной версии для тестирования, предварительного просмотра или экспериментов.

**✔️ РЕКОМЕНДУЕТСЯ.** Публикуйте стабильный выпуск пакета, когда он будет полностью готов, чтобы другие стабильные могли содержать ссылки на него.

## <a name="symbol-packages"></a>Пакеты символов

Файлы символов (`*.pdb`) создаются компилятором платформы .NET одновременно со сборками. Файлы символов сопоставляют расположения выполнения с исходным кодом, что позволяет выполнить пошаговое выполнение с использованием отладчика. NuGet позволяет [создавать отдельные пакеты символов (`*.snupkg`)](/nuget/create-packages/symbol-packages-snupkg) с файлами символов одновременно с основным пакетом сборок для .NET. Предполагается, что пакеты символов будут размещаться на сервере символов и скачиваться по требованию только специальными средствами, такими как Visual Studio.

NuGet.org размещает свой собственный [репозиторий сервера символов](/nuget/create-packages/symbol-packages-snupkg#nugetorg-symbol-server). Разработчики могут использовать символы, опубликованные на сервере символов NuGet.org, добавив `https://symbols.nuget.org/download/symbols` в [источники символов в Visual Studio](/visualstudio/debugger/specify-symbol-dot-pdb-and-source-files-in-the-visual-studio-debugger).

> [!IMPORTANT]
> Сервер символов NuGet.org поддерживает только новые [файлы переносимых символов](https://github.com/dotnet/core/blob/master/Documentation/diagnostics/portable_pdb.md) (`*.pdb`), созданные проектами в стиле пакетов SDK.
>
> Чтобы использовать сервер символов NuGet.org при отладке библиотеки .NET, у разработчиков должна быть Visual Studio 2017 версии 15.9 или более поздней.

Альтернатива созданию пакета символов — внедрение файлов символов в главный пакет NuGet. Главный пакет NuGet будет больше, но внедренные файлы символов позволяют разработчикам не настраивать сервер символов NuGet.org. Если вы создаете пакет NuGet из проекта в стиле SDK, файлы символов в него можно внедрить с помощью свойства `AllowedOutputExtensionsInPackageBuildOutputFolder`:

```xml
<Project Sdk="Microsoft.NET.Sdk">
 <PropertyGroup>
    <!-- Include symbol files (*.pdb) in the built .nupkg -->
    <AllowedOutputExtensionsInPackageBuildOutputFolder>$(AllowedOutputExtensionsInPackageBuildOutputFolder);.pdb</AllowedOutputExtensionsInPackageBuildOutputFolder>
  </PropertyGroup>
</Project>
```

Недостаток внедренных файлов символов в том, что они увеличивают размер пакета примерно на 30 % для библиотек .NET, скомпилированных с помощью проектов в стиле пакетов SDK. Если размер пакета важен, опубликуйте символы в пакете символов.

**✔️ РАССМОТРИТЕ ВОЗМОЖНОСТЬ** публикации символов в виде пакета символов (`*.snupkg`) на веб-сайте NuGet.org

> Благодаря пакетам символов (`*.snupkg`) разработчики получают эффективную среду отладки по требованию, причем при этом не увеличивается размер основного пакета и не снижается производительность восстановления в тех случаях, когда отладка пакета NuGet не предполагается.
>
> Недостаток заключается в том, что пользователям в процессе настройки может потребоваться однократно найти и настроить сервер символов NuGet в своей интегрированной среде разработки, чтобы получить файлы символов. В Visual Studio 2019 версии 16.1 сервер символов NuGet.org добавлен в список серверов символов по умолчанию.

>[!div class="step-by-step"]
>[Назад](strong-naming.md)
>[Вперед](dependencies.md)
