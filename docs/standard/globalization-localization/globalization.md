---
title: Глобализация
ms.date: 03/30/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- globalization [.NET Framework], about globalization
- global applications, globalization
- international applications [.NET Framework], globalization
- world-ready applications, globalization
- application development [.NET Framework], globalization
- culture, globalization
ms.assetid: 4e919934-6b19-42f2-b770-275a4fae87c9
ms.openlocfilehash: fe03bbdd7d037a9f1fb4985b62b447c6ef9c6535
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/15/2020
ms.locfileid: "79174788"
---
# <a name="globalization"></a><span data-ttu-id="5403b-102">Глобализация</span><span class="sxs-lookup"><span data-stu-id="5403b-102">Globalization</span></span>

<span data-ttu-id="5403b-103">Глобализация предполагает проектирование и разработку готовых к использованию во всем мире приложений, поддерживающих локализованные интерфейсы и региональные данные для пользователей разных культур.</span><span class="sxs-lookup"><span data-stu-id="5403b-103">Globalization involves designing and developing a world-ready app that supports localized interfaces and regional data for users in multiple cultures.</span></span> <span data-ttu-id="5403b-104">Перед началом проектирования необходимо определить, какие языки и региональные параметры будет поддерживать приложение.</span><span class="sxs-lookup"><span data-stu-id="5403b-104">Before beginning the design phase, you should determine which cultures your app will support.</span></span> <span data-ttu-id="5403b-105">Хотя приложение нацелено на один язык или страну по умолчанию, его можно спроектировать и создать так, чтобы его могли использовать пользователи в других странах.</span><span class="sxs-lookup"><span data-stu-id="5403b-105">Although an app targets a single culture or region as its default, you can design and write it so that it can easily be extended to users in other cultures or regions.</span></span>

<span data-ttu-id="5403b-106">Разработчики имеют предположения о пользовательских интерфейсах и данных, которые формируются их культурами.</span><span class="sxs-lookup"><span data-stu-id="5403b-106">As developers, we all have assumptions about user interfaces and data that are formed by our cultures.</span></span> <span data-ttu-id="5403b-107">Например, для англоговорящего разработчика в США сериализация сведений о дате и времени в виде строки в формате `MM/dd/yyyy hh:mm:ss` выглядит совершенно естественно.</span><span class="sxs-lookup"><span data-stu-id="5403b-107">For example, for an English-speaking developer in the United States, serializing date and time data as a string in the format `MM/dd/yyyy hh:mm:ss` seems perfectly reasonable.</span></span> <span data-ttu-id="5403b-108">Однако десериализация этой строки в системе на другом языке, вероятно, создаст исключение <xref:System.FormatException> или выдаст неточные данные.</span><span class="sxs-lookup"><span data-stu-id="5403b-108">However, deserializing that string on a system in a different culture is likely to throw a <xref:System.FormatException> exception or produce inaccurate data.</span></span> <span data-ttu-id="5403b-109">Глобализация позволяет определять такие допущения, связанные с языком и региональными параметрами, и убедиться, что они не влияют на разработку или код приложения.</span><span class="sxs-lookup"><span data-stu-id="5403b-109">Globalization enables us to identify such culture-specific assumptions and ensure that they do not affect our app's design or code.</span></span>

<span data-ttu-id="5403b-110">В этой статье рассматриваются некоторые из основных вопросов, которые следует принять во внимание, а также рекомендации, которым можно следовать при обработке строк, значений даты и времени и числовых значений в глобализованном приложении.</span><span class="sxs-lookup"><span data-stu-id="5403b-110">This article discusses some of the major issues you should consider and the best practices you can follow when handling strings, date and time values, and numeric values in a globalized app.</span></span>

## <a name="strings"></a><span data-ttu-id="5403b-111">Строки</span><span class="sxs-lookup"><span data-stu-id="5403b-111">Strings</span></span>

<span data-ttu-id="5403b-112">Обработка символов и строк является центральным моментом глобализации, поскольку для каждого языка или региона могут использоваться разные символы и кодировки, и сортироваться эти символы могут по-разному.</span><span class="sxs-lookup"><span data-stu-id="5403b-112">The handling of characters and strings is a central focus of globalization, because each culture or region may use different characters and character sets and sort them differently.</span></span> <span data-ttu-id="5403b-113">В этом разделе приведены рекомендации по использованию строк в глобализованных приложениях.</span><span class="sxs-lookup"><span data-stu-id="5403b-113">This section provides recommendations for using strings in globalized apps.</span></span>

### <a name="use-unicode-internally"></a><span data-ttu-id="5403b-114">Внутреннее использование Юникода</span><span class="sxs-lookup"><span data-stu-id="5403b-114">Use Unicode internally</span></span>

<span data-ttu-id="5403b-115">По умолчанию в .NET используются строки Юникода.</span><span class="sxs-lookup"><span data-stu-id="5403b-115">By default, .NET uses Unicode strings.</span></span> <span data-ttu-id="5403b-116">Строка Юникода состоит из 0, одного или нескольких объектов <xref:System.Char>, каждый из которых представляет собой единицу кода UTF-16.</span><span class="sxs-lookup"><span data-stu-id="5403b-116">A Unicode string consists of zero, one, or more <xref:System.Char> objects, each of which represents a UTF-16 code unit.</span></span> <span data-ttu-id="5403b-117">Представление Юникода существует почти для каждого символа в каждом из наборов символов, используемых по всему миру.</span><span class="sxs-lookup"><span data-stu-id="5403b-117">There is a Unicode representation for almost every character in every character set in use throughout the world.</span></span>

<span data-ttu-id="5403b-118">Многие приложения и операционные системы, включая операционную систему Windows, могут использовать также кодовые страницы для представления кодировок.</span><span class="sxs-lookup"><span data-stu-id="5403b-118">Many applications and operating systems, including the Windows operating system, can use also use code pages to represent character sets.</span></span> <span data-ttu-id="5403b-119">Кодовые страницы обычно содержат стандартные значения ASCII от 0x00 до 0x7F и сопоставляют другие символы с остальными значениями от 0x80 до 0xFF.</span><span class="sxs-lookup"><span data-stu-id="5403b-119">Code pages typically contain the standard ASCII values from 0x00 through 0x7F and map other characters to the remaining values from 0x80 through 0xFF.</span></span> <span data-ttu-id="5403b-120">Интерпретация значений от 0x80 до 0xFF зависит от конкретной кодовой страницы.</span><span class="sxs-lookup"><span data-stu-id="5403b-120">The interpretation of values from 0x80 through 0xFF depends on the specific code page.</span></span> <span data-ttu-id="5403b-121">По этой причине следует избегать использования кодовых страниц в глобализованном приложении, если это возможно.</span><span class="sxs-lookup"><span data-stu-id="5403b-121">Because of this, you should avoid using code pages in a globalized app if possible.</span></span>

<span data-ttu-id="5403b-122">В следующем примере показаны опасности, связанные с интерпретацией данных кодовой страницы, если используемая в системе по умолчанию кодовая страница отлична от кодовой страницы, на которой были сохранены данные.</span><span class="sxs-lookup"><span data-stu-id="5403b-122">The following example illustrates the dangers of interpreting code page data when the default code page on a system is different from the code page on which the data was saved.</span></span> <span data-ttu-id="5403b-123">(Чтобы смоделировать этот сценарий, в примере явным образом задаются разные кодовые страницы.) Во-первых, в примере определяется массив, состоящий из символов верхнего регистра греческого алфавита.</span><span class="sxs-lookup"><span data-stu-id="5403b-123">(To simulate this scenario, the example explicitly specifies different code pages.) First, the example defines an array that consists of the uppercase characters of the Greek alphabet.</span></span> <span data-ttu-id="5403b-124">Он кодирует их в массив байт с помощью кодовой страницы 737 (также известной как MS-DOS греческий) и сохраняет массив байтов в файл.</span><span class="sxs-lookup"><span data-stu-id="5403b-124">It encodes them into a byte array by using code page 737 (also known as MS-DOS Greek) and saves the byte array to a file.</span></span> <span data-ttu-id="5403b-125">Если файл извлекается и его массив байтов расшифровывается с использованием кодовой страницы 737, исходные символы будут восстановлены.</span><span class="sxs-lookup"><span data-stu-id="5403b-125">If the file is retrieved and its byte array is decoded by using code page 737, the original characters are restored.</span></span> <span data-ttu-id="5403b-126">Однако если файл извлекается и его массив байтов расшифровывается с использованием кодовой страницы 1252 (или Windows-1252, которая представляет символы в латинском алфавите), исходные символы теряются.</span><span class="sxs-lookup"><span data-stu-id="5403b-126">However, if the file is retrieved and its byte array is decoded by using code page 1252 (or Windows-1252, which represents characters in the Latin alphabet), the original characters are lost.</span></span>

[!code-csharp[Conceptual.Globalization#1](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.globalization/cs/codepages1.cs#1)]
[!code-vb[Conceptual.Globalization#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.globalization/vb/codepages1.vb#1)]

<span data-ttu-id="5403b-127">Использование Юникода гарантирует, что одни и те же единицы кода всегда сопоставляются с одними и теми же символами и что одни и те же символы всегда сопоставляются с одними и теми же байтовыми массивами.</span><span class="sxs-lookup"><span data-stu-id="5403b-127">The use of Unicode ensures that the same code units always map to the same characters, and that the same characters always map to the same byte arrays.</span></span>

### <a name="use-resource-files"></a><span data-ttu-id="5403b-128">Использование файлов ресурсов</span><span class="sxs-lookup"><span data-stu-id="5403b-128">Use resource files</span></span>

<span data-ttu-id="5403b-129">Даже если вы разрабатываете приложение, которое предназначено для одной культуры или региона, необходимо использовать файлы ресурсов для сохранения строк и других ресурсов, отображаемых в пользовательском интерфейсе.</span><span class="sxs-lookup"><span data-stu-id="5403b-129">Even if you are developing an app that targets a single culture or region, you should use resource files to store strings and other resources that are displayed in the user interface.</span></span> <span data-ttu-id="5403b-130">Никогда не следует добавлять их непосредственно в код.</span><span class="sxs-lookup"><span data-stu-id="5403b-130">You should never add them directly to your code.</span></span> <span data-ttu-id="5403b-131">Использование файлов ресурсов имеет ряд преимуществ:</span><span class="sxs-lookup"><span data-stu-id="5403b-131">Using resource files has a number of advantages:</span></span>

- <span data-ttu-id="5403b-132">Все строки находятся в одном месте.</span><span class="sxs-lookup"><span data-stu-id="5403b-132">All the strings are in a single location.</span></span> <span data-ttu-id="5403b-133">Нет необходимости выполнять поиск во всем исходном коде для определения строки для изменения для конкретного языка.</span><span class="sxs-lookup"><span data-stu-id="5403b-133">You don't have to search throughout your source code to identify strings to modify for a specific language or culture.</span></span>

- <span data-ttu-id="5403b-134">Дублировать строки не нужно.</span><span class="sxs-lookup"><span data-stu-id="5403b-134">There is no need to duplicate strings.</span></span> <span data-ttu-id="5403b-135">Разработчики, которые не используют файлы ресурсов, часто определяют одинаковые строки в нескольких файлах исходного кода.</span><span class="sxs-lookup"><span data-stu-id="5403b-135">Developers who don't use resource files often define the same string in multiple source code files.</span></span> <span data-ttu-id="5403b-136">Эта дублирование увеличивает вероятность пропуска одного или нескольких экземпляров при изменении строки.</span><span class="sxs-lookup"><span data-stu-id="5403b-136">This duplication increases the probability that one or more instances will be overlooked when a string is modified.</span></span>

- <span data-ttu-id="5403b-137">Нестроковые ресурсы, например изображения или двоичные данные, можно включить в файл ресурсов, вместо того чтобы сохранять их в отдельном файле, чтобы их можно было легко извлечь.</span><span class="sxs-lookup"><span data-stu-id="5403b-137">You can include non-string resources, such as images or binary data, in the resource file instead of storing them in a separate standalone file, so they can be retrieved easily.</span></span>

<span data-ttu-id="5403b-138">Использование файлов ресурсов имеет определенные преимущества при создании локализованного приложения.</span><span class="sxs-lookup"><span data-stu-id="5403b-138">Using resource files has particular advantages if you are creating a localized app.</span></span> <span data-ttu-id="5403b-139">При развертывании ресурсов во вспомогательных сборках среда CLR автоматически выбирает соответствующий языку и региональным параметрам ресурс на основе текущего языка пользовательского интерфейса, как определено свойством <xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="5403b-139">When you deploy resources in satellite assemblies, the common language runtime automatically selects a culture-appropriate resource based on the user's current UI culture as defined by the <xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="5403b-140">Если требуется предоставить подходящий ресурс для конкретного языка и региональных параметров и правильно создать экземпляр объекта <xref:System.Resources.ResourceManager> или использовать строго типизированный класс ресурса, среда выполнения обрабатывает сведения о получении соответствующих ресурсов.</span><span class="sxs-lookup"><span data-stu-id="5403b-140">As long as you provide an appropriate culture-specific resource and correctly instantiate a <xref:System.Resources.ResourceManager> object or use a strongly typed resource class, the runtime handles the details of retrieving the appropriate resources.</span></span>

<span data-ttu-id="5403b-141">Дополнительные сведения о создании файлов ресурсов см. в статье [Создание файлов ресурсов для приложений для настольных систем](../../../docs/framework/resources/creating-resource-files-for-desktop-apps.md).</span><span class="sxs-lookup"><span data-stu-id="5403b-141">For more information about creating resource files, see [Creating Resource Files](../../../docs/framework/resources/creating-resource-files-for-desktop-apps.md).</span></span> <span data-ttu-id="5403b-142">Сведения о создании и развертывании вспомогательных сборок см. в статьях [Создание вспомогательных сборок для приложений для настольных систем](../../../docs/framework/resources/creating-satellite-assemblies-for-desktop-apps.md) и [Упаковка и развертывание ресурсов в приложениях для настольных систем](../../../docs/framework/resources/packaging-and-deploying-resources-in-desktop-apps.md).</span><span class="sxs-lookup"><span data-stu-id="5403b-142">For information about creating and deploying satellite assemblies, see [Creating Satellite Assemblies](../../../docs/framework/resources/creating-satellite-assemblies-for-desktop-apps.md) and [Packaging and Deploying Resources](../../../docs/framework/resources/packaging-and-deploying-resources-in-desktop-apps.md).</span></span>

### <a name="search-and-compare-strings"></a><span data-ttu-id="5403b-143">Поиск и сравнение строк</span><span class="sxs-lookup"><span data-stu-id="5403b-143">Search and compare strings</span></span>

<span data-ttu-id="5403b-144">При возможности рекомендуется обрабатывать строки целиком, а не в виде последовательностей отдельных символов.</span><span class="sxs-lookup"><span data-stu-id="5403b-144">Whenever possible, you should handle strings as entire strings instead of handling them as a series of individual characters.</span></span> <span data-ttu-id="5403b-145">Это особенно важно при сортировке или поиске подстрок для избежания проблем, связанных с обработкой несамостоятельных знаков.</span><span class="sxs-lookup"><span data-stu-id="5403b-145">This is especially important when you sort or search for substrings, to prevent problems associated with parsing combined characters.</span></span>

> [!TIP]
> <span data-ttu-id="5403b-146">Можно использовать класс <xref:System.Globalization.StringInfo> для работы с текстовыми элементами, а не отдельными символами в строке.</span><span class="sxs-lookup"><span data-stu-id="5403b-146">You can use the <xref:System.Globalization.StringInfo> class to work with the text elements rather than the individual characters in a string.</span></span>

<span data-ttu-id="5403b-147">В операциях поиска и сравнения строк частая ошибка заключается в том, что строка рассматривается как коллекция символов, каждый из которых представлен объектом <xref:System.Char>.</span><span class="sxs-lookup"><span data-stu-id="5403b-147">In string searches and comparisons, a common mistake is to treat the string as a collection of characters, each of which is represented by a <xref:System.Char> object.</span></span> <span data-ttu-id="5403b-148">Фактически, один символ может быть сформирован одним, двумя или более объектами <xref:System.Char>.</span><span class="sxs-lookup"><span data-stu-id="5403b-148">In fact, a single character may be formed by one, two, or more <xref:System.Char> objects.</span></span> <span data-ttu-id="5403b-149">Эти символы чаще всего встречаются в строках из языков, алфавиты которых состоят из символов, не входящих в базовый диапазон латинских символов Юникода (с U+0021 по U+007E).</span><span class="sxs-lookup"><span data-stu-id="5403b-149">Such characters are found most frequently in strings from cultures whose alphabets consist of characters outside the Unicode Basic Latin character range (U+0021 through U+007E).</span></span> <span data-ttu-id="5403b-150">В следующем примере предпринимается попытка найти индекс символа LATIN CAPITAL LETTER A WITH GRAVE (U+00C0) в строке.</span><span class="sxs-lookup"><span data-stu-id="5403b-150">The following example tries to find the index of the LATIN CAPITAL LETTER A WITH GRAVE character (U+00C0) in a string.</span></span> <span data-ttu-id="5403b-151">Однако этот символ можно представить двумя различными способами: как один блок кода (U+00C0) или как составной знак (два блока кода: U+0041 и U+0300).</span><span class="sxs-lookup"><span data-stu-id="5403b-151">However, this character can be represented in two different ways: as a single code unit (U+00C0) or as a composite character (two code units: U+0041 and U+0300).</span></span> <span data-ttu-id="5403b-152">В этом случае символ представлен в экземпляре строки двумя объектами <xref:System.Char> — U+0041 и U+0300.</span><span class="sxs-lookup"><span data-stu-id="5403b-152">In this case, the character is represented in the string instance by two <xref:System.Char> objects, U+0041 and U+0300.</span></span> <span data-ttu-id="5403b-153">Код в примере вызывает перегрузки <xref:System.String.IndexOf%28System.Char%29?displayProperty=nameWithType> и <xref:System.String.IndexOf%28System.String%29?displayProperty=nameWithType>, чтобы найти позицию этого символа в экземпляре строки, но они возвращают разные результаты.</span><span class="sxs-lookup"><span data-stu-id="5403b-153">The example code calls the <xref:System.String.IndexOf%28System.Char%29?displayProperty=nameWithType> and <xref:System.String.IndexOf%28System.String%29?displayProperty=nameWithType> overloads to find the position of this character in the string instance, but these return different results.</span></span> <span data-ttu-id="5403b-154">Первый вызов метода имеет аргумент <xref:System.Char>; он выполняет порядковое сравнение и поэтому не может найти совпадение.</span><span class="sxs-lookup"><span data-stu-id="5403b-154">The first method call has a <xref:System.Char> argument; it performs an ordinal comparison and therefore cannot find a match.</span></span> <span data-ttu-id="5403b-155">Второй вызов имеет аргумент <xref:System.String>; он выполняет сравнение с учетом языка и региональных параметров и поэтому находит совпадение.</span><span class="sxs-lookup"><span data-stu-id="5403b-155">The second call has a <xref:System.String> argument; it performs a culture-sensitive comparison and therefore finds a match.</span></span>

[!code-csharp[Conceptual.Globalization#18](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.globalization/cs/search1.cs#18)]
[!code-vb[Conceptual.Globalization#18](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.globalization/vb/search1.vb#18)]

<span data-ttu-id="5403b-156">Чтобы избежать неоднозначности этого примера (вызовы двух одинаковых перегрузок метода возвращают разные результаты), можно вызвать перегрузку, которая включает параметр <xref:System.StringComparison>, например метод <xref:System.String.IndexOf%28System.String%2CSystem.StringComparison%29?displayProperty=nameWithType> или <xref:System.String.LastIndexOf%28System.String%2CSystem.StringComparison%29?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="5403b-156">You can avoid some of the ambiguity of this example (calls to two similar overloads of a method returning different results) by calling an overload that includes a <xref:System.StringComparison> parameter, such as the <xref:System.String.IndexOf%28System.String%2CSystem.StringComparison%29?displayProperty=nameWithType> or <xref:System.String.LastIndexOf%28System.String%2CSystem.StringComparison%29?displayProperty=nameWithType> method.</span></span>

<span data-ttu-id="5403b-157">Однако поиски всегда не учитывают язык и региональные параметры.</span><span class="sxs-lookup"><span data-stu-id="5403b-157">However, searches are not always culture-sensitive.</span></span> <span data-ttu-id="5403b-158">Если цель поиска — принять решение о безопасности или разрешить или запретить доступ к определенному ресурсу, сравнение должно быть порядковое, как описано в следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="5403b-158">If the purpose of the search is to make a security decision or to allow or disallow access to some resource, the comparison should be ordinal, as discussed in the next section.</span></span>

### <a name="test-strings-for-equality"></a><span data-ttu-id="5403b-159">Проверка строк на равенство</span><span class="sxs-lookup"><span data-stu-id="5403b-159">Test strings for equality</span></span>

<span data-ttu-id="5403b-160">Если требуется проверить две строки на равенство, а не определить, как они сравниваются в порядке сортировки, следует использовать метод <xref:System.String.Equals%2A?displayProperty=nameWithType> вместо метода сравнения строк, такого как <xref:System.String.Compare%2A?displayProperty=nameWithType> или <xref:System.Globalization.CompareInfo.Compare%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="5403b-160">If you want to test two strings for equality rather than determine how they compare in the sort order, use the <xref:System.String.Equals%2A?displayProperty=nameWithType> method instead of a string comparison method such as <xref:System.String.Compare%2A?displayProperty=nameWithType> or <xref:System.Globalization.CompareInfo.Compare%2A?displayProperty=nameWithType>.</span></span>

<span data-ttu-id="5403b-161">Сравнения на равенство обычно выполняются для получения некоторой условности ресурса.</span><span class="sxs-lookup"><span data-stu-id="5403b-161">Comparisons for equality are typically performed to access some resource conditionally.</span></span> <span data-ttu-id="5403b-162">Например, можно выполнить сравнение на равенство для проверки пароля или чтобы убедиться, что файл существует.</span><span class="sxs-lookup"><span data-stu-id="5403b-162">For example, you might perform a comparison for equality to verify a password or to confirm that a file exists.</span></span> <span data-ttu-id="5403b-163">Такие нелингвистические сравнения всегда должны быть порядковыми, а не зависящими от языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="5403b-163">Such non-linguistic comparisons should always be ordinal rather than culture-sensitive.</span></span> <span data-ttu-id="5403b-164">Как правило, необходимо вызвать экземпляр метода <xref:System.String.Equals%28System.String%2CSystem.StringComparison%29?displayProperty=nameWithType> или статический метод <xref:System.String.Equals%28System.String%2CSystem.String%2CSystem.StringComparison%29?displayProperty=nameWithType> со значением <xref:System.StringComparison.Ordinal?displayProperty=nameWithType> для строк, например паролей, и значением <xref:System.StringComparison.OrdinalIgnoreCase?displayProperty=nameWithType> для строк, таких как имена файлов или URI.</span><span class="sxs-lookup"><span data-stu-id="5403b-164">In general, you should call the instance <xref:System.String.Equals%28System.String%2CSystem.StringComparison%29?displayProperty=nameWithType> method or the static <xref:System.String.Equals%28System.String%2CSystem.String%2CSystem.StringComparison%29?displayProperty=nameWithType> method with a value of <xref:System.StringComparison.Ordinal?displayProperty=nameWithType> for strings such as passwords, and a value of <xref:System.StringComparison.OrdinalIgnoreCase?displayProperty=nameWithType> for strings such as file names or URIs.</span></span>

<span data-ttu-id="5403b-165">Сравнения на равенство иногда включают поиск или сравнения подстрок, а не вызовы метода <xref:System.String.Equals%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="5403b-165">Comparisons for equality sometimes involve searches or substring comparisons rather than calls to the <xref:System.String.Equals%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="5403b-166">В некоторых случаях можно использовать поиск подстрок, чтобы определить, равняется ли эта подстрока другой строке.</span><span class="sxs-lookup"><span data-stu-id="5403b-166">In some cases, you may use a substring search to determine whether that substring equals another string.</span></span> <span data-ttu-id="5403b-167">Если цель сравнения не лингвистическая, поиск также должен быть порядковым, а не с учетом языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="5403b-167">If the purpose of this comparison is non-linguistic, the search should also be ordinal rather than culture-sensitive.</span></span>

<span data-ttu-id="5403b-168">Следующий пример иллюстрирует опасность, связанную с использованием поиска с учетом языка и региональных параметров применительно к нелингвистическим данным.</span><span class="sxs-lookup"><span data-stu-id="5403b-168">The following example illustrates the danger of a culture-sensitive search on non-linguistic data.</span></span> <span data-ttu-id="5403b-169">Метод `AccessesFileSystem` позволяет запретить файловой системе доступ к URI, которые начинается с подстроки "FILE".</span><span class="sxs-lookup"><span data-stu-id="5403b-169">The `AccessesFileSystem` method is designed to prohibit file system access for URIs that begin with the substring "FILE".</span></span> <span data-ttu-id="5403b-170">Для этого он выполняет сравнение с учетом языка и региональных параметров без учета регистра начала URI со строкой "FILE".</span><span class="sxs-lookup"><span data-stu-id="5403b-170">To do this, it performs a culture-sensitive, case-insensitive comparison of the beginning of the URI with the string "FILE".</span></span> <span data-ttu-id="5403b-171">Поскольку универсальный код ресурса (URI) для доступа к файловой системе может начинаться с "FILE:" или "file:", то неявно предполагается, что символ "i" (U+0069) всегда является эквивалентом символа "I" (U+0049) в нижнем регистре.</span><span class="sxs-lookup"><span data-stu-id="5403b-171">Because a URI that accesses the file system can begin with either "FILE:" or "file:", the implicit assumption is that "i" (U+0069) is always the lowercase equivalent of "I" (U+0049).</span></span> <span data-ttu-id="5403b-172">Однако в турецком и азербайджанском прописная версия "i" — "İ" (U+0130).</span><span class="sxs-lookup"><span data-stu-id="5403b-172">However, in Turkish and Azerbaijani, the uppercase version of "i" is "İ" (U+0130).</span></span> <span data-ttu-id="5403b-173">Вследствие этого несоответствия сравнение с учетом языка и региональных параметров разрешает доступ к файловой системе, когда он должен быть запрещен.</span><span class="sxs-lookup"><span data-stu-id="5403b-173">Because of this discrepancy, the culture-sensitive comparison allows file system access when it should be prohibited.</span></span>

[!code-csharp[Conceptual.Globalization#12](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.globalization/cs/equals1.cs#12)]
[!code-vb[Conceptual.Globalization#12](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.globalization/vb/equals1.vb#12)]

<span data-ttu-id="5403b-174">Чтобы избежать этой проблемы, выполните порядковое сравнение, которое не учитывает регистр, как показано в следующем примере.</span><span class="sxs-lookup"><span data-stu-id="5403b-174">You can avoid this problem by performing an ordinal comparison that ignores case, as the following example shows.</span></span>

[!code-csharp[Conceptual.Globalization#13](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.globalization/cs/equals2.cs#13)]
[!code-vb[Conceptual.Globalization#13](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.globalization/vb/equals2.vb#13)]

### <a name="order-and-sort-strings"></a><span data-ttu-id="5403b-175">Порядок и сортировка строк</span><span class="sxs-lookup"><span data-stu-id="5403b-175">Order and sort strings</span></span>

<span data-ttu-id="5403b-176">Как правило, упорядоченные строки, которые должны отображаться в пользовательском интерфейсе, должны сортироваться с учетом языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="5403b-176">Typically, ordered strings that are to be displayed in the user interface should be sorted based on culture.</span></span> <span data-ttu-id="5403b-177">В большинстве случаев эти сравнения строк обрабатываются неявно платформой .NET при вызове метода, сортирующего строки, например <xref:System.Array.Sort%2A?displayProperty=nameWithType> или <xref:System.Collections.Generic.List%601.Sort%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="5403b-177">For the most part, such string comparisons are handled implicitly by .NET when you call a method that sorts strings, such as <xref:System.Array.Sort%2A?displayProperty=nameWithType> or <xref:System.Collections.Generic.List%601.Sort%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="5403b-178">По умолчанию строки будут отсортированы с помощью соглашений сортировки текущего языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="5403b-178">By default, strings are sorted by using the sorting conventions of the current culture.</span></span> <span data-ttu-id="5403b-179">В следующем примере показана разница между сортировкой массива строк с использованием соглашений языка и региональных параметров "Английский (США)" и языка и региональных параметров "Шведский (Швеция)".</span><span class="sxs-lookup"><span data-stu-id="5403b-179">The following example illustrates the difference when an array of strings is sorted by using the conventions of the English (United States) culture and the Swedish (Sweden) culture.</span></span>

[!code-csharp[Conceptual.Globalization#14](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.globalization/cs/sort1.cs#14)]
[!code-vb[Conceptual.Globalization#14](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.globalization/vb/sort1.vb#14)]

<span data-ttu-id="5403b-180">Учитывающее язык и региональные параметры сравнение строк определяется объектом <xref:System.Globalization.CompareInfo>, который возвращается свойством <xref:System.Globalization.CultureInfo.CompareInfo%2A?displayProperty=nameWithType> каждого языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="5403b-180">Culture-sensitive string comparison is defined by the <xref:System.Globalization.CompareInfo> object, which is returned by each culture's <xref:System.Globalization.CultureInfo.CompareInfo%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="5403b-181">Учитывающие язык и региональные параметры сравнения строк, которые используют перегрузки метода <xref:System.String.Compare%2A?displayProperty=nameWithType>, также используют объект <xref:System.Globalization.CompareInfo>.</span><span class="sxs-lookup"><span data-stu-id="5403b-181">Culture-sensitive string comparisons that use the <xref:System.String.Compare%2A?displayProperty=nameWithType> method overloads also use the <xref:System.Globalization.CompareInfo> object.</span></span>

<span data-ttu-id="5403b-182">В .NET используются таблицы для сортировки строковых данных с учетом языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="5403b-182">.NET uses tables to perform culture-sensitive sorts on string data.</span></span> <span data-ttu-id="5403b-183">Содержимое этих таблиц, которые содержат данные по весам сортировки и нормализации строк, определяется версией стандарта Юникода, реализуемой определенной версией .NET.</span><span class="sxs-lookup"><span data-stu-id="5403b-183">The content of these tables, which contain data on sort weights and string normalization, is determined by the version of the Unicode standard implemented by a particular version of .NET.</span></span> <span data-ttu-id="5403b-184">В следующей таблице перечислены версии Юникода, реализуемые различными версиями .NET Framework и .NET Core.</span><span class="sxs-lookup"><span data-stu-id="5403b-184">The following table lists the versions of Unicode implemented by the specified versions of the .NET Framework and by .NET Core.</span></span> <span data-ttu-id="5403b-185">Обратите внимание, что этот список поддерживаемых версий Юникода применяется только к сравнению и сортировке символов. Он не применяется для классификации символов Юникода по категориям.</span><span class="sxs-lookup"><span data-stu-id="5403b-185">Note that this list of supported Unicode versions applies to character comparison and sorting only; it does not apply to classification of Unicode characters by category.</span></span> <span data-ttu-id="5403b-186">Дополнительные сведения см. в разделе "Строки и стандарт Юникода" в статье <xref:System.String>.</span><span class="sxs-lookup"><span data-stu-id="5403b-186">For more information, see the "Strings and The Unicode Standard" section in the <xref:System.String> article.</span></span>

|<span data-ttu-id="5403b-187">Версия платформы .NET Framework</span><span class="sxs-lookup"><span data-stu-id="5403b-187">.NET Framework version</span></span>|<span data-ttu-id="5403b-188">Операционная система</span><span class="sxs-lookup"><span data-stu-id="5403b-188">Operating system</span></span>|<span data-ttu-id="5403b-189">Версия Юникода</span><span class="sxs-lookup"><span data-stu-id="5403b-189">Unicode version</span></span>|
|----------------------------|----------------------|---------------------|
|<span data-ttu-id="5403b-190">.NET Framework 2.0</span><span class="sxs-lookup"><span data-stu-id="5403b-190">.NET Framework 2.0</span></span>|<span data-ttu-id="5403b-191">Все операционные системы</span><span class="sxs-lookup"><span data-stu-id="5403b-191">All operating systems</span></span>|<span data-ttu-id="5403b-192">Юникод 4.1</span><span class="sxs-lookup"><span data-stu-id="5403b-192">Unicode 4.1</span></span>|
|<span data-ttu-id="5403b-193">.NET Framework 3.0</span><span class="sxs-lookup"><span data-stu-id="5403b-193">.NET Framework 3.0</span></span>|<span data-ttu-id="5403b-194">Все операционные системы</span><span class="sxs-lookup"><span data-stu-id="5403b-194">All operating systems</span></span>|<span data-ttu-id="5403b-195">Юникод 4.1</span><span class="sxs-lookup"><span data-stu-id="5403b-195">Unicode 4.1</span></span>|
|<span data-ttu-id="5403b-196">.NET Framework 3,5</span><span class="sxs-lookup"><span data-stu-id="5403b-196">.NET Framework 3.5</span></span>|<span data-ttu-id="5403b-197">Все операционные системы</span><span class="sxs-lookup"><span data-stu-id="5403b-197">All operating systems</span></span>|<span data-ttu-id="5403b-198">Юникод 4.1</span><span class="sxs-lookup"><span data-stu-id="5403b-198">Unicode 4.1</span></span>|
|<span data-ttu-id="5403b-199">.NET Framework 4</span><span class="sxs-lookup"><span data-stu-id="5403b-199">.NET Framework 4</span></span>|<span data-ttu-id="5403b-200">Все операционные системы</span><span class="sxs-lookup"><span data-stu-id="5403b-200">All operating systems</span></span>|<span data-ttu-id="5403b-201">Юникод 5.0</span><span class="sxs-lookup"><span data-stu-id="5403b-201">Unicode 5.0</span></span>|
|<span data-ttu-id="5403b-202">.NET Framework 4.5 и более поздних версий в Windows 7</span><span class="sxs-lookup"><span data-stu-id="5403b-202">.NET Framework 4.5 and later on Windows 7</span></span>|<span data-ttu-id="5403b-203">Юникод 5.0</span><span class="sxs-lookup"><span data-stu-id="5403b-203">Unicode 5.0</span></span>|
|<span data-ttu-id="5403b-204">.NET Framework 4.5 и более поздних версий в операционных системах не ниже Windows 8</span><span class="sxs-lookup"><span data-stu-id="5403b-204">.NET Framework 4.5 and later on Windows 8 and later operating systems</span></span>|<span data-ttu-id="5403b-205">Юникод 6.3.0</span><span class="sxs-lookup"><span data-stu-id="5403b-205">Unicode 6.3.0</span></span>|
|<span data-ttu-id="5403b-206">.NET Core (все версии)</span><span class="sxs-lookup"><span data-stu-id="5403b-206">.NET Core (all versions)</span></span>|<span data-ttu-id="5403b-207">Зависит от версии стандарта Юникода, поддерживаемой базовой операционной системой.</span><span class="sxs-lookup"><span data-stu-id="5403b-207">Depends on the version of the Unicode Standard supported by the underlying operating system.</span></span>|

<span data-ttu-id="5403b-208">Начиная с .NET Framework 4.5 и во всех версиях .NET Core сравнение строк и их сортировка зависит от операционной системы.</span><span class="sxs-lookup"><span data-stu-id="5403b-208">Starting with .NET Framework 4.5 and in all versions of .NET Core, string comparison and sorting depends on the operating system.</span></span> <span data-ttu-id="5403b-209">Платформа .NET Framework 4.5 и более поздних версий, запущенная в Windows 7, извлекает данные из собственных таблиц, реализующих Юникод 5.0.</span><span class="sxs-lookup"><span data-stu-id="5403b-209">The .NET Framework 4.5 and later running on Windows 7 retrieves data from its own tables that implement Unicode 5.0.</span></span> <span data-ttu-id="5403b-210">Платформа .NET Framework 4.5 и более поздних версий, запущенная в Windows 8, извлекает данные из таблиц операционной системы, реализующих Юникод 6.3.</span><span class="sxs-lookup"><span data-stu-id="5403b-210">The .NET Framework 4.5 and later running on Windows 8 and later retrieves data from operating system tables that implement Unicode 6.3.</span></span> <span data-ttu-id="5403b-211">В .NET Core поддерживаемая версия Юникода зависит от базовой операционной системы.</span><span class="sxs-lookup"><span data-stu-id="5403b-211">On .NET Core, the supported version of Unicode depends on the underlying operating system.</span></span> <span data-ttu-id="5403b-212">Если вы сериализуете учитывающие язык и региональные параметры данные, можно использовать класс <xref:System.Globalization.SortVersion>, чтобы определить, когда сериализованные данные должны быть отсортированы, чтобы порядок был согласован с порядком сортировки платформы .NET и операционной системы.</span><span class="sxs-lookup"><span data-stu-id="5403b-212">If you serialize culture-sensitive sorted data, you can use the <xref:System.Globalization.SortVersion> class to determine when your serialized data needs to be sorted so that it is consistent with .NET and the operating system's sort order.</span></span> <span data-ttu-id="5403b-213">Пример см. в разделе с описанием класса <xref:System.Globalization.SortVersion>.</span><span class="sxs-lookup"><span data-stu-id="5403b-213">For an example, see the <xref:System.Globalization.SortVersion> class topic.</span></span>

<span data-ttu-id="5403b-214">Если приложение выполняет множество сортировок строковых данных в связи с особенностями культуры, можно работать с классом <xref:System.Globalization.SortKey> для сравнения строк.</span><span class="sxs-lookup"><span data-stu-id="5403b-214">If your app performs extensive culture-specific sorts of string data, you can work with the <xref:System.Globalization.SortKey> class to compare strings.</span></span> <span data-ttu-id="5403b-215">Ключ сортировки отражает весовые коэффициенты сортировки для конкретных языков и региональных параметров, включая вес алфавитный, вес регистра и диакритический вес конкретной строки.</span><span class="sxs-lookup"><span data-stu-id="5403b-215">A sort key reflects the culture-specific sort weights, including the alphabetic, case, and diacritic weights of a particular string.</span></span> <span data-ttu-id="5403b-216">Поскольку сравнения с помощью ключей сортировки бинарны, они быстрее, чем сравнения, использующие объект <xref:System.Globalization.CompareInfo> явно или неявно.</span><span class="sxs-lookup"><span data-stu-id="5403b-216">Because comparisons using sort keys are binary, they are faster than comparisons that use a <xref:System.Globalization.CompareInfo> object either implicitly or explicitly.</span></span> <span data-ttu-id="5403b-217">При создании ключа сортировки для конкретных языков и региональных параметров для конкретной строки вы передаете строку в метод <xref:System.Globalization.CompareInfo.GetSortKey%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="5403b-217">You create a culture-specific sort key for a particular string by passing the string to the <xref:System.Globalization.CompareInfo.GetSortKey%2A?displayProperty=nameWithType> method.</span></span>

<span data-ttu-id="5403b-218">Следующий пример подобен предыдущему примеру.</span><span class="sxs-lookup"><span data-stu-id="5403b-218">The following example is similar to the previous example.</span></span> <span data-ttu-id="5403b-219">Однако вместо вызова метода <xref:System.Array.Sort%28System.Array%29?displayProperty=nameWithType>, который неявно вызывает метод <xref:System.Globalization.CompareInfo.Compare%2A?displayProperty=nameWithType>, он определяет реализацию <xref:System.Collections.Generic.IComparer%601?displayProperty=nameWithType>, которая сравнивает создаваемые им ключи сортировки и передает в метод <xref:System.Array.Sort%60%601%28%60%600%5B%5D%2CSystem.Collections.Generic.IComparer%7B%60%600%7D%29?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="5403b-219">However, instead of calling the <xref:System.Array.Sort%28System.Array%29?displayProperty=nameWithType> method, which implicitly calls the <xref:System.Globalization.CompareInfo.Compare%2A?displayProperty=nameWithType> method, it defines an <xref:System.Collections.Generic.IComparer%601?displayProperty=nameWithType> implementation that compares sort keys, which it instantiates and passes to the <xref:System.Array.Sort%60%601%28%60%600%5B%5D%2CSystem.Collections.Generic.IComparer%7B%60%600%7D%29?displayProperty=nameWithType> method.</span></span>

[!code-csharp[Conceptual.Globalization#15](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.globalization/cs/sortkey1.cs#15)]
[!code-vb[Conceptual.Globalization#15](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.globalization/vb/sortkey1.vb#15)]

### <a name="avoid-string-concatenation"></a><span data-ttu-id="5403b-220">Избегайте объединения строк</span><span class="sxs-lookup"><span data-stu-id="5403b-220">Avoid string concatenation</span></span>

<span data-ttu-id="5403b-221">Если это возможно, никогда не следует использовать составные строки, полученные во время выполнения программы при помощи соединения фраз.</span><span class="sxs-lookup"><span data-stu-id="5403b-221">If at all possible, avoid using composite strings that are built at run time from concatenated phrases.</span></span> <span data-ttu-id="5403b-222">Составные строки трудно локализовать, потому что они часто используют грамматический порядок исходного языка приложения, который не может быть применен для других языков локализации.</span><span class="sxs-lookup"><span data-stu-id="5403b-222">Composite strings are difficult to localize, because they often assume a grammatical order in the app's original language that does not apply to other localized languages.</span></span>

## <a name="handle-dates-and-times"></a><span data-ttu-id="5403b-223">Обработка дат и времени</span><span class="sxs-lookup"><span data-stu-id="5403b-223">Handle dates and times</span></span>

<span data-ttu-id="5403b-224">Способ обработки значений даты и времени зависит от того, отображаются ли они в интерфейсе пользователя или сохраняются.</span><span class="sxs-lookup"><span data-stu-id="5403b-224">How you handle date and time values depends on whether they are displayed in the user interface or persisted.</span></span> <span data-ttu-id="5403b-225">В данном разделе рассматриваются оба варианта использования.</span><span class="sxs-lookup"><span data-stu-id="5403b-225">This section examines both usages.</span></span> <span data-ttu-id="5403b-226">Здесь также рассматриваются способы обработки отличий в часовом поясе и арифметические операции при работе с датами и временем.</span><span class="sxs-lookup"><span data-stu-id="5403b-226">It also discusses how you can handle time zone differences and arithmetic operations when working with dates and times.</span></span>

### <a name="display-dates-and-times"></a><span data-ttu-id="5403b-227">Отображение дат и времени</span><span class="sxs-lookup"><span data-stu-id="5403b-227">Display dates and times</span></span>

<span data-ttu-id="5403b-228">Как правило, когда даты и время отображаются в пользовательском интерфейсе, необходимо использовать соглашения о форматировании, принятые в языке и региональных параметрах пользователя, которые определяются свойством <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType> и объектом <xref:System.Globalization.DateTimeFormatInfo>, возвращаемым свойством `CultureInfo.CurrentCulture.DateTimeFormat`.</span><span class="sxs-lookup"><span data-stu-id="5403b-228">Typically, when dates and times are displayed in the user interface, you should use the formatting conventions of the user's culture, which is defined by the <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType> property and by the <xref:System.Globalization.DateTimeFormatInfo> object returned by the `CultureInfo.CurrentCulture.DateTimeFormat` property.</span></span> <span data-ttu-id="5403b-229">Соглашения о форматировании текущего языка и региональных параметров автоматически используются при форматировании даты с помощью любого из следующих методов.</span><span class="sxs-lookup"><span data-stu-id="5403b-229">The formatting conventions of the current culture are automatically used when you format a date by using any of these methods:</span></span>

- <span data-ttu-id="5403b-230">Метод <xref:System.DateTime.ToString?displayProperty=nameWithType> без параметров</span><span class="sxs-lookup"><span data-stu-id="5403b-230">The parameterless <xref:System.DateTime.ToString?displayProperty=nameWithType> method</span></span>

- <span data-ttu-id="5403b-231">Метод <xref:System.DateTime.ToString%28System.String%29?displayProperty=nameWithType>, который включает строку формата</span><span class="sxs-lookup"><span data-stu-id="5403b-231">The <xref:System.DateTime.ToString%28System.String%29?displayProperty=nameWithType> method, which includes a format string</span></span>

- <span data-ttu-id="5403b-232">Метод <xref:System.DateTimeOffset.ToString?displayProperty=nameWithType> без параметров</span><span class="sxs-lookup"><span data-stu-id="5403b-232">The parameterless <xref:System.DateTimeOffset.ToString?displayProperty=nameWithType> method</span></span>

- <span data-ttu-id="5403b-233">Метод <xref:System.DateTimeOffset.ToString%28System.String%29?displayProperty=nameWithType>, который включает строку формата</span><span class="sxs-lookup"><span data-stu-id="5403b-233">The <xref:System.DateTimeOffset.ToString%28System.String%29?displayProperty=nameWithType>, which includes a format string</span></span>

- <span data-ttu-id="5403b-234">Функция [составного форматирования](../../../docs/standard/base-types/composite-formatting.md), когда она используется с датами.</span><span class="sxs-lookup"><span data-stu-id="5403b-234">The [composite formatting](../../../docs/standard/base-types/composite-formatting.md) feature, when it is used with dates</span></span>

<span data-ttu-id="5403b-235">Следующий пример выводит данные о восходе и заходе солнца дважды для 11 октября 2012 г.</span><span class="sxs-lookup"><span data-stu-id="5403b-235">The following example displays sunrise and sunset data twice for October 11, 2012.</span></span> <span data-ttu-id="5403b-236">Сначала он устанавливает текущий язык и региональные параметры как хорватский (Хорватия), а затем как английский язык (Соединенное Королевство).</span><span class="sxs-lookup"><span data-stu-id="5403b-236">It first sets the current culture to Croatian (Croatia), and then to English (Great Britain).</span></span> <span data-ttu-id="5403b-237">В каждом случае дата и время отображаются в формате, который подходит для этого языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="5403b-237">In each case, the dates and times are displayed in the format that is appropriate for that culture.</span></span>

[!code-csharp[Conceptual.Globalization#2](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.globalization/cs/dates1.cs#2)]
[!code-vb[Conceptual.Globalization#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.globalization/vb/dates1.vb#2)]

### <a name="persist-dates-and-times"></a><span data-ttu-id="5403b-238">Сохранение дат и времени</span><span class="sxs-lookup"><span data-stu-id="5403b-238">Persist dates and times</span></span>

<span data-ttu-id="5403b-239">Никогда не следует сохранять данные даты и времени в формате, который может зависеть от языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="5403b-239">You should never persist date and time data in a format that can vary by culture.</span></span> <span data-ttu-id="5403b-240">Это распространенная ошибка программирования, которая приводит к повреждению данных или исключению времени выполнения.</span><span class="sxs-lookup"><span data-stu-id="5403b-240">This is a common programming error that results in either corrupted data or a run-time exception.</span></span> <span data-ttu-id="5403b-241">Следующий пример сериализует две даты — 9 января 2013 г. и 18 августа 2013 г. — в виде строк с использованием соглашений о форматировании для языка и региональных параметров "Английский (США)".</span><span class="sxs-lookup"><span data-stu-id="5403b-241">The following example serializes two dates, January 9, 2013 and August 18, 2013, as strings by using the formatting conventions of the English (United States) culture.</span></span> <span data-ttu-id="5403b-242">Когда данные получены и проанализированы с помощью соглашений английского языка (американский вариант), они успешно восстанавливаются.</span><span class="sxs-lookup"><span data-stu-id="5403b-242">When the data is retrieved and parsed by using the conventions of the English (United States) culture, it is successfully restored.</span></span> <span data-ttu-id="5403b-243">Однако когда они извлекаются и анализируются с использованием соглашений для английского языка (Соединенное Королевство), первая дата неправильно интерпретируется как 1-е сентября, а вторая не анализируется, поскольку в григорианском календаре нет 18-го месяца.</span><span class="sxs-lookup"><span data-stu-id="5403b-243">However, when it is retrieved and parsed by using the conventions of the English (United Kingdom) culture, the first date is wrongly interpreted as September 1, and the second fails to parse because the Gregorian calendar does not have an eighteenth month.</span></span>

[!code-csharp[Conceptual.Globalization#3](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.globalization/cs/dates2.cs#3)]
[!code-vb[Conceptual.Globalization#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.globalization/vb/dates2.vb#3)]

<span data-ttu-id="5403b-244">Эту проблему можно исключить любым из трех способов.</span><span class="sxs-lookup"><span data-stu-id="5403b-244">You can avoid this problem in any of three ways:</span></span>

- <span data-ttu-id="5403b-245">Сериализовать дату и время в двоичный формат, а не в строку.</span><span class="sxs-lookup"><span data-stu-id="5403b-245">Serialize the date and time in binary format rather than as a string.</span></span>

- <span data-ttu-id="5403b-246">Сохранить и проанализировать строковое представление даты и времени, используя строку пользовательского формата, одинаковую вне зависимости от языка и региональных параметров пользователя.</span><span class="sxs-lookup"><span data-stu-id="5403b-246">Save and parse the string representation of the date and time by using a custom format string that is the same regardless of the user's culture.</span></span>

- <span data-ttu-id="5403b-247">Сохранить строку с использованием соглашений о форматировании, принятых в инвариантном языке и региональных параметрах.</span><span class="sxs-lookup"><span data-stu-id="5403b-247">Save the string by using the formatting conventions of the invariant culture.</span></span>

<span data-ttu-id="5403b-248">Последний подход показан в приведенном ниже примере.</span><span class="sxs-lookup"><span data-stu-id="5403b-248">The following example illustrates the last approach.</span></span> <span data-ttu-id="5403b-249">Он использует соглашения о форматировании с учетом инвариантного языка и региональных параметров с использованием свойства <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="5403b-249">It uses the formatting conventions of the invariant culture returned by the static <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType> property.</span></span>

[!code-csharp[Conceptual.Globalization#4](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.globalization/cs/dates3.cs#4)]
[!code-vb[Conceptual.Globalization#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.globalization/vb/dates3.vb#4)]

### <a name="serialization-and-time-zone-awareness"></a><span data-ttu-id="5403b-250">Поддержка сериализации и часовых поясов</span><span class="sxs-lookup"><span data-stu-id="5403b-250">Serialization and time zone awareness</span></span>

<span data-ttu-id="5403b-251">Значение даты и времени может иметь несколько интерпретаций, от общего времени ("Магазины открываются 2-го января 2013 г. в 9:00") до определенного момента времени ("Дата рождения: 2-е января 2013 г. 6:32:00").</span><span class="sxs-lookup"><span data-stu-id="5403b-251">A date and time value can have multiple interpretations, ranging from a general time ("The stores open on January 2, 2013, at 9:00 A.M.") to a specific moment in time ("Date of birth: January 2, 2013 6:32:00 A.M.").</span></span> <span data-ttu-id="5403b-252">Если значение времени представляет определенный момент времени и восстанавливается из сериализуемого значения, необходимо убедиться, что оно представляет тот же момент времени независимо от географического положения пользователя или часового пояса.</span><span class="sxs-lookup"><span data-stu-id="5403b-252">When a time value represents a specific moment in time and you restore it from a serialized value, you should ensure that it represents the same moment in time regardless of the user's geographical location or time zone.</span></span>

<span data-ttu-id="5403b-253">Приведенный ниже пример иллюстрирует данную проблему.</span><span class="sxs-lookup"><span data-stu-id="5403b-253">The following example illustrates this problem.</span></span> <span data-ttu-id="5403b-254">В нем одиночное значение локальных даты и времени сохраняется в виде строки в трех [стандартных форматах](../../../docs/standard/base-types/standard-date-and-time-format-strings.md) ("G" для общего длинного формата даты и времени, "s" для сортируемого формата даты и времени и "o" для обратимого преобразования даты и времени), а также в двоичном формате.</span><span class="sxs-lookup"><span data-stu-id="5403b-254">It saves a single local date and time value as a string in three [standard formats](../../../docs/standard/base-types/standard-date-and-time-format-strings.md) ("G" for general date long time, "s" for sortable date/time, and "o" for round-trip date/time) as well as in binary format.</span></span>

[!code-csharp[Conceptual.Globalization#10](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.globalization/cs/dates4.cs#10)]
[!code-vb[Conceptual.Globalization#10](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.globalization/vb/dates4.vb#10)]

<span data-ttu-id="5403b-255">Если данные восстановлены в системе в том же часовом поясе, что и система, в которой они были сериализованы, десериализованные значения даты и времени точно отражают исходное значение, как показано в выходных данных:</span><span class="sxs-lookup"><span data-stu-id="5403b-255">When the data is restored on a system in the same time zone as the system on which it was serialized, the deserialized date and time values accurately reflect the original value, as the output shows:</span></span>

```console
'3/30/2013 6:00:00 PM' --> 3/30/2013 6:00:00 PM Unspecified
'2013-03-30T18:00:00' --> 3/30/2013 6:00:00 PM Unspecified
'2013-03-30T18:00:00.0000000-07:00' --> 3/30/2013 6:00:00 PM Local

3/30/2013 6:00:00 PM Local
```

<span data-ttu-id="5403b-256">Однако при восстановлении данных в системе в другом часовом поясе только значение даты и времени, которое было форматировано с строкой стандартного формата "o" (цикл обработки), сохраняет данные часового пояса и поэтому представляет тот же момент времени.</span><span class="sxs-lookup"><span data-stu-id="5403b-256">However, if you restore the data on a system in a different time zone, only the date and time value that was formatted with the "o" (round-trip) standard format string preserves time zone information and therefore represents the same instant in time.</span></span> <span data-ttu-id="5403b-257">Далее приведен результат, когда данные даты и времени восстанавливаются в системе в часовом поясе "Стандартное романское время":</span><span class="sxs-lookup"><span data-stu-id="5403b-257">Here's the output when the date and time data is restored on a system in the Romance Standard Time zone:</span></span>

```console
'3/30/2013 6:00:00 PM' --> 3/30/2013 6:00:00 PM Unspecified
'2013-03-30T18:00:00' --> 3/30/2013 6:00:00 PM Unspecified
'2013-03-30T18:00:00.0000000-07:00' --> 3/31/2013 3:00:00 AM Local

3/30/2013 6:00:00 PM Local
```

<span data-ttu-id="5403b-258">Для точного отражения значения даты и времени, которое представляет один момент времени независимо от часового пояса системы, где десериализуются данные, можно выполнить любое из следующих действий.</span><span class="sxs-lookup"><span data-stu-id="5403b-258">To accurately reflect a date and time value that represents a single moment of time regardless of the time zone of the system on which the data is deserialized, you can do any of the following:</span></span>

- <span data-ttu-id="5403b-259">Сохранение значения как строки с помощью строки стандартного формата "o" (цикл обработки).</span><span class="sxs-lookup"><span data-stu-id="5403b-259">Save the value as a string by using the "o" (round-trip) standard format string.</span></span> <span data-ttu-id="5403b-260">Последующая десериализация в целевой системе.</span><span class="sxs-lookup"><span data-stu-id="5403b-260">Then deserialize it on the target system.</span></span>

- <span data-ttu-id="5403b-261">Преобразование его во время в формате UTC и сохранение его в виде строки с помощью строки стандартного формата "r" (RFC1123).</span><span class="sxs-lookup"><span data-stu-id="5403b-261">Convert it to UTC and save it as a string by using the "r" (RFC1123) standard format string.</span></span> <span data-ttu-id="5403b-262">Последующая десериализация в целевой системе и преобразование в местное время.</span><span class="sxs-lookup"><span data-stu-id="5403b-262">Then deserialize it on the target system and convert it to local time.</span></span>

- <span data-ttu-id="5403b-263">Преобразование его во время в формате UTC и сохранение его в виде строки с помощью строки стандартного формата "u" (универсальное сортируемое).</span><span class="sxs-lookup"><span data-stu-id="5403b-263">Convert it to UTC and save it as a string by using the "u" (universal sortable) standard format string.</span></span> <span data-ttu-id="5403b-264">Последующая десериализация в целевой системе и преобразование в местное время.</span><span class="sxs-lookup"><span data-stu-id="5403b-264">Then deserialize it on the target system and convert it to local time.</span></span>

- <span data-ttu-id="5403b-265">Преобразование его во время в формате UTC и сохранение его в двоичном формате.</span><span class="sxs-lookup"><span data-stu-id="5403b-265">Convert it to UTC and save it in binary format.</span></span> <span data-ttu-id="5403b-266">Последующая десериализация в целевой системе и преобразование в местное время.</span><span class="sxs-lookup"><span data-stu-id="5403b-266">Then deserialize it on the target system and convert it to local time.</span></span>

<span data-ttu-id="5403b-267">Следующий пример демонстрирует каждую из технологий.</span><span class="sxs-lookup"><span data-stu-id="5403b-267">The following example illustrates each technique.</span></span>

[!code-csharp[Conceptual.Globalization#11](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.globalization/cs/dates8.cs#11)]
[!code-vb[Conceptual.Globalization#11](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.globalization/vb/dates8.vb#11)]

<span data-ttu-id="5403b-268">Если данные сериализуются в системе в часовом поясе тихоокеанского стандартного времени и десериализуются в системе в часовом поясе римского стандартного времени, пример отображает следующий результат:</span><span class="sxs-lookup"><span data-stu-id="5403b-268">When the data is serialized on a system in the Pacific Standard Time zone and deserialized on a system in the Romance Standard Time zone, the example displays the following output:</span></span>

```console
'2013-03-30T18:00:00.0000000-07:00' --> 3/31/2013 3:00:00 AM Local
'Sun, 31 Mar 2013 01:00:00 GMT' --> 3/31/2013 3:00:00 AM Local
'2013-03-31 01:00:00Z' --> 3/31/2013 3:00:00 AM Local

3/31/2013 3:00:00 AM Local
```

<span data-ttu-id="5403b-269">Дополнительные сведения см. в статье [Преобразование времени из одного часового пояса в другой](../../../docs/standard/datetime/converting-between-time-zones.md).</span><span class="sxs-lookup"><span data-stu-id="5403b-269">For more information, see [Converting Times Between Time Zones](../../../docs/standard/datetime/converting-between-time-zones.md).</span></span>

### <a name="perform-date-and-time-arithmetic"></a><span data-ttu-id="5403b-270">Выполнение арифметических операций с датами и временем</span><span class="sxs-lookup"><span data-stu-id="5403b-270">Perform date and time arithmetic</span></span>

<span data-ttu-id="5403b-271">Типы <xref:System.DateTime> и <xref:System.DateTimeOffset> поддерживают арифметические операции.</span><span class="sxs-lookup"><span data-stu-id="5403b-271">Both the <xref:System.DateTime> and <xref:System.DateTimeOffset> types support arithmetic operations.</span></span> <span data-ttu-id="5403b-272">Можно вычислить разницу между двумя значениями дат или добавить или вычесть конкретные временные интервалы в или из значения даты.</span><span class="sxs-lookup"><span data-stu-id="5403b-272">You can calculate the difference between two date values, or you can add or subtract particular time intervals to or from a date value.</span></span> <span data-ttu-id="5403b-273">Однако арифметические операции над значениями даты и времени не принимают в расчет часовые пояса и правила коррекции часового пояса.</span><span class="sxs-lookup"><span data-stu-id="5403b-273">However, arithmetic operations on date and time values do not take time zones and time zone adjustment rules into account.</span></span> <span data-ttu-id="5403b-274">Вследствие этого арифметические операции даты и времени на значениях, представляющих моменты времени, могут возвращать неточные результаты.</span><span class="sxs-lookup"><span data-stu-id="5403b-274">Because of this, date and time arithmetic on values that represent moments in time can return inaccurate results.</span></span>

<span data-ttu-id="5403b-275">Например, переход со стандартного тихоокеанского времени на тихоокеанское летнее время происходит во второе воскресенье марта, то есть 10 марта 2013 г.</span><span class="sxs-lookup"><span data-stu-id="5403b-275">For example, the transition from Pacific Standard Time to Pacific Daylight Time occurs on the second Sunday of March, which is March 10 for the year 2013.</span></span> <span data-ttu-id="5403b-276">В следующем примере показан расчет даты и времени на момент через 48 часов после 10:30 9 марта 2013 г.</span><span class="sxs-lookup"><span data-stu-id="5403b-276">As the following example shows, if you calculate the date and time that is 48 hours after March 9, 2013 at 10:30 A.M.</span></span> <span data-ttu-id="5403b-277">в системе, использующей стандартный тихоокеанский часовой пояс. Мы получаем результат 11 марта 2013 г. 10:30 без учета корректировки времени, которая происходит в этот период.</span><span class="sxs-lookup"><span data-stu-id="5403b-277">on a system in the Pacific Standard Time zone, the result, March 11, 2013 at 10:30 A.M., does not take the intervening time adjustment into account.</span></span>

[!code-csharp[Conceptual.Globalization#8](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.globalization/cs/dates5.cs#8)]
[!code-vb[Conceptual.Globalization#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.globalization/vb/dates5.vb#8)]

<span data-ttu-id="5403b-278">Чтобы гарантировать, что арифметическая операция со значениями даты и времени даст точные результаты, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="5403b-278">To ensure that an arithmetic operation on date and time values produces accurate results, follow these steps:</span></span>

1. <span data-ttu-id="5403b-279">Преобразуйте время в исходном часовом поясе в формат UTC.</span><span class="sxs-lookup"><span data-stu-id="5403b-279">Convert the time in the source time zone to UTC.</span></span>

2. <span data-ttu-id="5403b-280">Выполните арифметическую операцию.</span><span class="sxs-lookup"><span data-stu-id="5403b-280">Perform the arithmetic operation.</span></span>

3. <span data-ttu-id="5403b-281">Если результатом является значение даты и времени, преобразуйте его из времени в формате UTC во время в исходном часовом поясе.</span><span class="sxs-lookup"><span data-stu-id="5403b-281">If the result is a date and time value, convert it from UTC to the time in the source time zone.</span></span>

<span data-ttu-id="5403b-282">Следующий пример аналогичен предыдущему за исключением того, что эти три шага выполняются для правильного добавления 48 часов к 9 марта 2013 г. в 10:30.</span><span class="sxs-lookup"><span data-stu-id="5403b-282">The following example is similar to the previous example, except that it follows these three steps to correctly add 48 hours to March 9, 2013 at 10:30 A.M.</span></span>

[!code-csharp[Conceptual.Globalization#9](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.globalization/cs/dates6.cs#9)]
[!code-vb[Conceptual.Globalization#9](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.globalization/vb/dates6.vb#9)]

<span data-ttu-id="5403b-283">Подробнее см. в статье [Выполнение арифметических операций с датами и временем](../../../docs/standard/datetime/performing-arithmetic-operations.md).</span><span class="sxs-lookup"><span data-stu-id="5403b-283">For more information, see [Performing Arithmetic Operations with Dates and Times](../../../docs/standard/datetime/performing-arithmetic-operations.md).</span></span>

### <a name="use-culture-sensitive-names-for-date-elements"></a><span data-ttu-id="5403b-284">Использование имен с учетом языка и региональных параметров для элементов дат</span><span class="sxs-lookup"><span data-stu-id="5403b-284">Use culture-sensitive names for date elements</span></span>

<span data-ttu-id="5403b-285">Возможно, приложению нужно отобразить название месяца или дня недели.</span><span class="sxs-lookup"><span data-stu-id="5403b-285">Your app may need to display the name of the month or the day of the week.</span></span> <span data-ttu-id="5403b-286">Для этого обычно используют код, аналогичный следующему.</span><span class="sxs-lookup"><span data-stu-id="5403b-286">To do this, code such as the following is common.</span></span>

[!code-csharp[Conceptual.Globalization#19](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.globalization/cs/monthname1.cs#19)]
[!code-vb[Conceptual.Globalization#19](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.globalization/vb/monthname1.vb#19)]

<span data-ttu-id="5403b-287">Однако этот код всегда возвращает имена дней недели на английском языке.</span><span class="sxs-lookup"><span data-stu-id="5403b-287">However, this code always returns the names of the days of the week in English.</span></span> <span data-ttu-id="5403b-288">Код, который извлекает имя месяца, часто бывает еще более жестким.</span><span class="sxs-lookup"><span data-stu-id="5403b-288">Code that extracts the name of the month is often even more inflexible.</span></span> <span data-ttu-id="5403b-289">Он часто предполагает использование календаря с 12 месяцами с именами месяцев на конкретном языке.</span><span class="sxs-lookup"><span data-stu-id="5403b-289">It frequently assumes a twelve-month calendar with names of months in a specific language.</span></span>

<span data-ttu-id="5403b-290">С помощью [строк даты и времени пользовательского формата](../../../docs/standard/base-types/custom-date-and-time-format-strings.md) или свойств объекта <xref:System.Globalization.DateTimeFormatInfo> можно легко извлечь строки с названиями дней недели или месяцев с учетом языка и региональных параметров пользователя, как показано в примере ниже.</span><span class="sxs-lookup"><span data-stu-id="5403b-290">By using [custom date and time format strings](../../../docs/standard/base-types/custom-date-and-time-format-strings.md) or the properties of the <xref:System.Globalization.DateTimeFormatInfo> object, it is easy to extract strings that reflect the names of days of the week or months in the user's culture, as the following example illustrates.</span></span> <span data-ttu-id="5403b-291">Он изменяет текущий язык на французский (Франция) и отображает название дня недели и название месяца для 1-го июля 2013 г.</span><span class="sxs-lookup"><span data-stu-id="5403b-291">It changes the current culture to French (France) and displays the name of the day of the week and the name of the month for July 1, 2013.</span></span>

[!code-csharp[Conceptual.Globalization#20](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.globalization/cs/monthname2.cs#20)]
[!code-vb[Conceptual.Globalization#20](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.globalization/vb/monthname2.vb#20)]

## <a name="numeric-values"></a><span data-ttu-id="5403b-292">Числовые значения</span><span class="sxs-lookup"><span data-stu-id="5403b-292">Numeric values</span></span>

<span data-ttu-id="5403b-293">Способ обработки чисел зависит от того, отображаются ли они в интерфейсе пользователя или сохраняются.</span><span class="sxs-lookup"><span data-stu-id="5403b-293">The handling of numbers depends on whether they are displayed in the user interface or persisted.</span></span> <span data-ttu-id="5403b-294">В данном разделе рассматриваются оба варианта использования.</span><span class="sxs-lookup"><span data-stu-id="5403b-294">This section examines both usages.</span></span>

> [!NOTE]
> <span data-ttu-id="5403b-295">В операциях форматирования и синтаксического анализа платформа .NET распознает как числовые символы только основные латинские символы от 0 до 9 (от U+0030 до U+0039).</span><span class="sxs-lookup"><span data-stu-id="5403b-295">In parsing and formatting operations, .NET recognizes only the Basic Latin characters 0 through 9 (U+0030 through U+0039) as numeric digits.</span></span>

### <a name="display-numeric-values"></a><span data-ttu-id="5403b-296">Отображение числовых значений</span><span class="sxs-lookup"><span data-stu-id="5403b-296">Display numeric values</span></span>

<span data-ttu-id="5403b-297">Как правило, когда числа отображаются в пользовательском интерфейсе, необходимо использовать соглашения о форматировании, принятые в языке и региональных параметрах пользователя, которые определяются свойством <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType> и объектом <xref:System.Globalization.NumberFormatInfo>, возвращаемым свойством `CultureInfo.CurrentCulture.NumberFormat`.</span><span class="sxs-lookup"><span data-stu-id="5403b-297">Typically, when numbers are displayed in the user interface, you should use the formatting conventions of the user's culture, which is defined by the <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType> property and by the <xref:System.Globalization.NumberFormatInfo> object returned by the `CultureInfo.CurrentCulture.NumberFormat` property.</span></span> <span data-ttu-id="5403b-298">Соглашения о форматировании текущего языка и региональных параметров автоматически используются при форматировании даты с помощью любого из следующих методов.</span><span class="sxs-lookup"><span data-stu-id="5403b-298">The formatting conventions of the current culture are automatically used when you format a date by using any of the following methods:</span></span>

- <span data-ttu-id="5403b-299">Метод `ToString` любого числового типа без параметров</span><span class="sxs-lookup"><span data-stu-id="5403b-299">The parameterless `ToString` method of any numeric type</span></span>

- <span data-ttu-id="5403b-300">Метод `ToString(String)` любого числового типа, включающий строку формата в качестве аргумента</span><span class="sxs-lookup"><span data-stu-id="5403b-300">The `ToString(String)` method of any numeric type, which includes a format string as an argument</span></span>

- <span data-ttu-id="5403b-301">Функция [составного форматирования](../../../docs/standard/base-types/composite-formatting.md), когда она используется с числовыми значениями.</span><span class="sxs-lookup"><span data-stu-id="5403b-301">The [composite formatting](../../../docs/standard/base-types/composite-formatting.md) feature, when it is used with numeric values</span></span>

<span data-ttu-id="5403b-302">В следующем примере выводится средняя температура для каждого месяца в Париж, Франция.</span><span class="sxs-lookup"><span data-stu-id="5403b-302">The following example displays the average temperature per month in Paris, France.</span></span> <span data-ttu-id="5403b-303">Перед отображением данных он устанавливает текущий язык и региональные параметры как французский (Франция), а затем задает английский язык (США).</span><span class="sxs-lookup"><span data-stu-id="5403b-303">It first sets the current culture to French (France) before displaying the data, and then sets it to English (United States).</span></span> <span data-ttu-id="5403b-304">В каждом случае имена месяцев и температуры отображаются в формате, который подходит для данного языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="5403b-304">In each case, the month names and temperatures are displayed in the format that is appropriate for that culture.</span></span> <span data-ttu-id="5403b-305">Обратите внимание, что в двух языках и региональных параметрах используются разные десятичные разделители в значении температуры.</span><span class="sxs-lookup"><span data-stu-id="5403b-305">Note that the two cultures use different decimal separators in the temperature value.</span></span> <span data-ttu-id="5403b-306">Также обратите внимание, что в примере используется строка пользовательского формата даты и времени "MMMM" для отображения полного названия месяца и что он выделяет необходимый объем пространства для названия месяца в результирующей строке, указав длину самого длинного названия месяца в массиве <xref:System.Globalization.DateTimeFormatInfo.MonthNames%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="5403b-306">Also note that the example uses the "MMMM" custom date and time format string to display the full month name, and that it allocates the appropriate amount of space for the month name in the result string by determining the length of the longest month name in the <xref:System.Globalization.DateTimeFormatInfo.MonthNames%2A?displayProperty=nameWithType> array.</span></span>

[!code-csharp[Conceptual.Globalization#5](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.globalization/cs/numbers1.cs#5)]
[!code-vb[Conceptual.Globalization#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.globalization/vb/numbers1.vb#5)]

### <a name="persist-numeric-values"></a><span data-ttu-id="5403b-307">Сохранение числовых значений</span><span class="sxs-lookup"><span data-stu-id="5403b-307">Persist numeric values</span></span>

<span data-ttu-id="5403b-308">Никогда не следует сохранять числовые данные в формате языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="5403b-308">You should never persist numeric data in a culture-specific format.</span></span> <span data-ttu-id="5403b-309">Это распространенная ошибка программирования, которая приводит к повреждению данных или исключению времени выполнения.</span><span class="sxs-lookup"><span data-stu-id="5403b-309">This is a common programming error that results in either corrupted data or a run-time exception.</span></span> <span data-ttu-id="5403b-310">Следующий пример создает десять случайных чисел с плавающей запятой, а затем сериализует их в виде строк с использованием соглашений о форматировании для языка и региональных параметров "Английский (США)".</span><span class="sxs-lookup"><span data-stu-id="5403b-310">The following example generates ten random floating-point numbers, and then serializes them as strings by using the formatting conventions of the English (United States) culture.</span></span> <span data-ttu-id="5403b-311">Когда данные получены и проанализированы с помощью соглашений английского языка (американский вариант), они успешно восстанавливаются.</span><span class="sxs-lookup"><span data-stu-id="5403b-311">When the data is retrieved and parsed by using the conventions of the English (United States) culture, it is successfully restored.</span></span> <span data-ttu-id="5403b-312">Однако если они извлекаются и анализируются с помощью соглашений культуры французского языка (Франция), ни одно из чисел не может быть проанализировано, поскольку языки используют различные десятичные разделители.</span><span class="sxs-lookup"><span data-stu-id="5403b-312">However, when it is retrieved and parsed by using the conventions of the French (France) culture, none of the numbers can be parsed because the cultures use different decimal separators.</span></span>

[!code-csharp[Conceptual.Globalization#6](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.globalization/cs/numbers2.cs#6)]
[!code-vb[Conceptual.Globalization#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.globalization/vb/numbers2.vb#6)]

<span data-ttu-id="5403b-313">Чтобы избежать этой проблемы, можно использовать один из следующих приемов:</span><span class="sxs-lookup"><span data-stu-id="5403b-313">To avoid this problem, you can use one of these techniques:</span></span>

- <span data-ttu-id="5403b-314">Сохраните и проанализируйте строковое представление числа, используя строку пользовательского формата, одинаковую вне зависимости от языка и региональных параметров пользователя.</span><span class="sxs-lookup"><span data-stu-id="5403b-314">Save and parse the string representation of the number by using a custom format string that is the same regardless of the user's culture.</span></span>

- <span data-ttu-id="5403b-315">Сохраните число в виде строки с использованием соглашений о форматировании, принятых в инвариантном языке и региональных параметрах, которые возвращаются свойством <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="5403b-315">Save the number as a string by using the formatting conventions of the invariant culture, which is returned by the <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType> property.</span></span>

- <span data-ttu-id="5403b-316">Сериализуйте число в двоичный, а не в строковый формат.</span><span class="sxs-lookup"><span data-stu-id="5403b-316">Serialize the number in binary instead of string format.</span></span>

<span data-ttu-id="5403b-317">Последний подход показан в приведенном ниже примере.</span><span class="sxs-lookup"><span data-stu-id="5403b-317">The following example illustrates the last approach.</span></span> <span data-ttu-id="5403b-318">Он выполняет сериализацию массива значений <xref:System.Double>, а затем десериализует и отображает их с помощью соглашений о форматировании для английского (США) и французского (Франция) языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="5403b-318">It serializes the array of <xref:System.Double> values, and then deserializes and displays them by using the formatting conventions of the English (United States) and French (France) cultures.</span></span>

[!code-csharp[Conceptual.Globalization#7](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.globalization/cs/numbers3.cs#7)]
[!code-vb[Conceptual.Globalization#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.globalization/vb/numbers3.vb#7)]

<span data-ttu-id="5403b-319">Сериализация значений валюты — особый случай.</span><span class="sxs-lookup"><span data-stu-id="5403b-319">Serializing currency values is a special case.</span></span> <span data-ttu-id="5403b-320">Поскольку значение валюты зависит от единицы валюты, в которой оно выражено, нет смысла интерпретировать его как независимое числовое значение.</span><span class="sxs-lookup"><span data-stu-id="5403b-320">Because a currency value depends on the unit of currency in which it is expressed; it makes little sense to treat it as an independent numeric value.</span></span> <span data-ttu-id="5403b-321">Однако если сохранить значение валюты в качестве отформатированной строки, которая содержит символ валюты, его невозможно десериализовать в системе, язык по умолчанию которой использует другой символ валюты, как показано в следующем примере.</span><span class="sxs-lookup"><span data-stu-id="5403b-321">However, if you save a currency value as a formatted string that includes a currency symbol, it cannot be deserialized on a system whose default culture uses a different currency symbol, as the following example shows.</span></span>

[!code-csharp[Conceptual.Globalization#16](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.globalization/cs/currency1.cs#16)]
[!code-vb[Conceptual.Globalization#16](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.globalization/vb/currency1.vb#16)]

<span data-ttu-id="5403b-322">Вместо этого необходимо сериализовать числовое значение вместе с некоторыми языковыми сведениями, например имя языка, чтобы значение и его символ валюты можно десериализовать независимо от текущего языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="5403b-322">Instead, you should serialize the numeric value along with some cultural information, such as the name of the culture, so that the value and its currency symbol can be deserialized independently of the current culture.</span></span> <span data-ttu-id="5403b-323">В следующем примере это делается путем определения структуры `CurrencyValue` с двумя членами: значением <xref:System.Decimal> и именем языка, которому принадлежит значение.</span><span class="sxs-lookup"><span data-stu-id="5403b-323">The following example does that by defining a `CurrencyValue` structure with two members: the <xref:System.Decimal> value and the name of the culture to which the value belongs.</span></span>

[!code-csharp[Conceptual.Globalization#17](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.globalization/cs/currency2.cs#17)]
[!code-vb[Conceptual.Globalization#17](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.globalization/vb/currency2.vb#17)]

## <a name="work-with-culture-specific-settings"></a><span data-ttu-id="5403b-324">Работа с параметрами, специфичными для языков и региональных параметров</span><span class="sxs-lookup"><span data-stu-id="5403b-324">Work with culture-specific settings</span></span>

<span data-ttu-id="5403b-325">В .NET конкретный язык и региональные параметры представлены классом <xref:System.Globalization.CultureInfo>.</span><span class="sxs-lookup"><span data-stu-id="5403b-325">In .NET, the <xref:System.Globalization.CultureInfo> class represents a particular culture or region.</span></span> <span data-ttu-id="5403b-326">Некоторые из его свойств возвращают объекты, которые содержат определенные сведения о каком-либо аспекте языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="5403b-326">Some of its properties return objects that provide specific information about some aspect of a culture:</span></span>

- <span data-ttu-id="5403b-327">Свойство <xref:System.Globalization.CultureInfo.CompareInfo%2A?displayProperty=nameWithType> возвращает объект <xref:System.Globalization.CompareInfo>, содержащий сведения о том, как в языке и региональных параметрах происходит сравнение и упорядочение строк.</span><span class="sxs-lookup"><span data-stu-id="5403b-327">The <xref:System.Globalization.CultureInfo.CompareInfo%2A?displayProperty=nameWithType> property returns a <xref:System.Globalization.CompareInfo> object that contains information about how the culture compares and orders strings.</span></span>

- <span data-ttu-id="5403b-328">Свойство <xref:System.Globalization.CultureInfo.DateTimeFormat%2A?displayProperty=nameWithType> возвращает объект <xref:System.Globalization.DateTimeFormatInfo>, который предоставляет относящиеся к конкретному языку и региональным параметрам сведения, используемые при форматировании данных дат и времени.</span><span class="sxs-lookup"><span data-stu-id="5403b-328">The <xref:System.Globalization.CultureInfo.DateTimeFormat%2A?displayProperty=nameWithType> property returns a <xref:System.Globalization.DateTimeFormatInfo> object that provides culture-specific information used in formatting date and time data.</span></span>

- <span data-ttu-id="5403b-329">Свойство <xref:System.Globalization.CultureInfo.NumberFormat%2A?displayProperty=nameWithType> возвращает объект <xref:System.Globalization.NumberFormatInfo>, который предоставляет относящиеся к конкретному языку и региональным параметрам сведения, используемые при форматировании числовых данных.</span><span class="sxs-lookup"><span data-stu-id="5403b-329">The <xref:System.Globalization.CultureInfo.NumberFormat%2A?displayProperty=nameWithType> property returns a <xref:System.Globalization.NumberFormatInfo> object that provides culture-specific information used in formatting numeric data.</span></span>

- <span data-ttu-id="5403b-330">Свойство <xref:System.Globalization.CultureInfo.TextInfo%2A?displayProperty=nameWithType> возвращает объект <xref:System.Globalization.TextInfo>, который предоставляет сведения о системе письма, соответствующей языку и региональным параметрам.</span><span class="sxs-lookup"><span data-stu-id="5403b-330">The <xref:System.Globalization.CultureInfo.TextInfo%2A?displayProperty=nameWithType> property returns a <xref:System.Globalization.TextInfo> object that provides information about the culture's writing system.</span></span>

<span data-ttu-id="5403b-331">Как правило, не следует делать предположений о конкретных значениях свойств <xref:System.Globalization.CultureInfo> и их связанных объектов.</span><span class="sxs-lookup"><span data-stu-id="5403b-331">In general, do not make any assumptions about the values of specific <xref:System.Globalization.CultureInfo> properties and their related objects.</span></span> <span data-ttu-id="5403b-332">Вместо этого данные для конкретных языков и региональных параметров необходимо считать изменяемыми по следующим причинам:</span><span class="sxs-lookup"><span data-stu-id="5403b-332">Instead, you should view culture-specific data as subject to change, for these reasons:</span></span>

- <span data-ttu-id="5403b-333">Значения отдельных свойств могут изменяться и редактироваться со временем по мере исправления данных, получения лучших данных или изменения соглашений для конкретных языков и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="5403b-333">Individual property values are subject to change and revision over time, as data is corrected, better data becomes available, or culture-specific conventions change.</span></span>

- <span data-ttu-id="5403b-334">Значения отдельных свойств могут различаться в разных версиях платформы .NET или операционной системы.</span><span class="sxs-lookup"><span data-stu-id="5403b-334">Individual property values may vary across versions of .NET or operating system versions.</span></span>

- <span data-ttu-id="5403b-335">.NET поддерживает замещающие языки и региональные параметры.</span><span class="sxs-lookup"><span data-stu-id="5403b-335">.NET supports replacement cultures.</span></span> <span data-ttu-id="5403b-336">Это позволяет определить новые пользовательские язык и региональные параметры, которые либо дополняют существующие стандартные языки и региональные параметры, либо полностью заменяют существующие стандартные язык и региональные параметры.</span><span class="sxs-lookup"><span data-stu-id="5403b-336">This makes it possible to define a new custom culture that either supplements existing standard cultures or completely replaces an existing standard culture.</span></span>

- <span data-ttu-id="5403b-337">В системе Windows пользователь может настроить язык и региональные параметры с помощью приложения **Язык и региональные стандарты** на панели управления.</span><span class="sxs-lookup"><span data-stu-id="5403b-337">On Windows systems, the user can customize culture-specific settings by using the **Region and Language** app in Control Panel.</span></span> <span data-ttu-id="5403b-338">При создании экземпляра объекта <xref:System.Globalization.CultureInfo> можно указать, отражает ли он эти настройки пользователя, вызвав конструктор <xref:System.Globalization.CultureInfo.%23ctor%28System.String%2CSystem.Boolean%29?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="5403b-338">When you instantiate a <xref:System.Globalization.CultureInfo> object, you can determine whether it reflects these user customizations by calling the <xref:System.Globalization.CultureInfo.%23ctor%28System.String%2CSystem.Boolean%29?displayProperty=nameWithType> constructor.</span></span> <span data-ttu-id="5403b-339">Обычно для приложений, предназначенных для конечных пользователей, необходимо учитывать предпочтения пользователя и предоставлять пользователю данные в том формате, в котором он ожидает их увидеть.</span><span class="sxs-lookup"><span data-stu-id="5403b-339">Typically, for end-user apps, you should respect user preferences so that the user is presented with data in a format that they expect.</span></span>

## <a name="see-also"></a><span data-ttu-id="5403b-340">См. также</span><span class="sxs-lookup"><span data-stu-id="5403b-340">See also</span></span>

- [<span data-ttu-id="5403b-341">Глобализация и локализация</span><span class="sxs-lookup"><span data-stu-id="5403b-341">Globalization and Localization</span></span>](../../../docs/standard/globalization-localization/index.md)
- [<span data-ttu-id="5403b-342">Рекомендации по использованию строк</span><span class="sxs-lookup"><span data-stu-id="5403b-342">Best Practices for Using Strings</span></span>](../../../docs/standard/base-types/best-practices-strings.md)
