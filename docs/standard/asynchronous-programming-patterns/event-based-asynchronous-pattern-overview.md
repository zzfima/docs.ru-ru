---
title: Обзор асинхронной модели, основанной на событиях
ms.date: 03/30/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- Event-based Asynchronous Pattern
- ProgressChangedEventArgs class
- BackgroundWorker component
- events [.NET Framework], asynchronous
- Asynchronous Pattern
- AsyncOperationManager class
- threading [.NET Framework], asynchronous features
- AsyncOperation class
- AsyncCompletedEventArgs class
ms.assetid: 792aa8da-918b-458e-b154-9836b97735f3
ms.openlocfilehash: cce01a7c87f6f20b5e6c46881b8c863bb5a72a88
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/15/2020
ms.locfileid: "78160072"
---
# <a name="event-based-asynchronous-pattern-overview"></a><span data-ttu-id="47fdf-102">Обзор асинхронной модели, основанной на событиях</span><span class="sxs-lookup"><span data-stu-id="47fdf-102">Event-based Asynchronous Pattern Overview</span></span>
<span data-ttu-id="47fdf-103">Приложениям, выполняющим множество задач одновременно и при этом активно реагирующим на действия пользователя, часто требуется структура, использующая несколько потоков.</span><span class="sxs-lookup"><span data-stu-id="47fdf-103">Applications that perform many tasks simultaneously, yet remain responsive to user interaction, often require a design that uses multiple threads.</span></span> <span data-ttu-id="47fdf-104">Пространство имен <xref:System.Threading> предоставляет все необходимые средства для создания высокопроизводительных многопоточных приложений, однако для эффективного использования этих средств требуется значительный опыт в области многопоточной программной инженерии.</span><span class="sxs-lookup"><span data-stu-id="47fdf-104">The <xref:System.Threading> namespace provides all the tools necessary to create high-performance multithreaded applications, but using these tools effectively requires significant experience with multithreaded software engineering.</span></span> <span data-ttu-id="47fdf-105">Для относительно простых многопоточных приложений компонент <xref:System.ComponentModel.BackgroundWorker> предоставляет прямолинейное решение.</span><span class="sxs-lookup"><span data-stu-id="47fdf-105">For relatively simple multithreaded applications, the <xref:System.ComponentModel.BackgroundWorker> component provides a straightforward solution.</span></span> <span data-ttu-id="47fdf-106">Для более сложных асинхронных приложений рекомендуется реализовать класс, который соответствует асинхронной модели на основе событий.</span><span class="sxs-lookup"><span data-stu-id="47fdf-106">For more sophisticated asynchronous applications, consider implementing a class that adheres to the Event-based Asynchronous Pattern.</span></span>  
  
 <span data-ttu-id="47fdf-107">Асинхронная модель на основе событий позволяет использовать преимущества многопоточных приложений и устраняет многие сложности, присущие многопоточности.</span><span class="sxs-lookup"><span data-stu-id="47fdf-107">The Event-based Asynchronous Pattern makes available the advantages of multithreaded applications while hiding many of the complex issues inherent in multithreaded design.</span></span> <span data-ttu-id="47fdf-108">Используя класс, поддерживающий такую модель, вы можете:</span><span class="sxs-lookup"><span data-stu-id="47fdf-108">Using a class that supports this pattern can allow you to:</span></span>  
  
- <span data-ttu-id="47fdf-109">выполнять задачи, занимающие много времени, такие как загрузки и операции с базами данных, "в фоновом режиме" без прерывания работы приложения;</span><span class="sxs-lookup"><span data-stu-id="47fdf-109">Perform time-consuming tasks, such as downloads and database operations, "in the background," without interrupting your application.</span></span>  
  
- <span data-ttu-id="47fdf-110">выполнять несколько операций одновременно, получая уведомления о завершении каждой из них;</span><span class="sxs-lookup"><span data-stu-id="47fdf-110">Execute multiple operations simultaneously, receiving notifications when each completes.</span></span>  
  
- <span data-ttu-id="47fdf-111">ожидать освобождения ресурсов без остановки ("блокирования") приложения;</span><span class="sxs-lookup"><span data-stu-id="47fdf-111">Wait for resources to become available without stopping ("blocking") your application.</span></span>  
  
- <span data-ttu-id="47fdf-112">взаимодействовать с ожидающими асинхронными операциями с использованием привычной модели событий и делегатов.</span><span class="sxs-lookup"><span data-stu-id="47fdf-112">Communicate with pending asynchronous operations using the familiar events-and-delegates model.</span></span> <span data-ttu-id="47fdf-113">Дополнительные сведения об использовании обработчиков событий и делегатов см. в статье [События](../../../docs/standard/events/index.md).</span><span class="sxs-lookup"><span data-stu-id="47fdf-113">For more information on using event handlers and delegates, see [Events](../../../docs/standard/events/index.md).</span></span>  
  
 <span data-ttu-id="47fdf-114">Класс, который поддерживает асинхронную модель на основе событий, будет иметь один или несколько методов с именем _MethodName_**Async**.</span><span class="sxs-lookup"><span data-stu-id="47fdf-114">A class that supports the Event-based Asynchronous Pattern will have one or more methods named _MethodName_**Async**.</span></span> <span data-ttu-id="47fdf-115">Эти методы могут копировать синхронные версии, выполняющие ту же операцию в текущем потоке.</span><span class="sxs-lookup"><span data-stu-id="47fdf-115">These methods may mirror synchronous versions, which perform the same operation on the current thread.</span></span> <span data-ttu-id="47fdf-116">Этот класс может содержать событие _MethodName_**Completed**, а также метод _MethodName_**AsyncCancel** (или просто **CancelAsync**).</span><span class="sxs-lookup"><span data-stu-id="47fdf-116">The class may also have a _MethodName_**Completed** event and it may have a _MethodName_**AsyncCancel** (or simply **CancelAsync**) method.</span></span>  
  
 <span data-ttu-id="47fdf-117"><xref:System.Windows.Forms.PictureBox> — это типичный компонент, поддерживающий асинхронную модель на основе событий.</span><span class="sxs-lookup"><span data-stu-id="47fdf-117"><xref:System.Windows.Forms.PictureBox> is a typical component that supports the Event-based Asynchronous Pattern.</span></span> <span data-ttu-id="47fdf-118">Вы можете загрузить изображение синхронно, вызвав его метод <xref:System.Windows.Forms.PictureBox.Load%2A>, но если изображение имеет большой размер или используется медленное подключение к сети, ваше приложение перестанет отвечать до завершения операции загрузки и возврата вызова <xref:System.Windows.Forms.PictureBox.Load%2A>.</span><span class="sxs-lookup"><span data-stu-id="47fdf-118">You can download an image synchronously by calling its <xref:System.Windows.Forms.PictureBox.Load%2A> method, but if the image is large, or if the network connection is slow, your application will stop responding until the download operation is completed and the call to <xref:System.Windows.Forms.PictureBox.Load%2A> returns.</span></span>  
  
 <span data-ttu-id="47fdf-119">Если вы хотите, чтобы приложение продолжало работать во время загрузки изображения, моно вызвать метод <xref:System.Windows.Forms.PictureBox.LoadAsync%2A> и обработать событие <xref:System.Windows.Forms.PictureBox.LoadCompleted> так, как и любое другое.</span><span class="sxs-lookup"><span data-stu-id="47fdf-119">If you want your application to keep running while the image is loading, you can call the <xref:System.Windows.Forms.PictureBox.LoadAsync%2A> method and handle the <xref:System.Windows.Forms.PictureBox.LoadCompleted> event, just as you would handle any other event.</span></span> <span data-ttu-id="47fdf-120">При вызове метода <xref:System.Windows.Forms.PictureBox.LoadAsync%2A> ваше приложение продолжит выполняться, пока загрузка идет в отдельном потоке ("в фоновом режиме").</span><span class="sxs-lookup"><span data-stu-id="47fdf-120">When you call the <xref:System.Windows.Forms.PictureBox.LoadAsync%2A> method, your application will continue to run while the download proceeds on a separate thread ("in the background").</span></span> <span data-ttu-id="47fdf-121">После завершения операции загрузки изображения вызывается ваш обработчик событий, который может изучить параметр <xref:System.ComponentModel.AsyncCompletedEventArgs>, чтобы определить, была ли загрузка успешной.</span><span class="sxs-lookup"><span data-stu-id="47fdf-121">Your event handler will be called when the image-loading operation is complete, and your event handler can examine the <xref:System.ComponentModel.AsyncCompletedEventArgs> parameter to determine if the download completed successfully.</span></span>  
  
 <span data-ttu-id="47fdf-122">Асинхронная модель на основе событий требует наличия возможности отмены асинхронной операции, и элемент управления <xref:System.Windows.Forms.PictureBox> позволяет выполнить это требование с помощью метода <xref:System.Windows.Forms.PictureBox.CancelAsync%2A>.</span><span class="sxs-lookup"><span data-stu-id="47fdf-122">The Event-based Asynchronous Pattern requires that an asynchronous operation can be canceled, and the <xref:System.Windows.Forms.PictureBox> control supports this requirement with its <xref:System.Windows.Forms.PictureBox.CancelAsync%2A> method.</span></span> <span data-ttu-id="47fdf-123">При вызове <xref:System.Windows.Forms.PictureBox.CancelAsync%2A> отправляется запрос на остановку ожидающей загрузки, а после отмены задачи возникает событие <xref:System.Windows.Forms.PictureBox.LoadCompleted>.</span><span class="sxs-lookup"><span data-stu-id="47fdf-123">Calling <xref:System.Windows.Forms.PictureBox.CancelAsync%2A> submits a request to stop the pending download, and when the task is canceled, the <xref:System.Windows.Forms.PictureBox.LoadCompleted> event is raised.</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="47fdf-124">Загрузка может закончиться одновременно с получением запроса <xref:System.Windows.Forms.PictureBox.CancelAsync%2A>, поэтому <xref:System.ComponentModel.AsyncCompletedEventArgs.Cancelled%2A> может не отражать отмену запроса.</span><span class="sxs-lookup"><span data-stu-id="47fdf-124">It is possible that the download will finish just as the <xref:System.Windows.Forms.PictureBox.CancelAsync%2A> request is made, so <xref:System.ComponentModel.AsyncCompletedEventArgs.Cancelled%2A> may not reflect the request to cancel.</span></span> <span data-ttu-id="47fdf-125">Это называется *состоянием гонки* и является распространенной проблемой в многопоточном программировании.</span><span class="sxs-lookup"><span data-stu-id="47fdf-125">This is called a *race condition* and is a common issue in multithreaded programming.</span></span> <span data-ttu-id="47fdf-126">Дополнительные сведения о проблемах многопоточного программирования см. в разделе [Рекомендации по работе с потоками](../../../docs/standard/threading/managed-threading-best-practices.md).</span><span class="sxs-lookup"><span data-stu-id="47fdf-126">For more information on issues in multithreaded programming, see [Managed Threading Best Practices](../../../docs/standard/threading/managed-threading-best-practices.md).</span></span>  
  
## <a name="characteristics-of-the-event-based-asynchronous-pattern"></a><span data-ttu-id="47fdf-127">Характеристики асинхронной модели на основе событий</span><span class="sxs-lookup"><span data-stu-id="47fdf-127">Characteristics of the Event-based Asynchronous Pattern</span></span>  
 <span data-ttu-id="47fdf-128">Асинхронная модель на основе событий может принимать разную форму в зависимости от операций, поддерживаемых определенным классом.</span><span class="sxs-lookup"><span data-stu-id="47fdf-128">The Event-based Asynchronous Pattern may take several forms, depending on the complexity of the operations supported by a particular class.</span></span> <span data-ttu-id="47fdf-129">Простейшие классы могут иметь один метод _MethodName_**Async** и одно соответствующее ему событие _MethodName_**Completed**.</span><span class="sxs-lookup"><span data-stu-id="47fdf-129">The simplest classes may have a single _MethodName_**Async** method and a corresponding _MethodName_**Completed** event.</span></span> <span data-ttu-id="47fdf-130">Более сложные классы будут содержать несколько методов _MethodName_**Async** с соответствующими событиями _MethodName_**Completed**, а также синхронные версии этих методов.</span><span class="sxs-lookup"><span data-stu-id="47fdf-130">More complex classes may have several _MethodName_**Async** methods, each with a corresponding _MethodName_**Completed** event, as well as synchronous versions of these methods.</span></span> <span data-ttu-id="47fdf-131">Классы также могут поддерживать отмену, составление отчетов о ходе работы и добавочные результаты для каждого асинхронного метода.</span><span class="sxs-lookup"><span data-stu-id="47fdf-131">Classes can optionally support cancellation, progress reporting, and incremental results for each asynchronous method.</span></span>  
  
 <span data-ttu-id="47fdf-132">Асинхронный метод также поддерживает несколько ожидающих вызовов (несколько одновременно выполняемых вызовов), позволяя вашему коду вызывать его любое число раз, прежде чем он выполнит другие ожидающие операции.</span><span class="sxs-lookup"><span data-stu-id="47fdf-132">An asynchronous method may also support multiple pending calls (multiple concurrent invocations), allowing your code to call it any number of times before it completes other pending operations.</span></span> <span data-ttu-id="47fdf-133">Для корректного разрешения данной ситуации вашему приложению может потребоваться отслеживать выполнение каждой операции.</span><span class="sxs-lookup"><span data-stu-id="47fdf-133">Correctly handling this situation may require your application to track the completion of each operation.</span></span>  
  
### <a name="examples-of-the-event-based-asynchronous-pattern"></a><span data-ttu-id="47fdf-134">Примеры для асинхронной модели на основе событий</span><span class="sxs-lookup"><span data-stu-id="47fdf-134">Examples of the Event-based Asynchronous Pattern</span></span>  
 <span data-ttu-id="47fdf-135">Компоненты <xref:System.Media.SoundPlayer> и <xref:System.Windows.Forms.PictureBox> представляют простые реализации асинхронной модели на основе событий.</span><span class="sxs-lookup"><span data-stu-id="47fdf-135">The <xref:System.Media.SoundPlayer> and <xref:System.Windows.Forms.PictureBox> components represent simple implementations of the Event-based Asynchronous Pattern.</span></span> <span data-ttu-id="47fdf-136">Компоненты <xref:System.Net.WebClient> и <xref:System.ComponentModel.BackgroundWorker> представляют более сложные реализации асинхронной модели на основе событий.</span><span class="sxs-lookup"><span data-stu-id="47fdf-136">The <xref:System.Net.WebClient> and <xref:System.ComponentModel.BackgroundWorker> components represent more complex implementations of the Event-based Asynchronous Pattern.</span></span>  
  
 <span data-ttu-id="47fdf-137">Ниже приведен пример объявления класса в соответствии с данной моделью:</span><span class="sxs-lookup"><span data-stu-id="47fdf-137">Below is an example class declaration that conforms to the pattern:</span></span>  
  
```vb  
Public Class AsyncExample  
    ' Synchronous methods.  
    Public Function Method1(ByVal param As String) As Integer
    Public Sub Method2(ByVal param As Double)
  
    ' Asynchronous methods.  
    Overloads Public Sub Method1Async(ByVal param As String)
    Overloads Public Sub Method1Async(ByVal param As String, ByVal userState As Object)
    Public Event Method1Completed As Method1CompletedEventHandler  
  
    Overloads Public Sub Method2Async(ByVal param As Double)
    Overloads Public Sub Method2Async(ByVal param As Double, ByVal userState As Object)
    Public Event Method2Completed As Method2CompletedEventHandler  
  
    Public Sub CancelAsync(ByVal userState As Object)
  
    Public ReadOnly Property IsBusy () As Boolean  
  
    ' Class implementation not shown.  
End Class  
```  
  
```csharp  
public class AsyncExample  
{  
    // Synchronous methods.  
    public int Method1(string param);  
    public void Method2(double param);  
  
    // Asynchronous methods.  
    public void Method1Async(string param);  
    public void Method1Async(string param, object userState);  
    public event Method1CompletedEventHandler Method1Completed;  
  
    public void Method2Async(double param);  
    public void Method2Async(double param, object userState);  
    public event Method2CompletedEventHandler Method2Completed;  
  
    public void CancelAsync(object userState);  
  
    public bool IsBusy { get; }  
  
    // Class implementation not shown.  
}  
```  
  
 <span data-ttu-id="47fdf-138">Вымышленный класс `AsyncExample` имеет два метода, которые поддерживают как синхронные, так и асинхронные вызовы.</span><span class="sxs-lookup"><span data-stu-id="47fdf-138">The fictitious `AsyncExample` class has two methods, both of which support synchronous and asynchronous invocations.</span></span> <span data-ttu-id="47fdf-139">Синхронные перегрузки работают аналогично вызову любого метода и выполняют операцию в вызывающем потоке; если выполнение операции требует много времени, перед возвратом вызова может возникнуть значительная задержка.</span><span class="sxs-lookup"><span data-stu-id="47fdf-139">The synchronous overloads behave like any method call and execute the operation on the calling thread; if the operation is time-consuming, there may be a noticeable delay before the call returns.</span></span> <span data-ttu-id="47fdf-140">Асинхронные перегрузки запустят операцию в другом потоке и затем немедленно выполнят возврат, позволяя вызывающему потоку продолжить работу, пока операция выполняется "в фоновом режиме".</span><span class="sxs-lookup"><span data-stu-id="47fdf-140">The asynchronous overloads will start the operation on another thread and then return immediately, allowing the calling thread to continue while the operation executes "in the background."</span></span>  
  
### <a name="asynchronous-method-overloads"></a><span data-ttu-id="47fdf-141">Асинхронные перегрузки методов</span><span class="sxs-lookup"><span data-stu-id="47fdf-141">Asynchronous Method Overloads</span></span>  
 <span data-ttu-id="47fdf-142">Для асинхронных операций существует две перегрузки: с одним вызовом и с несколькими вызовами.</span><span class="sxs-lookup"><span data-stu-id="47fdf-142">There are potentially two overloads for the asynchronous operations: single-invocation and multiple-invocation.</span></span> <span data-ttu-id="47fdf-143">Различить две этих формы можно по их сигнатурам методов: форма с несколькими вызовами имеет дополнительный параметр с именем `userState`.</span><span class="sxs-lookup"><span data-stu-id="47fdf-143">You can distinguish these two forms by their method signatures: the multiple-invocation form has an extra parameter called `userState`.</span></span> <span data-ttu-id="47fdf-144">Эта форма позволяет коду вызвать `Method1Async(string param, object userState)` несколько раз, не ожидая завершения ожидающих асинхронных операций.</span><span class="sxs-lookup"><span data-stu-id="47fdf-144">This form makes it possible for your code to call `Method1Async(string param, object userState)` multiple times without waiting for any pending asynchronous operations to finish.</span></span> <span data-ttu-id="47fdf-145">С другой стороны, если попытаться вызвать `Method1Async(string param)` до завершения предыдущего вызова, метод выдает исключение <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="47fdf-145">If, on the other hand, you try to call `Method1Async(string param)` before a previous invocation has completed, the method raises an <xref:System.InvalidOperationException>.</span></span>  
  
 <span data-ttu-id="47fdf-146">Параметр `userState` для перегрузок с несколькими вызовами позволяет вам различать асинхронные операции.</span><span class="sxs-lookup"><span data-stu-id="47fdf-146">The `userState` parameter for the multiple-invocation overloads allows you to distinguish among asynchronous operations.</span></span> <span data-ttu-id="47fdf-147">Вы указываете уникальное значение (например, GUID или хэш-код) для каждого вызова `Method1Async(string param, object userState)`, что позволяет обработчику событий после завершения каждой из операций определить, какой экземпляр этой операции сообщил о своем завершении.</span><span class="sxs-lookup"><span data-stu-id="47fdf-147">You provide a unique value (for example, a GUID or hash code) for each call to `Method1Async(string param, object userState)`, and when each operation is completed, your event handler can determine which instance of the operation raised the completion event.</span></span>  
  
### <a name="tracking-pending-operations"></a><span data-ttu-id="47fdf-148">Отслеживание ожидающих операций</span><span class="sxs-lookup"><span data-stu-id="47fdf-148">Tracking Pending Operations</span></span>  
 <span data-ttu-id="47fdf-149">Если вы используете перегрузки с несколькими вызовами, вашему коду потребуется отслеживать объекты `userState` (идентификаторы) для ожидающих задач.</span><span class="sxs-lookup"><span data-stu-id="47fdf-149">If you use the multiple-invocation overloads, your code will need to keep track of the `userState` objects (task IDs) for pending tasks.</span></span> <span data-ttu-id="47fdf-150">Для каждого вызова `Method1Async(string param, object userState)` обычно создается новый уникальный объект `userState`, который добавляется в коллекцию.</span><span class="sxs-lookup"><span data-stu-id="47fdf-150">For each call to `Method1Async(string param, object userState)`, you will typically generate a new, unique `userState` object and add it to a collection.</span></span> <span data-ttu-id="47fdf-151">Когда задача, соответствующая этому объекту `userState`, выдает событие выполнения, реализация метода выполнения проверяет <xref:System.ComponentModel.AsyncCompletedEventArgs.UserState%2A?displayProperty=nameWithType> и удаляет его из вашей коллекции.</span><span class="sxs-lookup"><span data-stu-id="47fdf-151">When the task corresponding to this `userState` object raises the completion event, your completion method implementation will examine <xref:System.ComponentModel.AsyncCompletedEventArgs.UserState%2A?displayProperty=nameWithType> and remove it from your collection.</span></span> <span data-ttu-id="47fdf-152">При таком использовании параметр `userState` играет роль идентификатора задачи.</span><span class="sxs-lookup"><span data-stu-id="47fdf-152">Used this way, the `userState` parameter takes the role of a task ID.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="47fdf-153">Вам следует внимательно следить за тем, чтобы значение, заданное для `userState` в ваших вызовах перегрузок с несколькими вызовами, было уникальным.</span><span class="sxs-lookup"><span data-stu-id="47fdf-153">You must be careful to provide a unique value for `userState` in your calls to multiple-invocation overloads.</span></span> <span data-ttu-id="47fdf-154">В случае неуникальных идентификаторов задач асинхронный класс выдает исключение <xref:System.ArgumentException>.</span><span class="sxs-lookup"><span data-stu-id="47fdf-154">Non-unique task IDs will cause the asynchronous class throw an <xref:System.ArgumentException>.</span></span>  
  
### <a name="canceling-pending-operations"></a><span data-ttu-id="47fdf-155">Отмена ожидающих операций</span><span class="sxs-lookup"><span data-stu-id="47fdf-155">Canceling Pending Operations</span></span>  
 <span data-ttu-id="47fdf-156">Важно иметь возможность отменить асинхронные операции в любое время до их завершения.</span><span class="sxs-lookup"><span data-stu-id="47fdf-156">It is important to be able to cancel asynchronous operations at any time before their completion.</span></span> <span data-ttu-id="47fdf-157">Классы, реализующие асинхронную модель на основе событий, будут иметь метод `CancelAsync` (если асинхронный метод всего один) или методы _MethodName_**AsyncCancel** (если асинхронных методов несколько).</span><span class="sxs-lookup"><span data-stu-id="47fdf-157">Classes that implement the Event-based Asynchronous Pattern will have a `CancelAsync` method (if there is only one asynchronous method) or a _MethodName_**AsyncCancel** method (if there are multiple asynchronous methods).</span></span>  
  
 <span data-ttu-id="47fdf-158">Методы, допускающие несколько вызовов, принимают параметр `userState`, который можно использовать для отслеживания времени существования каждой задачи.</span><span class="sxs-lookup"><span data-stu-id="47fdf-158">Methods that allow multiple invocations take a `userState` parameter, which can be used to track the lifetime of each task.</span></span> <span data-ttu-id="47fdf-159">`CancelAsync` принимает параметр `userState`, позволяющий отменить определенные ожидающие задачи.</span><span class="sxs-lookup"><span data-stu-id="47fdf-159">`CancelAsync` takes a `userState` parameter, which allows you to cancel particular pending tasks.</span></span>  
  
 <span data-ttu-id="47fdf-160">Методы, которые одновременно поддерживают только одну ожидающую операцию, такие как `Method1Async(string param)`, не допускают отмену.</span><span class="sxs-lookup"><span data-stu-id="47fdf-160">Methods that support only a single pending operation at a time, like `Method1Async(string param)`, are not cancelable.</span></span>  
  
### <a name="receiving-progress-updates-and-incremental-results"></a><span data-ttu-id="47fdf-161">Получение обновлений хода выполнения и добавочных результатов</span><span class="sxs-lookup"><span data-stu-id="47fdf-161">Receiving Progress Updates and Incremental Results</span></span>  
 <span data-ttu-id="47fdf-162">Класс, поддерживающий асинхронную модель на основе событий, может дополнительно предоставлять событие для отслеживания хода выполнения и добавочных результатов.</span><span class="sxs-lookup"><span data-stu-id="47fdf-162">A class that adheres to the Event-based Asynchronous Pattern may optionally provide an event for tracking progress and incremental results.</span></span> <span data-ttu-id="47fdf-163">Обычно оно имеет имя `ProgressChanged` или _MethodName_**ProgressChanged**, а соответствующий обработчик событий принимает параметр <xref:System.ComponentModel.ProgressChangedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="47fdf-163">This will typically be named `ProgressChanged` or _MethodName_**ProgressChanged**, and its corresponding event handler will take a <xref:System.ComponentModel.ProgressChangedEventArgs> parameter.</span></span>  
  
 <span data-ttu-id="47fdf-164">Обработчик событий для события `ProgressChanged` может проверить свойство <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A?displayProperty=nameWithType>, чтобы определить, какой процент асинхронной задачи уже выполнен.</span><span class="sxs-lookup"><span data-stu-id="47fdf-164">The event handler for the `ProgressChanged` event can examine the <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A?displayProperty=nameWithType> property to determine what percentage of an asynchronous task has been completed.</span></span> <span data-ttu-id="47fdf-165">Это свойство находится в диапазоне от 0 до 100 и может использоваться для обновления свойства <xref:System.Windows.Forms.ProgressBar.Value%2A> элемента <xref:System.Windows.Forms.ProgressBar>.</span><span class="sxs-lookup"><span data-stu-id="47fdf-165">This property will range from 0 to 100, and it can be used to update the <xref:System.Windows.Forms.ProgressBar.Value%2A> property of a <xref:System.Windows.Forms.ProgressBar>.</span></span> <span data-ttu-id="47fdf-166">Если имеется несколько ожидающих асинхронных операций, вы можете использовать свойство <xref:System.ComponentModel.ProgressChangedEventArgs.UserState%2A?displayProperty=nameWithType>, чтобы определить, какая операция сообщает о ходе выполнения.</span><span class="sxs-lookup"><span data-stu-id="47fdf-166">If multiple asynchronous operations are pending, you can use the <xref:System.ComponentModel.ProgressChangedEventArgs.UserState%2A?displayProperty=nameWithType> property to distinguish which operation is reporting progress.</span></span>  
  
 <span data-ttu-id="47fdf-167">Некоторые классы могут предоставлять добавочные результаты по мере выполнения асинхронных операций.</span><span class="sxs-lookup"><span data-stu-id="47fdf-167">Some classes may report incremental results as asynchronous operations proceed.</span></span> <span data-ttu-id="47fdf-168">Эти результаты будут сохранены в классе, который является производным от <xref:System.ComponentModel.ProgressChangedEventArgs>, и будут иметь вид свойств в производном классе.</span><span class="sxs-lookup"><span data-stu-id="47fdf-168">These results will be stored in a class that derives from <xref:System.ComponentModel.ProgressChangedEventArgs> and they will appear as properties in the derived class.</span></span> <span data-ttu-id="47fdf-169">Вы можете получить доступ к этим результатам в обработчике событий для события `ProgressChanged` точно так же, как стали бы получать доступ к свойству <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A>.</span><span class="sxs-lookup"><span data-stu-id="47fdf-169">You can access these results in the event handler for the `ProgressChanged` event, just as you would access the <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A> property.</span></span> <span data-ttu-id="47fdf-170">Если имеется несколько ожидающих асинхронных операций, вы можете использовать свойство <xref:System.ComponentModel.ProgressChangedEventArgs.UserState%2A>, чтобы определить, какая операция выдает добавочные результаты.</span><span class="sxs-lookup"><span data-stu-id="47fdf-170">If multiple asynchronous operations are pending, you can use the <xref:System.ComponentModel.ProgressChangedEventArgs.UserState%2A> property to distinguish which operation is reporting incremental results.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="47fdf-171">См. также раздел</span><span class="sxs-lookup"><span data-stu-id="47fdf-171">See also</span></span>

- <xref:System.ComponentModel.ProgressChangedEventArgs>
- <xref:System.ComponentModel.BackgroundWorker>
- <xref:System.ComponentModel.AsyncCompletedEventArgs>
- [<span data-ttu-id="47fdf-172">Практическое руководство. Использование компонентов, поддерживающих асинхронную модель, основанную на событиях</span><span class="sxs-lookup"><span data-stu-id="47fdf-172">How to: Use Components That Support the Event-based Asynchronous Pattern</span></span>](../../../docs/standard/asynchronous-programming-patterns/how-to-use-components-that-support-the-event-based-asynchronous-pattern.md)
- [<span data-ttu-id="47fdf-173">Практическое руководство. Фоновое выполнение операции</span><span class="sxs-lookup"><span data-stu-id="47fdf-173">How to: Run an Operation in the Background</span></span>](../../../docs/framework/winforms/controls/how-to-run-an-operation-in-the-background.md)
- [<span data-ttu-id="47fdf-174">Практическое руководство. Реализация формы, в которой выполняется фоновая операция</span><span class="sxs-lookup"><span data-stu-id="47fdf-174">How to: Implement a Form That Uses a Background Operation</span></span>](../../../docs/framework/winforms/controls/how-to-implement-a-form-that-uses-a-background-operation.md)
- [<span data-ttu-id="47fdf-175">Асинхронная модель на основе событий (EAP)</span><span class="sxs-lookup"><span data-stu-id="47fdf-175">Event-based Asynchronous Pattern (EAP)</span></span>](../../../docs/standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-eap.md)
- [<span data-ttu-id="47fdf-176">Рекомендации по реализации асинхронной модели, основанной на событиях</span><span class="sxs-lookup"><span data-stu-id="47fdf-176">Best Practices for Implementing the Event-based Asynchronous Pattern</span></span>](../../../docs/standard/asynchronous-programming-patterns/best-practices-for-implementing-the-event-based-asynchronous-pattern.md)
- [<span data-ttu-id="47fdf-177">Определение, когда следует реализовать асинхронную модель, основанную на событиях</span><span class="sxs-lookup"><span data-stu-id="47fdf-177">Deciding When to Implement the Event-based Asynchronous Pattern</span></span>](../../../docs/standard/asynchronous-programming-patterns/deciding-when-to-implement-the-event-based-asynchronous-pattern.md)
