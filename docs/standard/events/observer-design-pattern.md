---
title: Шаблон разработки Observer
ms.date: 03/30/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- IObserver(Of T) interface
- IObservable<T> interface
- IObserver<T> interface
- IObservable(Of T) interface
- observer design pattern [.NET Framework]
ms.assetid: 3680171f-f522-453c-aa4a-54f755a78f88
ms.openlocfilehash: 817337cec604a431f9f7d4eacb04378ee0d3c227
ms.sourcegitcommit: 559fcfbe4871636494870a8b716bf7325df34ac5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/30/2019
ms.locfileid: "73131576"
---
# <a name="observer-design-pattern"></a><span data-ttu-id="320c3-102">Шаблон разработки Observer</span><span class="sxs-lookup"><span data-stu-id="320c3-102">Observer Design Pattern</span></span>

<span data-ttu-id="320c3-103">Шаблон разработки наблюдателя позволяет подписчику регистрироваться у поставщика и получать от него уведомления.</span><span class="sxs-lookup"><span data-stu-id="320c3-103">The observer design pattern enables a subscriber to register with and receive notifications from a provider.</span></span> <span data-ttu-id="320c3-104">Он подходит для любого сценария, в котором требуется использование push-уведомлений.</span><span class="sxs-lookup"><span data-stu-id="320c3-104">It is suitable for any scenario that requires push-based notification.</span></span> <span data-ttu-id="320c3-105">Шаблон определяет *поставщик* (также называемый *субъектом* или *наблюдаемым*) и ноль, один или несколько *наблюдателей*.</span><span class="sxs-lookup"><span data-stu-id="320c3-105">The pattern defines a *provider* (also known as a *subject* or an *observable*) and zero, one, or more *observers*.</span></span> <span data-ttu-id="320c3-106">Наблюдатели регистрируются у поставщика, и при возникновении предварительно заданного условия, события или изменения состояния поставщик автоматически уведомляет все наблюдатели путем вызова одного из их методов.</span><span class="sxs-lookup"><span data-stu-id="320c3-106">Observers register with the provider, and whenever a predefined condition, event, or state change occurs, the provider automatically notifies all observers by calling one of their methods.</span></span> <span data-ttu-id="320c3-107">В вызове метода поставщик также может предоставить наблюдателям сведения о текущем состоянии.</span><span class="sxs-lookup"><span data-stu-id="320c3-107">In this method call, the provider can also provide current state information to observers.</span></span> <span data-ttu-id="320c3-108">В .NET Framework шаблон разработки наблюдателя применяется путем реализации универсальных интерфейсов <xref:System.IObservable%601?displayProperty=nameWithType> и <xref:System.IObserver%601?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="320c3-108">In the .NET Framework, the observer design pattern is applied by implementing the generic <xref:System.IObservable%601?displayProperty=nameWithType> and <xref:System.IObserver%601?displayProperty=nameWithType> interfaces.</span></span> <span data-ttu-id="320c3-109">Параметр универсального типа представляет тип, который предоставляет сведения об уведомлении.</span><span class="sxs-lookup"><span data-stu-id="320c3-109">The generic type parameter represents the type that provides notification information.</span></span>

## <a name="applying-the-pattern"></a><span data-ttu-id="320c3-110">Применение шаблона</span><span class="sxs-lookup"><span data-stu-id="320c3-110">Applying the Pattern</span></span>

<span data-ttu-id="320c3-111">Шаблон разработки наблюдателя подходит для распределенных push-уведомлений, так как он поддерживает четкое разделение двух разных компонентов или уровней приложения, таких как уровень источника данных (бизнес-логика) и уровень пользовательского интерфейса (отображение).</span><span class="sxs-lookup"><span data-stu-id="320c3-111">The observer design pattern is suitable for distributed push-based notifications, because it supports a clean separation between two different components or application layers, such as a data source (business logic) layer and a user interface (display) layer.</span></span> <span data-ttu-id="320c3-112">Шаблон можно реализовывать во всех случаях, когда поставщик использует обратные вызовы для предоставления текущих сведений клиентам.</span><span class="sxs-lookup"><span data-stu-id="320c3-112">The pattern can be implemented whenever a provider uses callbacks to supply its clients with current information.</span></span>

<span data-ttu-id="320c3-113">Для реализации шаблона необходимы перечисленные ниже элементы.</span><span class="sxs-lookup"><span data-stu-id="320c3-113">Implementing the pattern requires that you provide the following:</span></span>

- <span data-ttu-id="320c3-114">Поставщик или субъект, то есть объект, отправляющий уведомления наблюдателям.</span><span class="sxs-lookup"><span data-stu-id="320c3-114">A provider or subject, which is the object that sends notifications to observers.</span></span> <span data-ttu-id="320c3-115">Поставщик — это класс или структура, реализующие интерфейс <xref:System.IObservable%601>.</span><span class="sxs-lookup"><span data-stu-id="320c3-115">A provider is a class or structure that implements the <xref:System.IObservable%601> interface.</span></span> <span data-ttu-id="320c3-116">Поставщик должен реализовывать единственный метод, <xref:System.IObservable%601.Subscribe%2A?displayProperty=nameWithType>, вызываемый наблюдателями, которым требуется получать уведомления от поставщика.</span><span class="sxs-lookup"><span data-stu-id="320c3-116">The provider must implement a single method, <xref:System.IObservable%601.Subscribe%2A?displayProperty=nameWithType>, which is called by observers that wish to receive notifications from the provider.</span></span>

- <span data-ttu-id="320c3-117">Наблюдатель, то есть объект, получающий уведомления от поставщика.</span><span class="sxs-lookup"><span data-stu-id="320c3-117">An observer, which is an object that receives notifications from a provider.</span></span> <span data-ttu-id="320c3-118">Наблюдатель — это класс или структура, реализующие интерфейс <xref:System.IObserver%601>.</span><span class="sxs-lookup"><span data-stu-id="320c3-118">An observer is a class or structure that implements the <xref:System.IObserver%601> interface.</span></span> <span data-ttu-id="320c3-119">Наблюдатель должен реализовывать три метода, которые вызываются поставщиком:</span><span class="sxs-lookup"><span data-stu-id="320c3-119">The observer must implement three methods, all of which are called by the provider:</span></span>

  - <span data-ttu-id="320c3-120">метод <xref:System.IObserver%601.OnNext%2A?displayProperty=nameWithType>, предоставляющий наблюдателю новые или текущие сведения;</span><span class="sxs-lookup"><span data-stu-id="320c3-120"><xref:System.IObserver%601.OnNext%2A?displayProperty=nameWithType>, which supplies the observer with new or current information.</span></span>

  - <span data-ttu-id="320c3-121">метод <xref:System.IObserver%601.OnError%2A?displayProperty=nameWithType>, информирующий наблюдатель о том, что произошла ошибка;</span><span class="sxs-lookup"><span data-stu-id="320c3-121"><xref:System.IObserver%601.OnError%2A?displayProperty=nameWithType>, which informs the observer that an error has occurred.</span></span>

  - <span data-ttu-id="320c3-122">метод <xref:System.IObserver%601.OnCompleted%2A?displayProperty=nameWithType>, указывающий, что поставщик завершил отправку уведомлений.</span><span class="sxs-lookup"><span data-stu-id="320c3-122"><xref:System.IObserver%601.OnCompleted%2A?displayProperty=nameWithType>, which indicates that the provider has finished sending notifications.</span></span>

- <span data-ttu-id="320c3-123">Механизм, который позволяет поставщику отслеживать наблюдатели.</span><span class="sxs-lookup"><span data-stu-id="320c3-123">A mechanism that allows the provider to keep track of observers.</span></span> <span data-ttu-id="320c3-124">Как правило, поставщик использует объект контейнера, например объект <xref:System.Collections.Generic.List%601?displayProperty=nameWithType>, для хранения ссылок на реализации <xref:System.IObserver%601>, которые подписаны на уведомления.</span><span class="sxs-lookup"><span data-stu-id="320c3-124">Typically, the provider uses a container object, such as a <xref:System.Collections.Generic.List%601?displayProperty=nameWithType> object, to hold references to the <xref:System.IObserver%601> implementations that have subscribed to notifications.</span></span> <span data-ttu-id="320c3-125">Использование контейнера хранилища в этих целях позволяет поставщику обрабатывать от нуля до неограниченного числа наблюдателей.</span><span class="sxs-lookup"><span data-stu-id="320c3-125">Using a storage container for this purpose enables the provider to handle zero to an unlimited number of observers.</span></span> <span data-ttu-id="320c3-126">Порядок, в котором наблюдатели получают уведомления, не определен. Поставщик может использовать любой метод для определения порядка.</span><span class="sxs-lookup"><span data-stu-id="320c3-126">The order in which observers receive notifications is not defined; the provider is free to use any method to determine the order.</span></span>

- <span data-ttu-id="320c3-127">Реализация <xref:System.IDisposable>, которая позволяет поставщику удалять наблюдатели по завершении уведомления.</span><span class="sxs-lookup"><span data-stu-id="320c3-127">An <xref:System.IDisposable> implementation that enables the provider to remove observers when notification is complete.</span></span> <span data-ttu-id="320c3-128">Наблюдатели получают ссылку на реализацию <xref:System.IDisposable> из метода <xref:System.IObservable%601.Subscribe%2A>, поэтому они также могут вызывать метод <xref:System.IDisposable.Dispose%2A?displayProperty=nameWithType>, чтобы отменить подписку, прежде чем поставщик завершит отправку уведомлений.</span><span class="sxs-lookup"><span data-stu-id="320c3-128">Observers receive a reference to the <xref:System.IDisposable> implementation from the <xref:System.IObservable%601.Subscribe%2A> method, so they can also call the <xref:System.IDisposable.Dispose%2A?displayProperty=nameWithType> method to unsubscribe before the provider has finished sending notifications.</span></span>

- <span data-ttu-id="320c3-129">Объект, содержащий данные, которые поставщик отправляет своим наблюдателям.</span><span class="sxs-lookup"><span data-stu-id="320c3-129">An object that contains the data that the provider sends to its observers.</span></span> <span data-ttu-id="320c3-130">Тип этого объекта соответствует параметру универсального типа интерфейсов <xref:System.IObservable%601> и <xref:System.IObserver%601>.</span><span class="sxs-lookup"><span data-stu-id="320c3-130">The type of this object corresponds to the generic type parameter of the <xref:System.IObservable%601> and <xref:System.IObserver%601> interfaces.</span></span> <span data-ttu-id="320c3-131">Несмотря на то что этот объект может совпадать с реализацией <xref:System.IObservable%601>, чаще всего это отдельный тип.</span><span class="sxs-lookup"><span data-stu-id="320c3-131">Although this object can be the same as the <xref:System.IObservable%601> implementation, most commonly it is a separate type.</span></span>

> [!NOTE]
> <span data-ttu-id="320c3-132">Помимо реализации шаблона разработки наблюдателя, возможно, вас заинтересуют библиотеки, создаваемые с помощью интерфейсов <xref:System.IObservable%601> и <xref:System.IObserver%601>.</span><span class="sxs-lookup"><span data-stu-id="320c3-132">In addition to implementing the observer design pattern, you may be interested in exploring libraries that are built using the <xref:System.IObservable%601> and <xref:System.IObserver%601> interfaces.</span></span> <span data-ttu-id="320c3-133">Например, [Реактивные расширения для .NET (Rx)](https://docs.microsoft.com/previous-versions/dotnet/reactive-extensions/hh242985(v=vs.103)) — это набор методов расширения и стандартных операторов последовательности LINQ для поддержки асинхронного программирования.</span><span class="sxs-lookup"><span data-stu-id="320c3-133">For example, [Reactive Extensions for .NET (Rx)](https://docs.microsoft.com/previous-versions/dotnet/reactive-extensions/hh242985(v=vs.103)) consist of a set of extension methods and LINQ standard sequence operators to support asynchronous programming.</span></span>

## <a name="implementing-the-pattern"></a><span data-ttu-id="320c3-134">Реализация шаблона</span><span class="sxs-lookup"><span data-stu-id="320c3-134">Implementing the Pattern</span></span>

<span data-ttu-id="320c3-135">В примере ниже шаблон разработки наблюдателя используется для реализации информационной системы выдачи багажа в аэропорту.</span><span class="sxs-lookup"><span data-stu-id="320c3-135">The following example uses the observer design pattern to implement an airport baggage claim information system.</span></span> <span data-ttu-id="320c3-136">Класс `BaggageInfo` предоставляет информацию о прибывающих рейсах и лентах, с которых можно получить багаж с каждого рейса.</span><span class="sxs-lookup"><span data-stu-id="320c3-136">A `BaggageInfo` class provides information about arriving flights and the carousels where baggage from each flight is available for pickup.</span></span> <span data-ttu-id="320c3-137">Он показан в примере ниже.</span><span class="sxs-lookup"><span data-stu-id="320c3-137">It is shown in the following example.</span></span>

[!code-csharp[Conceptual.ObserverDesignPattern#1](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.observerdesignpattern/cs/provider.cs#1)]
[!code-vb[Conceptual.ObserverDesignPattern#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.observerdesignpattern/vb/provider.vb#1)]

<span data-ttu-id="320c3-138">Класс `BaggageHandler` отвечает за получение информации о прибывающих рейсах и лентах выдачи багажа.</span><span class="sxs-lookup"><span data-stu-id="320c3-138">A `BaggageHandler` class is responsible for receiving information about arriving flights and baggage claim carousels.</span></span> <span data-ttu-id="320c3-139">На внутреннем уровне он поддерживает две коллекции:</span><span class="sxs-lookup"><span data-stu-id="320c3-139">Internally, it maintains two collections:</span></span>

- <span data-ttu-id="320c3-140">`observers` — коллекция клиентов, которые будут получать обновленную информацию;</span><span class="sxs-lookup"><span data-stu-id="320c3-140">`observers` - A collection of clients that will receive updated information.</span></span>

- <span data-ttu-id="320c3-141">`flights` — коллекция рейсов и соответствующих им лент.</span><span class="sxs-lookup"><span data-stu-id="320c3-141">`flights` - A collection of flights and their assigned carousels.</span></span>

<span data-ttu-id="320c3-142">Обе коллекции представлены универсальными объектами <xref:System.Collections.Generic.List%601>, экземпляры которых создаются в конструкторе класса `BaggageHandler`.</span><span class="sxs-lookup"><span data-stu-id="320c3-142">Both collections are represented by generic <xref:System.Collections.Generic.List%601> objects that are instantiated in the `BaggageHandler` class constructor.</span></span> <span data-ttu-id="320c3-143">Исходный код для класса `BaggageHandler` показан в примере ниже.</span><span class="sxs-lookup"><span data-stu-id="320c3-143">The source code for the `BaggageHandler` class is shown in the following example.</span></span>

[!code-csharp[Conceptual.ObserverDesignPattern#2](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.observerdesignpattern/cs/provider.cs#2)]
[!code-vb[Conceptual.ObserverDesignPattern#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.observerdesignpattern/vb/provider.vb#2)]

<span data-ttu-id="320c3-144">Клиенты, которым требуется получить обновленную информацию, вызывают метод `BaggageHandler.Subscribe`.</span><span class="sxs-lookup"><span data-stu-id="320c3-144">Clients that wish to receive updated information call the `BaggageHandler.Subscribe` method.</span></span> <span data-ttu-id="320c3-145">Если клиент ранее не подписался на уведомления, ссылка на реализацию <xref:System.IObserver%601> клиента добавляется в коллекцию `observers`.</span><span class="sxs-lookup"><span data-stu-id="320c3-145">If the client has not previously subscribed to notifications, a reference to the client's <xref:System.IObserver%601> implementation is added to the `observers` collection.</span></span>

<span data-ttu-id="320c3-146">Чтобы указать, что багаж с определенного рейса либо выгружается, либо более не выгружается, можно вызвать перегруженный метод `BaggageHandler.BaggageStatus`.</span><span class="sxs-lookup"><span data-stu-id="320c3-146">The overloaded `BaggageHandler.BaggageStatus` method can be called to indicate that baggage from a flight either is being unloaded or is no longer being unloaded.</span></span> <span data-ttu-id="320c3-147">В первом случае методу передается номер рейса, аэропорт его отправления и лента, на которую выгружается багаж.</span><span class="sxs-lookup"><span data-stu-id="320c3-147">In the first case, the method is passed a flight number, the airport from which the flight originated, and the carousel where baggage is being unloaded.</span></span> <span data-ttu-id="320c3-148">Во втором случае методу передается только номер рейса.</span><span class="sxs-lookup"><span data-stu-id="320c3-148">In the second case, the method is passed only a flight number.</span></span> <span data-ttu-id="320c3-149">Для выгружаемого багажа метод проверяет, существует ли переданная методу информация `BaggageInfo` в коллекции `flights`.</span><span class="sxs-lookup"><span data-stu-id="320c3-149">For baggage that is being unloaded, the method checks whether the `BaggageInfo` information passed to the method exists in the `flights` collection.</span></span> <span data-ttu-id="320c3-150">Если нет, метод добавляет эту информацию и вызывает метод `OnNext` каждого наблюдателя.</span><span class="sxs-lookup"><span data-stu-id="320c3-150">If it does not, the method adds the information and calls each observer's `OnNext` method.</span></span> <span data-ttu-id="320c3-151">Для рейсов, багаж которых более не выгружается, метод проверяет, хранится ли информация об этом рейсе в коллекции `flights`.</span><span class="sxs-lookup"><span data-stu-id="320c3-151">For flights whose baggage is no longer being unloaded, the method checks whether information on that flight is stored in the `flights` collection.</span></span> <span data-ttu-id="320c3-152">Если да, метод вызывает метод `OnNext` каждого наблюдателя и удаляет объект `BaggageInfo` из коллекции `flights`.</span><span class="sxs-lookup"><span data-stu-id="320c3-152">If it is, the method calls each observer's `OnNext` method and removes the `BaggageInfo` object from the `flights` collection.</span></span>

<span data-ttu-id="320c3-153">После посадки последнего рейса текущего дня и обработки его багажа вызывается метод `BaggageHandler.LastBaggageClaimed`.</span><span class="sxs-lookup"><span data-stu-id="320c3-153">When the last flight of the day has landed and its baggage has been processed, the `BaggageHandler.LastBaggageClaimed` method is called.</span></span> <span data-ttu-id="320c3-154">Этот метод вызывает метод `OnCompleted` каждого наблюдателя, чтобы указать, что все уведомления завершены, а затем очищает коллекцию `observers`.</span><span class="sxs-lookup"><span data-stu-id="320c3-154">This method calls each observer's `OnCompleted` method to indicate that all notifications have completed, and then clears the `observers` collection.</span></span>

<span data-ttu-id="320c3-155">Метод <xref:System.IObservable%601.Subscribe%2A> поставщика возвращает реализацию <xref:System.IDisposable>, позволяющую наблюдателям прекратить получение уведомлений до вызова метода <xref:System.IObserver%601.OnCompleted%2A>.</span><span class="sxs-lookup"><span data-stu-id="320c3-155">The provider's <xref:System.IObservable%601.Subscribe%2A> method returns an <xref:System.IDisposable> implementation that enables observers to stop receiving notifications before the <xref:System.IObserver%601.OnCompleted%2A> method is called.</span></span> <span data-ttu-id="320c3-156">Исходный код для этого класса `Unsubscriber(Of BaggageInfo)` показан в примере ниже.</span><span class="sxs-lookup"><span data-stu-id="320c3-156">The source code for this `Unsubscriber(Of BaggageInfo)` class is shown in the following example.</span></span> <span data-ttu-id="320c3-157">Когда в методе `BaggageHandler.Subscribe` создается экземпляр этого класса, ему передается ссылка на коллекцию `observers` и ссылка на наблюдатель, добавленный в эту коллекцию.</span><span class="sxs-lookup"><span data-stu-id="320c3-157">When the class is instantiated in the `BaggageHandler.Subscribe` method, it is passed a reference to the `observers` collection and a reference to the observer that is added to the collection.</span></span> <span data-ttu-id="320c3-158">Эти ссылки присваиваются локальным переменным.</span><span class="sxs-lookup"><span data-stu-id="320c3-158">These references are assigned to local variables.</span></span> <span data-ttu-id="320c3-159">Когда вызывается метод `Dispose` объекта, он проверяет, существует ли еще наблюдатель в коллекции `observers`, и если это так, удаляет наблюдатель.</span><span class="sxs-lookup"><span data-stu-id="320c3-159">When the object's `Dispose` method is called, it checks whether the observer still exists in the `observers` collection, and, if it does, removes the observer.</span></span>

[!code-csharp[Conceptual.ObserverDesignPattern#3](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.observerdesignpattern/cs/provider.cs#3)]
[!code-vb[Conceptual.ObserverDesignPattern#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.observerdesignpattern/vb/provider.vb#3)]

<span data-ttu-id="320c3-160">В примере ниже приводится реализация интерфейса <xref:System.IObserver%601> с именем `ArrivalsMonitor`, которая является базовым классом, выводящим сведения о выдаче багажа.</span><span class="sxs-lookup"><span data-stu-id="320c3-160">The following example provides an <xref:System.IObserver%601> implementation named `ArrivalsMonitor`, which is a base class that displays baggage claim information.</span></span> <span data-ttu-id="320c3-161">Сведения выводятся в алфавитном порядке по названию города отправления.</span><span class="sxs-lookup"><span data-stu-id="320c3-161">The information is displayed alphabetically, by the name of the originating city.</span></span> <span data-ttu-id="320c3-162">Методы `ArrivalsMonitor` помечаются как `overridable` (в Visual Basic) или `virtual` (в C#), поэтому все они могут переопределяться производным классом.</span><span class="sxs-lookup"><span data-stu-id="320c3-162">The methods of `ArrivalsMonitor` are marked as `overridable` (in Visual Basic) or `virtual` (in C#), so they can all be overridden by a derived class.</span></span>

[!code-csharp[Conceptual.ObserverDesignPattern#4](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.observerdesignpattern/cs/observer.cs#4)]
[!code-vb[Conceptual.ObserverDesignPattern#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.observerdesignpattern/vb/observer.vb#4)]

<span data-ttu-id="320c3-163">Класс `ArrivalsMonitor` включает в себя методы `Subscribe` и `Unsubscribe`.</span><span class="sxs-lookup"><span data-stu-id="320c3-163">The `ArrivalsMonitor` class includes the `Subscribe` and `Unsubscribe` methods.</span></span> <span data-ttu-id="320c3-164">Метод `Subscribe` позволяет классу сохранять реализацию <xref:System.IDisposable>, возвращаемую вызовом <xref:System.IObservable%601.Subscribe%2A>, в закрытой переменной.</span><span class="sxs-lookup"><span data-stu-id="320c3-164">The `Subscribe` method enables the class to save the <xref:System.IDisposable> implementation returned by the call to <xref:System.IObservable%601.Subscribe%2A> to a private variable.</span></span> <span data-ttu-id="320c3-165">Метод `Unsubscribe` позволяет классу отменить подписку на уведомления путем вызова реализации класса <xref:System.IDisposable.Dispose%2A> поставщика.</span><span class="sxs-lookup"><span data-stu-id="320c3-165">The `Unsubscribe` method enables the class to unsubscribe from notifications by calling the provider's <xref:System.IDisposable.Dispose%2A> implementation.</span></span> <span data-ttu-id="320c3-166">`ArrivalsMonitor` также предоставляет реализации методов <xref:System.IObserver%601.OnNext%2A>, <xref:System.IObserver%601.OnError%2A> и <xref:System.IObserver%601.OnCompleted%2A>.</span><span class="sxs-lookup"><span data-stu-id="320c3-166">`ArrivalsMonitor` also provides implementations of the <xref:System.IObserver%601.OnNext%2A>, <xref:System.IObserver%601.OnError%2A>, and <xref:System.IObserver%601.OnCompleted%2A> methods.</span></span> <span data-ttu-id="320c3-167">Только реализация <xref:System.IObserver%601.OnNext%2A> содержит значительный объем кода.</span><span class="sxs-lookup"><span data-stu-id="320c3-167">Only the <xref:System.IObserver%601.OnNext%2A> implementation contains a significant amount of code.</span></span> <span data-ttu-id="320c3-168">Метод работает с закрытым отсортированным универсальным объектом <xref:System.Collections.Generic.List%601>, содержащим информацию об аэропортах отправления для прибывающих рейсов и о лентах, где можно найти багаж с этих рейсов.</span><span class="sxs-lookup"><span data-stu-id="320c3-168">The method works with a private, sorted, generic <xref:System.Collections.Generic.List%601> object that maintains information about the airports of origin for arriving flights and the carousels on which their baggage is available.</span></span> <span data-ttu-id="320c3-169">Если класс `BaggageHandler` сообщает о прибытии нового рейса, реализация метода <xref:System.IObserver%601.OnNext%2A> добавляет информацию об этом рейсе в список.</span><span class="sxs-lookup"><span data-stu-id="320c3-169">If the `BaggageHandler` class reports a new flight arrival, the <xref:System.IObserver%601.OnNext%2A> method implementation adds information about that flight to the list.</span></span> <span data-ttu-id="320c3-170">Если класс `BaggageHandler` сообщает о том, что багаж рейса выгружен, метод <xref:System.IObserver%601.OnNext%2A> удаляет этот рейс из списка.</span><span class="sxs-lookup"><span data-stu-id="320c3-170">If the `BaggageHandler` class reports that the flight's baggage has been unloaded, the <xref:System.IObserver%601.OnNext%2A> method removes that flight from the list.</span></span> <span data-ttu-id="320c3-171">При любом изменении список сортируется и выводится на консоль.</span><span class="sxs-lookup"><span data-stu-id="320c3-171">Whenever a change is made, the list is sorted and displayed to the console.</span></span>

<span data-ttu-id="320c3-172">В примере ниже содержится точка входа в приложение, создающая экземпляр класса `BaggageHandler` и два экземпляра класса `ArrivalsMonitor` и использующая метод `BaggageHandler.BaggageStatus` для добавления и удаления информации о прибывающих рейсах.</span><span class="sxs-lookup"><span data-stu-id="320c3-172">The following example contains the application entry point that instantiates the `BaggageHandler` class as well as two instances of the `ArrivalsMonitor` class, and uses the `BaggageHandler.BaggageStatus` method to add and remove information about arriving flights.</span></span> <span data-ttu-id="320c3-173">Во всех случаях наблюдатели получают обновления и правильно выводят информацию о выдаче багажа.</span><span class="sxs-lookup"><span data-stu-id="320c3-173">In each case, the observers receive updates and correctly display baggage claim information.</span></span>

[!code-csharp[Conceptual.ObserverDesignPattern#5](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.observerdesignpattern/cs/program.cs#5)]
[!code-vb[Conceptual.ObserverDesignPattern#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.observerdesignpattern/vb/module1.vb#5)]

## <a name="related-topics"></a><span data-ttu-id="320c3-174">См. также</span><span class="sxs-lookup"><span data-stu-id="320c3-174">Related Topics</span></span>

|<span data-ttu-id="320c3-175">Заголовок</span><span class="sxs-lookup"><span data-stu-id="320c3-175">Title</span></span>|<span data-ttu-id="320c3-176">ОПИСАНИЕ</span><span class="sxs-lookup"><span data-stu-id="320c3-176">Description</span></span>|
|-----------|-----------------|
|[<span data-ttu-id="320c3-177">Рекомендации по шаблону разработки Observer</span><span class="sxs-lookup"><span data-stu-id="320c3-177">Observer Design Pattern Best Practices</span></span>](../../../docs/standard/events/observer-design-pattern-best-practices.md)|<span data-ttu-id="320c3-178">Рекомендации по разработке приложений, реализующих шаблон разработки наблюдателя.</span><span class="sxs-lookup"><span data-stu-id="320c3-178">Describes best practices to adopt when developing applications that implement the observer design pattern.</span></span>|
|[<span data-ttu-id="320c3-179">Практическое руководство. Реализация поставщика</span><span class="sxs-lookup"><span data-stu-id="320c3-179">How to: Implement a Provider</span></span>](../../../docs/standard/events/how-to-implement-a-provider.md)|<span data-ttu-id="320c3-180">Пошаговая реализация поставщика для приложения контроля температуры.</span><span class="sxs-lookup"><span data-stu-id="320c3-180">Provides a step-by-step implementation of a provider for a temperature monitoring application.</span></span>|
|[<span data-ttu-id="320c3-181">Практическое руководство. Реализация наблюдателя</span><span class="sxs-lookup"><span data-stu-id="320c3-181">How to: Implement an Observer</span></span>](../../../docs/standard/events/how-to-implement-an-observer.md)|<span data-ttu-id="320c3-182">Пошаговая реализация наблюдателя для приложения контроля температуры.</span><span class="sxs-lookup"><span data-stu-id="320c3-182">Provides a step-by-step implementation of an observer for a temperature monitoring application.</span></span>|
