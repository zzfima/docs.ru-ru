---
title: Вопросы безопасности сборок
ms.date: 08/20/2019
helpviewer_keywords:
- assemblies [.NET Framework], security
- signcodes
- names [.NET Framework], assemblies
- strong-named assemblies, security considerations
- signing assemblies
- assemblies [.NET Framework], signing
- granting permissions, assemblies
- assemblies [.NET Framework], strong-named
- names [.NET Framework], strong names
- permissions [.NET Framework], assemblies
- security [.NET Framework], assemblies
- integrity with assemblies
ms.assetid: 1b5439c1-f3d5-4529-bd69-01814703d067
ms.openlocfilehash: 77c9f9131b556e0b8fa639cd723bf1ca8cd6602e
ms.sourcegitcommit: f348c84443380a1959294cdf12babcb804cfa987
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/12/2019
ms.locfileid: "73972310"
---
# <a name="assembly-security-considerations"></a><span data-ttu-id="f6969-102">Вопросы безопасности сборок</span><span class="sxs-lookup"><span data-stu-id="f6969-102">Assembly security considerations</span></span>
<span data-ttu-id="f6969-103">При создании сборки можно указать набор разрешений, который требуется для ее выполнения.</span><span class="sxs-lookup"><span data-stu-id="f6969-103">When you build an assembly, you can specify a set of permissions that the assembly requires to run.</span></span> <span data-ttu-id="f6969-104">От свидетельства зависит, предоставляются ли сборке определенные разрешения.</span><span class="sxs-lookup"><span data-stu-id="f6969-104">Whether certain permissions are granted or not granted to an assembly is based on evidence.</span></span>  
  
 <span data-ttu-id="f6969-105">Существует два различных способа использования свидетельств.</span><span class="sxs-lookup"><span data-stu-id="f6969-105">There are two distinct ways evidence is used:</span></span>  
  
- <span data-ttu-id="f6969-106">Входное свидетельство объединяется со свидетельством, собранным загрузчиком для создания окончательного набора свидетельств, используемых для разрешения политики.</span><span class="sxs-lookup"><span data-stu-id="f6969-106">The input evidence is merged with the evidence gathered by the loader to create a final set of evidence used for policy resolution.</span></span> <span data-ttu-id="f6969-107">К методам, использующим такую модель, относятся **Assembly.Load**, **Assembly.LoadFrom** и **Activator.CreateInstance**.</span><span class="sxs-lookup"><span data-stu-id="f6969-107">The methods that use this semantic include **Assembly.Load**, **Assembly.LoadFrom**, and **Activator.CreateInstance**.</span></span>  
  
- <span data-ttu-id="f6969-108">В качестве окончательного набора свидетельств для разрешения политики используется неизмененное входное свидетельство.</span><span class="sxs-lookup"><span data-stu-id="f6969-108">The input evidence is used unaltered as the final set of evidence used for policy resolution.</span></span> <span data-ttu-id="f6969-109">К методам, использующим такую модель, относятся **Assembly.Load(byte[])** и **AppDomain.DefineDynamicAssembly()** .</span><span class="sxs-lookup"><span data-stu-id="f6969-109">The methods that use this semantic include **Assembly.Load(byte[])** and **AppDomain.DefineDynamicAssembly()**.</span></span>  
  
  <span data-ttu-id="f6969-110">Дополнительные разрешения могут предоставляться [политикой безопасности](../../framework/misc/code-access-security-basics.md), заданной на компьютере, где будет работать сборка.</span><span class="sxs-lookup"><span data-stu-id="f6969-110">Optional permissions can be granted by the [security policy](../../framework/misc/code-access-security-basics.md) set on the computer where the assembly will run.</span></span> <span data-ttu-id="f6969-111">Для обработки в коде всех возможных исключений безопасности необходимо выполнить одно из следующих действий.</span><span class="sxs-lookup"><span data-stu-id="f6969-111">If you want your code to handle all potential security exceptions, you can do one of the following:</span></span>  
  
- <span data-ttu-id="f6969-112">Добавить запрос разрешения для всех разрешений, которые должны быть у кода, и заранее обрабатывать сбои загрузки, которые происходят, если такие разрешения не предоставляются.</span><span class="sxs-lookup"><span data-stu-id="f6969-112">Insert a permission request for all the permissions your code must have, and handle up front the load-time failure that occurs if the permissions are not granted.</span></span>  
  
- <span data-ttu-id="f6969-113">Не использовать запросы разрешения для получения необходимых разрешений для кода, но подготовиться к обработке исключений безопасности в случае, если разрешения не будут предоставлены.</span><span class="sxs-lookup"><span data-stu-id="f6969-113">Do not use a permission request to obtain permissions your code might need, but be prepared to handle security exceptions if permissions are not granted.</span></span>  
  
  > [!NOTE]
  > <span data-ttu-id="f6969-114">Безопасность является сложной областью, допускающей много вариантов настройки.</span><span class="sxs-lookup"><span data-stu-id="f6969-114">Security is a complex area, and you have many options to choose from.</span></span> <span data-ttu-id="f6969-115">Дополнительные сведения см. в разделе [Основные понятия безопасности](../../standard/security/key-security-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="f6969-115">For more information, see [Key Security Concepts](../../standard/security/key-security-concepts.md).</span></span>  
  
 <span data-ttu-id="f6969-116">В момент загрузки свидетельство сборки используется в качестве входных данных для политики безопасности.</span><span class="sxs-lookup"><span data-stu-id="f6969-116">At load time, the assembly's evidence is used as input to security policy.</span></span> <span data-ttu-id="f6969-117">Политика безопасности устанавливается как организацией и администратором компьютера, так и параметрами безопасности пользователя, и определяет набор разрешений, предоставленных всему управляемому коду при его выполнении.</span><span class="sxs-lookup"><span data-stu-id="f6969-117">Security policy is established by the enterprise and the computer's administrator as well as by user policy settings, and determines the set of permissions that is granted to all managed code when executed.</span></span> <span data-ttu-id="f6969-118">Политика безопасности может устанавливаться для издателя сборки (если у него есть средство для создания цифровой подписи), для веб-узла и зоны (в терминах Internet Explorer), откуда была загружена сборка, или для строгого имени сборки.</span><span class="sxs-lookup"><span data-stu-id="f6969-118">Security policy can be established for the publisher of the assembly (if it has a signing tool generated signature), for the Web site and zone (in Internet Explorer terms) the assembly was downloaded from, or for the assembly's strong name.</span></span> <span data-ttu-id="f6969-119">Например, администратор компьютера может установить политику безопасности, разрешающую всему коду, загруженному с веб-узла и подписанному определенной компанией-производителем программного обеспечения, иметь доступ к базе данных на компьютере, но запрещающую запись на диск компьютера.</span><span class="sxs-lookup"><span data-stu-id="f6969-119">For example, a computer's administrator can establish security policy that allows all code downloaded from a Web site and signed by a given software company to access a database on a computer, but does not grant access to write to the computer's disk.</span></span>  
  
## <a name="strong-named-assemblies-and-signing-tools"></a><span data-ttu-id="f6969-120">Сборки со строгими именами и средства подписывания</span><span class="sxs-lookup"><span data-stu-id="f6969-120">Strong-named assemblies and signing tools</span></span>  

 > [!WARNING]
 > <span data-ttu-id="f6969-121">Строгие имена не являются средством обеспечения безопасности.</span><span class="sxs-lookup"><span data-stu-id="f6969-121">Do not rely on strong names for security.</span></span> <span data-ttu-id="f6969-122">Они служат только для однозначной идентификации.</span><span class="sxs-lookup"><span data-stu-id="f6969-122">They provide a unique identity only.</span></span>

 <span data-ttu-id="f6969-123">Сборку можно подписать двумя разными, но взаимодополняющими способами: с помощью строгого имени или с помощью [SignTool.exe (программы подписывания)](../../framework/tools/signtool-exe.md).</span><span class="sxs-lookup"><span data-stu-id="f6969-123">You can sign an assembly in two different but complementary ways: with a strong name or by using  [SignTool.exe (Sign Tool)](../../framework/tools/signtool-exe.md).</span></span> <span data-ttu-id="f6969-124">При подписи сборки строгим именем в файл, содержащий манифест сборки, добавляется зашифрованный открытый ключ.</span><span class="sxs-lookup"><span data-stu-id="f6969-124">Signing an assembly with a strong name adds public key encryption to the file containing the assembly manifest.</span></span> <span data-ttu-id="f6969-125">Подпись строгим именем гарантирует уникальность имени, предотвращает подмену имени и после разрешения ссылки предоставляет вызывающему объекту определенное удостоверение.</span><span class="sxs-lookup"><span data-stu-id="f6969-125">Strong name signing helps to verify name uniqueness, prevent name spoofing, and provide callers with some identity when a reference is resolved.</span></span>  
  
 <span data-ttu-id="f6969-126">При использовании строгого имени отсутствует связанный с ним уровень доверия, поэтому важно использовать [SignTool.exe (программу подписывания)](../../framework/tools/signtool-exe.md).</span><span class="sxs-lookup"><span data-stu-id="f6969-126">No level of trust is associated with a strong name, which makes [SignTool.exe (Sign Tool)](../../framework/tools/signtool-exe.md) important.</span></span> <span data-ttu-id="f6969-127">У этих двух средств подписи должен быть издатель, который может доказать свою подлинность стороннему центру сертификации и получить сертификат.</span><span class="sxs-lookup"><span data-stu-id="f6969-127">The two signing tools require a publisher to prove its identity to a third-party authority and obtain a certificate.</span></span> <span data-ttu-id="f6969-128">После этого указанный сертификат включается в файл и может использоваться администратором для решения о том, следует ли доверять подлинности кода.</span><span class="sxs-lookup"><span data-stu-id="f6969-128">This certificate is then embedded in your file and can be used by an administrator to decide whether to trust the code's authenticity.</span></span>  
  
 <span data-ttu-id="f6969-129">Можно присвоить сборке и строгое имя, и цифровую подпись, созданные с помощью [SignTool.exe (программы подписывания)](../../framework/tools/signtool-exe.md), или можно использовать их по отдельности.</span><span class="sxs-lookup"><span data-stu-id="f6969-129">You can give both a strong name and a digital signature created using [SignTool.exe (Sign Tool)](../../framework/tools/signtool-exe.md) to an assembly, or you can use either alone.</span></span> <span data-ttu-id="f6969-130">При использовании средств подписи можно подписывать одновременно только один файл; для сборки, состоящей из нескольких файлов, подписывается файл, содержащий манифест сборки.</span><span class="sxs-lookup"><span data-stu-id="f6969-130">The two signing tools can sign only one file at a time; for a multifile assembly, you sign the file that contains the assembly manifest.</span></span> <span data-ttu-id="f6969-131">Строгое имя хранится в файле, содержащем манифест сборки, но цифровая подпись, созданная с помощью [SignTool.exe (программы подписывания)](../../framework/tools/signtool-exe.md), хранится в зарезервированном месте переносимого исполняемого (PE) файла, содержащего манифест сборки.</span><span class="sxs-lookup"><span data-stu-id="f6969-131">A strong name is stored in the file containing the assembly manifest, but a signature created using [SignTool.exe (Sign Tool)](../../framework/tools/signtool-exe.md) is stored in a reserved slot in the portable executable (PE) file containing the assembly manifest.</span></span> <span data-ttu-id="f6969-132">Подпись сборки с помощью [SignTool.exe (программы подписывания)](../../framework/tools/signtool-exe.md) может использоваться (со строгим именем или без него), когда уже существует иерархия доверия, основанная на подписях [SignTool.exe (программы подписывания)](../../framework/tools/signtool-exe.md), или когда в политике используется только часть ключа и не проверяется цепочка доверия.</span><span class="sxs-lookup"><span data-stu-id="f6969-132">Signing of an assembly using [SignTool.exe (Sign Tool)](../../framework/tools/signtool-exe.md) can be used (with or without a strong name) when you already have a trust hierarchy that relies on [SignTool.exe (Sign Tool)](../../framework/tools/signtool-exe.md) generated signatures, or when your policy uses only the key portion and does not check a chain of trust.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="f6969-133">При использовании для сборки как строгого имени, так и подписи сначала необходимо назначить строгое имя.</span><span class="sxs-lookup"><span data-stu-id="f6969-133">When using both a strong name and a signing tool signature on an assembly, the strong name must be assigned first.</span></span>  
  
 <span data-ttu-id="f6969-134">Среда CLR также выполняет проверку хэша, поскольку манифест сборки содержит список составляющих сборку файлов, в который входит и хэш каждого файла на момент создания манифеста.</span><span class="sxs-lookup"><span data-stu-id="f6969-134">The common language runtime also performs a hash verification; the assembly manifest contains a list of all files that make up the assembly, including a hash of each file as it existed when the manifest was built.</span></span> <span data-ttu-id="f6969-135">При загрузке каждого файла его содержимое хэшируется и сравнивается с хэш-значением в манифесте.</span><span class="sxs-lookup"><span data-stu-id="f6969-135">As each file is loaded, its contents are hashed and compared with the hash value stored in the manifest.</span></span> <span data-ttu-id="f6969-136">Если хэши не совпадают, сборка не загружается.</span><span class="sxs-lookup"><span data-stu-id="f6969-136">If the two hashes do not match, the assembly fails to load.</span></span>  
  
 <span data-ttu-id="f6969-137">Так как строгое именование и подпись с помощью [SignTool.exe (программы подписывания)](../../framework/tools/signtool-exe.md) гарантирует целостность, политику управления доступом для кода можно основать на этих двух видах свидетельства сборки.</span><span class="sxs-lookup"><span data-stu-id="f6969-137">Because strong naming and signing using [SignTool.exe (Sign Tool)](../../framework/tools/signtool-exe.md) guarantee integrity, you can base code access security policy on these two forms of assembly evidence.</span></span> <span data-ttu-id="f6969-138">Строгое именование и подпись с помощью [SignTool.exe (программы подписывания)](../../framework/tools/signtool-exe.md) гарантируют целостность благодаря цифровым подписям и сертификатам.</span><span class="sxs-lookup"><span data-stu-id="f6969-138">Strong naming and signing using [SignTool.exe (Sign Tool)](../../framework/tools/signtool-exe.md) guarantee integrity through digital signatures and certificates.</span></span> <span data-ttu-id="f6969-139">Все перечисленные технологии (проверка хэша, использование строгих имен и цифровая подпись с помощью [SignTool.exe (программы подписывания)](../../framework/tools/signtool-exe.md)) используются вместе, чтобы гарантировать, что сборка не была каким-либо образом изменена.</span><span class="sxs-lookup"><span data-stu-id="f6969-139">All the technologies mentioned—hash verification, strong naming, and signing using [SignTool.exe (Sign Tool)](../../framework/tools/signtool-exe.md)—work together to ensure that the assembly has not been altered in any way.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f6969-140">См. также</span><span class="sxs-lookup"><span data-stu-id="f6969-140">See also</span></span>

- [<span data-ttu-id="f6969-141">Сборки со строгими именами</span><span class="sxs-lookup"><span data-stu-id="f6969-141">Strong-named assemblies</span></span>](strong-named.md)
- [<span data-ttu-id="f6969-142">Сборки в .NET</span><span class="sxs-lookup"><span data-stu-id="f6969-142">Assemblies in .NET</span></span>](index.md)
- [<span data-ttu-id="f6969-143">SignTool.exe (программа подписывания)</span><span class="sxs-lookup"><span data-stu-id="f6969-143">SignTool.exe (Sign Tool)</span></span>](../../framework/tools/signtool-exe.md)
