---
title: Рекомендации по размещению веб-приложений ASP.NET Core в Azure
description: Разработка современных веб-приложений с помощью ASP.NET Core и Azure | Рекомендации по размещению веб-приложений ASP.NET Core в Azure
author: ardalis
ms.author: wiwagn
ms.date: 06/27/2018
ms.openlocfilehash: 221ea2a9fc154468f16ce09195a0415883ada9df
ms.sourcegitcommit: ccd8c36b0d74d99291d41aceb14cf98d74dc9d2b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2018
ms.locfileid: "53125936"
---
# <a name="azure-hosting-recommendations-for-aspnet-core-web-apps"></a>Рекомендации по размещению веб-приложений ASP.NET Core в Azure

> "Руководители бизнес-подразделений обходятся без участия ИТ-отдела, приобретая нужные приложения (SaaS) так легко и недорого, словно покупают их в магазине. После того как услуга больше не нужна, они могут просто отменить подписку, не оставляя после себя простаивающего без дела оборудования".  
> _\- Дэрил Пламмер (Daryl Plummer), аналитик Gartner_

Платформа Windows Azure позволяет реализовать любые требования для приложения с любой архитектурой. Вам может потребоваться разместить как самый простой статический веб-сайт, так и сложное приложение, состоящее из десятков услуг. Для монолитных веб-приложений ASP.NET Core и вспомогательных услуг существует ряд хорошо известных рекомендуемых конфигураций. Приведенные в этой статье рекомендации сгруппированы по виду размещаемых ресурсов (полное приложение, отдельные процессы или данные).

## <a name="web-applications"></a>Веб-приложения

Вариант размещения веб-приложений:

- Веб-приложения службы приложений

- Контейнеры

- Azure Service Fabric

- Виртуальные машины

В большинстве сценариев рекомендуется подход с веб-приложениями службы приложений. Для архитектуры микрослужб следует рассмотреть подход на основе контейнера или платформы Service Fabric. Если вам требуется больший контроль над машинами, на которых выполняется ваше приложение, рассмотрите возможность использования виртуальных машин Azure.

### <a name="app-service-web-apps"></a>Веб-приложения службы приложений

Веб-приложения службы приложений предоставляют полностью управляемую платформу, оптимизированную для размещения веб-приложений. Это предложение на основе модели "платформа как услуга" (PaaS) позволяет вам сосредоточиться на бизнес-логике, передав все задачи по организации инфраструктуры для выполнения и масштабирования приложения на сторону Azure. Некоторые основные возможности веб-приложений служб приложений:

- Оптимизация принципов DevOps (непрерывная интеграция и поставка, несколько окружений, A/B-тестирование, поддержка скриптов).

- Глобальная масштабируемость и высокий уровень доступности.

- Подключения к платформам SaaS и локальным данным.

- Безопасность и соответствие требованиям.

- Интеграция Visual Studio.

Служба приложений Azure оптимально подходит для большинства веб-приложений. Функции развертывания и управления интегрированы в платформу, обеспечивается возможность быстрого масштабирования сайтов для обработки больших объемов трафика, а встроенные компоненты балансировки нагрузки и диспетчера трафика позволяют гарантировать высокий уровень доступности. Вы можете перенести существующий сайт в службу приложений Azure с помощью средства миграции в Интернете, использовать специальное приложение с открытым исходным кодом из коллекции веб-приложений, а также создать новый сайт с помощью удобных для вас средств и платформы. С помощью функции веб-заданий вы можете с легкостью реализовать фоновую обработку заданий в своем веб-приложении службы приложений.

### <a name="azure-kubernetes-service"></a>Служба контейнеров Azure

Служба контейнеров Azure (AKS) управляет размещенной средой Kubernetes, позволяя быстро и легко развертывать и администрировать контейнерные приложения даже без опыта оркестрации контейнеров. Это позволяет устранить нагрузку, связанную с текущими операциями и обслуживанием, благодаря подготовке, обновлению и масштабированию ресурсов по требованию без перевода приложения в автономный режим.

AKS снижает сложность и операционные затраты на управление кластером Kubernetes, перенося большую часть ответственности на Azure. Как размещенная служба, Kubernetes Azure отвечает за критические задачи, такие как мониторинг работоспособности и техническое обслуживание. Кроме того, вы платите только за узлы агентов в своих кластерах, а не за главные узлы. Как управляемая служба, Kubernetes AKS предоставляет:

- Автоматические обновления и исправления версий Kubernetes.
- Простое масштабирование кластеров.
- Самовосстанавливающуюся размещенную область управления (главные узлы).
- Сокращение затрат — вы платите только за выполняющиеся узлы пула агентов.

Когда Azure управляет узлами в кластере AKS, вам больше не нужно выполнять вручную многие задачи, например обновление кластера. Так как Azure выполняет эти важные задачи обслуживания без вашего участия, AKS не предоставляет к кластеру прямой доступ (например, с помощью SSH).

### <a name="azure-service-fabric"></a>Azure Service Fabric

Платформа Service Fabric является хорошим выбором в тех случаях, когда вы создаете новое или переписываете существующее приложение для работы с архитектурой микрослужб. Приложения, выполняющиеся в общем пуле машин, могут при необходимости масштабироваться от небольших до огромных систем, включающих сотни и даже тысячи машин. Службы с отслеживанием состояния обеспечивают удобное, согласованное и надежное хранение сведений о состоянии приложения, а Service Fabric автоматически управляет секционированием, масштабируемостью и доступностью службы. Service Fabric также поддерживает WebAPI с открытым веб-интерфейсом для .NET (OWIN) и ASP.NET Core. По сравнению со службой приложений, Service Fabric также обеспечивает более высокую степень управления базовой инфраструктурой или прямой доступ к ней. Вы можете получать удаленный доступ к серверам или настраивать задачи запуска серверов.

### <a name="azure-virtual-machines"></a>Виртуальные машины Azure

Если вам требуется внести серьезные изменения в существующее приложение для работы в службе приложений или Service Fabric, вы можете упростить миграцию в облако с помощью виртуальных машин. Тем не менее для корректной настройки, защиты и обслуживания виртуальных машин требуется гораздо больше времени и опыта по сравнению со службой приложений Azure и Service Fabric. Если вы планируете использовать виртуальные машины Azure, необходимо учитывать затраты времени и ресурсов на текущее обслуживание, установку исправлений и обновлений, а также на управление средой виртуальных машин. Виртуальные машины Azure реализуются на основе концепции "инфраструктура как услуга" (IaaS), тогда как служба приложений и Service Fabric построены на основе модели "платформа как услуга" (Paas).

#### <a name="feature-comparison"></a>Сравнение функций

| Функция                                                                                    | Служба приложений | Контейнеры (AKS) | Service Fabric. | Виртуальная машина |
| ------------------------------------------------------------------------------------------ | ----------- | ---------------- | -------------- | --------------- |
| Практически мгновенное развертывание                                                                    | X           | X                | X              |                 |
| Масштабирование до большого числа машин без повторного развертывания                                               | X           | X                | X              |                 |
| Экземпляры совместно используют содержимое и конфигурацию, не требуя повторного развертывания или настройки при масштабировании | X           | X                | X              |                 |
| Несколько сред развертывания (рабочая, промежуточная)                                     | X           | X                | X              |                 |
| Автоматическое управление обновлениями операционной системы                                                             | X           | X                |                |                 |
| Простота перехода между 32- и 64-разрядными платформами                                             | X           | X                |                |                 |
| Развертывание кода с помощью Git и FTP                                                                  | X           | X                |                | X               |
| Развертывание кода с помощью WebDeploy                                                                 | X           | X                |                | X               |
| Развертывание кода с помощью TFS                                                                       | X           | X                | X              | X               |
| Размещение уровня веб-сайтов или веб-служб многоуровневой архитектуры                                    | X           | X                | X              | X               |
| Доступ к таким службам Azure, как служебная шина, служба хранилища, база данных SQL                              | X           | X                | X              | X               |
| Установка любых пользовательских MSI                                                                     |             | X                | X              | X               |

## <a name="logical-processes"></a>Логические процессы

Отдельные логические процессы, которые могут быть отделены от остальной части приложения, могут развертываться независимо от функций Azure в режиме "без сервера". Благодаря функциям Azure вы можете просто написать код для решения возникшей проблемы, не беспокоясь о приложении или инфраструктуре, необходимых для его выполнения. Вы можете выбрать удобный для вас язык программирования, например C\#, F\#, Node.js, Python или PHP, который поможет наиболее эффективно решить задачу в вашей ситуации. Как и в случае с большинством облачных решений, вы платите только за время использования и при необходимости всегда можете рассчитывать на возможность масштабирования с использованием функций Azure.

## <a name="data"></a>Данные

Azure предлагает широкий спектр вариантов хранения данных, благодаря чему вы можете выбирать подходящий поставщик для вашего приложения.

Для работы с транзакционными и реляционными данными лучше всего подходят базы данных SQL Azure. Для данных, предназначенных преимущественно для высокопроизводительных операций чтения, эффективным решением будет кэш Redis на основе базы данных SQL Azure.

Неструктурированные данные JSON могут храниться разными способами, включая столбцы базы данных SQL, большие двоичные объекты, таблицы в службе хранилища Azure или DocumentDB. Среди этих вариантов лучшую производительность при обработке запросов обеспечивает DocumentDB, который является оптимальным вариантом для работы с большим числом документов JSON, требующих поддержки запросов.

Для данных на основе промежуточных команд или событий, используемых для оркестрации поведения приложения, можно использовать служебную шину или очереди хранилища Azure. Служебная шина Azure обеспечивает большую гибкость и является оптимальным вариантом для нетривиального обмена сообщениями в рамках одного приложения или между приложениями.

## <a name="architecture-recommendations"></a>Рекомендации по выбору архитектуры

Архитектура приложения определяется предъявляемыми к нему требованиями. Существует множество различных служб Azure. Очень важно выбрать подходящую. Корпорация Майкрософт предлагает коллекцию эталонных образцов архитектуры, на основе которой можно определить типовые архитектуры, оптимизированные для распространенных сценариев. Вы сможете найти архитектуру, которая будет в точности соответствовать потребностям вашего приложения или, как минимум, может быть использована в качестве отправной точки.

Пример эталонного образца архитектуры показан на рис. 11-2. На этой схеме описывается рекомендуемый подход к выбору архитектуры для системы управления содержимым веб-сайта Sitecore, оптимизированного для маркетинговых задач.

![](./media/image11-2.png)

**Рис. 11-1.** Эталонный образец архитектуры маркетингового веб-сайта Sitecore.

**Ссылки — рекомендации по размещению в Azure**

- Архитектуры решений Azure\
  <https://azure.microsoft.com/solutions/architecture/>

- Руководство для разработчиков Azure\
  <https://azure.microsoft.com/campaigns/developer-guide/>

- Общие сведения об устройствах\
  <https://docs.microsoft.com/azure/app-service/app-service-web-overview>

- Сравнение службы приложений, виртуальных машин, Service Fabric и облачных служб Azure\
  <https://docs.microsoft.com/azure/app-service-web/choose-web-site-cloud-service-vm>

- Общие сведения о службе контейнеров Azure (AKS)\
  <https://docs.microsoft.com/azure/aks/intro-kubernetes>

>[!div class="step-by-step"]
>[Назад](development-process-for-azure.md)